<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ï†àÎåÄÍ∞ïÏûêÍ≥ÑÏÇ∞Í∏∞ - Î™®Îì† Í≥ÑÏÇ∞ÏùÑ Ìïú Í≥≥ÏóêÏÑú</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --text-dark: #2d3748;
            --text-light: #718096;
            --bg-color: #f7fafc;
            --card-bg: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--text-dark);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            animation: fadeInDown 0.8s ease;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px;
        }

        .logo i {
            font-size: 48px;
        }

        .header h1 {
            font-size: 42px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            font-size: 18px;
            opacity: 0.9;
            font-weight: 300;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 40px 60px;
            margin-bottom: 40px;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }

        .calc-card {
            background: transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            animation: fadeInUp 0.6s ease;
        }

        .calc-card:hover {
            transform: scale(1.05);
        }

        .calc-card:hover .card-icon {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .card-icon {
            width: 80px;
            height: 80px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
            transition: all 0.3s ease;
        }

        .card-icon i {
            font-size: 36px;
            color: white;
        }

        .calc-card h3 {
            font-size: 17px;
            font-weight: 600;
            color: white;
            line-height: 1.4;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        #calculatorPage {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .calc-header {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            padding: 20px 30px;
            border-radius: 20px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .back-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            padding: 12px 20px;
            border-radius: 12px;
            color: white;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateX(-5px);
        }

        .calc-header h2 {
            font-size: 28px;
            font-weight: 600;
            color: white;
            margin: 0;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        .calc-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            max-width: 900px;
            margin: 0 auto;
            overflow-x: auto;
        }

        .calc-content.basic-calc-content {
            max-width: 100%;
            background: transparent;
            box-shadow: none;
            padding: 0;
        }

        .calc-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-group label {
            font-weight: 500;
            color: var(--text-dark);
            font-size: 15px;
        }

        .form-group input,
        .form-group select {
            padding: 14px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn-calculate {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-calculate:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .result-box {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            color: white;
            display: none;
        }

        .result-box.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .result-box h3 {
            font-size: 20px;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 16px;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-value {
            font-weight: 700;
            font-size: 18px;
        }

        .basic-calculator-container {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            max-width: 900px;
            margin: 0 auto;
        }

        .calculator-main {
            background: linear-gradient(145deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            border-radius: 24px;
            padding: 28px;
            box-shadow: 0 20px 60px rgba(102, 126, 234, 0.4), 0 8px 16px rgba(0, 0, 0, 0.1);
            min-width: 0;
            position: relative;
            overflow: hidden;
        }

        .calculator-main::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 60%);
            animation: shimmer 15s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(20%, 20%) rotate(180deg); }
        }

        .calculator-display {
            background: rgba(0, 0, 0, 0.25);
            backdrop-filter: blur(15px);
            color: white;
            padding: 24px;
            border-radius: 18px;
            text-align: right;
            font-size: clamp(26px, 5vw, 48px);
            font-weight: 400;
            letter-spacing: 1px;
            min-height: 90px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            word-break: break-all;
            margin-bottom: 24px;
            box-shadow: inset 0 4px 20px rgba(0, 0, 0, 0.3), 0 2px 4px rgba(255, 255, 255, 0.1);
            overflow: hidden;
            overflow-wrap: break-word;
            position: relative;
            z-index: 1;
            font-family: 'Segoe UI', 'SF Pro Display', -apple-system, sans-serif;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .calculator-buttons {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            position: relative;
            z-index: 1;
        }

        .calc-btn {
            padding: 18px 8px;
            border: none;
            border-radius: 16px;
            font-size: clamp(16px, 3vw, 20px);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            background: rgba(255, 255, 255, 0.95);
            color: #2d3748;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08), 0 2px 4px rgba(0, 0, 0, 0.04);
            min-width: 0;
            position: relative;
            overflow: hidden;
        }

        .calc-btn::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(180deg, rgba(255,255,255,0.5) 0%, transparent 100%);
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .calc-btn:hover {
            background: white;
            transform: translateY(-4px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .calc-btn:hover::after {
            opacity: 1;
        }

        .calc-btn:active {
            transform: translateY(-1px) scale(0.98);
        }

        .calc-btn.operator {
            background: rgba(255, 255, 255, 0.25);
            color: white;
            font-weight: 700;
            font-size: clamp(18px, 3.5vw, 24px);
            backdrop-filter: blur(5px);
        }

        .calc-btn.operator:hover {
            background: rgba(255, 255, 255, 0.4);
            box-shadow: 0 8px 25px rgba(255, 255, 255, 0.2);
        }

        .calc-btn.clear {
            background: linear-gradient(145deg, #ff6b6b 0%, #ee5a5a 100%);
            color: white;
            font-weight: 700;
        }

        .calc-btn.clear:hover {
            background: linear-gradient(145deg, #ff5252 0%, #e53935 100%);
            box-shadow: 0 8px 25px rgba(255, 82, 82, 0.4);
        }

        .calc-btn.equals {
            background: linear-gradient(145deg, #4ade80 0%, #22c55e 100%);
            color: white;
            font-size: clamp(24px, 4vw, 32px);
            font-weight: 700;
        }

        .calc-btn.equals:hover {
            background: linear-gradient(145deg, #22c55e 0%, #16a34a 100%);
            box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4);
        }

        .calc-btn.zero {
            grid-column: span 2;
        }

        .calculator-history {
            background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 24px;
            padding: 24px;
            max-height: 500px;
            display: flex;
            flex-direction: column;
            min-width: 0;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.8);
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid transparent;
            background: linear-gradient(90deg, #667eea, #764ba2) border-box;
            background-clip: padding-box, border-box;
            border-image: linear-gradient(90deg, #667eea, #764ba2) 1;
            border-image-slice: 0 0 1 0;
        }

        .history-header h3 {
            font-size: 18px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin: 0;
        }

        .clear-history-btn {
            background: linear-gradient(145deg, #ff6b6b 0%, #ee5a5a 100%);
            color: white;
            border: none;
            padding: 10px 18px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3);
        }

        .clear-history-btn:hover {
            background: linear-gradient(145deg, #ff5252 0%, #e53935 100%);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 82, 82, 0.4);
        }

        .history-list {
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding-right: 4px;
        }

        .history-list::-webkit-scrollbar {
            width: 6px;
        }

        .history-list::-webkit-scrollbar-track {
            background: #e2e8f0;
            border-radius: 3px;
        }

        .history-list::-webkit-scrollbar-thumb {
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
            border-radius: 3px;
        }

        .history-item {
            background: white;
            padding: 16px;
            border-radius: 14px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
            border: 2px solid transparent;
        }

        .history-item:hover {
            border-color: #667eea;
            background: linear-gradient(135deg, #f0f4ff 0%, #faf5ff 100%);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.15);
            transform: translateX(-6px) scale(1.01);
        }

        .history-expression {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 6px;
            font-weight: 500;
        }

        .history-result {
            font-size: 22px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .history-empty {
            text-align: center;
            color: #94a3b8;
            padding: 50px 20px;
            font-size: 15px;
            font-weight: 500;
        }

        .history-empty::before {
            content: 'üìù';
            display: block;
            font-size: 40px;
            margin-bottom: 12px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 900px) {
            .basic-calculator-container {
                grid-template-columns: 1fr;
                max-width: 500px;
            }
            .calculator-history { 
                max-height: 300px;
                order: 2;
            }
            .calculator-main {
                order: 1;
            }
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 32px; }
            .calculator-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 30px 40px;
            }
            .card-icon { width: 70px; height: 70px; }
            .card-icon i { font-size: 32px; }
            .calc-card h3 { font-size: 15px; }
            .calc-header {
                padding: 15px 20px;
                gap: 15px;
            }
            .calc-header h2 {
                font-size: 22px;
            }
            .back-btn {
                padding: 10px 15px;
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }
            .header h1 { font-size: 28px; }
            .logo i { font-size: 36px; }
            .calculator-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 25px 20px;
            }
            .card-icon { width: 60px; height: 60px; }
            .card-icon i { font-size: 28px; }
            .calc-card h3 { font-size: 13px; }
            .calc-content { padding: 15px; }
            .calculator-main {
                padding: 15px;
            }
            .calculator-display {
                padding: 15px;
                min-height: 60px;
                font-size: 24px;
            }
            .calc-btn {
                padding: 15px 8px;
                font-size: 16px;
                border-radius: 10px;
            }
            .calculator-buttons {
                gap: 8px;
            }
            .calculator-history {
                padding: 15px;
            }
            .history-header h3 {
                font-size: 16px;
            }
            .clear-history-btn {
                padding: 6px 12px;
                font-size: 12px;
            }
            .history-result {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="mainPage">
            <header class="header">
                <div class="logo">
                    <i class="fas fa-calculator"></i>
                    <h1>Ï†àÎåÄÍ∞ïÏûêÍ≥ÑÏÇ∞Í∏∞</h1>
                </div>
                <p class="subtitle">Î™®Îì† Í≥ÑÏÇ∞ÏùÑ Ìïú Í≥≥ÏóêÏÑú Í∞ÑÌé∏ÌïòÍ≤å</p>
            </header>

            <div class="calculator-grid">
                <div class="calc-card" data-calc="basic">
                    <div class="card-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h3>ÏùºÎ∞ò Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="compound">
                    <div class="card-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <h3>Ï†ÅÎ¶ΩÏãù<br>Î≥µÎ¶¨Í≥ÑÏÇ∞</h3>
                </div>

                <div class="calc-card" data-calc="deposit">
                    <div class="card-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-piggy-bank"></i>
                    </div>
                    <h3>ÏòàÍ∏à¬∑Ï†ÅÍ∏à<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="loan">
                    <div class="card-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <i class="fas fa-hand-holding-usd"></i>
                    </div>
                    <h3>ÎåÄÏ∂ú<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="dividend">
                    <div class="card-icon" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                        <i class="fas fa-coins"></i>
                    </div>
                    <h3>Î∞∞ÎãπÍ∏à<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="vat">
                    <div class="card-icon" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                        <i class="fas fa-receipt"></i>
                    </div>
                    <h3>Î∂ÄÍ∞ÄÏÑ∏<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="exchange">
                    <div class="card-icon" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <h3>ÌôòÏú®<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="pyeong">
                    <div class="card-icon" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
                        <i class="fas fa-home"></i>
                    </div>
                    <h3>ÌèâÏàò<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="commission">
                    <div class="card-icon" style="background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <h3>Î≥µÎπÑ<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="capital-gains">
                    <div class="card-icon" style="background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%);">
                        <i class="fas fa-building"></i>
                    </div>
                    <h3>ÏñëÎèÑÏÜåÎìùÏÑ∏<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="acquisition-tax">
                    <div class="card-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                        <i class="fas fa-home"></i>
                    </div>
                    <h3>Î∂ÄÎèôÏÇ∞<br>Ï∑®ÎìùÏÑ∏</h3>
                </div>

                <div class="calc-card" data-calc="car-tax">
                    <div class="card-icon" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                        <i class="fas fa-car"></i>
                    </div>
                    <h3>ÏûêÎèôÏ∞®ÏÑ∏<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="percentage">
                    <div class="card-icon" style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%);">
                        <i class="fas fa-percent"></i>
                    </div>
                    <h3>ÌçºÏÑºÌä∏<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="unit-converter">
                    <div class="card-icon" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <h3>Îã®ÏúÑÌôòÏÇ∞<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="lunar-solar">
                    <div class="card-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <i class="fas fa-moon"></i>
                    </div>
                    <h3>ÏñëÎ†•ÏùåÎ†•<br>Î≥ÄÌôò</h3>
                </div>

                <div class="calc-card" data-calc="age-calculator">
                    <div class="card-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                        <i class="fas fa-birthday-cake"></i>
                    </div>
                    <h3>ÎßåÎÇòÏù¥<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="unit-price">
                    <div class="card-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <h3>Îã®Í∞Ä<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="bmi">
                    <div class="card-icon" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);">
                        <i class="fas fa-weight"></i>
                    </div>
                    <h3>ÎπÑÎßåÎèÑ<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="dutch-pay">
                    <div class="card-icon" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
                        <i class="fas fa-dice"></i>
                    </div>
                    <h3>ÎçîÏπòÌéòÏù¥<br>Î≥µÎ∂àÎ≥µ</h3>
                </div>

                <div class="calc-card" data-calc="world-time">
                    <div class="card-icon" style="background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);">
                        <i class="fas fa-globe"></i>
                    </div>
                    <h3>ÏÑ∏Í≥ÑÏãúÍ∞Ñ<br>Î≥ÄÌôò</h3>
                </div>

                <div class="calc-card" data-calc="ovulation">
                    <div class="card-icon" style="background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%);">
                        <i class="fas fa-heart"></i>
                    </div>
                    <h3>Î∞∞ÎûÄÏùº<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="smoking">
                    <div class="card-icon" style="background: linear-gradient(135deg, #eb5757 0%, #f2994a 100%);">
                        <i class="fas fa-smoking"></i>
                    </div>
                    <h3>Ìù°Ïó∞<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="family-relation">
                    <div class="card-icon" style="background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);">
                        <i class="fas fa-users"></i>
                    </div>
                    <h3>Ï¥åÏàòÌò∏Ïπ≠<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="golf-score">
                    <div class="card-icon" style="background: linear-gradient(135deg, #10b981 0%, #34d399 100%);">
                        <i class="fas fa-golf-ball"></i>
                    </div>
                    <h3>Í≥®ÌîÑÏ†êÏàò<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="bowling-score">
                    <div class="card-icon" style="background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%);">
                        <i class="fas fa-bowling-ball"></i>
                    </div>
                    <h3>Î≥ºÎßÅÏ†êÏàò<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>

                <div class="calc-card" data-calc="shoe-size">
                    <div class="card-icon" style="background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%);">
                        <i class="fas fa-shoe-prints"></i>
                    </div>
                    <h3>Ïã†Î∞úÏπòÏàò<br>Í≥ÑÏÇ∞Í∏∞</h3>
                </div>
            </div>
        </div>

        <div id="calculatorPage">
            <div class="calc-header">
                <button class="back-btn" onclick="goBackToMain()">
                    <i class="fas fa-arrow-left"></i>
                    <span>ÎèåÏïÑÍ∞ÄÍ∏∞</span>
                </button>
                <h2 id="calcTitle">Í≥ÑÏÇ∞Í∏∞</h2>
            </div>
            <div class="calc-content" id="calcBody"></div>
        </div>
    </div>

    <script>
        let history = [];
        let currentCalc = '';

        // Ïà´ÏûêÏóê ÏΩ§Îßà Ï∂îÍ∞Ä Ìï®Ïàò
        function formatNumberWithComma(num) {
            if (num === '' || num === null || num === undefined) return '';
            const parts = num.toString().replace(/,/g, '').split('.');
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            return parts.join('.');
        }

        // ÏΩ§Îßà Ï†úÍ±∞ÌïòÍ≥† Ïà´ÏûêÎ°ú Î≥ÄÌôò
        function parseNumberFromComma(str) {
            if (str === '' || str === null || str === undefined) return 0;
            return parseFloat(str.toString().replace(/,/g, '')) || 0;
        }

        // ÏûÖÎ†• ÌïÑÎìúÏóê ÏΩ§Îßà ÏûêÎèô Ï†ÅÏö©
        function applyCommaFormat(input) {
            const cursorPos = input.selectionStart;
            const oldLength = input.value.length;
            const oldCommaCount = (input.value.match(/,/g) || []).length;
            
            // Ïà´ÏûêÏôÄ ÏÜåÏàòÏ†êÎßå ÌóàÏö©
            let value = input.value.replace(/[^\d.]/g, '');
            
            // ÏÜåÏàòÏ†êÏù¥ Ïó¨Îü¨ Í∞úÎ©¥ Ï≤´ Î≤àÏß∏Îßå Ïú†ÏßÄ
            const parts = value.split('.');
            if (parts.length > 2) {
                value = parts[0] + '.' + parts.slice(1).join('');
            }
            
            input.value = formatNumberWithComma(value);
            
            // Ïª§ÏÑú ÏúÑÏπò Ï°∞Ï†ï
            const newCommaCount = (input.value.match(/,/g) || []).length;
            const newCursorPos = cursorPos + (newCommaCount - oldCommaCount);
            input.setSelectionRange(newCursorPos, newCursorPos);
        }

        // ÏûÖÎ†• ÌïÑÎìúÏóê Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
        function setupCommaInputs() {
            document.querySelectorAll('input[data-comma="true"]').forEach(input => {
                input.addEventListener('input', function() {
                    applyCommaFormat(this);
                });
            });
        }

        document.querySelectorAll('.calc-card').forEach(card => {
            card.addEventListener('click', () => {
                const calcType = card.dataset.calc;
                openCalculator(calcType);
            });
        });

        function openCalculator(type) {
            currentCalc = type;
            document.getElementById('mainPage').style.display = 'none';
            document.getElementById('calculatorPage').style.display = 'block';
            
            const titles = {
                'basic': 'ÏùºÎ∞ò Í≥ÑÏÇ∞Í∏∞',
                'compound': 'Ï†ÅÎ¶ΩÏãù Î≥µÎ¶¨Í≥ÑÏÇ∞',
                'deposit': 'ÏòàÍ∏à¬∑Ï†ÅÍ∏à Í≥ÑÏÇ∞Í∏∞',
                'loan': 'ÎåÄÏ∂ú Í≥ÑÏÇ∞Í∏∞',
                'dividend': 'Î∞∞ÎãπÍ∏à Í≥ÑÏÇ∞Í∏∞',
                'vat': 'Î∂ÄÍ∞ÄÏÑ∏ Í≥ÑÏÇ∞Í∏∞',
                'exchange': 'ÌôòÏú® Í≥ÑÏÇ∞Í∏∞',
                'pyeong': 'ÌèâÏàò Í≥ÑÏÇ∞Í∏∞',
                'commission': 'Î≥µÎπÑ Í≥ÑÏÇ∞Í∏∞',
                'capital-gains': 'ÏñëÎèÑÏÜåÎìùÏÑ∏ Í≥ÑÏÇ∞Í∏∞',
                'acquisition-tax': 'Î∂ÄÎèôÏÇ∞ Ï∑®ÎìùÏÑ∏',
                'car-tax': 'ÏûêÎèôÏ∞®ÏÑ∏ Í≥ÑÏÇ∞Í∏∞',
                'percentage': 'ÌçºÏÑºÌä∏ Í≥ÑÏÇ∞Í∏∞',
                'unit-converter': 'Îã®ÏúÑÌôòÏÇ∞ Í≥ÑÏÇ∞Í∏∞',
                'lunar-solar': 'ÏñëÎ†•ÏùåÎ†• Î≥ÄÌôò',
                'age-calculator': 'ÎßåÎÇòÏù¥ Í≥ÑÏÇ∞Í∏∞',
                'unit-price': 'Îã®Í∞Ä Í≥ÑÏÇ∞Í∏∞',
                'bmi': 'ÎπÑÎßåÎèÑ Í≥ÑÏÇ∞Í∏∞',
                'dutch-pay': 'ÎçîÏπòÌéòÏù¥Î≥µÎ∂àÎ≥µ',
                'world-time': 'ÏÑ∏Í≥ÑÏãúÍ∞Ñ Î≥ÄÌôò',
                'ovulation': 'Î∞∞ÎûÄÏùº Í≥ÑÏÇ∞Í∏∞',
                'smoking': 'Ìù°Ïó∞ Í≥ÑÏÇ∞Í∏∞',
                'family-relation': 'Ï¥åÏàòÌò∏Ïπ≠ Í≥ÑÏÇ∞Í∏∞',
                'golf-score': 'Í≥®ÌîÑÏ†êÏàò Í≥ÑÏÇ∞Í∏∞',
                'bowling-score': 'Î≥ºÎßÅÏ†êÏàò Í≥ÑÏÇ∞Í∏∞',
                'shoe-size': 'Ïã†Î∞úÏπòÏàò Í≥ÑÏÇ∞Í∏∞'
            };
            
            document.getElementById('calcTitle').textContent = titles[type];
            loadCalculator(type);
        }

        function goBackToMain() {
            document.getElementById('mainPage').style.display = 'block';
            document.getElementById('calculatorPage').style.display = 'none';
        }

        function loadCalculator(type) {
            const calcBody = document.getElementById('calcBody');
            
            // ÏùºÎ∞ò Í≥ÑÏÇ∞Í∏∞Ïùº Îïå ÌäπÎ≥ÑÌïú Ïä§ÌÉÄÏùº Ï†ÅÏö©
            if (type === 'basic') {
                calcBody.classList.add('basic-calc-content');
            } else {
                calcBody.classList.remove('basic-calc-content');
            }
            
            switch(type) {
                case 'basic':
                    calcBody.innerHTML = getBasicCalculator();
                    break;
                case 'compound':
                    calcBody.innerHTML = getCompoundCalculator();
                    break;
                case 'deposit':
                    calcBody.innerHTML = getDepositCalculator();
                    break;
                case 'loan':
                    calcBody.innerHTML = getLoanCalculator();
                    break;
                case 'vat':
                    calcBody.innerHTML = getVatCalculator();
                    break;
                case 'percentage':
                    calcBody.innerHTML = getPercentageCalculator();
                    break;
                case 'bmi':
                    calcBody.innerHTML = getBMICalculator();
                    break;
                case 'dutch-pay':
                    calcBody.innerHTML = getDutchPayCalculator();
                    break;
                case 'pyeong':
                    calcBody.innerHTML = getPyeongCalculator();
                    break;
                case 'commission':
                    calcBody.innerHTML = getCommissionCalculator();
                    break;
                case 'age-calculator':
                    calcBody.innerHTML = getAgeCalculator();
                    break;
                case 'unit-price':
                    calcBody.innerHTML = getUnitPriceCalculator();
                    initUnitPriceCalculator();
                    break;
                case 'dividend':
                    calcBody.innerHTML = getDividendCalculator();
                    break;
                case 'exchange':
                    calcBody.innerHTML = getExchangeCalculator();
                    initExchangeCalculator();
                    break;
                case 'world-time':
                    calcBody.innerHTML = getWorldTimeCalculator();
                    initWorldTime();
                    break;
                case 'capital-gains':
                    calcBody.innerHTML = getCapitalGainsTaxCalculator();
                    break;
                case 'acquisition-tax':
                    calcBody.innerHTML = getAcquisitionTaxCalculator();
                    break;
                case 'car-tax':
                    calcBody.innerHTML = getCarTaxCalculator();
                    break;
                case 'unit-converter':
                    calcBody.innerHTML = getUnitConverterCalculator();
                    initUnitConverter();
                    break;
                case 'smoking':
                    calcBody.innerHTML = getSmokingCalculator();
                    break;
                case 'ovulation':
                    calcBody.innerHTML = getOvulationCalculator();
                    initOvulationCalculator();
                    break;
                case 'family-relation':
                    calcBody.innerHTML = getFamilyRelationCalculator();
                    initFamilyRelationCalculator();
                    break;
                case 'golf-score':
                    calcBody.innerHTML = getGolfScoreCalculator();
                    initGolfScoreCalculator();
                    break;
                case 'bowling-score':
                    calcBody.innerHTML = getBowlingScoreCalculator();
                    initBowlingScoreCalculator();
                    break;
                case 'shoe-size':
                    calcBody.innerHTML = getShoeSizeCalculator();
                    initShoeSizeCalculator();
                    break;
                case 'lunar-solar':
                    calcBody.innerHTML = getLunarSolarConverter();
                    initLunarSolarConverter();
                    break;
                default:
                    calcBody.innerHTML = `<p style="text-align: center; color: #718096;">Ïù¥ Í≥ÑÏÇ∞Í∏∞Îäî Ï§ÄÎπÑ Ï§ëÏûÖÎãàÎã§.</p>`;
            }
            
            // ÏΩ§Îßà ÏûÖÎ†• ÌïÑÎìú ÏÑ§Ï†ï
            setTimeout(() => setupCommaInputs(), 100);
        }

        function getBasicCalculator() {
            return `
                <div class="basic-calculator-container">
                    <div class="calculator-main">
                        <div class="calculator-display" id="display">0</div>
                        <div class="calculator-buttons">
                            <button class="calc-btn clear" onclick="clearDisplay()">C</button>
                            <button class="calc-btn operator" onclick="appendPercent()">%</button>
                            <button class="calc-btn operator" onclick="appendOperator('/')">/</button>
                            <button class="calc-btn operator" onclick="appendOperator('*')">√ó</button>
                            <button class="calc-btn operator" onclick="deleteChar()">‚å´</button>
                            
                            <button class="calc-btn" onclick="appendNumber('7')">7</button>
                            <button class="calc-btn" onclick="appendNumber('8')">8</button>
                            <button class="calc-btn" onclick="appendNumber('9')">9</button>
                            <button class="calc-btn operator" onclick="appendOperator('-')">-</button>
                            <button class="calc-btn operator" onclick="appendOperator('+')">+</button>
                            
                            <button class="calc-btn" onclick="appendNumber('4')">4</button>
                            <button class="calc-btn" onclick="appendNumber('5')">5</button>
                            <button class="calc-btn" onclick="appendNumber('6')">6</button>
                            <button class="calc-btn" onclick="appendNumber('00')">00</button>
                            <button class="calc-btn equals" onclick="calculate()" style="grid-row: span 2;">=</button>
                            
                            <button class="calc-btn" onclick="appendNumber('1')">1</button>
                            <button class="calc-btn" onclick="appendNumber('2')">2</button>
                            <button class="calc-btn" onclick="appendNumber('3')">3</button>
                            <button class="calc-btn" onclick="appendNumber('000')">000</button>
                            
                            <button class="calc-btn zero" style="grid-column: span 2;" onclick="appendNumber('0')">0</button>
                            <button class="calc-btn" onclick="appendNumber('.')">.</button>
                            <button class="calc-btn" onclick="toggleSign()">¬±</button>
                        </div>
                    </div>
                    <div class="calculator-history">
                        <div class="history-header">
                            <h3>Í≥ÑÏÇ∞ Í∏∞Î°ù</h3>
                            <button class="clear-history-btn" onclick="clearHistory()">
                                <i class="fas fa-trash"></i> Ï†ÑÏ≤¥ ÏÇ≠Ï†ú
                            </button>
                        </div>
                        <div class="history-list" id="historyList">
                            <div class="history-empty">Í≥ÑÏÇ∞ Í∏∞Î°ùÏù¥ ÏóÜÏäµÎãàÎã§</div>
                        </div>
                    </div>
                </div>
            `;
        }

        let currentInput = '0';
        let expression = '';
        let rawCurrentInput = '0'; // ÏΩ§Îßà ÏóÜÎäî ÏõêÎ≥∏ Ïà´Ïûê

        // ÏùºÎ∞ò Í≥ÑÏÇ∞Í∏∞Ïö© Ïà´Ïûê Ìè¨Îß∑ÌåÖ (ÏΩ§Îßà Ï∂îÍ∞Ä)
        function formatCalcNumber(numStr) {
            if (numStr === '' || numStr === '-') return numStr;
            
            // ÏùåÏàò Ï≤òÎ¶¨
            const isNegative = numStr.startsWith('-');
            let cleanNum = isNegative ? numStr.slice(1) : numStr;
            
            // ÏÜåÏàòÏ†ê Î∂ÑÎ¶¨
            const parts = cleanNum.split('.');
            
            // Ï†ïÏàò Î∂ÄÎ∂ÑÏóê ÏΩ§Îßà Ï∂îÍ∞Ä
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            
            const result = parts.join('.');
            return isNegative ? '-' + result : result;
        }

        // ÏΩ§Îßà Ï†úÍ±∞
        function removeCalcCommas(str) {
            return str.replace(/,/g, '');
        }

        function appendNumber(num) {
            if (rawCurrentInput === '0' && num !== '.') {
                rawCurrentInput = num;
            } else if (num === '.' && rawCurrentInput.includes('.')) {
                return; // ÏÜåÏàòÏ†ê Ï§ëÎ≥µ Î∞©ÏßÄ
            } else {
                rawCurrentInput += num;
            }
            currentInput = formatCalcNumber(rawCurrentInput);
            updateDisplay();
        }

        function appendOperator(op) {
            const displayOp = (op === '*' ? '√ó' : op);
            
            // ÌòÑÏû¨ ÏûÖÎ†•Îêú Ïà´ÏûêÍ∞Ä ÏûàÏúºÎ©¥ ÏàòÏãùÏóê Ï∂îÍ∞Ä
            if (rawCurrentInput !== '' && rawCurrentInput !== '0') {
                expression += formatCalcNumber(rawCurrentInput) + ' ' + displayOp + ' ';
                rawCurrentInput = '';
                currentInput = '';
            } else if (currentInput !== '' && currentInput !== '0') {
                expression += currentInput + ' ' + displayOp + ' ';
                rawCurrentInput = '';
                currentInput = '';
            } else if (expression !== '') {
                // Ïù¥ÎØ∏ Ïó∞ÏÇ∞ÏûêÍ∞Ä ÏûàÏúºÎ©¥ ÎßàÏßÄÎßâ Ïó∞ÏÇ∞ÏûêÎ•º ÍµêÏ≤¥
                expression = expression.replace(/[+\-√ó/] $/, displayOp + ' ');
            }
            updateDisplay();
        }

        function appendPercent() {
            if (rawCurrentInput !== '' && rawCurrentInput !== '0') {
                const percentValue = parseFloat(rawCurrentInput) / 100;
                rawCurrentInput = percentValue.toString();
                currentInput = formatCalcNumber(rawCurrentInput);
                updateDisplay();
            }
        }

        function deleteChar() {
            if (rawCurrentInput.length > 1) {
                rawCurrentInput = rawCurrentInput.slice(0, -1);
                currentInput = formatCalcNumber(rawCurrentInput);
            } else if (rawCurrentInput.length === 1 && rawCurrentInput !== '0') {
                rawCurrentInput = '0';
                currentInput = '0';
            } else if (expression !== '') {
                // expressionÏóêÏÑú ÎßàÏßÄÎßâ Ïó∞ÏÇ∞ÏûêÏôÄ Ïà´Ïûê Ï†úÍ±∞
                expression = expression.replace(/\d[\d,]*\.?\d*\s*[+\-√ó/]\s*$/, '').replace(/\s*[+\-√ó/]\s*$/, '');
                if (expression === '') {
                    rawCurrentInput = '0';
                    currentInput = '0';
                }
            }
            updateDisplay();
        }

        function clearDisplay() {
            rawCurrentInput = '0';
            currentInput = '0';
            expression = '';
            updateDisplay();
        }

        function toggleSign() {
            if (rawCurrentInput !== '0' && rawCurrentInput !== '') {
                if (rawCurrentInput.startsWith('-')) {
                    rawCurrentInput = rawCurrentInput.slice(1);
                } else {
                    rawCurrentInput = '-' + rawCurrentInput;
                }
                currentInput = formatCalcNumber(rawCurrentInput);
                updateDisplay();
            }
        }

        function updateDisplay() {
            document.getElementById('display').textContent = expression + currentInput;
        }

        function calculate() {
            try {
                // ÌëúÏãúÏö© ÏàòÏãù (ÏΩ§Îßà Ìè¨Ìï®)
                const displayExpression = expression + currentInput;
                
                // Í≥ÑÏÇ∞Ïö© ÏàòÏãù (ÏΩ§Îßà Ï†úÍ±∞)
                const calcExpression = removeCalcCommas(displayExpression).replace(/√ó/g, '*').replace(/√∑/g, '/');
                const result = eval(calcExpression);
                
                // Í≤∞Í≥º Ìè¨Îß∑ÌåÖ
                const formattedResult = formatCalcNumber(result.toString());
                
                history.unshift({
                    expression: displayExpression,
                    result: formattedResult
                });
                
                updateHistory();
                rawCurrentInput = result.toString();
                currentInput = formattedResult;
                expression = '';
                updateDisplay();
            } catch (e) {
                rawCurrentInput = '0';
                currentInput = 'Error';
                updateDisplay();
            }
        }

        function updateHistory() {
            const historyList = document.getElementById('historyList');
            if (!historyList) return;
            
            if (history.length === 0) {
                historyList.innerHTML = '<div class="history-empty">Í≥ÑÏÇ∞ Í∏∞Î°ùÏù¥ ÏóÜÏäµÎãàÎã§</div>';
            } else {
                historyList.innerHTML = history.map((item, index) => `
                    <div class="history-item" onclick="useHistoryResult(${index})">
                        <div class="history-expression">${item.expression}</div>
                        <div class="history-result">= ${item.result}</div>
                    </div>
                `).join('');
            }
        }

        function useHistoryResult(index) {
            const resultStr = history[index].result.toString();
            rawCurrentInput = removeCalcCommas(resultStr);
            currentInput = resultStr;
            expression = '';
            updateDisplay();
        }

        function clearHistory() {
            history = [];
            updateHistory();
        }

        function getCompoundCalculator() {
            return `
                <style>
                    .compound-container {
                        display: flex;
                        flex-direction: column;
                        gap: 30px;
                    }
                    .compound-form-section {
                        background: #f8fafc;
                        padding: 25px;
                        border-radius: 15px;
                    }
                    .compound-result-section {
                        display: none;
                    }
                    .compound-result-section.active {
                        display: block;
                        animation: fadeIn 0.5s ease;
                    }
                    .compound-summary {
                        display: grid;
                        grid-template-columns: repeat(4, 1fr);
                        gap: 15px;
                        margin-bottom: 30px;
                    }
                    .summary-card {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        padding: 20px;
                        border-radius: 15px;
                        color: white;
                        text-align: center;
                    }
                    .summary-card.profit {
                        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
                    }
                    .summary-card.rate {
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                    }
                    .summary-card.total {
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                    }
                    .summary-label {
                        font-size: 13px;
                        opacity: 0.9;
                        margin-bottom: 8px;
                    }
                    .summary-value {
                        font-size: 20px;
                        font-weight: 700;
                    }
                    .chart-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                    }
                    .chart-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .chart-title i {
                        color: #667eea;
                    }
                    .yearly-table-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                        overflow-x: auto;
                    }
                    .yearly-table {
                        width: 100%;
                        border-collapse: collapse;
                        font-size: 14px;
                    }
                    .yearly-table th {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 12px 15px;
                        text-align: right;
                        font-weight: 600;
                    }
                    .yearly-table th:first-child {
                        text-align: center;
                        border-radius: 10px 0 0 0;
                    }
                    .yearly-table th:last-child {
                        border-radius: 0 10px 0 0;
                    }
                    .yearly-table td {
                        padding: 12px 15px;
                        text-align: right;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .yearly-table td:first-child {
                        text-align: center;
                        font-weight: 600;
                        color: #667eea;
                    }
                    .yearly-table tr:hover {
                        background: #f7fafc;
                    }
                    .yearly-table tr:last-child td:first-child {
                        border-radius: 0 0 0 10px;
                    }
                    .yearly-table tr:last-child td:last-child {
                        border-radius: 0 0 10px 0;
                    }
                    .profit-cell {
                        color: #38a169;
                        font-weight: 600;
                    }
                    .etf-tips-container {
                        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                    }
                    .etf-tips-title {
                        font-size: 18px;
                        font-weight: 600;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .etf-tips-title i {
                        color: #ffd700;
                    }
                    .etf-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                    }
                    .etf-card {
                        background: rgba(255,255,255,0.1);
                        padding: 18px;
                        border-radius: 12px;
                        backdrop-filter: blur(10px);
                        transition: all 0.3s ease;
                    }
                    .etf-card:hover {
                        background: rgba(255,255,255,0.15);
                        transform: translateY(-3px);
                    }
                    .etf-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 10px;
                    }
                    .etf-name {
                        font-weight: 700;
                        font-size: 16px;
                    }
                    .etf-return {
                        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
                        padding: 5px 12px;
                        border-radius: 20px;
                        font-weight: 700;
                        font-size: 14px;
                    }
                    .etf-desc {
                        font-size: 13px;
                        opacity: 0.8;
                        line-height: 1.5;
                    }
                    .etf-note {
                        margin-top: 20px;
                        padding: 15px;
                        background: rgba(255,215,0,0.1);
                        border-radius: 10px;
                        border-left: 4px solid #ffd700;
                        font-size: 13px;
                        line-height: 1.6;
                    }
                    @media (max-width: 768px) {
                        .compound-summary {
                            grid-template-columns: repeat(2, 1fr);
                        }
                        .etf-grid {
                            grid-template-columns: 1fr;
                        }
                        .summary-value {
                            font-size: 16px;
                        }
                    }
                    @media (max-width: 480px) {
                        .compound-summary {
                            grid-template-columns: 1fr;
                        }
                    }
                </style>
                <div class="compound-container">
                    <div class="compound-form-section">
                        <form class="calc-form" onsubmit="calculateCompound(event)">
                            <div class="form-group">
                                <label><i class="fas fa-wallet" style="color: #667eea; margin-right: 8px;"></i>Ï¥àÍ∏∞ Ìà¨ÏûêÍ∏à (Ïõê)</label>
                                <input type="text" id="initialAmount" data-comma="true" placeholder="1,000,000" required>
                            </div>
                            <div class="form-group">
                                <label><i class="fas fa-calendar-plus" style="color: #667eea; margin-right: 8px;"></i>Ïõî Ï†ÅÎ¶ΩÍ∏à (Ïõê)</label>
                                <input type="text" id="monthlyAmount" data-comma="true" placeholder="100,000" required>
                            </div>
                            <div class="form-group">
                                <label><i class="fas fa-percentage" style="color: #667eea; margin-right: 8px;"></i>Ïó∞ ÏàòÏùµÎ•† (%)</label>
                                <input type="text" id="interestRate" placeholder="7" required>
                            </div>
                            <div class="form-group">
                                <label><i class="fas fa-clock" style="color: #667eea; margin-right: 8px;"></i>Ìà¨Ïûê Í∏∞Í∞Ñ (ÎÖÑ)</label>
                                <input type="text" id="years" placeholder="10" required>
                            </div>
                            <button type="submit" class="btn-calculate">
                                <i class="fas fa-calculator" style="margin-right: 8px;"></i>Î≥µÎ¶¨ Í≥ÑÏÇ∞ÌïòÍ∏∞
                            </button>
                        </form>
                    </div>
                    
                    <div class="compound-result-section" id="compoundResultSection">
                        <div class="compound-summary" id="compoundSummary"></div>
                        <div class="chart-container">
                            <div class="chart-title"><i class="fas fa-chart-area"></i> ÏûêÏÇ∞ ÏÑ±Ïû• Í∑∏ÎûòÌîÑ</div>
                            <canvas id="compoundChart"></canvas>
                        </div>
                        <div class="yearly-table-container">
                            <div class="chart-title"><i class="fas fa-table"></i> Ïó∞ÎèÑÎ≥Ñ ÏÉÅÏÑ∏ ÎÇ¥Ïó≠</div>
                            <table class="yearly-table" id="yearlyTable"></table>
                        </div>
                        <div class="etf-tips-container">
                            <div class="etf-tips-title"><i class="fas fa-lightbulb"></i> ÎØ∏Íµ≠ Ïö∞Îüâ ETF ÏµúÍ∑º 10ÎÖÑ ÏàòÏùµÎ•† Ï∞∏Í≥†</div>
                            <div class="etf-grid">
                                <div class="etf-card">
                                    <div class="etf-header">
                                        <span class="etf-name">VOO</span>
                                        <span class="etf-return">+212%</span>
                                    </div>
                                    <div class="etf-desc">Vanguard S&P 500 ETF<br>ÎØ∏Íµ≠ ÎåÄÌòïÏ£º 500Í∞ú Ï∂îÏ¢Ö, Ïó∞ÌèâÍ∑† ÏïΩ 12%</div>
                                </div>
                                <div class="etf-card">
                                    <div class="etf-header">
                                        <span class="etf-name">QQQ</span>
                                        <span class="etf-return">+396%</span>
                                    </div>
                                    <div class="etf-desc">Invesco NASDAQ 100 ETF<br>Í∏∞Ïà†Ï£º Ï§ëÏã¨, Ïó∞ÌèâÍ∑† ÏïΩ 17%</div>
                                </div>
                                <div class="etf-card">
                                    <div class="etf-header">
                                        <span class="etf-name">SPY</span>
                                        <span class="etf-return">+208%</span>
                                    </div>
                                    <div class="etf-desc">SPDR S&P 500 ETF<br>ÏÑ∏Í≥Ñ ÏµúÎåÄ Í∑úÎ™® ETF, Ïó∞ÌèâÍ∑† ÏïΩ 12%</div>
                                </div>
                                <div class="etf-card">
                                    <div class="etf-header">
                                        <span class="etf-name">VTI</span>
                                        <span class="etf-return">+196%</span>
                                    </div>
                                    <div class="etf-desc">Vanguard Total Stock Market<br>ÎØ∏Íµ≠ Ï†ÑÏ≤¥ ÏãúÏû•, Ïó∞ÌèâÍ∑† ÏïΩ 11%</div>
                                </div>
                                <div class="etf-card">
                                    <div class="etf-header">
                                        <span class="etf-name">SCHD</span>
                                        <span class="etf-return">+176%</span>
                                    </div>
                                    <div class="etf-desc">Schwab US Dividend Equity<br>Î∞∞ÎãπÏÑ±Ïû•Ï£º, Ïó∞ÌèâÍ∑† ÏïΩ 10.5%</div>
                                </div>
                                <div class="etf-card">
                                    <div class="etf-header">
                                        <span class="etf-name">VGT</span>
                                        <span class="etf-return">+450%</span>
                                    </div>
                                    <div class="etf-desc">Vanguard Info Tech ETF<br>IT ÏÑπÌÑ∞ ÏßëÏ§ë, Ïó∞ÌèâÍ∑† ÏïΩ 18%</div>
                                </div>
                            </div>
                            <div class="etf-note">
                                <strong>üí° Ìà¨Ïûê ÌåÅ:</strong> Í≥ºÍ±∞ ÏàòÏùµÎ•†Ïù¥ ÎØ∏Îûò ÏàòÏùµÏùÑ Î≥¥Ïû•ÌïòÏßÄ ÏïäÏäµÎãàÎã§. 
                                Ïû•Í∏∞ Ìà¨ÏûêÏôÄ Î∂ÑÏÇ∞ Ìà¨ÏûêÍ∞Ä Ï§ëÏöîÌïòÎ©∞, S&P 500 ÏßÄÏàòÏùò Ïó≠ÏÇ¨Ï†Å ÌèâÍ∑† ÏàòÏùµÎ•†ÏùÄ Ïó∞ ÏïΩ 10%ÏûÖÎãàÎã§.
                                Î≥µÎ¶¨ Ìö®Í≥ºÎ•º Í∑πÎåÄÌôîÌïòÎ†§Î©¥ ÏµúÏÜå 10ÎÖÑ Ïù¥ÏÉÅÏùò Ïû•Í∏∞ Ìà¨ÏûêÎ•º Í∂åÏû•Ìï©ÎãàÎã§.
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        let compoundChartInstance = null;

        function calculateCompound(e) {
            e.preventDefault();
            const initial = parseNumberFromComma(document.getElementById('initialAmount').value);
            const monthly = parseNumberFromComma(document.getElementById('monthlyAmount').value);
            const rate = parseFloat(document.getElementById('interestRate').value) / 100;
            const years = parseInt(document.getElementById('years').value);
            
            const monthlyRate = rate / 12;
            const months = years * 12;
            
            // Ïó∞ÎèÑÎ≥Ñ Îç∞Ïù¥ÌÑ∞ Í≥ÑÏÇ∞
            let yearlyData = [];
            let total = initial;
            let totalInvested = initial;
            
            for (let year = 1; year <= years; year++) {
                let yearStart = total;
                let yearInvested = 0;
                
                for (let month = 0; month < 12; month++) {
                    total = total * (1 + monthlyRate) + monthly;
                    totalInvested += monthly;
                    yearInvested += monthly;
                }
                
                yearlyData.push({
                    year: year,
                    invested: totalInvested,
                    total: Math.round(total),
                    profit: Math.round(total - totalInvested),
                    yearlyContribution: initial + yearInvested * year / year
                });
            }
            
            const finalTotal = total;
            const finalInvested = totalInvested;
            const profit = finalTotal - finalInvested;
            const profitRate = (profit / finalInvested) * 100;
            
            // Í≤∞Í≥º ÏÑπÏÖò ÌëúÏãú
            const resultSection = document.getElementById('compoundResultSection');
            resultSection.classList.add('active');
            
            // ÏöîÏïΩ Ïπ¥Îìú ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('compoundSummary').innerHTML = `
                <div class="summary-card">
                    <div class="summary-label">Ï¥ù Ìà¨ÏûêÍ∏àÏï°</div>
                    <div class="summary-value">${Math.round(finalInvested).toLocaleString()}Ïõê</div>
                </div>
                <div class="summary-card total">
                    <div class="summary-label">ÏµúÏ¢Ö ÏûêÏÇ∞</div>
                    <div class="summary-value">${Math.round(finalTotal).toLocaleString()}Ïõê</div>
                </div>
                <div class="summary-card profit">
                    <div class="summary-label">Ï¥ù ÏàòÏùµÍ∏à</div>
                    <div class="summary-value">+${Math.round(profit).toLocaleString()}Ïõê</div>
                </div>
                <div class="summary-card rate">
                    <div class="summary-label">Ï¥ù ÏàòÏùµÎ•†</div>
                    <div class="summary-value">+${profitRate.toFixed(1)}%</div>
                </div>
            `;
            
            // Ï∞®Ìä∏ ÏÉùÏÑ±
            const ctx = document.getElementById('compoundChart').getContext('2d');
            
            if (compoundChartInstance) {
                compoundChartInstance.destroy();
            }
            
            compoundChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: yearlyData.map(d => d.year + 'ÎÖÑ'),
                    datasets: [
                        {
                            label: 'Ï¥ù ÏûêÏÇ∞',
                            data: yearlyData.map(d => d.total),
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 3,
                            pointBackgroundColor: '#667eea',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 5
                        },
                        {
                            label: 'Ìà¨Ïûê ÏõêÍ∏à',
                            data: yearlyData.map(d => d.invested),
                            borderColor: '#a0aec0',
                            backgroundColor: 'rgba(160, 174, 192, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 2,
                            borderDash: [5, 5],
                            pointBackgroundColor: '#a0aec0',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                usePointStyle: true,
                                padding: 20,
                                font: {
                                    size: 13,
                                    weight: '500'
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            padding: 15,
                            titleFont: { size: 14, weight: 'bold' },
                            bodyFont: { size: 13 },
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.raw.toLocaleString() + 'Ïõê';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    if (value >= 100000000) {
                                        return (value / 100000000).toFixed(1) + 'Ïñµ';
                                    } else if (value >= 10000) {
                                        return (value / 10000).toFixed(0) + 'Îßå';
                                    }
                                    return value;
                                },
                                font: { size: 12 }
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)'
                            }
                        },
                        x: {
                            ticks: {
                                font: { size: 12 }
                            },
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
            
            // Ïó∞ÎèÑÎ≥Ñ ÌÖåÏù¥Î∏î ÏÉùÏÑ±
            let tableHTML = `
                <thead>
                    <tr>
                        <th>Ïó∞Ï∞®</th>
                        <th>Ìà¨Ïûê ÏõêÍ∏à</th>
                        <th>Ï¥ù ÏûêÏÇ∞</th>
                        <th>ÎàÑÏ†Å ÏàòÏùµ</th>
                        <th>ÏàòÏùµÎ•†</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            yearlyData.forEach(data => {
                const yearProfitRate = ((data.total - data.invested) / data.invested * 100).toFixed(1);
                tableHTML += `
                    <tr>
                        <td>${data.year}ÎÖÑÏ∞®</td>
                        <td>${data.invested.toLocaleString()}Ïõê</td>
                        <td>${data.total.toLocaleString()}Ïõê</td>
                        <td class="profit-cell">+${data.profit.toLocaleString()}Ïõê</td>
                        <td class="profit-cell">+${yearProfitRate}%</td>
                    </tr>
                `;
            });
            
            tableHTML += '</tbody>';
            document.getElementById('yearlyTable').innerHTML = tableHTML;
            
            // Í≤∞Í≥º ÏÑπÏÖòÏúºÎ°ú Ïä§ÌÅ¨Î°§
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function getDepositCalculator() {
            return `
                <style>
                    .deposit-container {
                        display: flex;
                        flex-direction: column;
                        gap: 30px;
                    }
                    .deposit-form-section {
                        background: #f8fafc;
                        padding: 25px;
                        border-radius: 15px;
                    }
                    .form-row {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 20px;
                    }
                    .deposit-result-section {
                        display: none;
                    }
                    .deposit-result-section.active {
                        display: block;
                        animation: fadeIn 0.5s ease;
                    }
                    .deposit-summary {
                        display: grid;
                        grid-template-columns: repeat(4, 1fr);
                        gap: 15px;
                        margin-bottom: 30px;
                    }
                    .deposit-summary-card {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        padding: 20px;
                        border-radius: 15px;
                        color: white;
                        text-align: center;
                    }
                    .deposit-summary-card.interest {
                        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
                    }
                    .deposit-summary-card.tax {
                        background: linear-gradient(135deg, #fc8181 0%, #f56565 100%);
                    }
                    .deposit-summary-card.total {
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                    }
                    .deposit-summary-label {
                        font-size: 13px;
                        opacity: 0.9;
                        margin-bottom: 8px;
                    }
                    .deposit-summary-value {
                        font-size: 18px;
                        font-weight: 700;
                    }
                    .deposit-chart-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                    }
                    .deposit-chart-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .deposit-chart-title i {
                        color: #667eea;
                    }
                    .deposit-table-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                        overflow-x: auto;
                    }
                    .deposit-table {
                        width: 100%;
                        border-collapse: collapse;
                        font-size: 14px;
                    }
                    .deposit-table th {
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                        color: white;
                        padding: 12px 15px;
                        text-align: right;
                        font-weight: 600;
                    }
                    .deposit-table th:first-child {
                        text-align: center;
                        border-radius: 10px 0 0 0;
                    }
                    .deposit-table th:last-child {
                        border-radius: 0 10px 0 0;
                    }
                    .deposit-table td {
                        padding: 12px 15px;
                        text-align: right;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .deposit-table td:first-child {
                        text-align: center;
                        font-weight: 600;
                        color: #4facfe;
                    }
                    .deposit-table tr:hover {
                        background: #f7fafc;
                    }
                    .interest-cell {
                        color: #38a169;
                        font-weight: 600;
                    }
                    .deposit-tips-container {
                        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                    }
                    .deposit-tips-title {
                        font-size: 18px;
                        font-weight: 600;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .deposit-tips-title i {
                        color: #ffd700;
                    }
                    .terms-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        margin-bottom: 25px;
                    }
                    .term-card {
                        background: rgba(255,255,255,0.1);
                        padding: 18px;
                        border-radius: 12px;
                        backdrop-filter: blur(10px);
                    }
                    .term-name {
                        font-weight: 700;
                        font-size: 15px;
                        margin-bottom: 8px;
                        color: #ffd700;
                    }
                    .term-desc {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .tips-section {
                        margin-top: 20px;
                        padding-top: 20px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .tips-section-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    .tip-item {
                        background: rgba(255,255,255,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 10px;
                        border-left: 4px solid #38ef7d;
                    }
                    .tip-item:last-child {
                        margin-bottom: 0;
                    }
                    .tip-title {
                        font-weight: 600;
                        margin-bottom: 5px;
                    }
                    .tip-content {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .comparison-box {
                        background: rgba(255,215,0,0.1);
                        border: 2px solid #ffd700;
                        border-radius: 12px;
                        padding: 20px;
                        margin-top: 20px;
                    }
                    .comparison-title {
                        font-weight: 700;
                        font-size: 15px;
                        margin-bottom: 12px;
                        color: #ffd700;
                    }
                    .comparison-table {
                        width: 100%;
                        font-size: 13px;
                    }
                    .comparison-table td {
                        padding: 8px 0;
                        border-bottom: 1px solid rgba(255,255,255,0.1);
                    }
                    .comparison-table td:last-child {
                        text-align: right;
                        font-weight: 600;
                    }
                    @media (max-width: 768px) {
                        .deposit-summary {
                            grid-template-columns: repeat(2, 1fr);
                        }
                        .terms-grid {
                            grid-template-columns: 1fr;
                        }
                        .form-row {
                            grid-template-columns: 1fr;
                        }
                        .deposit-summary-value {
                            font-size: 15px;
                        }
                    }
                    @media (max-width: 480px) {
                        .deposit-summary {
                            grid-template-columns: 1fr;
                        }
                    }
                </style>
                <div class="deposit-container">
                    <div class="deposit-form-section">
                        <form class="calc-form" onsubmit="calculateDeposit(event)">
                            <div class="form-row">
                                <div class="form-group">
                                    <label><i class="fas fa-piggy-bank" style="color: #4facfe; margin-right: 8px;"></i>Ï†ÄÏ∂ï Î∞©Ïãù</label>
                                    <select id="depositType" onchange="updateDepositLabel()">
                                        <option value="savings">Ï†ÅÍ∏à (Îß§Ïõî ÎÇ©ÏûÖ)</option>
                                        <option value="deposit">ÏòàÍ∏à (ÏùºÏãú ÎÇ©ÏûÖ)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-percentage" style="color: #4facfe; margin-right: 8px;"></i>Ïù¥Ïûê Í≥ÑÏÇ∞ Î∞©Ïãù</label>
                                    <select id="interestType">
                                        <option value="simple">Îã®Î¶¨</option>
                                        <option value="compound">Î≥µÎ¶¨ (ÏõîÎ≥µÎ¶¨)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label id="depositAmountLabel"><i class="fas fa-won-sign" style="color: #4facfe; margin-right: 8px;"></i>Ïõî ÎÇ©ÏûÖÏï° (Ïõê)</label>
                                    <input type="text" id="depositAmount" data-comma="true" placeholder="500,000" required>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-chart-line" style="color: #4facfe; margin-right: 8px;"></i>Ïó∞ Ïù¥ÏûêÏú® (%)</label>
                                    <input type="text" id="depositRate" placeholder="4.5" required>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label><i class="fas fa-calendar-alt" style="color: #4facfe; margin-right: 8px;"></i>Í∞ÄÏûÖ Í∏∞Í∞Ñ (Í∞úÏõî)</label>
                                    <input type="text" id="depositPeriod" placeholder="12" required>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-landmark" style="color: #4facfe; margin-right: 8px;"></i>ÏÑ∏Í∏à Ïú†Ìòï</label>
                                    <select id="taxType">
                                        <option value="normal">ÏùºÎ∞òÍ≥ºÏÑ∏ (15.4%)</option>
                                        <option value="preferential">ÏÑ∏Í∏àÏö∞ÎåÄ (9.5%)</option>
                                        <option value="exempt">ÎπÑÍ≥ºÏÑ∏ (0%)</option>
                                    </select>
                                </div>
                            </div>
                            <button type="submit" class="btn-calculate">
                                <i class="fas fa-calculator" style="margin-right: 8px;"></i>ÏòàÏ†ÅÍ∏à Í≥ÑÏÇ∞ÌïòÍ∏∞
                            </button>
                        </form>
                    </div>
                    
                    <div class="deposit-result-section" id="depositResultSection">
                        <div class="deposit-summary" id="depositSummary"></div>
                        <div class="deposit-chart-container">
                            <div class="deposit-chart-title"><i class="fas fa-chart-pie"></i> ÏõêÍ∏à vs Ïù¥Ïûê Íµ¨ÏÑ±</div>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; align-items: center;">
                                <canvas id="depositPieChart"></canvas>
                                <canvas id="depositBarChart"></canvas>
                            </div>
                        </div>
                        <div class="deposit-table-container">
                            <div class="deposit-chart-title"><i class="fas fa-table"></i> ÏõîÎ≥Ñ ÏÉÅÏÑ∏ ÎÇ¥Ïó≠</div>
                            <table class="deposit-table" id="depositTable"></table>
                        </div>
                        <div class="deposit-tips-container">
                            <div class="deposit-tips-title"><i class="fas fa-book"></i> ÏòàÏ†ÅÍ∏à Ïö©Ïñ¥ ÏÇ¨Ï†Ñ</div>
                            <div class="terms-grid">
                                <div class="term-card">
                                    <div class="term-name">üìä Îã®Î¶¨ (Simple Interest)</div>
                                    <div class="term-desc">ÏõêÍ∏àÏóê ÎåÄÌï¥ÏÑúÎßå Ïù¥ÏûêÎ•º Í≥ÑÏÇ∞ÌïòÎäî Î∞©Ïãù. Ïù¥ÏûêÍ∞Ä ÏõêÍ∏àÏóê Ìï©ÏÇ∞ÎêòÏßÄ ÏïäÏïÑ Ïù¥Ïûê Í≥ÑÏÇ∞Ïù¥ Í∞ÑÎã®Ìï©ÎãàÎã§.</div>
                                </div>
                                <div class="term-card">
                                    <div class="term-name">üìà Î≥µÎ¶¨ (Compound Interest)</div>
                                    <div class="term-desc">ÏõêÍ∏àÍ≥º Ïù¥ÏûêÎ•º Ìï©Ìïú Í∏àÏï°Ïóê Ïù¥ÏûêÎ•º Í≥ÑÏÇ∞ÌïòÎäî Î∞©Ïãù. Í∏∞Í∞ÑÏù¥ Í∏∏ÏàòÎ°ù Îã®Î¶¨Î≥¥Îã§ Ïú†Î¶¨Ìï©ÎãàÎã§.</div>
                                </div>
                                <div class="term-card">
                                    <div class="term-name">üí∞ ÏùºÎ∞òÍ≥ºÏÑ∏ (15.4%)</div>
                                    <div class="term-desc">Ïù¥ÏûêÏÜåÎìùÏÑ∏ 14% + ÏßÄÎ∞©ÏÜåÎìùÏÑ∏ 1.4%Í∞Ä Î∂ÄÍ≥ºÎê©ÎãàÎã§. ÏùºÎ∞òÏ†ÅÏù∏ ÏòàÏ†ÅÍ∏àÏóê Ï†ÅÏö©Îê©ÎãàÎã§.</div>
                                </div>
                                <div class="term-card">
                                    <div class="term-name">üéÅ ÎπÑÍ≥ºÏÑ∏ (0%)</div>
                                    <div class="term-desc">ÏÑ∏Í∏àÏù¥ Î©¥Ï†úÎêòÎäî ÏÉÅÌíà. Ï≤≠ÎÖÑÌù¨ÎßùÏ†ÅÍ∏à, Ï£ºÌÉùÏ≤≠ÏïΩÏ†ÄÏ∂ï Îì± ÌäπÏ†ï Ï°∞Í±¥ÏóêÏÑú Í∞ÄÎä•Ìï©ÎãàÎã§.</div>
                                </div>
                                <div class="term-card">
                                    <div class="term-name">‚≠ê ÏÑ∏Í∏àÏö∞ÎåÄ (9.5%)</div>
                                    <div class="term-desc">ÎÜçÌäπÏÑ∏ 1.4% + Ïù¥ÏûêÏÜåÎìùÏÑ∏ 9.5%Îßå Î∂ÄÍ≥º. Ï°∞Ìï© Î∞è ÏÉàÎßàÏùÑÍ∏àÍ≥†ÏóêÏÑú 1Ïù∏Îãπ 3Ï≤úÎßåÏõê ÌïúÎèÑÎ°ú Í∞ÄÎä•Ìï©ÎãàÎã§.</div>
                                </div>
                                <div class="term-card">
                                    <div class="term-name">üè¶ ÏòàÍ∏àÏûêÎ≥¥Ìò∏</div>
                                    <div class="term-desc">Í∏àÏúµÍ∏∞Í¥Ä ÌååÏÇ∞ Ïãú 1Ïù∏Îãπ 5Ï≤úÎßåÏõêÍπåÏßÄ Î≥¥Ìò∏. Ïó¨Îü¨ ÏùÄÌñâÏóê Î∂ÑÏÇ∞ ÏòàÏπòÌïòÎ©¥ Î≥¥Ìò∏ ÌïúÎèÑÍ∞Ä ÎäòÏñ¥ÎÇ©ÎãàÎã§.</div>
                                </div>
                            </div>
                            
                            <div class="tips-section">
                                <div class="tips-section-title"><i class="fas fa-lightbulb" style="color: #ffd700;"></i> Ïú†Î¶¨Ìïú ÏòàÏ†ÅÍ∏à Í∞ÄÏûÖ ÌåÅ</div>
                                <div class="tip-item">
                                    <div class="tip-title">1. Ïö∞ÎåÄÍ∏àÎ¶¨ Ï°∞Í±¥ ÌôïÏù∏ÌïòÍ∏∞</div>
                                    <div class="tip-content">Í∏âÏó¨Ïù¥Ï≤¥, Ïπ¥ÎìúÍ≤∞Ï†ú, ÏûêÎèôÏù¥Ï≤¥ Îì± Ïö∞ÎåÄÍ∏àÎ¶¨ Ï°∞Í±¥ÏùÑ Ï∂©Ï°±ÌïòÎ©¥ ÏµúÎåÄ 1~2%p Ï∂îÍ∞Ä Í∏àÎ¶¨Î•º Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§.</div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-title">2. Ïù∏ÌÑ∞ÎÑ∑/Î™®Î∞îÏùº Ï†ÑÏö© ÏÉÅÌíà ÌôúÏö©</div>
                                    <div class="tip-content">ÏòÅÏóÖÏ†ê Î∞©Î¨∏ ÏóÜÏù¥ Í∞ÄÏûÖÌïòÎäî ÎπÑÎåÄÎ©¥ ÏÉÅÌíàÏùÄ Î≥¥ÌÜµ 0.1~0.3%p Í∏àÎ¶¨Í∞Ä ÎÜíÏäµÎãàÎã§.</div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-title">3. ÏÉàÎßàÏùÑÍ∏àÍ≥†, Ïã†Ìòë Îì± Ï†ú2Í∏àÏúµÍ∂å ÌôúÏö©</div>
                                    <div class="tip-content">ÏãúÏ§ëÏùÄÌñâÎ≥¥Îã§ 0.5~1%p ÎÜíÏùÄ Í∏àÎ¶¨Î•º Ï†úÍ≥µÌïòÎ©∞, ÏÑ∏Í∏àÏö∞ÎåÄ ÌòúÌÉùÎèÑ Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§.</div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-title">4. ÌäπÌåê Ï†ÅÍ∏à ÎÖ∏Î¶¨Í∏∞</div>
                                    <div class="tip-content">ÏùÄÌñâ Í∏∞ÎÖêÏùº, Ïó∞ÎßêÏó∞Ïãú Îì±Ïóê Ï∂úÏãúÎêòÎäî ÌäπÌåê ÏÉÅÌíàÏùÄ ÏùºÎ∞ò ÏÉÅÌíàÎ≥¥Îã§ Í∏àÎ¶¨Í∞Ä ÎÜíÏäµÎãàÎã§.</div>
                                </div>
                                <div class="tip-item">
                                    <div class="tip-title">5. Ïû•Í∏∞ ÏòàÍ∏àÏùÄ Î≥µÎ¶¨ ÏÑ†ÌÉù</div>
                                    <div class="tip-content">1ÎÖÑ Ïù¥ÏÉÅ Ïû•Í∏∞ ÏòàÏπò Ïãú Î≥µÎ¶¨ ÏÉÅÌíàÏùÑ ÏÑ†ÌÉùÌïòÎ©¥ Îã®Î¶¨Î≥¥Îã§ Îçî ÎßéÏùÄ Ïù¥ÏûêÎ•º Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§.</div>
                                </div>
                            </div>
                            
                            <div class="comparison-box">
                                <div class="comparison-title">üí° ÏÑ∏Í∏à Ïú†ÌòïÎ≥Ñ Ïã§ÏàòÎ†πÏï° ÎπÑÍµê (Ïù¥Ïûê 100ÎßåÏõê Í∏∞Ï§Ä)</div>
                                <table class="comparison-table">
                                    <tr>
                                        <td>ÏùºÎ∞òÍ≥ºÏÑ∏ (15.4%)</td>
                                        <td>ÏÑ∏Í∏à 154,000Ïõê ‚Üí Ïã§ÏàòÎ†π 846,000Ïõê</td>
                                    </tr>
                                    <tr>
                                        <td>ÏÑ∏Í∏àÏö∞ÎåÄ (9.5%)</td>
                                        <td>ÏÑ∏Í∏à 95,000Ïõê ‚Üí Ïã§ÏàòÎ†π 905,000Ïõê</td>
                                    </tr>
                                    <tr>
                                        <td>ÎπÑÍ≥ºÏÑ∏ (0%)</td>
                                        <td>ÏÑ∏Í∏à 0Ïõê ‚Üí Ïã§ÏàòÎ†π 1,000,000Ïõê</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function updateDepositLabel() {
            const type = document.getElementById('depositType').value;
            const label = document.getElementById('depositAmountLabel');
            if (type === 'savings') {
                label.innerHTML = '<i class="fas fa-won-sign" style="color: #4facfe; margin-right: 8px;"></i>Ïõî ÎÇ©ÏûÖÏï° (Ïõê)';
            } else {
                label.innerHTML = '<i class="fas fa-won-sign" style="color: #4facfe; margin-right: 8px;"></i>ÏòàÍ∏àÏï° (Ïõê)';
            }
        }

        let depositPieChartInstance = null;
        let depositBarChartInstance = null;

        function calculateDeposit(e) {
            e.preventDefault();
            const depositType = document.getElementById('depositType').value;
            const interestType = document.getElementById('interestType').value;
            const amount = parseNumberFromComma(document.getElementById('depositAmount').value);
            const rate = parseFloat(document.getElementById('depositRate').value) / 100;
            const months = parseInt(document.getElementById('depositPeriod').value);
            const taxType = document.getElementById('taxType').value;
            
            // ÏÑ∏Ïú® ÏÑ§Ï†ï
            const taxRates = {
                normal: 0.154,
                preferential: 0.095,
                exempt: 0
            };
            const taxRate = taxRates[taxType];
            
            let monthlyData = [];
            let totalPrincipal = 0;
            let totalInterest = 0;
            let balance = 0;
            
            if (depositType === 'savings') {
                // Ï†ÅÍ∏à Í≥ÑÏÇ∞
                if (interestType === 'simple') {
                    // Îã®Î¶¨ Ï†ÅÍ∏à
                    for (let month = 1; month <= months; month++) {
                        totalPrincipal = amount * month;
                        // Í∞Å ÎÇ©ÏûÖÍ∏àÏùò Ïù¥Ïûê = ÎÇ©ÏûÖÍ∏à √ó Ïó∞Ïù¥Ïú® √ó (ÏûîÏó¨Í∞úÏõîÏàò/12)
                        let accInterest = 0;
                        for (let i = 1; i <= month; i++) {
                            accInterest += amount * rate * (months - i + 1) / 12;
                        }
                        const monthInterest = month === 1 ? accInterest : accInterest - monthlyData[month-2].accumulatedInterest;
                        balance = totalPrincipal + accInterest;
                        
                        monthlyData.push({
                            month: month,
                            deposit: amount,
                            principal: totalPrincipal,
                            monthInterest: monthInterest,
                            accumulatedInterest: accInterest,
                            balance: balance
                        });
                    }
                    totalInterest = monthlyData[months-1].accumulatedInterest;
                } else {
                    // Î≥µÎ¶¨ Ï†ÅÍ∏à (ÏõîÎ≥µÎ¶¨)
                    const monthlyRate = rate / 12;
                    for (let month = 1; month <= months; month++) {
                        balance = balance * (1 + monthlyRate) + amount;
                        totalPrincipal = amount * month;
                        const accInterest = balance - totalPrincipal;
                        const monthInterest = month === 1 ? accInterest : accInterest - monthlyData[month-2].accumulatedInterest;
                        
                        monthlyData.push({
                            month: month,
                            deposit: amount,
                            principal: totalPrincipal,
                            monthInterest: monthInterest,
                            accumulatedInterest: accInterest,
                            balance: balance
                        });
                    }
                    totalInterest = balance - totalPrincipal;
                }
            } else {
                // ÏòàÍ∏à Í≥ÑÏÇ∞
                totalPrincipal = amount;
                if (interestType === 'simple') {
                    // Îã®Î¶¨ ÏòàÍ∏à
                    for (let month = 1; month <= months; month++) {
                        const accInterest = amount * rate * month / 12;
                        const monthInterest = amount * rate / 12;
                        balance = amount + accInterest;
                        
                        monthlyData.push({
                            month: month,
                            deposit: month === 1 ? amount : 0,
                            principal: amount,
                            monthInterest: monthInterest,
                            accumulatedInterest: accInterest,
                            balance: balance
                        });
                    }
                    totalInterest = monthlyData[months-1].accumulatedInterest;
                } else {
                    // Î≥µÎ¶¨ ÏòàÍ∏à (ÏõîÎ≥µÎ¶¨)
                    const monthlyRate = rate / 12;
                    balance = amount;
                    for (let month = 1; month <= months; month++) {
                        const prevBalance = balance;
                        balance = balance * (1 + monthlyRate);
                        const monthInterest = balance - prevBalance;
                        const accInterest = balance - amount;
                        
                        monthlyData.push({
                            month: month,
                            deposit: month === 1 ? amount : 0,
                            principal: amount,
                            monthInterest: monthInterest,
                            accumulatedInterest: accInterest,
                            balance: balance
                        });
                    }
                    totalInterest = balance - amount;
                }
            }
            
            // ÏÑ∏Í∏à Í≥ÑÏÇ∞
            const taxAmount = totalInterest * taxRate;
            const netInterest = totalInterest - taxAmount;
            const totalAmount = totalPrincipal + netInterest;
            
            // Í≤∞Í≥º ÏÑπÏÖò ÌëúÏãú
            const resultSection = document.getElementById('depositResultSection');
            resultSection.classList.add('active');
            
            // ÏöîÏïΩ Ïπ¥Îìú ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('depositSummary').innerHTML = `
                <div class="deposit-summary-card">
                    <div class="deposit-summary-label">Ï¥ù ÏõêÍ∏à</div>
                    <div class="deposit-summary-value">${Math.round(totalPrincipal).toLocaleString()}Ïõê</div>
                </div>
                <div class="deposit-summary-card interest">
                    <div class="deposit-summary-label">ÏÑ∏Ï†Ñ Ïù¥Ïûê</div>
                    <div class="deposit-summary-value">+${Math.round(totalInterest).toLocaleString()}Ïõê</div>
                </div>
                <div class="deposit-summary-card tax">
                    <div class="deposit-summary-label">ÏÑ∏Í∏à (${(taxRate*100).toFixed(1)}%)</div>
                    <div class="deposit-summary-value">-${Math.round(taxAmount).toLocaleString()}Ïõê</div>
                </div>
                <div class="deposit-summary-card total">
                    <div class="deposit-summary-label">ÎßåÍ∏∞ ÏàòÎ†πÏï°</div>
                    <div class="deposit-summary-value">${Math.round(totalAmount).toLocaleString()}Ïõê</div>
                </div>
            `;
            
            // ÌååÏù¥ Ï∞®Ìä∏ ÏÉùÏÑ±
            const pieCtx = document.getElementById('depositPieChart').getContext('2d');
            
            if (depositPieChartInstance) {
                depositPieChartInstance.destroy();
            }
            
            depositPieChartInstance = new Chart(pieCtx, {
                type: 'doughnut',
                data: {
                    labels: ['ÏõêÍ∏à', 'ÏÑ∏ÌõÑ Ïù¥Ïûê', 'ÏÑ∏Í∏à'],
                    datasets: [{
                        data: [totalPrincipal, netInterest, taxAmount],
                        backgroundColor: ['#667eea', '#38ef7d', '#fc8181'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: { size: 12 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${context.label}: ${Math.round(value).toLocaleString()}Ïõê (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Î∞î Ï∞®Ìä∏ ÏÉùÏÑ± (ÏõîÎ≥Ñ ÏûîÏï° Ï∂îÏù¥)
            const barCtx = document.getElementById('depositBarChart').getContext('2d');
            
            if (depositBarChartInstance) {
                depositBarChartInstance.destroy();
            }
            
            // ÏõîÎ≥Ñ Îç∞Ïù¥ÌÑ∞ ÏÉòÌîåÎßÅ (ÎÑàÎ¨¥ ÎßéÏúºÎ©¥ ÏùºÎ∂ÄÎßå ÌëúÏãú)
            let chartData = monthlyData;
            if (months > 12) {
                const interval = Math.ceil(months / 12);
                chartData = monthlyData.filter((_, idx) => idx % interval === 0 || idx === months - 1);
            }
            
            depositBarChartInstance = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: chartData.map(d => d.month + 'Í∞úÏõî'),
                    datasets: [
                        {
                            label: 'ÏõêÍ∏à',
                            data: chartData.map(d => d.principal),
                            backgroundColor: '#667eea',
                            borderRadius: 5
                        },
                        {
                            label: 'Ïù¥Ïûê',
                            data: chartData.map(d => d.accumulatedInterest),
                            backgroundColor: '#38ef7d',
                            borderRadius: 5
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: { size: 12 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + Math.round(context.raw).toLocaleString() + 'Ïõê';
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            grid: { display: false }
                        },
                        y: {
                            stacked: true,
                            ticks: {
                                callback: function(value) {
                                    if (value >= 100000000) {
                                        return (value / 100000000).toFixed(1) + 'Ïñµ';
                                    } else if (value >= 10000) {
                                        return (value / 10000).toFixed(0) + 'Îßå';
                                    }
                                    return value;
                                }
                            },
                            grid: { color: 'rgba(0, 0, 0, 0.05)' }
                        }
                    }
                }
            });
            
            // ÏõîÎ≥Ñ ÌÖåÏù¥Î∏î ÏÉùÏÑ±
            let tableHTML = `
                <thead>
                    <tr>
                        <th>ÌöåÏ∞®</th>
                        <th>ÎÇ©ÏûÖÏï°</th>
                        <th>ÎàÑÏ†Å ÏõêÍ∏à</th>
                        <th>Ïõî Ïù¥Ïûê</th>
                        <th>ÎàÑÏ†Å Ïù¥Ïûê</th>
                        <th>ÏûîÏï°</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            // ÌÖåÏù¥Î∏îÎèÑ ÏÉòÌîåÎßÅ (ÎÑàÎ¨¥ Í∏∏Î©¥)
            let tableData = monthlyData;
            if (months > 24) {
                const interval = Math.ceil(months / 24);
                tableData = monthlyData.filter((_, idx) => idx % interval === 0 || idx === months - 1);
            }
            
            tableData.forEach(data => {
                tableHTML += `
                    <tr>
                        <td>${data.month}Í∞úÏõî</td>
                        <td>${data.deposit.toLocaleString()}Ïõê</td>
                        <td>${Math.round(data.principal).toLocaleString()}Ïõê</td>
                        <td class="interest-cell">+${Math.round(data.monthInterest).toLocaleString()}Ïõê</td>
                        <td class="interest-cell">+${Math.round(data.accumulatedInterest).toLocaleString()}Ïõê</td>
                        <td>${Math.round(data.balance).toLocaleString()}Ïõê</td>
                    </tr>
                `;
            });
            
            tableHTML += '</tbody>';
            document.getElementById('depositTable').innerHTML = tableHTML;
            
            // Í≤∞Í≥º ÏÑπÏÖòÏúºÎ°ú Ïä§ÌÅ¨Î°§
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function getLoanCalculator() {
            return `
                <style>
                    .loan-container {
                        display: flex;
                        flex-direction: column;
                        gap: 30px;
                    }
                    .loan-form-section {
                        background: #f8fafc;
                        padding: 25px;
                        border-radius: 15px;
                    }
                    .loan-form-row {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 20px;
                    }
                    .loan-result-section {
                        display: none;
                    }
                    .loan-result-section.active {
                        display: block;
                        animation: fadeIn 0.5s ease;
                    }
                    .loan-summary {
                        display: grid;
                        grid-template-columns: repeat(4, 1fr);
                        gap: 15px;
                        margin-bottom: 30px;
                    }
                    .loan-summary-card {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        padding: 20px;
                        border-radius: 15px;
                        color: white;
                        text-align: center;
                    }
                    .loan-summary-card.interest {
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                    }
                    .loan-summary-card.monthly {
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                    }
                    .loan-summary-card.total {
                        background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                    }
                    .loan-summary-label {
                        font-size: 13px;
                        opacity: 0.9;
                        margin-bottom: 8px;
                    }
                    .loan-summary-value {
                        font-size: 18px;
                        font-weight: 700;
                    }
                    .loan-chart-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                    }
                    .loan-chart-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .loan-chart-title i {
                        color: #667eea;
                    }
                    .loan-charts-grid {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 30px;
                        align-items: center;
                    }
                    .loan-table-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                        overflow-x: auto;
                    }
                    .loan-table {
                        width: 100%;
                        border-collapse: collapse;
                        font-size: 14px;
                    }
                    .loan-table th {
                        background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                        color: white;
                        padding: 12px 10px;
                        text-align: right;
                        font-weight: 600;
                        white-space: nowrap;
                    }
                    .loan-table th:first-child {
                        text-align: center;
                        border-radius: 10px 0 0 0;
                    }
                    .loan-table th:last-child {
                        border-radius: 0 10px 0 0;
                    }
                    .loan-table td {
                        padding: 10px;
                        text-align: right;
                        border-bottom: 1px solid #e2e8f0;
                        white-space: nowrap;
                    }
                    .loan-table td:first-child {
                        text-align: center;
                        font-weight: 600;
                        color: #fa709a;
                    }
                    .loan-table tr:hover {
                        background: #fef5f7;
                    }
                    .principal-cell {
                        color: #667eea;
                        font-weight: 600;
                    }
                    .interest-cell {
                        color: #f56565;
                        font-weight: 600;
                    }
                    .loan-table-note {
                        margin-top: 15px;
                        padding: 15px;
                        background: #fef5f7;
                        border-radius: 10px;
                        font-size: 13px;
                        color: #718096;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .loan-tips-container {
                        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                    }
                    .loan-tips-title {
                        font-size: 18px;
                        font-weight: 600;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .loan-tips-title i {
                        color: #ffd700;
                    }
                    .loan-terms-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        margin-bottom: 25px;
                    }
                    .loan-term-card {
                        background: rgba(255,255,255,0.1);
                        padding: 18px;
                        border-radius: 12px;
                        backdrop-filter: blur(10px);
                    }
                    .loan-term-name {
                        font-weight: 700;
                        font-size: 15px;
                        margin-bottom: 8px;
                        color: #ffd700;
                    }
                    .loan-term-desc {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .loan-regulations {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .loan-reg-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #ff6b6b;
                    }
                    .loan-reg-item {
                        background: rgba(255,107,107,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 10px;
                        border-left: 4px solid #ff6b6b;
                    }
                    .loan-reg-item:last-child {
                        margin-bottom: 0;
                    }
                    .loan-reg-name {
                        font-weight: 600;
                        margin-bottom: 5px;
                        color: #ff6b6b;
                    }
                    .loan-reg-content {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .loan-tips-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .loan-tips-section-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #38ef7d;
                    }
                    .loan-tip-item {
                        background: rgba(56,239,125,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 10px;
                        border-left: 4px solid #38ef7d;
                    }
                    .loan-tip-title {
                        font-weight: 600;
                        margin-bottom: 5px;
                        color: #38ef7d;
                    }
                    .loan-tip-content {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .loan-comparison-box {
                        background: rgba(255,215,0,0.1);
                        border: 2px solid #ffd700;
                        border-radius: 12px;
                        padding: 20px;
                        margin-top: 20px;
                    }
                    .loan-comparison-title {
                        font-weight: 700;
                        font-size: 15px;
                        margin-bottom: 12px;
                        color: #ffd700;
                    }
                    .loan-comparison-table {
                        width: 100%;
                        font-size: 13px;
                    }
                    .loan-comparison-table th {
                        text-align: left;
                        padding: 8px;
                        border-bottom: 1px solid rgba(255,255,255,0.2);
                        color: #ffd700;
                    }
                    .loan-comparison-table td {
                        padding: 8px;
                        border-bottom: 1px solid rgba(255,255,255,0.1);
                    }
                    @media (max-width: 768px) {
                        .loan-summary {
                            grid-template-columns: repeat(2, 1fr);
                        }
                        .loan-terms-grid {
                            grid-template-columns: 1fr;
                        }
                        .loan-form-row {
                            grid-template-columns: 1fr;
                        }
                        .loan-summary-value {
                            font-size: 15px;
                        }
                        .loan-charts-grid {
                            grid-template-columns: 1fr;
                        }
                    }
                    @media (max-width: 480px) {
                        .loan-summary {
                            grid-template-columns: 1fr;
                        }
                    }
                </style>
                <div class="loan-container">
                    <div class="loan-form-section">
                        <form class="calc-form" onsubmit="calculateLoan(event)">
                            <div class="loan-form-row">
                                <div class="form-group">
                                    <label><i class="fas fa-landmark" style="color: #fa709a; margin-right: 8px;"></i>ÎåÄÏ∂ú Ï¢ÖÎ•ò</label>
                                    <select id="loanCategory" onchange="updateLoanOptions()">
                                        <option value="general">ÏùºÎ∞ò Ïã†Ïö©ÎåÄÏ∂ú</option>
                                        <option value="mortgage">Ï£ºÌÉùÎã¥Î≥¥ÎåÄÏ∂ú</option>
                                        <option value="jeonse">Ï†ÑÏÑ∏ÏûêÍ∏àÎåÄÏ∂ú</option>
                                        <option value="business">ÏÇ¨ÏóÖÏûêÎåÄÏ∂ú</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-sync-alt" style="color: #fa709a; margin-right: 8px;"></i>ÏÉÅÌôò Î∞©Ïãù</label>
                                    <select id="loanType">
                                        <option value="equal">ÏõêÎ¶¨Í∏àÍ∑†Îì±ÏÉÅÌôò</option>
                                        <option value="principal">ÏõêÍ∏àÍ∑†Îì±ÏÉÅÌôò</option>
                                        <option value="bullet">ÎßåÍ∏∞ÏùºÏãúÏÉÅÌôò</option>
                                    </select>
                                </div>
                            </div>
                            <div class="loan-form-row">
                                <div class="form-group">
                                    <label><i class="fas fa-won-sign" style="color: #fa709a; margin-right: 8px;"></i>ÎåÄÏ∂ú ÏõêÍ∏à (Ïõê)</label>
                                    <input type="text" id="loanAmount" data-comma="true" placeholder="100,000,000" required>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-percentage" style="color: #fa709a; margin-right: 8px;"></i>Ïó∞ Ïù¥ÏûêÏú® (%)</label>
                                    <input type="text" id="loanRate" placeholder="4.5" required>
                                </div>
                            </div>
                            <div class="loan-form-row">
                                <div class="form-group">
                                    <label><i class="fas fa-calendar-alt" style="color: #fa709a; margin-right: 8px;"></i>ÎåÄÏ∂ú Í∏∞Í∞Ñ (ÎÖÑ)</label>
                                    <select id="loanYears">
                                        <option value="1">1ÎÖÑ</option>
                                        <option value="3">3ÎÖÑ</option>
                                        <option value="5">5ÎÖÑ</option>
                                        <option value="10" selected>10ÎÖÑ</option>
                                        <option value="15">15ÎÖÑ</option>
                                        <option value="20">20ÎÖÑ</option>
                                        <option value="30">30ÎÖÑ</option>
                                        <option value="40">40ÎÖÑ</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-hourglass-half" style="color: #fa709a; margin-right: 8px;"></i>Í±∞Ïπò Í∏∞Í∞Ñ (ÎÖÑ)</label>
                                    <select id="gracePeriod">
                                        <option value="0" selected>ÏóÜÏùå</option>
                                        <option value="1">1ÎÖÑ</option>
                                        <option value="2">2ÎÖÑ</option>
                                        <option value="3">3ÎÖÑ</option>
                                        <option value="5">5ÎÖÑ</option>
                                    </select>
                                </div>
                            </div>
                            <button type="submit" class="btn-calculate">
                                <i class="fas fa-calculator" style="margin-right: 8px;"></i>ÎåÄÏ∂ú Í≥ÑÏÇ∞ÌïòÍ∏∞
                            </button>
                        </form>
                    </div>
                    
                    <div class="loan-result-section" id="loanResultSection">
                        <div class="loan-summary" id="loanSummary"></div>
                        <div class="loan-chart-container">
                            <div class="loan-chart-title"><i class="fas fa-chart-pie"></i> ÏõêÍ∏à vs Ïù¥Ïûê Î∂ÑÏÑù</div>
                            <div class="loan-charts-grid">
                                <canvas id="loanPieChart"></canvas>
                                <canvas id="loanLineChart"></canvas>
                            </div>
                        </div>
                        <div class="loan-table-container">
                            <div class="loan-chart-title"><i class="fas fa-table"></i> ÏÉÅÌôò Ïä§ÏºÄÏ§Ñ</div>
                            <table class="loan-table" id="loanTable"></table>
                            <div class="loan-table-note">
                                <i class="fas fa-info-circle" style="color: #fa709a;"></i>
                                <span id="loanTableNote">Ï†ÑÏ≤¥ ÏÉÅÌôò Ïä§ÏºÄÏ§Ñ Ï§ë Ï£ºÏöî ÌöåÏ∞®Î•º ÌëúÏãúÌï©ÎãàÎã§.</span>
                            </div>
                        </div>
                        <div class="loan-tips-container">
                            <div class="loan-tips-title"><i class="fas fa-book"></i> ÎåÄÏ∂ú Ïö©Ïñ¥ ÏÇ¨Ï†Ñ</div>
                            <div class="loan-terms-grid">
                                <div class="loan-term-card">
                                    <div class="loan-term-name">üí∞ ÏõêÎ¶¨Í∏àÍ∑†Îì±ÏÉÅÌôò</div>
                                    <div class="loan-term-desc">Îß§Ïõî ÎèôÏùºÌïú Í∏àÏï°(ÏõêÍ∏à+Ïù¥Ïûê)ÏùÑ ÏÉÅÌôòÌïòÎäî Î∞©Ïãù. Ï¥àÍ∏∞ÏóêÎäî Ïù¥Ïûê ÎπÑÏ§ëÏù¥ ÎÜíÍ≥†, ÌõÑÍ∏∞ÏóêÎäî ÏõêÍ∏à ÎπÑÏ§ëÏù¥ ÎÜíÏïÑÏßëÎãàÎã§.</div>
                                </div>
                                <div class="loan-term-card">
                                    <div class="loan-term-name">üìä ÏõêÍ∏àÍ∑†Îì±ÏÉÅÌôò</div>
                                    <div class="loan-term-desc">Îß§Ïõî ÎèôÏùºÌïú ÏõêÍ∏àÏùÑ ÏÉÅÌôòÌïòÎäî Î∞©Ïãù. Ï¥àÍ∏∞ ÏÉÅÌôò Î∂ÄÎã¥Ïù¥ ÌÅ¨ÏßÄÎßå Ï¥ù Ïù¥Ïûê Î∂ÄÎã¥Ïù¥ Ï†ÅÏäµÎãàÎã§.</div>
                                </div>
                                <div class="loan-term-card">
                                    <div class="loan-term-name">üéØ ÎßåÍ∏∞ÏùºÏãúÏÉÅÌôò</div>
                                    <div class="loan-term-desc">ÎåÄÏ∂ú Í∏∞Í∞Ñ ÎèôÏïà Ïù¥ÏûêÎßå ÎÇ©Î∂ÄÌïòÍ≥†, ÎßåÍ∏∞Ïóê ÏõêÍ∏àÏùÑ ÏùºÏãú ÏÉÅÌôòÌïòÎäî Î∞©Ïãù. Ïõî Î∂ÄÎã¥ÏùÄ Ï†ÅÏßÄÎßå Ï¥ù Ïù¥ÏûêÍ∞Ä ÎßéÏäµÎãàÎã§.</div>
                                </div>
                                <div class="loan-term-card">
                                    <div class="loan-term-name">‚è≥ Í±∞Ïπò Í∏∞Í∞Ñ</div>
                                    <div class="loan-term-desc">ÏõêÍ∏à ÏÉÅÌôò ÏóÜÏù¥ Ïù¥ÏûêÎßå ÎÇ©Î∂ÄÌïòÎäî Í∏∞Í∞Ñ. Í±∞Ïπò Í∏∞Í∞Ñ ÌõÑ Î≥∏Í≤©Ï†ÅÏù∏ ÏõêÍ∏à+Ïù¥Ïûê ÏÉÅÌôòÏù¥ ÏãúÏûëÎê©ÎãàÎã§.</div>
                                </div>
                                <div class="loan-term-card">
                                    <div class="loan-term-name">üè† LTV (Îã¥Î≥¥Ïù∏Ï†ïÎπÑÏú®)</div>
                                    <div class="loan-term-desc">Ï£ºÌÉù Í∞ÄÍ≤© ÎåÄÎπÑ ÎåÄÏ∂ú Í∞ÄÎä• Í∏àÏï°Ïùò ÎπÑÏú®. Ïòà: LTV 70%Î©¥ 5Ïñµ Ï£ºÌÉùÏóê ÏµúÎåÄ 3.5Ïñµ ÎåÄÏ∂ú Í∞ÄÎä•.</div>
                                </div>
                                <div class="loan-term-card">
                                    <div class="loan-term-name">üíµ DTI (Ï¥ùÎ∂ÄÏ±ÑÏÉÅÌôòÎπÑÏú®)</div>
                                    <div class="loan-term-desc">Ïó∞ ÏÜåÎìù ÎåÄÎπÑ Ïó∞Í∞Ñ ÎåÄÏ∂ú ÏõêÎ¶¨Í∏à ÏÉÅÌôòÏï° ÎπÑÏú®. ÏÜåÎìù ÎåÄÎπÑ ÏÉÅÌôò Îä•Î†•ÏùÑ ÌèâÍ∞ÄÌïòÎäî ÏßÄÌëúÏûÖÎãàÎã§.</div>
                                </div>
                                <div class="loan-term-card">
                                    <div class="loan-term-name">üìã DSR (Ï¥ùÎ∂ÄÏ±ÑÏõêÎ¶¨Í∏àÏÉÅÌôòÎπÑÏú®)</div>
                                    <div class="loan-term-desc">Î™®Îì† ÎåÄÏ∂úÏùò ÏõêÎ¶¨Í∏à ÏÉÅÌôòÏï°ÏùÑ Ïó∞ ÏÜåÎìùÏúºÎ°ú ÎÇòÎàà ÎπÑÏú®. Ï†ÑÏ≤¥ Î∂ÄÏ±Ñ ÏÉÅÌôò Îä•Î†•ÏùÑ ÌèâÍ∞ÄÌï©ÎãàÎã§.</div>
                                </div>
                                <div class="loan-term-card">
                                    <div class="loan-term-name">üîÑ Ï§ëÎèÑÏÉÅÌôòÏàòÏàòÎ£å</div>
                                    <div class="loan-term-desc">ÎåÄÏ∂ú ÎßåÍ∏∞ Ï†Ñ Ï°∞Í∏∞ ÏÉÅÌôò Ïãú Î∂ÄÍ≥ºÎêòÎäî ÏàòÏàòÎ£å. Î≥¥ÌÜµ 3ÎÖÑ Ïù¥ÎÇ¥ ÏÉÅÌôò Ïãú 1~1.5% Î∂ÄÍ≥ºÎê©ÎãàÎã§.</div>
                                </div>
                            </div>
                            
                            <div class="loan-regulations">
                                <div class="loan-reg-title"><i class="fas fa-gavel"></i> Ï£ºÏöî ÎåÄÏ∂ú Í∑úÏ†ú</div>
                                <div class="loan-reg-item">
                                    <div class="loan-reg-name">üìå LTV Í∑úÏ†ú (2024ÎÖÑ Í∏∞Ï§Ä)</div>
                                    <div class="loan-reg-content">
                                        ‚Ä¢ Ìà¨Í∏∞Í≥ºÏó¥ÏßÄÍµ¨: Î¨¥Ï£ºÌÉùÏûê 50%, 1Ï£ºÌÉùÏûê 30%<br>
                                        ‚Ä¢ Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠: Î¨¥Ï£ºÌÉùÏûê 60%, 1Ï£ºÌÉùÏûê 50%<br>
                                        ‚Ä¢ ÎπÑÍ∑úÏ†úÏßÄÏó≠: Î¨¥Ï£ºÌÉùÏûê 70%, 1Ï£ºÌÉùÏûê 60%<br>
                                        ‚Ä¢ ÏÉùÏï†ÏµúÏ¥à Ï£ºÌÉùÍµ¨ÏûÖÏûê Ïö∞ÎåÄ: LTV 80% (6Ïñµ Ïù¥Ìïò, Ïó∞ÏÜåÎìù 9Ï≤úÎßåÏõê Ïù¥Ìïò)
                                    </div>
                                </div>
                                <div class="loan-reg-item">
                                    <div class="loan-reg-name">üìå DSR Í∑úÏ†ú</div>
                                    <div class="loan-reg-content">
                                        ‚Ä¢ 1ÏñµÏõê Ï¥àÍ≥º ÎåÄÏ∂ú: DSR 40% Ï†ÅÏö©<br>
                                        ‚Ä¢ Ï¥ù ÎåÄÏ∂ú 2ÏñµÏõê Ï¥àÍ≥º: Ïä§Ìä∏Î†àÏä§ DSR Ï†ÅÏö©<br>
                                        ‚Ä¢ ÏùÄÌñâÍ∂å Ï£ºÎã¥ÎåÄ: DSR 40% (Î¨¥Ï£ºÌÉùÏûê ÏùºÎ∂Ä Ïö∞ÎåÄ)
                                    </div>
                                </div>
                                <div class="loan-reg-item">
                                    <div class="loan-reg-name">üìå Ï†ÑÏÑ∏ÎåÄÏ∂ú Í∑úÏ†ú</div>
                                    <div class="loan-reg-content">
                                        ‚Ä¢ Î≥¥Ï¶ùÍ∏àÏùò ÏµúÎåÄ 80%ÍπåÏßÄ ÎåÄÏ∂ú Í∞ÄÎä•<br>
                                        ‚Ä¢ Í≥†Í∞Ä Ï†ÑÏÑ∏(ÏàòÎèÑÍ∂å 5Ïñµ, ÏßÄÎ∞© 3Ïñµ Ï¥àÍ≥º) Í∑úÏ†ú Ï†ÅÏö©<br>
                                        ‚Ä¢ Îã§Ï£ºÌÉùÏûê Ï†ÑÏÑ∏ÎåÄÏ∂ú Ï†úÌïú
                                    </div>
                                </div>
                            </div>
                            
                            <div class="loan-tips-section">
                                <div class="loan-tips-section-title"><i class="fas fa-lightbulb"></i> Ïú†Î¶¨Ìïú ÎåÄÏ∂ú ÌåÅ</div>
                                <div class="loan-tip-item">
                                    <div class="loan-tip-title">1. Í∏àÎ¶¨ ÎπÑÍµêÎäî ÌïÑÏàò!</div>
                                    <div class="loan-tip-content">ÏùÄÌñâÎ≥ÑÎ°ú Í∏àÎ¶¨ Ï∞®Ïù¥Í∞Ä ÌÅ¨ÎØÄÎ°ú ÏµúÏÜå 3~5Í∞ú ÏùÄÌñâ ÎπÑÍµê. Í∏àÏúµÍ∞êÎèÖÏõê Í∏àÏúµÏÉÅÌíàÌïúÎààÏóê, Ïπ¥Ïπ¥Ïò§Î±ÖÌÅ¨/ÌÜ†Ïä§ Îì± ÎπÑÍµê ÏÑúÎπÑÏä§ ÌôúÏö©.</div>
                                </div>
                                <div class="loan-tip-item">
                                    <div class="loan-tip-title">2. Ïö∞ÎåÄÍ∏àÎ¶¨ Ï°∞Í±¥ ÌôïÏù∏</div>
                                    <div class="loan-tip-content">Í∏âÏó¨Ïù¥Ï≤¥, Ïπ¥ÎìúÏã§Ï†Å, Ï†ÅÍ∏àÍ∞ÄÏûÖ Îì±ÏúºÎ°ú 0.1~0.5%p Ïö∞ÎåÄ Í∞ÄÎä•. Ï£ºÍ±∞Îûò ÏùÄÌñâÏùÑ Ï†ïÌï¥ÎëêÎ©¥ Ïú†Î¶¨Ìï©ÎãàÎã§.</div>
                                </div>
                                <div class="loan-tip-item">
                                    <div class="loan-tip-title">3. Í≥†Ï†ïÍ∏àÎ¶¨ vs Î≥ÄÎèôÍ∏àÎ¶¨</div>
                                    <div class="loan-tip-content">Í∏àÎ¶¨ ÏÉÅÏäπÍ∏∞ÏóêÎäî Í≥†Ï†ïÍ∏àÎ¶¨, ÌïòÎùΩÍ∏∞ÏóêÎäî Î≥ÄÎèôÍ∏àÎ¶¨Í∞Ä Ïú†Î¶¨. ÌòºÌï©Ìòï(5ÎÖÑ Í≥†Ï†ï ÌõÑ Î≥ÄÎèô)ÎèÑ Í≥†Î†§Ìï¥Î≥¥ÏÑ∏Ïöî.</div>
                                </div>
                                <div class="loan-tip-item">
                                    <div class="loan-tip-title">4. Ï§ëÎèÑÏÉÅÌôò Í≥ÑÌöç ÏÑ∏Ïö∞Í∏∞</div>
                                    <div class="loan-tip-content">Ïó¨Ïú†ÏûêÍ∏à ÏÉùÍ∏∞Î©¥ Ï§ëÎèÑÏÉÅÌôòÏúºÎ°ú Ïù¥Ïûê Ï†àÏïΩ. Ï§ëÎèÑÏÉÅÌôòÏàòÏàòÎ£å Î©¥Ï†ú ÏãúÏ†ê(Î≥¥ÌÜµ 3ÎÖÑ) ÌôïÏù∏ ÌïÑÏàò!</div>
                                </div>
                                <div class="loan-tip-item">
                                    <div class="loan-tip-title">5. Ï†ïÏ±ÖÍ∏àÏúµÏÉÅÌíà Ïö∞ÏÑ† ÌôïÏù∏</div>
                                    <div class="loan-tip-content">ÎîîÎî§ÎèåÎåÄÏ∂ú, Î≥¥Í∏àÏûêÎ¶¨Î°†, Î≤ÑÌåÄÎ™©Ï†ÑÏÑ∏ÎåÄÏ∂ú Îì± Ï†ÄÍ∏àÎ¶¨ Ï†ïÏ±ÖÏÉÅÌíà ÏûêÍ≤©ÏöîÍ±¥ Î®ºÏ†Ä ÌôïÏù∏ÌïòÏÑ∏Ïöî.</div>
                                </div>
                            </div>
                            
                            <div class="loan-comparison-box">
                                <div class="loan-comparison-title">üí° ÏÉÅÌôò Î∞©ÏãùÎ≥Ñ ÎπÑÍµê (1Ïñµ, Ïó∞ 5%, 10ÎÖÑ Í∏∞Ï§Ä)</div>
                                <table class="loan-comparison-table">
                                    <tr>
                                        <th>ÏÉÅÌôò Î∞©Ïãù</th>
                                        <th>Ïõî ÏÉÅÌôòÏï°</th>
                                        <th>Ï¥ù Ïù¥Ïûê</th>
                                    </tr>
                                    <tr>
                                        <td>ÏõêÎ¶¨Í∏àÍ∑†Îì±</td>
                                        <td>ÏïΩ 106ÎßåÏõê (Í≥†Ï†ï)</td>
                                        <td>ÏïΩ 2,728ÎßåÏõê</td>
                                    </tr>
                                    <tr>
                                        <td>ÏõêÍ∏àÍ∑†Îì±</td>
                                        <td>Ï¥àÍ∏∞ 125Îßå‚ÜíÌõÑÍ∏∞ 84ÎßåÏõê</td>
                                        <td>ÏïΩ 2,542ÎßåÏõê</td>
                                    </tr>
                                    <tr>
                                        <td>ÎßåÍ∏∞ÏùºÏãú</td>
                                        <td>ÏïΩ 42ÎßåÏõê (Ïù¥ÏûêÎßå)</td>
                                        <td>ÏïΩ 5,000ÎßåÏõê</td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function updateLoanOptions() {
            const category = document.getElementById('loanCategory').value;
            const yearsSelect = document.getElementById('loanYears');
            const graceSelect = document.getElementById('gracePeriod');
            
            // ÎåÄÏ∂ú Ï¢ÖÎ•òÏóê Îî∞Îùº Í∏∞Î≥∏Í∞í Ï°∞Ï†ï
            if (category === 'mortgage') {
                yearsSelect.value = '30';
            } else if (category === 'jeonse') {
                yearsSelect.value = '2';
            } else if (category === 'business') {
                yearsSelect.value = '5';
            } else {
                yearsSelect.value = '5';
            }
        }

        let loanPieChartInstance = null;
        let loanLineChartInstance = null;

        function calculateLoan(e) {
            e.preventDefault();
            const category = document.getElementById('loanCategory').value;
            const type = document.getElementById('loanType').value;
            const principal = parseNumberFromComma(document.getElementById('loanAmount').value);
            const annualRate = parseFloat(document.getElementById('loanRate').value) / 100;
            const monthlyRate = annualRate / 12;
            const years = parseInt(document.getElementById('loanYears').value);
            const graceYears = parseInt(document.getElementById('gracePeriod').value);
            const totalMonths = years * 12;
            const graceMonths = graceYears * 12;
            const repaymentMonths = totalMonths - graceMonths;
            
            let scheduleData = [];
            let totalInterest = 0;
            let totalPayment = 0;
            let remainingPrincipal = principal;
            let monthlyPayment = 0;
            let firstMonthPayment = 0;
            let lastMonthPayment = 0;
            
            // Í±∞ÏπòÍ∏∞Í∞Ñ Ï§ë Ïù¥Ïûê
            const graceInterest = principal * monthlyRate;
            
            for (let month = 1; month <= totalMonths; month++) {
                let principalPayment = 0;
                let interestPayment = 0;
                let payment = 0;
                
                if (month <= graceMonths) {
                    // Í±∞Ïπò Í∏∞Í∞Ñ: Ïù¥ÏûêÎßå ÎÇ©Î∂Ä
                    interestPayment = remainingPrincipal * monthlyRate;
                    payment = interestPayment;
                } else {
                    // ÏÉÅÌôò Í∏∞Í∞Ñ
                    const repaymentMonth = month - graceMonths;
                    
                    if (type === 'bullet') {
                        // ÎßåÍ∏∞ÏùºÏãúÏÉÅÌôò
                        interestPayment = remainingPrincipal * monthlyRate;
                        if (month === totalMonths) {
                            principalPayment = principal;
                        }
                        payment = interestPayment + principalPayment;
                    } else if (type === 'equal') {
                        // ÏõêÎ¶¨Í∏àÍ∑†Îì±ÏÉÅÌôò
                        payment = principal * monthlyRate * Math.pow(1 + monthlyRate, repaymentMonths) / (Math.pow(1 + monthlyRate, repaymentMonths) - 1);
                        interestPayment = remainingPrincipal * monthlyRate;
                        principalPayment = payment - interestPayment;
                    } else {
                        // ÏõêÍ∏àÍ∑†Îì±ÏÉÅÌôò
                        principalPayment = principal / repaymentMonths;
                        interestPayment = remainingPrincipal * monthlyRate;
                        payment = principalPayment + interestPayment;
                    }
                }
                
                remainingPrincipal -= principalPayment;
                if (remainingPrincipal < 0) remainingPrincipal = 0;
                
                totalInterest += interestPayment;
                totalPayment += payment;
                
                if (month === 1) firstMonthPayment = payment;
                if (month === totalMonths) lastMonthPayment = payment;
                
                scheduleData.push({
                    month: month,
                    payment: Math.round(payment),
                    principal: Math.round(principalPayment),
                    interest: Math.round(interestPayment),
                    remaining: Math.round(remainingPrincipal)
                });
            }
            
            // Ïõî ÏÉÅÌôòÏï° (ÎåÄÌëúÍ∞í)
            if (type === 'equal') {
                monthlyPayment = principal * monthlyRate * Math.pow(1 + monthlyRate, repaymentMonths) / (Math.pow(1 + monthlyRate, repaymentMonths) - 1);
            } else if (type === 'principal') {
                monthlyPayment = (firstMonthPayment + lastMonthPayment) / 2; // ÌèâÍ∑†
            } else {
                monthlyPayment = principal * monthlyRate; // Ïù¥ÏûêÎßå
            }
            
            // Í≤∞Í≥º ÏÑπÏÖò ÌëúÏãú
            const resultSection = document.getElementById('loanResultSection');
            resultSection.classList.add('active');
            
            // Ïπ¥ÌÖåÍ≥†Î¶¨ ÌïúÍ∏ÄÎ™Ö
            const categoryNames = {
                general: 'ÏùºÎ∞ò Ïã†Ïö©ÎåÄÏ∂ú',
                mortgage: 'Ï£ºÌÉùÎã¥Î≥¥ÎåÄÏ∂ú',
                jeonse: 'Ï†ÑÏÑ∏ÏûêÍ∏àÎåÄÏ∂ú',
                business: 'ÏÇ¨ÏóÖÏûêÎåÄÏ∂ú'
            };
            
            const typeNames = {
                equal: 'ÏõêÎ¶¨Í∏àÍ∑†Îì±',
                principal: 'ÏõêÍ∏àÍ∑†Îì±',
                bullet: 'ÎßåÍ∏∞ÏùºÏãú'
            };
            
            // ÏöîÏïΩ Ïπ¥Îìú ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('loanSummary').innerHTML = `
                <div class="loan-summary-card">
                    <div class="loan-summary-label">ÎåÄÏ∂ú ÏõêÍ∏à</div>
                    <div class="loan-summary-value">${principal.toLocaleString()}Ïõê</div>
                </div>
                <div class="loan-summary-card monthly">
                    <div class="loan-summary-label">${type === 'equal' ? 'Ïõî ÏÉÅÌôòÏï°' : (type === 'principal' ? 'Ï≤´Îã¨ ÏÉÅÌôòÏï°' : 'Ïõî Ïù¥Ïûê')}</div>
                    <div class="loan-summary-value">${Math.round(firstMonthPayment).toLocaleString()}Ïõê</div>
                </div>
                <div class="loan-summary-card interest">
                    <div class="loan-summary-label">Ï¥ù Ïù¥Ïûê</div>
                    <div class="loan-summary-value">${Math.round(totalInterest).toLocaleString()}Ïõê</div>
                </div>
                <div class="loan-summary-card total">
                    <div class="loan-summary-label">Ï¥ù ÏÉÅÌôòÏï°</div>
                    <div class="loan-summary-value">${Math.round(totalPayment).toLocaleString()}Ïõê</div>
                </div>
            `;
            
            // ÌååÏù¥ Ï∞®Ìä∏ ÏÉùÏÑ±
            const pieCtx = document.getElementById('loanPieChart').getContext('2d');
            
            if (loanPieChartInstance) {
                loanPieChartInstance.destroy();
            }
            
            loanPieChartInstance = new Chart(pieCtx, {
                type: 'doughnut',
                data: {
                    labels: ['ÏõêÍ∏à', 'Ïù¥Ïûê'],
                    datasets: [{
                        data: [principal, totalInterest],
                        backgroundColor: ['#667eea', '#f56565'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                font: { size: 12 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${context.label}: ${Math.round(value).toLocaleString()}Ïõê (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
            
            // ÎùºÏù∏ Ï∞®Ìä∏ ÏÉùÏÑ± (ÏûîÏï° Ï∂îÏù¥)
            const lineCtx = document.getElementById('loanLineChart').getContext('2d');
            
            if (loanLineChartInstance) {
                loanLineChartInstance.destroy();
            }
            
            // Ï∞®Ìä∏Ïö© Îç∞Ïù¥ÌÑ∞ ÏÉòÌîåÎßÅ
            let chartData = scheduleData;
            if (totalMonths > 60) {
                const interval = Math.ceil(totalMonths / 30);
                chartData = scheduleData.filter((_, idx) => idx % interval === 0 || idx === totalMonths - 1);
            }
            
            loanLineChartInstance = new Chart(lineCtx, {
                type: 'line',
                data: {
                    labels: chartData.map(d => d.month + 'Í∞úÏõî'),
                    datasets: [
                        {
                            label: 'ÎÇ®ÏùÄ ÏõêÍ∏à',
                            data: chartData.map(d => d.remaining),
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            fill: true,
                            tension: 0.4,
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                usePointStyle: true,
                                font: { size: 12 }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.raw.toLocaleString() + 'Ïõê';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    if (value >= 100000000) {
                                        return (value / 100000000).toFixed(1) + 'Ïñµ';
                                    } else if (value >= 10000) {
                                        return (value / 10000).toFixed(0) + 'Îßå';
                                    }
                                    return value;
                                }
                            },
                            grid: { color: 'rgba(0, 0, 0, 0.05)' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
            
            // ÏÉÅÌôò Ïä§ÏºÄÏ§Ñ ÌÖåÏù¥Î∏î ÏÉùÏÑ±
            let tableHTML = `
                <thead>
                    <tr>
                        <th>ÌöåÏ∞®</th>
                        <th>ÏÉÅÌôòÍ∏à</th>
                        <th>ÏõêÍ∏à</th>
                        <th>Ïù¥Ïûê</th>
                        <th>ÏûîÍ∏à</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            // ÌÖåÏù¥Î∏îÏö© ÏÉòÌîåÎßÅ (12Í∞úÏõî Í∞ÑÍ≤© ÎòêÎäî Ï†ÅÏ†àÌûà)
            let tableData = [];
            if (totalMonths <= 24) {
                tableData = scheduleData;
            } else {
                const interval = Math.ceil(totalMonths / 24);
                tableData = scheduleData.filter((d, idx) => 
                    idx === 0 || 
                    idx === graceMonths - 1 ||
                    idx === graceMonths ||
                    (idx + 1) % 12 === 0 || 
                    idx === totalMonths - 1
                );
            }
            
            tableData.forEach(data => {
                const isGrace = data.month <= graceMonths && graceMonths > 0;
                tableHTML += `
                    <tr style="${isGrace ? 'background: #fef5f7;' : ''}">
                        <td>${data.month}Ìöå${isGrace ? ' (Í±∞Ïπò)' : ''}</td>
                        <td>${data.payment.toLocaleString()}Ïõê</td>
                        <td class="principal-cell">${data.principal.toLocaleString()}Ïõê</td>
                        <td class="interest-cell">${data.interest.toLocaleString()}Ïõê</td>
                        <td>${data.remaining.toLocaleString()}Ïõê</td>
                    </tr>
                `;
            });
            
            tableHTML += '</tbody>';
            document.getElementById('loanTable').innerHTML = tableHTML;
            
            // ÌÖåÏù¥Î∏î ÎÖ∏Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
            let noteText = `${categoryNames[category]} | ${typeNames[type]}ÏÉÅÌôò | ${years}ÎÖÑ`;
            if (graceYears > 0) noteText += ` (Í±∞Ïπò ${graceYears}ÎÖÑ Ìè¨Ìï®)`;
            document.getElementById('loanTableNote').textContent = noteText;
            
            // Í≤∞Í≥º ÏÑπÏÖòÏúºÎ°ú Ïä§ÌÅ¨Î°§
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function getVatCalculator() {
            return `
                <form class="calc-form" onsubmit="calculateVat(event)">
                    <div class="form-group">
                        <label>Í≥ÑÏÇ∞ Î∞©Ïãù</label>
                        <select id="vatType">
                            <option value="add">Î∂ÄÍ∞ÄÏÑ∏ Ìè¨Ìï® (Í≥µÍ∏âÍ∞ÄÏï° ‚Üí Ï¥ùÏï°)</option>
                            <option value="remove">Î∂ÄÍ∞ÄÏÑ∏ Ï†úÏô∏ (Ï¥ùÏï° ‚Üí Í≥µÍ∏âÍ∞ÄÏï°)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label id="vatAmountLabel">Í≥µÍ∏âÍ∞ÄÏï° (Ïõê)</label>
                        <input type="text" id="vatAmount" data-comma="true" placeholder="100,000" required>
                    </div>
                    <button type="submit" class="btn-calculate">Í≥ÑÏÇ∞ÌïòÍ∏∞</button>
                </form>
                <div class="result-box" id="vatResult"></div>
            `;
        }

        function calculateVat(e) {
            e.preventDefault();
            const type = document.getElementById('vatType').value;
            const amount = parseNumberFromComma(document.getElementById('vatAmount').value);
            
            let supply, vat, total;
            
            if (type === 'add') {
                supply = amount;
                vat = Math.round(amount * 0.1);
                total = supply + vat;
            } else {
                total = amount;
                supply = Math.round(amount / 1.1);
                vat = total - supply;
            }
            
            const resultBox = document.getElementById('vatResult');
            resultBox.className = 'result-box active';
            resultBox.innerHTML = `
                <h3>Î∂ÄÍ∞ÄÏÑ∏ Í≥ÑÏÇ∞ Í≤∞Í≥º</h3>
                <div class="result-item">
                    <span class="result-label">Í≥µÍ∏âÍ∞ÄÏï°</span>
                    <span class="result-value">${supply.toLocaleString()}Ïõê</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Î∂ÄÍ∞ÄÏÑ∏ (10%)</span>
                    <span class="result-value">${vat.toLocaleString()}Ïõê</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Ï¥ùÏï°</span>
                    <span class="result-value">${total.toLocaleString()}Ïõê</span>
                </div>
            `;
        }

        function getPercentageCalculator() {
            return `
                <div class="percent-calc-container">
                    <h3 style="text-align: center; margin-bottom: 20px; color: var(--primary-color);">
                        <i class="fas fa-percent"></i> Í≥ÑÏÇ∞Ìï† Î∞©ÏãùÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî
                    </h3>
                    
                    <div class="percent-method-tabs">
                        <button class="percent-tab active" onclick="selectPercentMethod(1, this)">
                            <i class="fas fa-calculator"></i>
                            <span>AÏùò B%Îäî?</span>
                        </button>
                        <button class="percent-tab" onclick="selectPercentMethod(2, this)">
                            <i class="fas fa-percentage"></i>
                            <span>AÎäî BÏùò Î™á%?</span>
                        </button>
                        <button class="percent-tab" onclick="selectPercentMethod(3, this)">
                            <i class="fas fa-search-plus"></i>
                            <span>B%Í∞Ä AÏùº Îïå Ï†ÑÏ≤¥Îäî?</span>
                        </button>
                    </div>

                    <div id="percentMethodDesc" class="percent-method-desc">
                        <i class="fas fa-info-circle"></i>
                        <span>Ïòà: 1000Ïùò 15%Îäî ÏñºÎßàÏù∏Í∞ÄÏöî?</span>
                    </div>

                    <form class="calc-form" onsubmit="calculatePercentage(event)">
                        <input type="hidden" id="percentMethod" value="1">
                        
                        <div class="form-group">
                            <label id="labelA"><i class="fas fa-a"></i> Í∞í A (Í∏∞Ï§Ä Í∞í)</label>
                            <input type="number" step="any" id="percentA" placeholder="1000" required>
                        </div>
                        <div class="form-group">
                            <label id="labelB"><i class="fas fa-b"></i> Í∞í B (ÌçºÏÑºÌä∏ %)</label>
                            <input type="number" step="any" id="percentB" placeholder="15" required>
                        </div>
                        <button type="submit" class="btn-calculate">
                            <i class="fas fa-calculator"></i> Í≥ÑÏÇ∞ÌïòÍ∏∞
                        </button>
                    </form>
                    
                    <div class="result-box" id="percentResult"></div>

                    <div class="percent-tips">
                        <h4><i class="fas fa-lightbulb"></i> ÌçºÏÑºÌä∏ Í≥ÑÏÇ∞ ÌôúÏö© ÌåÅ</h4>
                        <div class="tip-grid">
                            <div class="tip-item">
                                <i class="fas fa-shopping-cart"></i>
                                <strong>Ìï†Ïù∏ Í≥ÑÏÇ∞</strong>
                                <p>Ï†ïÍ∞Ä 50,000ÏõêÏóêÏÑú 20% Ìï†Ïù∏ Ïãú Ìï†Ïù∏ Í∏àÏï° Í≥ÑÏÇ∞</p>
                            </div>
                            <div class="tip-item">
                                <i class="fas fa-chart-line"></i>
                                <strong>ÏÑ±Ïû•Î•†/Î≥ÄÌôîÏú®</strong>
                                <p>Îß§Ï∂ú 120ÎßåÏõêÏù¥ 150ÎßåÏõêÏúºÎ°ú ‚Üí Î™á % Ï¶ùÍ∞Ä?</p>
                            </div>
                            <div class="tip-item">
                                <i class="fas fa-piggy-bank"></i>
                                <strong>Ïù¥Ïûê/ÏàòÏùµÎ•†</strong>
                                <p>ÏõêÍ∏à ÎåÄÎπÑ Ïù¥ÏûêÍ∞Ä Î™á %Ïù∏ÏßÄ, Ìà¨Ïûê ÏàòÏùµÎ•† Í≥ÑÏÇ∞</p>
                            </div>
                            <div class="tip-item">
                                <i class="fas fa-utensils"></i>
                                <strong>ÌåÅ Í≥ÑÏÇ∞</strong>
                                <p>ÏãùÏÇ¨ÎπÑÏùò 15~20% ÌåÅ Í≥ÑÏÇ∞ Ïãú ÌôúÏö©</p>
                            </div>
                            <div class="tip-item">
                                <i class="fas fa-home"></i>
                                <strong>ÏÑ∏Í∏à/ÏàòÏàòÎ£å</strong>
                                <p>Î∂ÄÎèôÏÇ∞ Ï§ëÍ∞úÏàòÏàòÎ£å, ÏÑ∏Í∏à Í≥ÑÏÇ∞ Îì±</p>
                            </div>
                            <div class="tip-item">
                                <i class="fas fa-graduation-cap"></i>
                                <strong>Ï†êÏàò/ÏÑ±Ï†Å</strong>
                                <p>Ï†ÑÏ≤¥ Î¨∏Ï†ú Ï§ë ÎßûÌûå ÎπÑÏú®, ÏÑ±Ï†Å Í≥ÑÏÇ∞</p>
                            </div>
                        </div>
                    </div>
                </div>

                <style>
                    .percent-calc-container {
                        max-width: 100%;
                    }
                    .percent-method-tabs {
                        display: flex;
                        gap: 10px;
                        margin-bottom: 20px;
                        flex-wrap: wrap;
                    }
                    .percent-tab {
                        flex: 1;
                        min-width: 140px;
                        padding: 15px 10px;
                        border: 2px solid #e2e8f0;
                        background: white;
                        border-radius: 12px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        gap: 8px;
                    }
                    .percent-tab i {
                        font-size: 24px;
                        color: var(--primary-color);
                    }
                    .percent-tab span {
                        font-size: 14px;
                        font-weight: 600;
                        color: var(--text-dark);
                    }
                    .percent-tab:hover {
                        border-color: var(--primary-color);
                        transform: translateY(-2px);
                        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
                    }
                    .percent-tab.active {
                        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
                        border-color: transparent;
                    }
                    .percent-tab.active i,
                    .percent-tab.active span {
                        color: white;
                    }
                    .percent-method-desc {
                        background: linear-gradient(135deg, #e0e7ff 0%, #f0e6ff 100%);
                        padding: 15px 20px;
                        border-radius: 10px;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        font-size: 15px;
                        color: var(--primary-color);
                    }
                    .percent-method-desc i {
                        font-size: 20px;
                    }
                    .percent-tips {
                        margin-top: 30px;
                        padding: 25px;
                        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
                        border-radius: 16px;
                        border: 1px solid #e2e8f0;
                    }
                    .percent-tips h4 {
                        color: var(--primary-color);
                        margin-bottom: 20px;
                        font-size: 18px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .percent-tips h4 i {
                        color: #f59e0b;
                    }
                    .tip-grid {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                        gap: 15px;
                    }
                    .tip-item {
                        background: white;
                        padding: 18px;
                        border-radius: 12px;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                        transition: all 0.3s ease;
                    }
                    .tip-item:hover {
                        transform: translateY(-3px);
                        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.15);
                    }
                    .tip-item i {
                        font-size: 28px;
                        color: var(--primary-color);
                        margin-bottom: 10px;
                        display: block;
                    }
                    .tip-item strong {
                        display: block;
                        margin-bottom: 8px;
                        color: var(--text-dark);
                        font-size: 15px;
                    }
                    .tip-item p {
                        font-size: 13px;
                        color: var(--text-light);
                        line-height: 1.5;
                    }
                    @media (max-width: 600px) {
                        .percent-method-tabs {
                            flex-direction: column;
                        }
                        .percent-tab {
                            flex-direction: row;
                            justify-content: center;
                        }
                    }
                </style>
            `;
        }

        function selectPercentMethod(method, btn) {
            // ÌÉ≠ ÌôúÏÑ±Ìôî Î≥ÄÍ≤Ω
            document.querySelectorAll('.percent-tab').forEach(tab => tab.classList.remove('active'));
            btn.classList.add('active');
            
            // Ïà®Í≤®ÏßÑ Í∞í ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('percentMethod').value = method;
            
            // ÎùºÎ≤®Í≥º ÏÑ§Î™Ö ÏóÖÎç∞Ïù¥Ìä∏
            const labelA = document.getElementById('labelA');
            const labelB = document.getElementById('labelB');
            const desc = document.getElementById('percentMethodDesc');
            const inputA = document.getElementById('percentA');
            const inputB = document.getElementById('percentB');
            
            switch(method) {
                case 1:
                    labelA.innerHTML = '<i class="fas fa-a"></i> Í∞í A (Í∏∞Ï§Ä Í∞í)';
                    labelB.innerHTML = '<i class="fas fa-b"></i> Í∞í B (ÌçºÏÑºÌä∏ %)';
                    inputA.placeholder = '1000';
                    inputB.placeholder = '15';
                    desc.innerHTML = '<i class="fas fa-info-circle"></i><span>Ïòà: 1000Ïùò 15%Îäî ÏñºÎßàÏù∏Í∞ÄÏöî? ‚Üí 150</span>';
                    break;
                case 2:
                    labelA.innerHTML = '<i class="fas fa-a"></i> Í∞í A (Î∂ÄÎ∂Ñ Í∞í)';
                    labelB.innerHTML = '<i class="fas fa-b"></i> Í∞í B (Ï†ÑÏ≤¥ Í∞í)';
                    inputA.placeholder = '30';
                    inputB.placeholder = '200';
                    desc.innerHTML = '<i class="fas fa-info-circle"></i><span>Ïòà: 30ÏùÄ 200Ïùò Î™á %? ‚Üí 15%</span>';
                    break;
                case 3:
                    labelA.innerHTML = '<i class="fas fa-a"></i> Í∞í A (Î∂ÄÎ∂Ñ Í∞í)';
                    labelB.innerHTML = '<i class="fas fa-b"></i> Í∞í B (Ìï¥Îãπ ÌçºÏÑºÌä∏ %)';
                    inputA.placeholder = '150';
                    inputB.placeholder = '15';
                    desc.innerHTML = '<i class="fas fa-info-circle"></i><span>Ïòà: 15%Í∞Ä 150Ïùº Îïå Ï†ÑÏ≤¥Îäî? ‚Üí 1000</span>';
                    break;
            }
            
            // ÏûÖÎ†• ÌïÑÎìú Ï¥àÍ∏∞Ìôî
            inputA.value = '';
            inputB.value = '';
            document.getElementById('percentResult').className = 'result-box';
            document.getElementById('percentResult').innerHTML = '';
        }

        function calculatePercentage(e) {
            e.preventDefault();
            const method = parseInt(document.getElementById('percentMethod').value);
            const a = parseFloat(document.getElementById('percentA').value);
            const b = parseFloat(document.getElementById('percentB').value);
            
            let result, resultTitle, resultItems;
            
            switch(method) {
                case 1: // AÏùò B%Îäî?
                    result = a * (b / 100);
                    resultTitle = 'AÏùò B% Í≥ÑÏÇ∞ Í≤∞Í≥º';
                    resultItems = `
                        <div class="result-item">
                            <span class="result-label">Í≥ÑÏÇ∞Ïãù</span>
                            <span class="result-value">${a.toLocaleString()} √ó ${b}%</span>
                        </div>
                        <div class="result-item" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px; padding: 15px;">
                            <span class="result-label" style="color: rgba(255,255,255,0.9);">${a.toLocaleString()}Ïùò ${b}%Îäî</span>
                            <span class="result-value" style="font-size: 28px; color: white;">${result.toLocaleString()}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">ÎÇ®ÏùÄ Í∞í (${100-b}%)</span>
                            <span class="result-value">${(a - result).toLocaleString()}</span>
                        </div>
                    `;
                    break;
                case 2: // AÎäî BÏùò Î™á%?
                    result = (a / b) * 100;
                    resultTitle = 'AÍ∞Ä BÏùò Î™á %Ïù∏ÏßÄ Í≥ÑÏÇ∞';
                    resultItems = `
                        <div class="result-item">
                            <span class="result-label">Í≥ÑÏÇ∞Ïãù</span>
                            <span class="result-value">${a.toLocaleString()} √∑ ${b.toLocaleString()} √ó 100</span>
                        </div>
                        <div class="result-item" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px; padding: 15px;">
                            <span class="result-label" style="color: rgba(255,255,255,0.9);">${a.toLocaleString()}ÏùÄ(Îäî) ${b.toLocaleString()}Ïùò</span>
                            <span class="result-value" style="font-size: 28px; color: white;">${result.toFixed(2)}%</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">ÎÇòÎ®∏ÏßÄ ÎπÑÏú®</span>
                            <span class="result-value">${(100 - result).toFixed(2)}%</span>
                        </div>
                    `;
                    break;
                case 3: // B%Í∞Ä AÏùº Îïå Ï†ÑÏ≤¥Îäî?
                    result = a / (b / 100);
                    resultTitle = 'Ï†ÑÏ≤¥ Í∞í Ïó≠ÏÇ∞ Í≤∞Í≥º';
                    resultItems = `
                        <div class="result-item">
                            <span class="result-label">Í≥ÑÏÇ∞Ïãù</span>
                            <span class="result-value">${a.toLocaleString()} √∑ ${b}% √ó 100</span>
                        </div>
                        <div class="result-item" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border-radius: 10px; padding: 15px;">
                            <span class="result-label" style="color: rgba(255,255,255,0.9);">${b}%Í∞Ä ${a.toLocaleString()}Ïùº Îïå Ï†ÑÏ≤¥Îäî</span>
                            <span class="result-value" style="font-size: 28px; color: white;">${result.toLocaleString()}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">ÎÇòÎ®∏ÏßÄ ${100-b}%Ïùò Í∞í</span>
                            <span class="result-value">${(result - a).toLocaleString()}</span>
                        </div>
                    `;
                    break;
            }
            
            const resultBox = document.getElementById('percentResult');
            resultBox.className = 'result-box active';
            resultBox.innerHTML = `
                <h3><i class="fas fa-check-circle" style="color: #10b981;"></i> ${resultTitle}</h3>
                ${resultItems}
            `;
        }

        function getBMICalculator() {
            return `
                <style>
                    .bmi-container {
                        display: flex;
                        flex-direction: column;
                        gap: 25px;
                    }
                    
                    .bmi-input-section {
                        background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
                        padding: 25px;
                        border-radius: 20px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
                    }
                    
                    .bmi-section-title {
                        font-size: 16px;
                        font-weight: 700;
                        color: #166534;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    
                    .bmi-section-title i {
                        color: #22c55e;
                    }
                    
                    .bmi-type-selector {
                        display: grid;
                        grid-template-columns: repeat(3, 1fr);
                        gap: 10px;
                        margin-bottom: 20px;
                    }
                    
                    .bmi-type-btn {
                        padding: 15px 12px;
                        border: 2px solid #bbf7d0;
                        background: white;
                        border-radius: 12px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        text-align: center;
                    }
                    
                    .bmi-type-btn:hover {
                        border-color: #22c55e;
                        background: #f0fdf4;
                    }
                    
                    .bmi-type-btn.active {
                        border-color: #22c55e;
                        background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
                        color: white;
                    }
                    
                    .bmi-type-btn i {
                        font-size: 24px;
                        margin-bottom: 8px;
                        display: block;
                    }
                    
                    .bmi-type-btn span {
                        font-size: 14px;
                        font-weight: 600;
                    }
                    
                    .bmi-type-btn.active i,
                    .bmi-type-btn.active span {
                        color: white;
                    }
                    
                    .bmi-inputs-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                    }
                    
                    .bmi-inputs-grid.with-age {
                        grid-template-columns: repeat(3, 1fr);
                    }
                    
                    @media (max-width: 600px) {
                        .bmi-inputs-grid, .bmi-inputs-grid.with-age {
                            grid-template-columns: 1fr;
                        }
                    }
                    
                    .bmi-input-group {
                        display: flex;
                        flex-direction: column;
                        gap: 8px;
                    }
                    
                    .bmi-input-group label {
                        font-size: 13px;
                        font-weight: 600;
                        color: #166534;
                        display: flex;
                        align-items: center;
                        gap: 6px;
                    }
                    
                    .bmi-input-group label i {
                        color: #22c55e;
                        font-size: 12px;
                    }
                    
                    .bmi-input-group input {
                        padding: 14px 16px;
                        border: 2px solid #bbf7d0;
                        border-radius: 12px;
                        font-size: 16px;
                        font-weight: 500;
                        color: #166534;
                        background: white;
                        transition: all 0.3s ease;
                    }
                    
                    .bmi-input-group input:focus {
                        outline: none;
                        border-color: #22c55e;
                        box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.15);
                    }
                    
                    .bmi-input-group input::placeholder {
                        color: #86efac;
                    }
                    
                    .bmi-calc-btn {
                        margin-top: 20px;
                        padding: 16px;
                        background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
                        color: white;
                        border: none;
                        border-radius: 12px;
                        font-size: 16px;
                        font-weight: 700;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                        width: 100%;
                    }
                    
                    .bmi-calc-btn:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 6px 20px rgba(34, 197, 94, 0.4);
                    }
                    
                    .bmi-result-section {
                        display: none;
                    }
                    
                    .bmi-result-section.active {
                        display: block;
                        animation: fadeIn 0.4s ease;
                    }
                    
                    .bmi-result-main {
                        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                        padding: 25px;
                        border-radius: 20px;
                        text-align: center;
                        margin-bottom: 20px;
                    }
                    
                    .bmi-score {
                        font-size: 56px;
                        font-weight: 800;
                        color: #92400e;
                        line-height: 1;
                        margin-bottom: 10px;
                    }
                    
                    .bmi-status {
                        display: inline-block;
                        padding: 8px 20px;
                        border-radius: 20px;
                        font-size: 18px;
                        font-weight: 700;
                        margin-bottom: 15px;
                    }
                    
                    .bmi-status.underweight { background: #dbeafe; color: #1e40af; }
                    .bmi-status.normal { background: #dcfce7; color: #166534; }
                    .bmi-status.overweight { background: #fef3c7; color: #92400e; }
                    .bmi-status.obese { background: #fee2e2; color: #991b1b; }
                    .bmi-status.severely-obese { background: #fecaca; color: #7f1d1d; }
                    
                    .bmi-gauge-container {
                        margin: 20px 0;
                        padding: 15px;
                        background: white;
                        border-radius: 15px;
                    }
                    
                    .bmi-gauge {
                        height: 16px;
                        background: linear-gradient(to right, #3b82f6 0%, #22c55e 25%, #eab308 50%, #f97316 75%, #ef4444 100%);
                        border-radius: 8px;
                        position: relative;
                        margin: 10px 0;
                    }
                    
                    .bmi-gauge-marker {
                        position: absolute;
                        top: -8px;
                        width: 32px;
                        height: 32px;
                        background: white;
                        border: 3px solid #1f2937;
                        border-radius: 50%;
                        transform: translateX(-50%);
                        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 10px;
                        font-weight: 800;
                    }
                    
                    .bmi-gauge-labels {
                        display: flex;
                        justify-content: space-between;
                        font-size: 11px;
                        color: #6b7280;
                        margin-top: 8px;
                    }
                    
                    .bmi-details-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        margin-bottom: 20px;
                    }
                    
                    @media (max-width: 600px) {
                        .bmi-details-grid {
                            grid-template-columns: 1fr;
                        }
                    }
                    
                    .bmi-detail-card {
                        background: white;
                        padding: 20px;
                        border-radius: 16px;
                        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
                    }
                    
                    .bmi-detail-card h4 {
                        font-size: 13px;
                        font-weight: 600;
                        color: #6b7280;
                        margin-bottom: 10px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    
                    .bmi-detail-card h4 i {
                        color: #22c55e;
                    }
                    
                    .bmi-detail-card .value {
                        font-size: 24px;
                        font-weight: 700;
                        color: #1f2937;
                    }
                    
                    .bmi-detail-card .sub {
                        font-size: 13px;
                        color: #9ca3af;
                        margin-top: 5px;
                    }
                    
                    .bmi-solution-section {
                        background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);
                        padding: 25px;
                        border-radius: 20px;
                        margin-bottom: 20px;
                    }
                    
                    .bmi-solution-title {
                        font-size: 16px;
                        font-weight: 700;
                        color: #5b21b6;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    
                    .bmi-solution-title i {
                        color: #8b5cf6;
                    }
                    
                    .bmi-solution-list {
                        display: flex;
                        flex-direction: column;
                        gap: 12px;
                    }
                    
                    .bmi-solution-item {
                        background: white;
                        padding: 15px 18px;
                        border-radius: 12px;
                        display: flex;
                        align-items: flex-start;
                        gap: 12px;
                        box-shadow: 0 2px 6px rgba(0,0,0,0.03);
                    }
                    
                    .bmi-solution-item i {
                        color: #8b5cf6;
                        font-size: 18px;
                        margin-top: 2px;
                    }
                    
                    .bmi-solution-item .content {
                        flex: 1;
                    }
                    
                    .bmi-solution-item .content h5 {
                        font-size: 14px;
                        font-weight: 600;
                        color: #1f2937;
                        margin-bottom: 4px;
                    }
                    
                    .bmi-solution-item .content p {
                        font-size: 13px;
                        color: #6b7280;
                        line-height: 1.5;
                    }
                    
                    .bmi-tips-section {
                        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                        padding: 25px;
                        border-radius: 20px;
                    }
                    
                    .bmi-tips-title {
                        font-size: 16px;
                        font-weight: 700;
                        color: #92400e;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    
                    .bmi-tips-title i {
                        color: #f59e0b;
                    }
                    
                    .bmi-tips-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 12px;
                    }
                    
                    @media (max-width: 600px) {
                        .bmi-tips-grid {
                            grid-template-columns: 1fr;
                        }
                    }
                    
                    .bmi-tip-card {
                        background: white;
                        padding: 15px;
                        border-radius: 12px;
                        display: flex;
                        align-items: flex-start;
                        gap: 12px;
                        transition: all 0.3s ease;
                    }
                    
                    .bmi-tip-card:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 6px 15px rgba(0,0,0,0.1);
                    }
                    
                    .bmi-tip-card .emoji {
                        font-size: 24px;
                    }
                    
                    .bmi-tip-card .content h5 {
                        font-size: 13px;
                        font-weight: 600;
                        color: #1f2937;
                        margin-bottom: 4px;
                    }
                    
                    .bmi-tip-card .content p {
                        font-size: 12px;
                        color: #6b7280;
                        line-height: 1.4;
                    }
                    
                    .bmi-age-notice {
                        background: #e0f2fe;
                        border: 2px solid #7dd3fc;
                        border-radius: 12px;
                        padding: 12px 15px;
                        margin-top: 15px;
                        display: none;
                    }
                    
                    .bmi-age-notice.visible {
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    
                    .bmi-age-notice i {
                        color: #0284c7;
                        font-size: 18px;
                    }
                    
                    .bmi-age-notice span {
                        font-size: 13px;
                        color: #0369a1;
                        line-height: 1.4;
                    }
                </style>
                
                <div class="bmi-container">
                    <div class="bmi-input-section">
                        <div class="bmi-section-title">
                            <i class="fas fa-user-check"></i> ÎπÑÎßåÎèÑ Ï∏°Ï†ï
                        </div>
                        
                        <div class="bmi-type-selector">
                            <button type="button" class="bmi-type-btn" onclick="selectBMIType('child', this)">
                                <i class="fas fa-child"></i>
                                <span>Ïñ¥Î¶∞Ïù¥</span>
                            </button>
                            <button type="button" class="bmi-type-btn active" onclick="selectBMIType('male', this)">
                                <i class="fas fa-male"></i>
                                <span>ÏÑ±Ïù∏ ÎÇ®ÏÑ±</span>
                            </button>
                            <button type="button" class="bmi-type-btn" onclick="selectBMIType('female', this)">
                                <i class="fas fa-female"></i>
                                <span>ÏÑ±Ïù∏ Ïó¨ÏÑ±</span>
                            </button>
                        </div>
                        
                        <div class="bmi-age-notice" id="bmiAgeNotice">
                            <i class="fas fa-info-circle"></i>
                            <span>Ïñ¥Î¶∞Ïù¥(2~18ÏÑ∏)Ïùò BMIÎäî ÎÇòÏù¥ÏôÄ ÏÑ±Î≥ÑÏóê Îî∞Î•∏ Î∞±Î∂ÑÏúÑÏàòÎ°ú ÌåêÏ†ïÎê©ÎãàÎã§. Ï†ïÌôïÌïú ÏßÑÎã®ÏùÄ Ï†ÑÎ¨∏ÏùòÏôÄ ÏÉÅÎã¥ÌïòÏÑ∏Ïöî.</span>
                        </div>
                        
                        <form onsubmit="calculateBMI(event)">
                            <div class="bmi-inputs-grid" id="bmiInputsGrid">
                                <div class="bmi-input-group">
                                    <label><i class="fas fa-ruler-vertical"></i> Ïã†Ïû•</label>
                                    <input type="number" step="0.1" id="bmiHeight" placeholder="170 cm" required>
                                </div>
                                <div class="bmi-input-group">
                                    <label><i class="fas fa-weight"></i> Ï≤¥Ï§ë</label>
                                    <input type="number" step="0.1" id="bmiWeight" placeholder="65 kg" required>
                                </div>
                                <div class="bmi-input-group" id="bmiAgeGroup" style="display: none;">
                                    <label><i class="fas fa-birthday-cake"></i> ÎÇòÏù¥</label>
                                    <input type="number" id="bmiAge" placeholder="10 ÏÑ∏" min="2" max="18">
                                </div>
                            </div>
                            <button type="submit" class="bmi-calc-btn">
                                <i class="fas fa-calculator"></i> ÎπÑÎßåÎèÑ Í≥ÑÏÇ∞ÌïòÍ∏∞
                            </button>
                        </form>
                    </div>
                    
                    <div class="bmi-result-section" id="bmiResultSection">
                        <!-- Í≤∞Í≥ºÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê® -->
                    </div>
                    
                    <div class="bmi-tips-section">
                        <div class="bmi-tips-title">
                            <i class="fas fa-lightbulb"></i> ÎπÑÎßåÏóê ÎåÄÌïú ÏÉÅÏãù
                        </div>
                        <div class="bmi-tips-grid">
                            <div class="bmi-tip-card">
                                <span class="emoji">‚öñÔ∏è</span>
                                <div class="content">
                                    <h5>BMIÏùò ÌïúÍ≥Ñ</h5>
                                    <p>BMIÎäî Í∑ºÏú°ÎüâÏùÑ Íµ¨Î∂ÑÌïòÏßÄ Î™ªÌï©ÎãàÎã§. Ïö¥ÎèôÏÑ†ÏàòÎäî BMIÍ∞Ä ÎÜíÏïÑÎèÑ Í±¥Í∞ïÌï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                                </div>
                            </div>
                            <div class="bmi-tip-card">
                                <span class="emoji">üìè</span>
                                <div class="content">
                                    <h5>ÌóàÎ¶¨ÎëòÎ†àÎèÑ Ï§ëÏöî</h5>
                                    <p>ÎÇ®ÏÑ± 90cm, Ïó¨ÏÑ± 85cm Ïù¥ÏÉÅÏù¥Î©¥ Î≥µÎ∂ÄÎπÑÎßåÏûÖÎãàÎã§. ÎÇ¥Ïû•ÏßÄÎ∞©Ïù¥ Îçî ÏúÑÌóòÌï©ÎãàÎã§.</p>
                                </div>
                            </div>
                            <div class="bmi-tip-card">
                                <span class="emoji">üçΩÔ∏è</span>
                                <div class="content">
                                    <h5>Í∏∞Ï¥àÎåÄÏÇ¨Îüâ</h5>
                                    <p>Î¨¥Î¶¨Ìïú Îã§Ïù¥Ïñ¥Ìä∏Îäî Í∏∞Ï¥àÎåÄÏÇ¨ÎüâÏùÑ ÎÇÆÏ∂∞ ÏöîÏöîÌòÑÏÉÅÏùÑ Ïú†Î∞úÌï©ÎãàÎã§. Ï≤úÏ≤úÌûà Í∞êÎüâÌïòÏÑ∏Ïöî.</p>
                                </div>
                            </div>
                            <div class="bmi-tip-card">
                                <span class="emoji">üèÉ</span>
                                <div class="content">
                                    <h5>Ï≤¥ÏßÄÎ∞©Î•†</h5>
                                    <p>ÎÇ®ÏÑ± 15~20%, Ïó¨ÏÑ± 20~25%Í∞Ä Ï†ïÏÉÅÏûÖÎãàÎã§. BMIÎ≥¥Îã§ Ï≤¥ÏßÄÎ∞©Î•†Ïù¥ Îçî Ï†ïÌôïÌïú ÏßÄÌëúÏûÖÎãàÎã§.</p>
                                </div>
                            </div>
                            <div class="bmi-tip-card">
                                <span class="emoji">üí™</span>
                                <div class="content">
                                    <h5>Í∑ºÏú°Ïùò Ï§ëÏöîÏÑ±</h5>
                                    <p>Í∑ºÏú° 1kgÏùÄ ÌïòÎ£® ÏïΩ 50kcalÎ•º ÏÜåÎπÑÌï©ÎãàÎã§. Í∑ºÎ†• Ïö¥ÎèôÏúºÎ°ú Í∏∞Ï¥àÎåÄÏÇ¨ÎüâÏùÑ ÎÜíÏù¥ÏÑ∏Ïöî.</p>
                                </div>
                            </div>
                            <div class="bmi-tip-card">
                                <span class="emoji">üò¥</span>
                                <div class="content">
                                    <h5>ÏàòÎ©¥Í≥º ÎπÑÎßå</h5>
                                    <p>ÏàòÎ©¥ Î∂ÄÏ°±ÏùÄ ÏãùÏöï Ìò∏Î•¥Î™¨ÏùÑ ÍµêÎûÄÏãúÏºú ÎπÑÎßå ÏúÑÌóòÏùÑ 40% ÎÜíÏûÖÎãàÎã§. 7-8ÏãúÍ∞Ñ ÏàòÎ©¥Ïù¥ Ïù¥ÏÉÅÏ†ÅÏûÖÎãàÎã§.</p>
                                </div>
                            </div>
                            <div class="bmi-tip-card">
                                <span class="emoji">üß¨</span>
                                <div class="content">
                                    <h5>Ïú†Ï†ÑÏ†Å ÏöîÏù∏</h5>
                                    <p>ÎπÑÎßåÏùò 40~70%Îäî Ïú†Ï†ÑÏ†Å ÏöîÏù∏ÏûÖÎãàÎã§. ÌïòÏßÄÎßå ÏÉùÌôúÏäµÍ¥Ä Í∞úÏÑ†ÏúºÎ°ú Ï∂©Î∂ÑÌûà Í¥ÄÎ¶¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.</p>
                                </div>
                            </div>
                            <div class="bmi-tip-card">
                                <span class="emoji">‚è∞</span>
                                <div class="content">
                                    <h5>Í±¥Í∞ïÌïú Í∞êÎüâ ÏÜçÎèÑ</h5>
                                    <p>Ï£ºÎãπ 0.5~1kg Í∞êÎüâÏù¥ Ïù¥ÏÉÅÏ†ÅÏûÖÎãàÎã§. Í∏âÍ≤©Ìïú Í∞êÎüâÏùÄ Í∑ºÏÜêÏã§Í≥º ÏòÅÏñë Î∂àÍ∑†ÌòïÏùÑ Ï¥àÎûòÌï©ÎãàÎã§.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        let currentBMIType = 'male';
        
        function selectBMIType(type, btn) {
            currentBMIType = type;
            document.querySelectorAll('.bmi-type-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            const ageGroup = document.getElementById('bmiAgeGroup');
            const inputsGrid = document.getElementById('bmiInputsGrid');
            const ageNotice = document.getElementById('bmiAgeNotice');
            
            if (type === 'child') {
                ageGroup.style.display = 'block';
                inputsGrid.classList.add('with-age');
                ageNotice.classList.add('visible');
                document.getElementById('bmiAge').required = true;
            } else {
                ageGroup.style.display = 'none';
                inputsGrid.classList.remove('with-age');
                ageNotice.classList.remove('visible');
                document.getElementById('bmiAge').required = false;
            }
        }

        function calculateBMI(e) {
            e.preventDefault();
            const height = parseFloat(document.getElementById('bmiHeight').value) / 100;
            const weight = parseFloat(document.getElementById('bmiWeight').value);
            const age = currentBMIType === 'child' ? parseInt(document.getElementById('bmiAge').value) : null;
            
            const bmi = weight / (height * height);
            const heightCm = height * 100;
            
            let status, statusClass, statusText, solutions;
            
            // Ïñ¥Î¶∞Ïù¥Ïùò Í≤ΩÏö∞ Îã§Î•∏ Í∏∞Ï§Ä Ï†ÅÏö©
            if (currentBMIType === 'child') {
                // Ïñ¥Î¶∞Ïù¥ BMI Î∞±Î∂ÑÏúÑÏàò Í∏∞Ï§Ä (Í∞ÑÎûµÌôî)
                if (bmi < 14) {
                    status = 'Ï†ÄÏ≤¥Ï§ë'; statusClass = 'underweight';
                    statusText = 'Ï†ïÏÉÅ Î≤îÏúÑÎ≥¥Îã§ Ï≤¥Ï§ëÏù¥ Ï†ÅÏäµÎãàÎã§.';
                } else if (bmi < 18.5) {
                    status = 'Ï†ïÏÉÅ'; statusClass = 'normal';
                    statusText = 'Í±¥Í∞ïÌïú Ï≤¥Ï§ë Î≤îÏúÑÏûÖÎãàÎã§.';
                } else if (bmi < 21) {
                    status = 'Í≥ºÏ≤¥Ï§ë ÏúÑÌóò'; statusClass = 'overweight';
                    statusText = 'Ï≤¥Ï§ë Í¥ÄÎ¶¨Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§.';
                } else {
                    status = 'ÎπÑÎßå'; statusClass = 'obese';
                    statusText = 'Ï†ÑÎ¨∏Ïùò ÏÉÅÎã¥Ïù¥ Í∂åÏû•Îê©ÎãàÎã§.';
                }
                
                solutions = [
                    { icon: 'fas fa-carrot', title: 'Í∑†Ìòï Ïû°Ìûå ÏãùÎã®', desc: 'Í≥ºÏùº, Ï±ÑÏÜå, Îã®Î∞±ÏßàÏùÑ Í≥®Í≥†Î£® ÏÑ≠Ï∑®ÌïòÍ≥† Ìå®Ïä§Ìä∏Ìë∏ÎìúÏôÄ ÌÉÑÏÇ∞ÏùåÎ£åÎ•º Ï§ÑÏù¥ÏÑ∏Ïöî.' },
                    { icon: 'fas fa-running', title: 'ÌôúÎèôÏ†ÅÏù∏ ÏÉùÌôú', desc: 'ÌïòÎ£® 60Î∂Ñ Ïù¥ÏÉÅ Ïã†Ï≤¥ ÌôúÎèôÏùÑ Í∂åÏû•Ìï©ÎãàÎã§. Î∞îÍπ• ÎÜÄÏù¥ÏôÄ Ïö¥ÎèôÏùÑ Ï¶êÍ∏∞ÏÑ∏Ïöî.' },
                    { icon: 'fas fa-moon', title: 'Ï∂©Î∂ÑÌïú ÏàòÎ©¥', desc: 'ÏÑ±Ïû•Í∏∞ÏóêÎäî Ï∂©Î∂ÑÌïú ÏàòÎ©¥Ïù¥ Ï§ëÏöîÌï©ÎãàÎã§. Ïó∞Î†πÏóê ÎßûÎäî ÏàòÎ©¥ ÏãúÍ∞ÑÏùÑ ÌôïÎ≥¥ÌïòÏÑ∏Ïöî.' },
                    { icon: 'fas fa-tv', title: 'Ïä§ÌÅ¨Î¶∞ ÌÉÄÏûÑ Ï†úÌïú', desc: 'TV, Ïä§ÎßàÌä∏Ìè∞ ÏÇ¨Ïö© ÏãúÍ∞ÑÏùÑ ÌïòÎ£® 2ÏãúÍ∞Ñ Ïù¥ÎÇ¥Î°ú Ï†úÌïúÌïòÏÑ∏Ïöî.' }
                ];
            } else {
                // ÏÑ±Ïù∏ Í∏∞Ï§Ä (ÏïÑÏãúÏïÑ-ÌÉúÌèâÏñë Í∏∞Ï§Ä)
                let baseBMI = currentBMIType === 'female' ? 
                    { low: 18.5, normal: 23, overweight: 25, obese: 30 } :
                    { low: 18.5, normal: 23, overweight: 25, obese: 30 };
                
                if (bmi < baseBMI.low) {
                    status = 'Ï†ÄÏ≤¥Ï§ë'; statusClass = 'underweight';
                    statusText = currentBMIType === 'female' ? 
                        'Ï†ïÏÉÅ Î≤îÏúÑÎ≥¥Îã§ Ï≤¥Ï§ëÏù¥ ÎÇÆÏäµÎãàÎã§. ÏòÅÏñë ÏÑ≠Ï∑®Ïóê Ï£ºÏùòÌïòÏÑ∏Ïöî.' :
                        'Ï†ïÏÉÅ Î≤îÏúÑÎ≥¥Îã§ Ï≤¥Ï§ëÏù¥ ÎÇÆÏäµÎãàÎã§. Í∑†Ìòï Ïû°Ìûå ÏãùÏÇ¨Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§.';
                } else if (bmi < baseBMI.normal) {
                    status = 'Ï†ïÏÉÅ'; statusClass = 'normal';
                    statusText = 'Í±¥Í∞ïÌïú Ï≤¥Ï§ëÏùÑ Ïú†ÏßÄÌïòÍ≥† ÏûàÏäµÎãàÎã§. ÌòÑÏû¨ ÏÉÅÌÉúÎ•º Ïú†ÏßÄÌïòÏÑ∏Ïöî!';
                } else if (bmi < baseBMI.overweight) {
                    status = 'Í≥ºÏ≤¥Ï§ë'; statusClass = 'overweight';
                    statusText = 'Ï†ïÏÉÅ Î≤îÏúÑÎ•º ÏïΩÍ∞Ñ Ï¥àÍ≥ºÌñàÏäµÎãàÎã§. ÏÉùÌôúÏäµÍ¥Ä Í∞úÏÑ†ÏùÑ Í∂åÏû•Ìï©ÎãàÎã§.';
                } else if (bmi < baseBMI.obese) {
                    status = 'ÎπÑÎßå'; statusClass = 'obese';
                    statusText = 'ÎπÑÎßå ÏÉÅÌÉúÏûÖÎãàÎã§. Í±¥Í∞ïÏùÑ ÏúÑÌï¥ Ï≤¥Ï§ë Í¥ÄÎ¶¨Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§.';
                } else {
                    status = 'Í≥†ÎèÑÎπÑÎßå'; statusClass = 'severely-obese';
                    statusText = 'Í≥†ÎèÑÎπÑÎßå ÏÉÅÌÉúÏûÖÎãàÎã§. Ï†ÑÎ¨∏Ïùò ÏÉÅÎã¥ÏùÑ Í∂åÏû•Ìï©ÎãàÎã§.';
                }
                
                if (statusClass === 'underweight') {
                    solutions = [
                        { icon: 'fas fa-utensils', title: 'ÏπºÎ°úÎ¶¨ ÏÑ≠Ï∑® Ï¶ùÍ∞Ä', desc: 'ÌïòÎ£® 300~500kcal Ï∂îÍ∞Ä ÏÑ≠Ï∑®Î•º Î™©ÌëúÎ°ú ÌïòÏÑ∏Ïöî. Í±¥Í∞ïÌïú ÏßÄÎ∞©Í≥º Îã®Î∞±Ïßà ÏúÑÏ£ºÎ°ú ÏÑ≠Ï∑®ÌïòÏÑ∏Ïöî.' },
                        { icon: 'fas fa-dumbbell', title: 'Í∑ºÎ†• Ïö¥Îèô', desc: 'Í∑ºÏú°Îüâ Ï¶ùÍ∞ÄÎ•º ÏúÑÌï¥ Ï£º 3~4Ìöå Í∑ºÎ†• Ïö¥ÎèôÏùÑ Í∂åÏû•Ìï©ÎãàÎã§.' },
                        { icon: 'fas fa-clock', title: 'Í∑úÏπôÏ†ÅÏù∏ ÏãùÏÇ¨', desc: 'ÌïòÎ£® 3ÎÅº + 2Ìöå Í∞ÑÏãùÏúºÎ°ú Í∑úÏπôÏ†ÅÏù∏ ÏòÅÏñë ÏÑ≠Ï∑®Î•º Ïú†ÏßÄÌïòÏÑ∏Ïöî.' },
                        { icon: 'fas fa-stethoscope', title: 'Í±¥Í∞ï Ï≤¥ÌÅ¨', desc: 'Í∏âÍ≤©Ìïú Ï≤¥Ï§ë Í∞êÏÜåÍ∞Ä ÏûàÎã§Î©¥ Ï†ÑÎ¨∏Ïùò ÏÉÅÎã¥ÏùÑ Î∞õÏïÑÎ≥¥ÏÑ∏Ïöî.' }
                    ];
                } else if (statusClass === 'normal') {
                    solutions = [
                        { icon: 'fas fa-check-circle', title: 'ÌòÑÏû¨ ÏÉÅÌÉú Ïú†ÏßÄ', desc: 'Í∑†Ìòï Ïû°Ìûå ÏãùÎã®Í≥º Í∑úÏπôÏ†ÅÏù∏ Ïö¥ÎèôÏúºÎ°ú ÌòÑÏû¨Ïùò Í±¥Í∞ïÌïú Ï≤¥Ï§ëÏùÑ Ïú†ÏßÄÌïòÏÑ∏Ïöî.' },
                        { icon: 'fas fa-heartbeat', title: 'Ïú†ÏÇ∞ÏÜå Ïö¥Îèô', desc: 'Ï£º 150Î∂Ñ Ïù¥ÏÉÅÏùò Ï§ëÎì±ÎèÑ Ïú†ÏÇ∞ÏÜå Ïö¥ÎèôÏúºÎ°ú Ïã¨ÌòàÍ¥Ä Í±¥Í∞ïÏùÑ Ïú†ÏßÄÌïòÏÑ∏Ïöî.' },
                        { icon: 'fas fa-apple-alt', title: 'ÏòÅÏñë Í∑†Ìòï', desc: 'Îã§ÏñëÌïú Ï±ÑÏÜå, Í≥ºÏùº, ÌÜµÍ≥°Î¨º, ÏñëÏßàÏùò Îã®Î∞±ÏßàÏùÑ ÏÑ≠Ï∑®ÌïòÏÑ∏Ïöî.' },
                        { icon: 'fas fa-bed', title: 'Ï∂©Î∂ÑÌïú Ìú¥Ïãù', desc: '7~8ÏãúÍ∞Ñ ÏàòÎ©¥Í≥º Ïä§Ìä∏Î†àÏä§ Í¥ÄÎ¶¨Î°ú Ï†ÑÎ∞òÏ†ÅÏù∏ Í±¥Í∞ïÏùÑ Ïú†ÏßÄÌïòÏÑ∏Ïöî.' }
                    ];
                } else {
                    solutions = [
                        { icon: 'fas fa-salad', title: 'ÏãùÎã® Ï°∞Ï†à', desc: currentBMIType === 'female' ? 
                            'ÏùºÏùº 1,200~1,500kcalÎ•º Î™©ÌëúÎ°ú ÌïòÏÑ∏Ïöî. Îã®Î∞±ÏßàÍ≥º ÏãùÏù¥ÏÑ¨Ïú† ÏúÑÏ£ºÎ°ú ÏÑ≠Ï∑®ÌïòÏÑ∏Ïöî.' :
                            'ÏùºÏùº 1,500~1,800kcalÎ•º Î™©ÌëúÎ°ú ÌïòÏÑ∏Ïöî. ÌÉÑÏàòÌôîÎ¨ºÍ≥º ÏßÄÎ∞© ÏÑ≠Ï∑®Î•º Ï§ÑÏù¥ÏÑ∏Ïöî.' },
                        { icon: 'fas fa-walking', title: 'Ïú†ÏÇ∞ÏÜå Ïö¥Îèô', desc: 'Ï£º 5Ìöå, 30Î∂Ñ Ïù¥ÏÉÅ Í±∑Í∏∞, Ï°∞ÍπÖ, ÏàòÏòÅ Îì±Ïùò Ïú†ÏÇ∞ÏÜå Ïö¥ÎèôÏùÑ Ïã§Ï≤úÌïòÏÑ∏Ïöî.' },
                        { icon: 'fas fa-dumbbell', title: 'Í∑ºÎ†• Ïö¥Îèô', desc: 'Ï£º 2~3Ìöå Í∑ºÎ†• Ïö¥ÎèôÏúºÎ°ú Í∏∞Ï¥àÎåÄÏÇ¨ÎüâÏùÑ ÎÜíÏù¥ÏÑ∏Ïöî.' },
                        { icon: 'fas fa-glass-water', title: 'Ï∂©Î∂ÑÌïú ÏàòÎ∂Ñ', desc: 'ÌïòÎ£® 2L Ïù¥ÏÉÅÏùò Î¨ºÏùÑ ÎßàÏãúÍ≥†, ÎãπÎ∂ÑÏù¥ Îì† ÏùåÎ£åÎäî ÌîºÌïòÏÑ∏Ïöî.' }
                    ];
                }
            }
            
            // Ïù¥ÏÉÅ Ï≤¥Ï§ë Í≥ÑÏÇ∞
            const idealWeightMin = 18.5 * height * height;
            const idealWeightMax = 23 * height * height;
            const weightDiff = weight - idealWeightMax;
            
            // Í≤åÏù¥ÏßÄ ÏúÑÏπò Í≥ÑÏÇ∞ (BMI 15~35 Î≤îÏúÑ)
            let gaugePosition = ((bmi - 15) / 20) * 100;
            gaugePosition = Math.max(0, Math.min(100, gaugePosition));
            
            const resultSection = document.getElementById('bmiResultSection');
            resultSection.className = 'bmi-result-section active';
            resultSection.innerHTML = `
                <div class="bmi-result-main">
                    <div class="bmi-score">${bmi.toFixed(1)}</div>
                    <div class="bmi-status ${statusClass}">${status}</div>
                    <p style="color: #78716c; font-size: 14px; margin: 0;">${statusText}</p>
                    
                    <div class="bmi-gauge-container">
                        <div class="bmi-gauge">
                            <div class="bmi-gauge-marker" style="left: ${gaugePosition}%">${bmi.toFixed(0)}</div>
                        </div>
                        <div class="bmi-gauge-labels">
                            <span>15 Ï†ÄÏ≤¥Ï§ë</span>
                            <span>18.5</span>
                            <span>23 Ï†ïÏÉÅ</span>
                            <span>25</span>
                            <span>30 ÎπÑÎßå</span>
                            <span>35+</span>
                        </div>
                    </div>
                </div>
                
                <div class="bmi-details-grid">
                    <div class="bmi-detail-card">
                        <h4><i class="fas fa-bullseye"></i> Ïù¥ÏÉÅ Ï≤¥Ï§ë Î≤îÏúÑ</h4>
                        <div class="value">${idealWeightMin.toFixed(1)} ~ ${idealWeightMax.toFixed(1)} kg</div>
                        <div class="sub">Ïã†Ïû• ${heightCm}cm Í∏∞Ï§Ä</div>
                    </div>
                    <div class="bmi-detail-card">
                        <h4><i class="fas fa-balance-scale"></i> Ï≤¥Ï§ë Ï∞®Ïù¥</h4>
                        <div class="value" style="color: ${weightDiff > 0 ? '#dc2626' : weightDiff < -5 ? '#2563eb' : '#16a34a'}">
                            ${weightDiff > 0 ? '+' : ''}${weightDiff.toFixed(1)} kg
                        </div>
                        <div class="sub">${weightDiff > 0 ? 'Í∞êÎüâ Í∂åÏû•' : weightDiff < -5 ? 'Ï¶ùÎüâ Í∂åÏû•' : 'Ï†ÅÏ†ï Ï≤¥Ï§ë'}</div>
                    </div>
                </div>
                
                <div class="bmi-solution-section">
                    <div class="bmi-solution-title">
                        <i class="fas fa-lightbulb"></i> ÎßûÏ∂§ Í±¥Í∞ï Í¥ÄÎ¶¨ Î∞©Î≤ï
                    </div>
                    <div class="bmi-solution-list">
                        ${solutions.map(s => `
                            <div class="bmi-solution-item">
                                <i class="${s.icon}"></i>
                                <div class="content">
                                    <h5>${s.title}</h5>
                                    <p>${s.desc}</p>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            // Í≤∞Í≥º ÏòÅÏó≠ÏúºÎ°ú Ïä§ÌÅ¨Î°§
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function getDutchPayCalculator() {
            return `
                <style>
                    .dutch-tabs {
                        display: flex;
                        margin-bottom: 25px;
                        background: #f1f5f9;
                        border-radius: 12px;
                        padding: 5px;
                    }
                    .dutch-tab {
                        flex: 1;
                        padding: 15px 20px;
                        border: none;
                        background: transparent;
                        font-size: 16px;
                        font-weight: 600;
                        color: #64748b;
                        cursor: pointer;
                        border-radius: 10px;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 8px;
                    }
                    .dutch-tab.active {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                    }
                    .dutch-tab:hover:not(.active) {
                        background: #e2e8f0;
                    }
                    .dutch-content {
                        display: none;
                    }
                    .dutch-content.active {
                        display: block;
                        animation: fadeIn 0.3s ease;
                    }
                    
                    /* Î∞òÏùëÌòï ÏûÖÎ†• Ïª®ÌÖåÏù¥ÎÑà - ÌôîÎ©¥ Î∞ñÏúºÎ°ú ÎÇòÍ∞ÄÏßÄ ÏïäÎèÑÎ°ù */
                    .people-inputs-container {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 10px;
                        margin-top: 15px;
                        max-width: 100%;
                        overflow: hidden;
                    }
                    .people-inputs-container .form-group {
                        margin: 0;
                        min-width: 0;
                    }
                    .people-inputs-container input {
                        padding: 12px 15px;
                        font-size: 14px;
                        width: 100%;
                        box-sizing: border-box;
                    }
                    
                    @media (max-width: 480px) {
                        .people-inputs-container {
                            grid-template-columns: 1fr;
                        }
                    }
                    
                    /* Í≤åÏûÑ ÏÑ§Î™Ö ÌåÅ Ïä§ÌÉÄÏùº */
                    .game-tip-box {
                        background: linear-gradient(135deg, #e0e7ff 0%, #c7d2fe 100%);
                        border-radius: 12px;
                        padding: 15px 20px;
                        margin-bottom: 20px;
                        border-left: 4px solid #667eea;
                    }
                    .game-tip-box h4 {
                        color: #4338ca;
                        font-size: 14px;
                        margin-bottom: 10px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    .game-tip-box ul {
                        margin: 0;
                        padding-left: 20px;
                        color: #4338ca;
                        font-size: 13px;
                        line-height: 1.8;
                    }
                    .game-tip-box li {
                        margin-bottom: 5px;
                    }
                    
                    /* Ïä¨Î°ØÎ®∏Ïã† Ïä§ÌÉÄÏùº */
                    .slot-machine {
                        background: linear-gradient(180deg, #1a1a2e 0%, #16213e 50%, #1a1a2e 100%);
                        border-radius: 20px;
                        padding: 30px 20px;
                        margin-top: 20px;
                        box-shadow: 0 10px 40px rgba(0,0,0,0.3), inset 0 2px 0 rgba(255,255,255,0.1);
                        position: relative;
                        overflow: hidden;
                    }
                    .slot-machine::before {
                        content: '';
                        position: absolute;
                        top: 0;
                        left: 0;
                        right: 0;
                        height: 3px;
                        background: linear-gradient(90deg, #ff6b6b, #feca57, #4ecdc4, #45b7d1, #ff6b6b);
                        background-size: 200% 100%;
                        animation: borderGlow 2s linear infinite;
                    }
                    @keyframes borderGlow {
                        0% { background-position: 0% 0%; }
                        100% { background-position: 200% 0%; }
                    }
                    .slot-header {
                        text-align: center;
                        margin-bottom: 25px;
                    }
                    .slot-header h3 {
                        color: #feca57;
                        font-size: 20px;
                        text-shadow: 0 0 20px rgba(254, 202, 87, 0.5);
                        margin-bottom: 5px;
                    }
                    .slot-header .subtitle {
                        color: #94a3b8;
                        font-size: 14px;
                    }
                    .slot-reels-container {
                        display: flex;
                        justify-content: center;
                        gap: 15px;
                        margin-bottom: 25px;
                        flex-wrap: wrap;
                    }
                    .slot-reel {
                        background: linear-gradient(180deg, #0f0f23 0%, #1e1e3f 50%, #0f0f23 100%);
                        border: 3px solid #feca57;
                        border-radius: 15px;
                        width: 80px;
                        height: 100px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        overflow: hidden;
                        position: relative;
                        box-shadow: 0 0 20px rgba(254, 202, 87, 0.3), inset 0 5px 15px rgba(0,0,0,0.5);
                    }
                    .slot-reel::before,
                    .slot-reel::after {
                        content: '';
                        position: absolute;
                        left: 0;
                        right: 0;
                        height: 25px;
                        z-index: 2;
                        pointer-events: none;
                    }
                    .slot-reel::before {
                        top: 0;
                        background: linear-gradient(to bottom, #0f0f23, transparent);
                    }
                    .slot-reel::after {
                        bottom: 0;
                        background: linear-gradient(to top, #0f0f23, transparent);
                    }
                    .slot-name {
                        font-size: 16px;
                        font-weight: 800;
                        color: #fff;
                        text-align: center;
                        text-shadow: 0 0 10px rgba(255,255,255,0.5);
                        padding: 5px;
                        word-break: break-all;
                    }
                    .slot-name.spinning {
                        animation: slotSpin 0.08s linear infinite;
                    }
                    @keyframes slotSpin {
                        0% { transform: translateY(-20px); opacity: 0.3; }
                        50% { transform: translateY(0); opacity: 1; }
                        100% { transform: translateY(20px); opacity: 0.3; }
                    }
                    
                    /* ÎãπÏ≤®Ïûê Î∞úÌëú Ïä§ÌÉÄÏùº */
                    .winner-reveal {
                        text-align: center;
                        padding: 40px 20px;
                        background: linear-gradient(135deg, #ff6b6b 0%, #feca57 50%, #ff6b6b 100%);
                        background-size: 200% 200%;
                        animation: gradientShift 3s ease infinite;
                        border-radius: 20px;
                        margin-top: 20px;
                        position: relative;
                        overflow: hidden;
                    }
                    @keyframes gradientShift {
                        0% { background-position: 0% 50%; }
                        50% { background-position: 100% 50%; }
                        100% { background-position: 0% 50%; }
                    }
                    .winner-reveal::before {
                        content: '';
                        position: absolute;
                        top: -50%;
                        left: -50%;
                        width: 200%;
                        height: 200%;
                        background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
                        animation: spotlight 2s ease-in-out infinite;
                    }
                    @keyframes spotlight {
                        0%, 100% { transform: translate(0, 0); }
                        50% { transform: translate(20%, 20%); }
                    }
                    .confetti-container {
                        position: absolute;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        overflow: hidden;
                        pointer-events: none;
                    }
                    .confetti {
                        position: absolute;
                        width: 10px;
                        height: 10px;
                        animation: confettiFall 3s ease-out forwards;
                    }
                    @keyframes confettiFall {
                        0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
                        100% { transform: translateY(500%) rotate(720deg); opacity: 0; }
                    }
                    .winner-crown {
                        font-size: 60px;
                        animation: crownBounce 0.5s ease-out;
                        text-shadow: 0 5px 20px rgba(0,0,0,0.3);
                    }
                    @keyframes crownBounce {
                        0% { transform: scale(0) rotate(-180deg); }
                        50% { transform: scale(1.3) rotate(10deg); }
                        100% { transform: scale(1) rotate(0deg); }
                    }
                    .winner-title {
                        font-size: 24px;
                        font-weight: 800;
                        color: white;
                        margin: 15px 0;
                        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                        animation: titlePulse 1s ease-in-out infinite;
                    }
                    @keyframes titlePulse {
                        0%, 100% { transform: scale(1); }
                        50% { transform: scale(1.05); }
                    }
                    .winner-names {
                        display: flex;
                        flex-wrap: wrap;
                        justify-content: center;
                        gap: 15px;
                        margin: 20px 0;
                        position: relative;
                        z-index: 10;
                    }
                    .winner-name-badge {
                        background: rgba(255,255,255,0.95);
                        color: #e11d48;
                        padding: 15px 30px;
                        border-radius: 50px;
                        font-size: 22px;
                        font-weight: 800;
                        box-shadow: 0 8px 25px rgba(0,0,0,0.2);
                        animation: badgePop 0.6s ease-out backwards;
                        position: relative;
                        overflow: hidden;
                    }
                    .winner-name-badge::before {
                        content: 'üí∏';
                        position: absolute;
                        right: -5px;
                        top: -5px;
                        font-size: 20px;
                        animation: moneyShake 0.5s ease-in-out infinite;
                    }
                    @keyframes badgePop {
                        0% { transform: scale(0) rotate(-10deg); opacity: 0; }
                        60% { transform: scale(1.2) rotate(5deg); }
                        100% { transform: scale(1) rotate(0deg); opacity: 1; }
                    }
                    @keyframes moneyShake {
                        0%, 100% { transform: rotate(-10deg); }
                        50% { transform: rotate(10deg); }
                    }
                    .winner-amount-display {
                        font-size: 28px;
                        font-weight: 700;
                        color: white;
                        margin-top: 20px;
                        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                        position: relative;
                        z-index: 10;
                    }
                    
                    /* Ï∞∏Ïó¨Ïûê Î™©Î°ù Ïä§ÌÉÄÏùº */
                    .participants-result {
                        margin-top: 25px;
                        padding: 25px;
                        background: #f8fafc;
                        border-radius: 15px;
                    }
                    .participants-result h4 {
                        color: #334155;
                        margin-bottom: 15px;
                        font-size: 16px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    .participants-badges {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 10px;
                    }
                    .participant-badge {
                        padding: 10px 18px;
                        border-radius: 25px;
                        font-weight: 600;
                        font-size: 14px;
                        transition: transform 0.2s;
                    }
                    .participant-badge:hover {
                        transform: scale(1.05);
                    }
                    .participant-badge.winner {
                        background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
                        color: white;
                        box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
                    }
                    .participant-badge.safe {
                        background: #e2e8f0;
                        color: #64748b;
                    }
                    
                    .retry-btn {
                        margin-top: 25px;
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border: none;
                        padding: 15px 40px;
                        border-radius: 30px;
                        font-size: 16px;
                        font-weight: 700;
                        cursor: pointer;
                        transition: all 0.3s;
                        display: inline-flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .retry-btn:hover {
                        transform: translateY(-3px);
                        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
                    }
                    
                    /* Í∏∞Ï°¥ Ïä§ÌÉÄÏùº Ïú†ÏßÄ */
                    .winner-count-container {
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .winner-count-container input {
                        flex: 1;
                    }
                    .winner-count-note {
                        font-size: 12px;
                        color: #64748b;
                        margin-top: 5px;
                    }
                </style>
                
                <div class="dutch-tabs">
                    <button type="button" class="dutch-tab active" onclick="switchDutchTab('dutch')">
                        <i class="fas fa-calculator"></i> ÎçîÏπòÌéòÏù¥
                    </button>
                    <button type="button" class="dutch-tab" onclick="switchDutchTab('random')">
                        <i class="fas fa-dice"></i> Î≥µÎ∂àÎ≥µ
                    </button>
                </div>
                
                <!-- ÎçîÏπòÌéòÏù¥ Í≥ÑÏÇ∞Í∏∞ -->
                <div id="dutchCalcContent" class="dutch-content active">
                    <div class="game-tip-box">
                        <h4><i class="fas fa-lightbulb"></i> ÎçîÏπòÌéòÏù¥ÎûÄ?</h4>
                        <ul>
                            <li>Ï¥ù Í∏àÏï°ÏùÑ Ïù∏ÏõêÏàòÎ°ú ÎÇòÎàÑÏñ¥ Í∞ÅÏûê Î∂ÄÎã¥ÌïòÎäî Î∞©Ïãù</li>
                            <li>100Ïõê Îã®ÏúÑÎ°ú Ïò¨Î¶ºÌïòÏó¨ ÍπîÎÅîÌïòÍ≤å Ï†ïÏÇ∞!</li>
                            <li>ÎÇ®Îäî Í∏àÏï°ÏùÄ Îã§Ïùå Î™®ÏûÑ Í∏∞Í∏àÏúºÎ°ú~ üí∞</li>
                        </ul>
                    </div>
                    <form class="calc-form" onsubmit="calculateDutchPay(event)">
                        <div class="form-group">
                            <label><i class="fas fa-won-sign"></i> Ï¥ù Í∏àÏï° (Ïõê)</label>
                            <input type="text" id="totalAmount" class="comma-input" placeholder="50,000" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-users"></i> Ïù∏Ïõê Ïàò (Î™Ö)</label>
                            <input type="number" id="peopleCount" placeholder="4" min="1" required>
                        </div>
                        <button type="submit" class="btn-calculate">
                            <i class="fas fa-calculator"></i> Í≥ÑÏÇ∞ÌïòÍ∏∞
                        </button>
                    </form>
                    <div class="result-box" id="dutchResult"></div>
                </div>
                
                <!-- Î≥µÎ∂àÎ≥µ Í≥ÑÏÇ∞Í∏∞ -->
                <div id="randomCalcContent" class="dutch-content">
                    <div class="game-tip-box">
                        <h4><i class="fas fa-dice"></i> Î≥µÎ∂àÎ≥µ Í≤åÏûÑ Î∞©Î≤ï</h4>
                        <ul>
                            <li>üéØ Ï¥ù Í∏àÏï°Í≥º Ï∞∏Ïó¨ Ïù∏ÏõêÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî</li>
                            <li>üë• ÎãπÏ≤®Ïûê ÏàòÎ•º ÏÑ§Ï†ïÌïòÏÑ∏Ïöî (1Î™Ö Ïù¥ÏÉÅ)</li>
                            <li>‚úèÔ∏è Í∞Å Ï∞∏Ïó¨ÏûêÏùò Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî</li>
                            <li>üé∞ Î≥µÎ∂àÎ≥µ ÏãúÏûë Î≤ÑÌäºÏùÑ ÎàÑÎ•¥Î©¥ Ïä¨Î°ØÎ®∏Ïã† Ï∂îÏ≤®!</li>
                            <li>üí∏ ÎãπÏ≤®ÏûêÍ∞Ä Ï†ÑÏï° Í≤∞Ï†úÌï©ÎãàÎã§!</li>
                        </ul>
                    </div>
                    <form class="calc-form" onsubmit="calculateRandom(event)">
                        <div class="form-group">
                            <label><i class="fas fa-won-sign"></i> Ï¥ù Í∏àÏï° (Ïõê)</label>
                            <input type="text" id="randomAmount" class="comma-input" placeholder="50,000" required>
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-users"></i> Ï¥ù Ïù∏ÏõêÏàò (1~10Î™Ö)</label>
                            <input type="number" id="totalPeople" placeholder="5" min="1" max="10" required onchange="updatePeopleInputs()" oninput="updatePeopleInputs()">
                        </div>
                        <div class="form-group">
                            <label><i class="fas fa-crown"></i> ÎãπÏ≤®Ïûê Ïù∏ÏõêÏàò</label>
                            <div class="winner-count-container">
                                <input type="number" id="winnerCount" placeholder="1" min="1" max="9" required onchange="validateWinnerCount()" oninput="validateWinnerCount()">
                            </div>
                            <span class="winner-count-note">* ÎãπÏ≤®ÏûêÎäî Ï¥ù Ïù∏ÏõêÏàòÎ≥¥Îã§ ÏûëÏïÑÏïº Ìï©ÎãàÎã§</span>
                        </div>
                        <div class="form-group" id="peopleNamesGroup" style="display: none;">
                            <label><i class="fas fa-id-card"></i> Ï∞∏Ïó¨Ïûê Ïù¥Î¶Ñ ÏûÖÎ†•</label>
                            <div class="people-inputs-container" id="peopleNamesContainer"></div>
                        </div>
                        <button type="submit" class="btn-calculate" style="background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);">
                            <i class="fas fa-dice"></i> Î≥µÎ∂àÎ≥µ ÏãúÏûë!
                        </button>
                    </form>
                    <div class="result-box" id="randomResult"></div>
                </div>
            `;
        }

        function switchDutchTab(tab) {
            document.querySelectorAll('.dutch-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.dutch-content').forEach(c => c.classList.remove('active'));
            
            if (tab === 'dutch') {
                document.querySelector('.dutch-tab:first-child').classList.add('active');
                document.getElementById('dutchCalcContent').classList.add('active');
            } else {
                document.querySelector('.dutch-tab:last-child').classList.add('active');
                document.getElementById('randomCalcContent').classList.add('active');
            }
        }

        function updatePeopleInputs() {
            const count = parseInt(document.getElementById('totalPeople').value) || 0;
            const container = document.getElementById('peopleNamesContainer');
            const group = document.getElementById('peopleNamesGroup');
            
            if (count > 0 && count <= 10) {
                group.style.display = 'block';
                container.innerHTML = '';
                
                for (let i = 1; i <= count; i++) {
                    container.innerHTML += `
                        <div class="form-group">
                            <input type="text" id="person${i}" placeholder="${i}Î≤à (Ïù¥Î¶Ñ)" required>
                        </div>
                    `;
                }
                
                // ÎãπÏ≤®Ïûê Ïàò Í≤ÄÏ¶ù
                validateWinnerCount();
            } else {
                group.style.display = 'none';
            }
        }

        function validateWinnerCount() {
            const totalPeople = parseInt(document.getElementById('totalPeople').value) || 0;
            const winnerInput = document.getElementById('winnerCount');
            const winnerCount = parseInt(winnerInput.value) || 0;
            
            if (totalPeople > 0) {
                winnerInput.max = totalPeople - 1;
                if (winnerCount >= totalPeople) {
                    winnerInput.value = totalPeople - 1;
                }
            }
        }

        function calculateDutchPay(e) {
            e.preventDefault();
            const totalStr = document.getElementById('totalAmount').value.replace(/,/g, '');
            const total = parseFloat(totalStr);
            const people = parseInt(document.getElementById('peopleCount').value);
            
            if (isNaN(total) || total <= 0) {
                alert('Ïò¨Î∞îÎ•∏ Í∏àÏï°ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            if (isNaN(people) || people <= 0) {
                alert('Ïò¨Î∞îÎ•∏ Ïù∏ÏõêÏàòÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            const perPerson = Math.ceil(total / people / 100) * 100;
            const perPersonExact = Math.round(total / people);
            const totalRounded = perPerson * people;
            const difference = totalRounded - total;
            
            const resultBox = document.getElementById('dutchResult');
            resultBox.className = 'result-box active';
            resultBox.innerHTML = `
                <h3><i class="fas fa-receipt"></i> ÎçîÏπòÌéòÏù¥ Í≥ÑÏÇ∞ Í≤∞Í≥º</h3>
                <div class="result-item">
                    <span class="result-label">Ï¥ù Í∏àÏï°</span>
                    <span class="result-value">${total.toLocaleString()}Ïõê</span>
                </div>
                <div class="result-item">
                    <span class="result-label">Ïù∏Ïõê</span>
                    <span class="result-value">${people}Î™Ö</span>
                </div>
                <div class="result-item">
                    <span class="result-label">1Ïù∏Îãπ Í∏àÏï° (Ï†ïÌôï)</span>
                    <span class="result-value">${perPersonExact.toLocaleString()}Ïõê</span>
                </div>
                <div class="result-item" style="background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%); padding: 15px; border-radius: 10px;">
                    <span class="result-label" style="font-weight: 700;">1Ïù∏Îãπ Í∏àÏï° (100Ïõê Îã®ÏúÑ)</span>
                    <span class="result-value" style="font-size: 24px; color: #667eea;">${perPerson.toLocaleString()}Ïõê</span>
                </div>
                ${difference > 0 ? `
                <div class="result-item">
                    <span class="result-label">Ï¥ù Ï†ïÏÇ∞ Í∏àÏï°</span>
                    <span class="result-value">${totalRounded.toLocaleString()}Ïõê</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ÎÇ®Îäî Í∏àÏï°</span>
                    <span class="result-value">+${difference.toLocaleString()}Ïõê</span>
                </div>
                ` : ''}
            `;
        }

        function calculateRandom(e) {
            e.preventDefault();
            const totalStr = document.getElementById('randomAmount').value.replace(/,/g, '');
            const amount = parseFloat(totalStr);
            const totalPeople = parseInt(document.getElementById('totalPeople').value);
            const winnerCount = parseInt(document.getElementById('winnerCount').value);
            
            if (isNaN(amount) || amount <= 0) {
                alert('Ïò¨Î∞îÎ•∏ Í∏àÏï°ÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            if (isNaN(totalPeople) || totalPeople <= 0 || totalPeople > 10) {
                alert('Ïù∏ÏõêÏàòÎäî 1~10Î™Ö ÏÇ¨Ïù¥Î°ú ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            if (isNaN(winnerCount) || winnerCount <= 0 || winnerCount >= totalPeople) {
                alert('ÎãπÏ≤®Ïûê ÏàòÎäî 1Î™Ö Ïù¥ÏÉÅ, Ï¥ù Ïù∏ÏõêÏàò ÎØ∏ÎßåÏù¥Ïñ¥Ïïº Ìï©ÎãàÎã§.');
                return;
            }
            
            // Ï∞∏Ïó¨Ïûê Ïù¥Î¶Ñ ÏàòÏßë
            const participants = [];
            for (let i = 1; i <= totalPeople; i++) {
                const nameInput = document.getElementById(`person${i}`);
                if (!nameInput || !nameInput.value.trim()) {
                    alert(`${i}Î≤à Ï∞∏Ïó¨Ïûê Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.`);
                    return;
                }
                participants.push(nameInput.value.trim());
            }
            
            const resultBox = document.getElementById('randomResult');
            resultBox.className = 'result-box active';
            
            // ÎãπÏ≤®Ïûê ÎØ∏Î¶¨ Í≤∞Ï†ï (Ï§ëÎ≥µ ÏóÜÏù¥)
            const shuffled = [...participants].sort(() => Math.random() - 0.5);
            const finalWinners = shuffled.slice(0, winnerCount);
            
            // Ïä¨Î°ØÎ®∏Ïã† Ïï†ÎãàÎ©îÏù¥ÏÖò ÏãúÏûë
            startSlotMachineAnimation(participants, finalWinners, winnerCount, amount, resultBox);
        }

        function startSlotMachineAnimation(participants, finalWinners, winnerCount, amount, resultBox) {
            // Ïä¨Î°ØÎ®∏Ïã† UI ÏÉùÏÑ±
            const reelsHTML = finalWinners.map((_, idx) => `
                <div class="slot-reel" id="slotReel${idx}">
                    <div class="slot-name spinning" id="slotName${idx}">${participants[0]}</div>
                </div>
            `).join('');
            
            resultBox.innerHTML = `
                <div class="slot-machine">
                    <div class="slot-header">
                        <h3><i class="fas fa-dice"></i> Î≥µÎ∂àÎ≥µ Ï∂îÏ≤® Ï§ë!</h3>
                        <div class="subtitle">ÎëêÍ∑ºÎëêÍ∑º... ÎàÑÍ∞Ä Í≤∞Ï†úÌï†ÍπåÏöî?</div>
                    </div>
                    <div class="slot-reels-container">
                        ${reelsHTML}
                    </div>
                    <div style="text-align: center; color: #feca57; font-size: 18px; font-weight: 600;">
                        <i class="fas fa-spinner fa-spin"></i> Ï∂îÏ≤® ÏßÑÌñâÏ§ë...
                    </div>
                </div>
            `;
            
            // Í∞Å Î¶¥Ïùò Ïä§ÌîºÎãù ÏÜçÎèÑÏôÄ ÏßÄÏÜçÏãúÍ∞Ñ ÏÑ§Ï†ï
            const baseSpinDuration = 2000; // Í∏∞Î≥∏ 2Ï¥à
            const delayBetweenReels = 800; // Î¶¥ Í∞Ñ 0.8Ï¥à ÎîúÎ†àÏù¥
            
            finalWinners.forEach((winner, idx) => {
                const spinDuration = baseSpinDuration + (idx * delayBetweenReels);
                let spinInterval;
                let spinSpeed = 50; // ÏãúÏûë ÏÜçÎèÑ (ms)
                let currentIndex = 0;
                const startTime = Date.now();
                
                // Ïä§ÌîºÎãù ÏãúÏûë
                const spinReel = () => {
                    const elapsed = Date.now() - startTime;
                    const slotNameEl = document.getElementById(`slotName${idx}`);
                    
                    if (!slotNameEl) return;
                    
                    // ÏãúÍ∞ÑÏù¥ ÏßÄÎÇ†ÏàòÎ°ù ÎäêÎ†§Ïßê
                    if (elapsed > spinDuration * 0.7) {
                        spinSpeed = Math.min(300, spinSpeed + 10);
                    }
                    
                    if (elapsed < spinDuration) {
                        // ÎûúÎç§ÌïòÍ≤å Ïù¥Î¶Ñ Î≥ÄÍ≤Ω
                        currentIndex = (currentIndex + 1) % participants.length;
                        slotNameEl.textContent = participants[currentIndex];
                        
                        setTimeout(spinReel, spinSpeed);
                    } else {
                        // Ïä§ÌîºÎãù Ï¢ÖÎ£å - ÏµúÏ¢Ö ÎãπÏ≤®Ïûê ÌëúÏãú
                        slotNameEl.classList.remove('spinning');
                        slotNameEl.textContent = winner;
                        slotNameEl.style.color = '#feca57';
                        slotNameEl.style.transform = 'scale(1.1)';
                        slotNameEl.style.transition = 'all 0.3s ease';
                        
                        // Î¶¥ ÌÖåÎëêÎ¶¨ ÏÉâÏÉÅ Î≥ÄÍ≤Ω
                        const reelEl = document.getElementById(`slotReel${idx}`);
                        if (reelEl) {
                            reelEl.style.borderColor = '#ff6b6b';
                            reelEl.style.boxShadow = '0 0 30px rgba(255, 107, 107, 0.6)';
                        }
                        
                        // ÎßàÏßÄÎßâ Î¶¥Ïù¥ Î©àÏ∂îÎ©¥ ÏµúÏ¢Ö Í≤∞Í≥º ÌëúÏãú
                        if (idx === finalWinners.length - 1) {
                            setTimeout(() => {
                                showFinalWinners(participants, finalWinners, winnerCount, amount, resultBox);
                            }, 800);
                        }
                    }
                };
                
                // Í∞Å Î¶¥Ïóê ÎîúÎ†àÏù¥Î•º Ï£ºÍ≥† ÏãúÏûë
                setTimeout(spinReel, idx * 200);
            });
        }

        function showFinalWinners(participants, winners, winnerCount, amount, resultBox) {
            const perPerson = Math.ceil(amount / winnerCount / 100) * 100;
            
            // Ïª®ÌéòÌã∞ ÏÉùÏÑ±
            const confettiColors = ['#ff6b6b', '#feca57', '#4ecdc4', '#45b7d1', '#a55eea', '#26de81'];
            let confettiHTML = '';
            for (let i = 0; i < 50; i++) {
                const color = confettiColors[Math.floor(Math.random() * confettiColors.length)];
                const left = Math.random() * 100;
                const delay = Math.random() * 2;
                const size = Math.random() * 10 + 5;
                const shape = Math.random() > 0.5 ? 'border-radius: 50%' : 'transform: rotate(45deg)';
                confettiHTML += `<div class="confetti" style="left: ${left}%; background: ${color}; width: ${size}px; height: ${size}px; ${shape}; animation-delay: ${delay}s;"></div>`;
            }
            
            // ÎãπÏ≤®Ïûê Î∞∞ÏßÄ ÏÉùÏÑ± (Ïï†ÎãàÎ©îÏù¥ÏÖò ÎîúÎ†àÏù¥ Ìè¨Ìï®)
            const winnerBadgesHTML = winners.map((name, idx) => 
                `<div class="winner-name-badge" style="animation-delay: ${0.3 + idx * 0.2}s;">${name}</div>`
            ).join('');
            
            resultBox.innerHTML = `
                <div class="winner-reveal">
                    <div class="confetti-container">${confettiHTML}</div>
                    <div class="winner-crown">üëë</div>
                    <div class="winner-title">üéâ ÎãπÏ≤®Ïûê Î∞úÌëú! üéâ</div>
                    <div class="winner-names">
                        ${winnerBadgesHTML}
                    </div>
                    <div class="winner-amount-display">
                        ${winnerCount > 1 ? `1Ïù∏Îãπ ` : ''}${perPerson.toLocaleString()}Ïõê Í≤∞Ï†ú!
                    </div>
                </div>
                <div class="participants-result">
                    <h4><i class="fas fa-users"></i> Ï†ÑÏ≤¥ Ï∞∏Ïó¨Ïûê</h4>
                    <div class="participants-badges">
                        ${participants.map(name => {
                            const isWinner = winners.includes(name);
                            return `<span class="participant-badge ${isWinner ? 'winner' : 'safe'}">${name} ${isWinner ? 'üí∏' : '‚ú®'}</span>`;
                        }).join('')}
                    </div>
                </div>
                <div style="text-align: center;">
                    <button type="button" onclick="calculateRandom(event)" class="retry-btn">
                        <i class="fas fa-redo"></i> Îã§Ïãú Ï∂îÏ≤®ÌïòÍ∏∞
                    </button>
                </div>
            `;
        }

        function getPyeongCalculator() {
            return `
                <style>
                    .pyeong-container {
                        display: flex;
                        flex-direction: column;
                        gap: 30px;
                    }
                    .pyeong-converter-section {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        padding: 30px;
                        border-radius: 20px;
                        color: white;
                    }
                    .pyeong-converter-title {
                        text-align: center;
                        font-size: 24px;
                        font-weight: 700;
                        margin-bottom: 10px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                    }
                    .pyeong-converter-subtitle {
                        text-align: center;
                        font-size: 14px;
                        opacity: 0.9;
                        margin-bottom: 30px;
                    }
                    .pyeong-converter-grid {
                        display: grid;
                        grid-template-columns: 1fr auto 1fr;
                        gap: 20px;
                        align-items: center;
                    }
                    .pyeong-input-card {
                        background: rgba(255,255,255,0.15);
                        backdrop-filter: blur(10px);
                        padding: 25px;
                        border-radius: 15px;
                        text-align: center;
                    }
                    .pyeong-input-label {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 8px;
                    }
                    .pyeong-input-wrapper {
                        position: relative;
                    }
                    .pyeong-input {
                        width: 100%;
                        padding: 20px;
                        padding-right: 50px;
                        border: none;
                        border-radius: 12px;
                        font-size: 28px;
                        font-weight: 700;
                        text-align: center;
                        background: white;
                        color: #2d3748;
                        transition: all 0.3s ease;
                    }
                    .pyeong-input:focus {
                        outline: none;
                        box-shadow: 0 0 0 3px rgba(255,255,255,0.5);
                    }
                    .pyeong-input-unit {
                        position: absolute;
                        right: 15px;
                        top: 50%;
                        transform: translateY(-50%);
                        font-size: 16px;
                        font-weight: 600;
                        color: #718096;
                    }
                    .pyeong-arrow {
                        font-size: 32px;
                        color: white;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    }
                    .pyeong-quick-buttons {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 10px;
                        justify-content: center;
                        margin-top: 25px;
                    }
                    .pyeong-quick-btn {
                        background: rgba(255,255,255,0.2);
                        border: none;
                        padding: 10px 18px;
                        border-radius: 25px;
                        color: white;
                        font-size: 14px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    }
                    .pyeong-quick-btn:hover {
                        background: rgba(255,255,255,0.3);
                        transform: translateY(-2px);
                    }
                    .pyeong-reference-section {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                    }
                    .pyeong-reference-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .pyeong-reference-title i {
                        color: #667eea;
                    }
                    .pyeong-reference-grid {
                        display: grid;
                        grid-template-columns: repeat(4, 1fr);
                        gap: 15px;
                    }
                    .pyeong-reference-card {
                        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
                        padding: 15px;
                        border-radius: 12px;
                        text-align: center;
                        border: 2px solid transparent;
                        transition: all 0.3s ease;
                        cursor: pointer;
                    }
                    .pyeong-reference-card:hover {
                        border-color: #667eea;
                        transform: translateY(-3px);
                        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
                    }
                    .pyeong-reference-pyeong {
                        font-size: 24px;
                        font-weight: 700;
                        color: #667eea;
                        margin-bottom: 5px;
                    }
                    .pyeong-reference-sqm {
                        font-size: 14px;
                        color: #718096;
                    }
                    .pyeong-reference-desc {
                        font-size: 12px;
                        color: #a0aec0;
                        margin-top: 5px;
                    }
                    .pyeong-terms-section {
                        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                    }
                    .pyeong-terms-title {
                        font-size: 18px;
                        font-weight: 600;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .pyeong-terms-title i {
                        color: #ffd700;
                    }
                    .pyeong-terms-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                    }
                    .pyeong-term-card {
                        background: rgba(255,255,255,0.1);
                        padding: 18px;
                        border-radius: 12px;
                        backdrop-filter: blur(10px);
                    }
                    .pyeong-term-name {
                        font-weight: 700;
                        font-size: 15px;
                        margin-bottom: 8px;
                        color: #ffd700;
                    }
                    .pyeong-term-desc {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .pyeong-property-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .pyeong-property-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #38ef7d;
                    }
                    .pyeong-property-grid {
                        display: grid;
                        grid-template-columns: repeat(3, 1fr);
                        gap: 12px;
                    }
                    .pyeong-property-card {
                        background: rgba(56,239,125,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        border-left: 4px solid #38ef7d;
                    }
                    .pyeong-property-name {
                        font-weight: 600;
                        margin-bottom: 5px;
                        color: #38ef7d;
                        font-size: 14px;
                    }
                    .pyeong-property-content {
                        font-size: 12px;
                        opacity: 0.9;
                        line-height: 1.4;
                    }
                    .pyeong-note {
                        margin-top: 20px;
                        padding: 15px;
                        background: rgba(255,215,0,0.1);
                        border-radius: 10px;
                        border-left: 4px solid #ffd700;
                        font-size: 13px;
                        line-height: 1.6;
                    }
                    @media (max-width: 768px) {
                        .pyeong-converter-grid {
                            grid-template-columns: 1fr;
                            gap: 15px;
                        }
                        .pyeong-arrow {
                            transform: rotate(90deg);
                        }
                        .pyeong-input {
                            font-size: 24px;
                            padding: 15px;
                        }
                        .pyeong-reference-grid {
                            grid-template-columns: repeat(2, 1fr);
                        }
                        .pyeong-terms-grid {
                            grid-template-columns: 1fr;
                        }
                        .pyeong-property-grid {
                            grid-template-columns: 1fr;
                        }
                    }
                    @media (max-width: 480px) {
                        .pyeong-converter-section {
                            padding: 20px;
                        }
                        .pyeong-input {
                            font-size: 20px;
                        }
                        .pyeong-quick-btn {
                            padding: 8px 14px;
                            font-size: 12px;
                        }
                    }
                </style>
                <div class="pyeong-container">
                    <div class="pyeong-converter-section">
                        <div class="pyeong-converter-title">
                            <i class="fas fa-home"></i>
                            Ïã§ÏãúÍ∞Ñ ÌèâÏàò Î≥ÄÌôòÍ∏∞
                        </div>
                        <div class="pyeong-converter-subtitle">1Ìèâ = 3.3058„é° (ÏïΩ 3.3„é°)</div>
                        
                        <div class="pyeong-converter-grid">
                            <div class="pyeong-input-card">
                                <div class="pyeong-input-label">
                                    <i class="fas fa-ruler-combined"></i> Ìèâ (Âù™)
                                </div>
                                <div class="pyeong-input-wrapper">
                                    <input type="text" class="pyeong-input" id="pyeongInput" placeholder="0" oninput="convertFromPyeong(this.value)">
                                    <span class="pyeong-input-unit">Ìèâ</span>
                                </div>
                            </div>
                            
                            <div class="pyeong-arrow">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            
                            <div class="pyeong-input-card">
                                <div class="pyeong-input-label">
                                    <i class="fas fa-vector-square"></i> Ï†úÍ≥±ÎØ∏ÌÑ∞ („é°)
                                </div>
                                <div class="pyeong-input-wrapper">
                                    <input type="text" class="pyeong-input" id="sqmInput" placeholder="0" oninput="convertFromSqm(this.value)">
                                    <span class="pyeong-input-unit">„é°</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="pyeong-quick-buttons">
                            <button type="button" class="pyeong-quick-btn" onclick="setQuickPyeong(10)">10Ìèâ</button>
                            <button type="button" class="pyeong-quick-btn" onclick="setQuickPyeong(18)">18Ìèâ</button>
                            <button type="button" class="pyeong-quick-btn" onclick="setQuickPyeong(24)">24Ìèâ</button>
                            <button type="button" class="pyeong-quick-btn" onclick="setQuickPyeong(32)">32Ìèâ</button>
                            <button type="button" class="pyeong-quick-btn" onclick="setQuickPyeong(42)">42Ìèâ</button>
                            <button type="button" class="pyeong-quick-btn" onclick="setQuickPyeong(59)">59Ìèâ</button>
                        </div>
                    </div>
                    
                    <div class="pyeong-reference-section">
                        <div class="pyeong-reference-title"><i class="fas fa-th"></i> ÏïÑÌååÌä∏ ÌèâÏàòÎ≥Ñ Ïã§Î©¥Ï†Å Ï∞∏Í≥†</div>
                        <div class="pyeong-reference-grid">
                            <div class="pyeong-reference-card" onclick="setQuickPyeong(18)">
                                <div class="pyeong-reference-pyeong">18Ìèâ</div>
                                <div class="pyeong-reference-sqm">59.5„é°</div>
                                <div class="pyeong-reference-desc">1~2Ïù∏ Í∞ÄÍµ¨</div>
                            </div>
                            <div class="pyeong-reference-card" onclick="setQuickPyeong(24)">
                                <div class="pyeong-reference-pyeong">24Ìèâ</div>
                                <div class="pyeong-reference-sqm">79.3„é°</div>
                                <div class="pyeong-reference-desc">2~3Ïù∏ Í∞ÄÍµ¨</div>
                            </div>
                            <div class="pyeong-reference-card" onclick="setQuickPyeong(32)">
                                <div class="pyeong-reference-pyeong">32Ìèâ</div>
                                <div class="pyeong-reference-sqm">105.8„é°</div>
                                <div class="pyeong-reference-desc">3~4Ïù∏ Í∞ÄÍµ¨</div>
                            </div>
                            <div class="pyeong-reference-card" onclick="setQuickPyeong(42)">
                                <div class="pyeong-reference-pyeong">42Ìèâ</div>
                                <div class="pyeong-reference-sqm">138.8„é°</div>
                                <div class="pyeong-reference-desc">4Ïù∏ Ïù¥ÏÉÅ Í∞ÄÍµ¨</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="pyeong-terms-section">
                        <div class="pyeong-terms-title"><i class="fas fa-book"></i> Î∂ÄÎèôÏÇ∞ Í±¥Ï∂ï Ïö©Ïñ¥ ÏÇ¨Ï†Ñ</div>
                        <div class="pyeong-terms-grid">
                            <div class="pyeong-term-card">
                                <div class="pyeong-term-name">üìê Ï†ÑÏö©Î©¥Ï†Å</div>
                                <div class="pyeong-term-desc">Ïã§Ï†úÎ°ú Í±∞Ï£ºÏûêÍ∞Ä ÎèÖÏ†êÏ†ÅÏúºÎ°ú ÏÇ¨Ïö©ÌïòÎäî Î©¥Ï†Å. Î∞©, Í±∞Ïã§, Ï£ºÎ∞©, ÌôîÏû•Ïã§ Îì± Ïã§ÎÇ¥ Í≥µÍ∞ÑÎßå Ìè¨Ìï®. ÏïÑÌååÌä∏ Î∂ÑÏñë Ïãú Í∞ÄÏû• Ï§ëÏöîÌïú Í∏∞Ï§Ä.</div>
                            </div>
                            <div class="pyeong-term-card">
                                <div class="pyeong-term-name">üè¢ Í≥µÍ∏âÎ©¥Ï†Å</div>
                                <div class="pyeong-term-desc">Ï†ÑÏö©Î©¥Ï†Å + Ï£ºÍ±∞Í≥µÏö©Î©¥Ï†Å(Í≥ÑÎã®, Î≥µÎèÑ, ÏóòÎ¶¨Î≤†Ïù¥ÌÑ∞ Îì±). Î∂ÑÏñëÍ∞Ä ÏÇ∞Ï†ï Í∏∞Ï§ÄÏù¥ ÎêòÎ©∞ "Î∂ÑÏñëÎ©¥Ï†Å"Ïù¥ÎùºÍ≥†ÎèÑ Ìï®.</div>
                            </div>
                            <div class="pyeong-term-card">
                                <div class="pyeong-term-name">üìä Í≥ÑÏïΩÎ©¥Ï†Å</div>
                                <div class="pyeong-term-desc">Í≥µÍ∏âÎ©¥Ï†Å + Í∏∞ÌÉÄÍ≥µÏö©Î©¥Ï†Å(Í¥ÄÎ¶¨ÏÇ¨Î¨¥ÏÜå, Ï£ºÏ∞®Ïû•, ÎÜÄÏù¥ÌÑ∞ Îì±). Ïã§Ï†ú Í≥ÑÏïΩÏÑúÏóê Î™ÖÏãúÎêòÎäî Ï¥ù Î©¥Ï†Å.</div>
                            </div>
                            <div class="pyeong-term-card">
                                <div class="pyeong-term-name">üè† ÎåÄÏßÄÎ©¥Ï†Å</div>
                                <div class="pyeong-term-desc">Í±¥Î¨ºÏù¥ Îì§Ïñ¥ÏÑúÎäî ÎïÖÏùò ÏàòÌèâ Ìà¨ÏòÅ Î©¥Ï†Å. ÌÜ†ÏßÄÎåÄÏû•Ïóê Í∏∞Ïû¨Îêú Î©¥Ï†ÅÏúºÎ°ú ÌÜ†ÏßÄ Í∞ÄÍ≤© ÏÇ∞Ï†ï Í∏∞Ï§Ä.</div>
                            </div>
                            <div class="pyeong-term-card">
                                <div class="pyeong-term-name">üèóÔ∏è Í±¥Ï∂ïÎ©¥Ï†Å</div>
                                <div class="pyeong-term-desc">Í±¥Î¨ºÏùò Î∞îÎã• Î©¥Ï†Å(1Ï∏µ Î∞îÎã•). Í±¥ÌèêÏú® Í≥ÑÏÇ∞Ïùò Í∏∞Ï§ÄÏù¥ ÎêòÎ©∞, Ïô∏Î≤Ω Ï§ëÏã¨ÏÑ†ÏúºÎ°ú Ï∏°Ï†ï.</div>
                            </div>
                            <div class="pyeong-term-card">
                                <div class="pyeong-term-name">üìè Ïó∞Î©¥Ï†Å</div>
                                <div class="pyeong-term-desc">Î™®Îì† Ï∏µÏùò Î∞îÎã•Î©¥Ï†ÅÏùÑ Ìï©Ìïú Ï¥ù Î©¥Ï†Å. ÏßÄÌïòÏ∏µ, Ï£ºÏ∞®Ïû• Îì± Ìè¨Ìï®. Ïö©Ï†ÅÎ•† Í≥ÑÏÇ∞Ïùò Í∏∞Ï§Ä.</div>
                            </div>
                            <div class="pyeong-term-card">
                                <div class="pyeong-term-name">üìà Í±¥ÌèêÏú®</div>
                                <div class="pyeong-term-desc">ÎåÄÏßÄÎ©¥Ï†Å ÎåÄÎπÑ Í±¥Ï∂ïÎ©¥Ï†ÅÏùò ÎπÑÏú®. Ïòà: Í±¥ÌèêÏú® 60%Î©¥ 100Ìèâ ÎïÖÏóê 60ÌèâÍπåÏßÄ Í±¥Î¨º Í∞ÄÎä•. Ïö©ÎèÑÏßÄÏó≠Î≥Ñ Ï†úÌïú ÏûàÏùå.</div>
                            </div>
                            <div class="pyeong-term-card">
                                <div class="pyeong-term-name">üìä Ïö©Ï†ÅÎ•†</div>
                                <div class="pyeong-term-desc">ÎåÄÏßÄÎ©¥Ï†Å ÎåÄÎπÑ Ïó∞Î©¥Ï†ÅÏùò ÎπÑÏú®. Ïòà: Ïö©Ï†ÅÎ•† 200%Î©¥ 100Ìèâ ÎïÖÏóê Ïó∞Î©¥Ï†Å 200Ìèâ Í±¥Î¨º Í∞ÄÎä•. Ï∏µÏàò Í≤∞Ï†ïÏóê ÏòÅÌñ•.</div>
                            </div>
                        </div>
                        
                        <div class="pyeong-property-section">
                            <div class="pyeong-property-title"><i class="fas fa-building"></i> Î∂ÄÎèôÏÇ∞ Ïú†ÌòïÎ≥Ñ ÌäπÏßï</div>
                            <div class="pyeong-property-grid">
                                <div class="pyeong-property-card">
                                    <div class="pyeong-property-name">üè¢ ÏïÑÌååÌä∏</div>
                                    <div class="pyeong-property-content">5Ï∏µ Ïù¥ÏÉÅ Í≥µÎèôÏ£ºÌÉù. Ï†ÑÏö©Î•† ÏïΩ 75~82%. Í¥ÄÎ¶¨ÎπÑ Î∞úÏÉù, Ï£ºÏ∞®/Ìé∏ÏùòÏãúÏÑ§ Í≥µÏö©.</div>
                                </div>
                                <div class="pyeong-property-card">
                                    <div class="pyeong-property-name">üè¨ Ïò§ÌîºÏä§ÌÖî</div>
                                    <div class="pyeong-property-content">ÏóÖÎ¨¥+Ï£ºÍ±∞ Í≤∏Ïö©. Ï†ÑÏö©Î•† ÏïΩ 50~60%Î°ú ÎÇÆÏùå. Ï†ÑÏûÖÏã†Í≥† Í∞ÄÎä•, Î∂ÑÏñëÍ∂å Ï†ÑÎß§ ÏûêÏú†.</div>
                                </div>
                                <div class="pyeong-property-card">
                                    <div class="pyeong-property-name">üèòÔ∏è ÎπåÎùº(Ïó∞Î¶Ω/Îã§ÏÑ∏ÎåÄ)</div>
                                    <div class="pyeong-property-content">4Ï∏µ Ïù¥Ìïò Í≥µÎèôÏ£ºÌÉù. Ï†ÑÏö©Î•† ÏïΩ 80~90%Î°ú ÎÜíÏùå. Í¥ÄÎ¶¨ÎπÑ Ï†ÄÎ†¥, Ï£ºÏ∞® Í≥µÍ∞Ñ Î∂ÄÏ°±.</div>
                                </div>
                                <div class="pyeong-property-card">
                                    <div class="pyeong-property-name">üè™ ÏÉÅÍ∞Ä</div>
                                    <div class="pyeong-property-content">ÏÉÅÏóÖÏö© Î∂ÄÎèôÏÇ∞. Ï†ÑÏö©Î•† ÏïΩ 50~60%. Î∂ÄÍ∞ÄÏÑ∏ Î≥ÑÎèÑ, Í∂åÎ¶¨Í∏à Ï°¥Ïû¨, ÏàòÏùµÌòï Ìà¨Ïûê.</div>
                                </div>
                                <div class="pyeong-property-card">
                                    <div class="pyeong-property-name">üè° Îã®ÎèÖÏ£ºÌÉù</div>
                                    <div class="pyeong-property-content">1Í∞ÄÍµ¨ 1Ï£ºÌÉù. Ï†ÑÏö©Î•† 100%. ÎåÄÏßÄ+Í±¥Î¨º ÏÜåÏú†, Ï¶ùÏ∂ï/Î¶¨Î™®Îç∏ÎßÅ ÏûêÏú†.</div>
                                </div>
                                <div class="pyeong-property-card">
                                    <div class="pyeong-property-name">üåæ ÌÜ†ÏßÄ(ÎïÖ)</div>
                                    <div class="pyeong-property-content">ÏßÄÎ™©Î≥Ñ Ïö©ÎèÑ Ï†úÌïú. Ï†Ñ/Îãµ/ÏûÑÏïº/ÎåÄÏßÄ Îì±. Ïö©ÎèÑÏßÄÏó≠Ïóê Îî∞Îùº Í±¥Ï∂ï Í∞ÄÎä• Ïó¨Î∂Ä Í≤∞Ï†ï.</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="pyeong-note">
                            <strong>üí° ÏïåÏïÑÎëêÎ©¥ Ïú†Ïö©Ìïú ÌåÅ:</strong><br>
                            ‚Ä¢ 2007ÎÖÑÎ∂ÄÌÑ∞ Î∂ÄÎèôÏÇ∞ Î©¥Ï†ÅÏùÄ „é°(Ï†úÍ≥±ÎØ∏ÌÑ∞)Î°ú ÌëúÍ∏∞Í∞Ä ÏùòÎ¨¥ÌôîÎêòÏóàÏäµÎãàÎã§.<br>
                            ‚Ä¢ ÏïÑÌååÌä∏ "24ÌèâÌòï"ÏùÄ Ïã§Ï†ú Ï†ÑÏö©Î©¥Ï†Å 59„é°(ÏïΩ 18Ìèâ)Ïù∏ Í≤ΩÏö∞Í∞Ä ÎßéÏäµÎãàÎã§.<br>
                            ‚Ä¢ Î∂ÑÏñë Î©¥Ï†ÅÍ≥º Ïã§Ï†ú Ï†ÑÏö©Î©¥Ï†ÅÏùò Ï∞®Ïù¥Î•º Íº≠ ÌôïÏù∏ÌïòÏÑ∏Ïöî!<br>
                            ‚Ä¢ Ï†ÑÏö©Î•† = (Ï†ÑÏö©Î©¥Ï†Å √∑ Í≥µÍ∏âÎ©¥Ï†Å) √ó 100. Ï†ÑÏö©Î•†Ïù¥ ÎÜíÏùÑÏàòÎ°ù Ïã§ÏÇ¨Ïö© Î©¥Ï†ÅÏù¥ ÎÑìÏäµÎãàÎã§.
                        </div>
                    </div>
                </div>
            `;
        }

        function convertFromPyeong(value) {
            const numValue = parseFloat(value.replace(/,/g, '')) || 0;
            const sqm = numValue * 3.3058;
            
            const pyeongInput = document.getElementById('pyeongInput');
            const sqmInput = document.getElementById('sqmInput');
            
            // Format pyeong input with comma
            if (value && !isNaN(numValue)) {
                pyeongInput.value = numValue.toLocaleString('ko-KR');
            }
            
            // Update sqm input
            if (numValue === 0) {
                sqmInput.value = '';
            } else {
                sqmInput.value = sqm.toFixed(2);
            }
        }

        function convertFromSqm(value) {
            const numValue = parseFloat(value.replace(/,/g, '')) || 0;
            const pyeong = numValue / 3.3058;
            
            const pyeongInput = document.getElementById('pyeongInput');
            const sqmInput = document.getElementById('sqmInput');
            
            // Format sqm input
            if (value && !isNaN(numValue)) {
                sqmInput.value = numValue.toLocaleString('ko-KR', { maximumFractionDigits: 2 });
            }
            
            // Update pyeong input
            if (numValue === 0) {
                pyeongInput.value = '';
            } else {
                pyeongInput.value = pyeong.toFixed(2);
            }
        }

        function setQuickPyeong(pyeong) {
            document.getElementById('pyeongInput').value = pyeong;
            convertFromPyeong(pyeong.toString());
        }

        function calculatePyeong(e) {
            e.preventDefault();
        }

        function getCommissionCalculator() {
            return `
                <style>
                    .commission-container {
                        display: flex;
                        flex-direction: column;
                        gap: 30px;
                    }
                    .commission-form-section {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        padding: 30px;
                        border-radius: 20px;
                        color: white;
                    }
                    .commission-form-title {
                        text-align: center;
                        font-size: 24px;
                        font-weight: 700;
                        margin-bottom: 25px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                    }
                    .commission-form-grid {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 20px;
                        margin-bottom: 20px;
                    }
                    .commission-form-group {
                        display: flex;
                        flex-direction: column;
                        gap: 8px;
                    }
                    .commission-form-group label {
                        font-size: 14px;
                        font-weight: 600;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    .commission-form-group select,
                    .commission-form-group input {
                        padding: 14px 16px;
                        border: none;
                        border-radius: 12px;
                        font-size: 16px;
                        background: rgba(255,255,255,0.95);
                        color: #2d3748;
                        transition: all 0.3s ease;
                    }
                    .commission-form-group select:focus,
                    .commission-form-group input:focus {
                        outline: none;
                        box-shadow: 0 0 0 3px rgba(255,255,255,0.5);
                    }
                    .monthly-rent-group {
                        display: none;
                        grid-column: span 2;
                    }
                    .monthly-rent-group.active {
                        display: block;
                    }
                    .commission-calculate-btn {
                        width: 100%;
                        padding: 18px;
                        background: rgba(255,255,255,0.2);
                        border: 2px solid white;
                        border-radius: 15px;
                        color: white;
                        font-size: 18px;
                        font-weight: 700;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                    }
                    .commission-calculate-btn:hover {
                        background: rgba(255,255,255,0.3);
                        transform: translateY(-3px);
                    }
                    .commission-result-section {
                        display: none;
                    }
                    .commission-result-section.active {
                        display: block;
                        animation: fadeIn 0.5s ease;
                    }
                    .commission-result-card {
                        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
                        padding: 30px;
                        border-radius: 20px;
                        color: white;
                        text-align: center;
                        margin-bottom: 25px;
                    }
                    .commission-result-label {
                        font-size: 16px;
                        opacity: 0.9;
                        margin-bottom: 10px;
                    }
                    .commission-result-value {
                        font-size: 42px;
                        font-weight: 700;
                        margin-bottom: 15px;
                    }
                    .commission-result-sub {
                        font-size: 14px;
                        opacity: 0.9;
                    }
                    .commission-detail-grid {
                        display: grid;
                        grid-template-columns: repeat(3, 1fr);
                        gap: 15px;
                        margin-bottom: 25px;
                    }
                    .commission-detail-card {
                        background: white;
                        padding: 20px;
                        border-radius: 15px;
                        text-align: center;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                    }
                    .commission-detail-label {
                        font-size: 13px;
                        color: #718096;
                        margin-bottom: 8px;
                    }
                    .commission-detail-value {
                        font-size: 18px;
                        font-weight: 700;
                        color: #2d3748;
                    }
                    .commission-rate-table-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 25px;
                        overflow-x: auto;
                    }
                    .commission-rate-table-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .commission-rate-table-title i {
                        color: #667eea;
                    }
                    .commission-rate-table {
                        width: 100%;
                        border-collapse: collapse;
                        font-size: 13px;
                    }
                    .commission-rate-table th {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 12px 10px;
                        text-align: center;
                        font-weight: 600;
                    }
                    .commission-rate-table th:first-child {
                        border-radius: 10px 0 0 0;
                    }
                    .commission-rate-table th:last-child {
                        border-radius: 0 10px 0 0;
                    }
                    .commission-rate-table td {
                        padding: 12px 10px;
                        text-align: center;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .commission-rate-table tr:hover {
                        background: #f7fafc;
                    }
                    .commission-rate-table tr.active-row {
                        background: #ebf8ff;
                        font-weight: 600;
                    }
                    .commission-rate-table tr.active-row td {
                        color: #667eea;
                    }
                    .commission-tips-container {
                        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                    }
                    .commission-tips-title {
                        font-size: 18px;
                        font-weight: 600;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .commission-tips-title i {
                        color: #ffd700;
                    }
                    .commission-terms-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        margin-bottom: 25px;
                    }
                    .commission-term-card {
                        background: rgba(255,255,255,0.1);
                        padding: 18px;
                        border-radius: 12px;
                        backdrop-filter: blur(10px);
                    }
                    .commission-term-name {
                        font-weight: 700;
                        font-size: 15px;
                        margin-bottom: 8px;
                        color: #ffd700;
                    }
                    .commission-term-desc {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .commission-save-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .commission-save-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #38ef7d;
                    }
                    .commission-save-item {
                        background: rgba(56,239,125,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 10px;
                        border-left: 4px solid #38ef7d;
                    }
                    .commission-save-item:last-child {
                        margin-bottom: 0;
                    }
                    .commission-save-item-title {
                        font-weight: 600;
                        margin-bottom: 5px;
                        color: #38ef7d;
                    }
                    .commission-save-item-content {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .commission-warning {
                        margin-top: 20px;
                        padding: 15px;
                        background: rgba(252,129,129,0.1);
                        border-radius: 10px;
                        border-left: 4px solid #fc8181;
                        font-size: 13px;
                        line-height: 1.6;
                    }
                    @media (max-width: 768px) {
                        .commission-form-grid {
                            grid-template-columns: 1fr;
                        }
                        .monthly-rent-group {
                            grid-column: span 1;
                        }
                        .commission-detail-grid {
                            grid-template-columns: 1fr;
                        }
                        .commission-terms-grid {
                            grid-template-columns: 1fr;
                        }
                        .commission-result-value {
                            font-size: 32px;
                        }
                    }
                </style>
                <div class="commission-container">
                    <div class="commission-form-section">
                        <div class="commission-form-title">
                            <i class="fas fa-calculator"></i>
                            Î∂ÄÎèôÏÇ∞ Ï§ëÍ∞úÏàòÏàòÎ£å Í≥ÑÏÇ∞Í∏∞
                        </div>
                        <form onsubmit="calculateCommission(event)">
                            <div class="commission-form-grid">
                                <div class="commission-form-group">
                                    <label><i class="fas fa-building"></i> Î∂ÄÎèôÏÇ∞ Ï¢ÖÎ•ò</label>
                                    <select id="propertyType" onchange="updateCommissionOptions()">
                                        <option value="apartment">ÏïÑÌååÌä∏</option>
                                        <option value="officetel">Ïò§ÌîºÏä§ÌÖî (Ï£ºÍ±∞Ïö©)</option>
                                        <option value="officetel-commercial">Ïò§ÌîºÏä§ÌÖî (ÏóÖÎ¨¥Ïö©)</option>
                                        <option value="villa">ÎπåÎùº/Ïó∞Î¶Ω/Îã§ÏÑ∏ÎåÄ</option>
                                        <option value="house">Îã®ÎèÖÏ£ºÌÉù/Îã§Í∞ÄÍµ¨</option>
                                        <option value="commercial">ÏÉÅÍ∞Ä/Ï†êÌè¨</option>
                                        <option value="building">Í±¥Î¨º/ÎπåÎî©</option>
                                        <option value="land">ÌÜ†ÏßÄ/ÎïÖ</option>
                                    </select>
                                </div>
                                <div class="commission-form-group">
                                    <label><i class="fas fa-exchange-alt"></i> Í±∞Îûò Ïú†Ìòï</label>
                                    <select id="transactionType" onchange="updateCommissionOptions()">
                                        <option value="sale">Îß§Îß§</option>
                                        <option value="jeonse">Ï†ÑÏÑ∏</option>
                                        <option value="monthly">ÏõîÏÑ∏</option>
                                    </select>
                                </div>
                                <div class="commission-form-group">
                                    <label><i class="fas fa-won-sign"></i> <span id="priceLabel">Îß§Îß§Í∞Ä</span> (Ïõê)</label>
                                    <input type="text" id="propertyPrice" data-comma="true" placeholder="300,000,000" required>
                                </div>
                                <div class="commission-form-group monthly-rent-group" id="monthlyRentGroup">
                                    <label><i class="fas fa-calendar-alt"></i> ÏõîÏÑ∏ (Ïõê)</label>
                                    <input type="text" id="monthlyRent" data-comma="true" placeholder="500,000">
                                </div>
                            </div>
                            <button type="submit" class="commission-calculate-btn">
                                <i class="fas fa-calculator"></i>
                                Ï§ëÍ∞úÏàòÏàòÎ£å Í≥ÑÏÇ∞ÌïòÍ∏∞
                            </button>
                        </form>
                    </div>
                    
                    <div class="commission-result-section" id="commissionResultSection">
                        <div class="commission-result-card">
                            <div class="commission-result-label">ÏòàÏÉÅ Ï§ëÍ∞úÏàòÏàòÎ£å (VAT Î≥ÑÎèÑ)</div>
                            <div class="commission-result-value" id="commissionResultValue">0Ïõê</div>
                            <div class="commission-result-sub" id="commissionResultSub">ÏÉÅÌïúÏöîÏú® 0% Ï†ÅÏö©</div>
                        </div>
                        
                        <div class="commission-detail-grid">
                            <div class="commission-detail-card">
                                <div class="commission-detail-label">Í±∞ÎûòÍ∏àÏï°</div>
                                <div class="commission-detail-value" id="detailPrice">0Ïõê</div>
                            </div>
                            <div class="commission-detail-card">
                                <div class="commission-detail-label">Ï†ÅÏö© ÏöîÏú®</div>
                                <div class="commission-detail-value" id="detailRate">0%</div>
                            </div>
                            <div class="commission-detail-card">
                                <div class="commission-detail-label">VAT Ìè¨Ìï® Ïãú</div>
                                <div class="commission-detail-value" id="detailVat">0Ïõê</div>
                            </div>
                        </div>
                        
                        <div class="commission-rate-table-container">
                            <div class="commission-rate-table-title"><i class="fas fa-table"></i> <span id="rateTableTitle">Ï£ºÌÉù Ï§ëÍ∞úÏàòÏàòÎ£å ÏöîÏú®Ìëú</span></div>
                            <table class="commission-rate-table" id="commissionRateTable"></table>
                        </div>
                    </div>
                    
                    <div class="commission-tips-container">
                        <div class="commission-tips-title"><i class="fas fa-book"></i> Î∂ÄÎèôÏÇ∞ Ï§ëÍ∞úÏàòÏàòÎ£å ÏïàÎÇ¥</div>
                        <div class="commission-terms-grid">
                            <div class="commission-term-card">
                                <div class="commission-term-name">üè† Ï£ºÍ±∞Ïö© Î∂ÄÎèôÏÇ∞</div>
                                <div class="commission-term-desc">ÏïÑÌååÌä∏, ÎπåÎùº, Ï£ºÌÉù Îì±. Í±∞ÎûòÍ∏àÏï°Ïóê Îî∞Îùº 0.4%~0.7% Ï∞®Îì± Ï†ÅÏö©. ÏÉÅÌïúÏöîÏú® Í∑úÏ†ïÏù¥ ÏóÑÍ≤©Ìï®.</div>
                            </div>
                            <div class="commission-term-card">
                                <div class="commission-term-name">üè¢ Ïò§ÌîºÏä§ÌÖî</div>
                                <div class="commission-term-desc">Ï£ºÍ±∞Ïö©ÏùÄ Ï£ºÌÉùÍ≥º ÎèôÏùº ÏöîÏú®, ÏóÖÎ¨¥Ïö©ÏùÄ Î≥ÑÎèÑ ÏöîÏú®(Îß§Îß§ 0.5%, ÏûÑÎåÄ 0.4%) Ï†ÅÏö©.</div>
                            </div>
                            <div class="commission-term-card">
                                <div class="commission-term-name">üè™ ÏÉÅÍ∞Ä/Í±¥Î¨º/ÌÜ†ÏßÄ</div>
                                <div class="commission-term-desc">ÎπÑÏ£ºÍ±∞Ïö©ÏùÄ ÏÉÅÌïúÏöîÏú® 0.9% Ïù¥ÎÇ¥ÏóêÏÑú Ï§ëÍ∞úÏÇ¨ÏôÄ ÌòëÏùò. ÌòëÏÉÅ Ïó¨ÏßÄÍ∞Ä ÏûàÏùå.</div>
                            </div>
                            <div class="commission-term-card">
                                <div class="commission-term-name">üí∞ ÏõîÏÑ∏ Í±∞ÎûòÍ∏àÏï°</div>
                                <div class="commission-term-desc">ÏõîÏÑ∏ = Î≥¥Ï¶ùÍ∏à + (ÏõîÏÑ∏ √ó 100). Îã®, 5Ï≤úÎßåÏõê ÎØ∏ÎßåÏù¥Î©¥ Î≥¥Ï¶ùÍ∏à + (ÏõîÏÑ∏ √ó 70).</div>
                            </div>
                            <div class="commission-term-card">
                                <div class="commission-term-name">üìã ÏÉÅÌïúÏöîÏú® vs ÌïúÎèÑÏï°</div>
                                <div class="commission-term-desc">ÏöîÏú®Î°ú Í≥ÑÏÇ∞Ìïú Í∏àÏï°Í≥º ÌïúÎèÑÏï° Ï§ë ÎÇÆÏùÄ Í∏àÏï°Ïù¥ ÏµúÎåÄ ÏàòÏàòÎ£å. ÌòëÏùòÎ°ú Îçî ÎÇÆÏ∂ú Ïàò ÏûàÏùå.</div>
                            </div>
                            <div class="commission-term-card">
                                <div class="commission-term-name">üßæ Î∂ÄÍ∞ÄÏÑ∏ (VAT)</div>
                                <div class="commission-term-desc">ÏùºÎ∞òÍ≥ºÏÑ∏Ïûê Ï§ëÍ∞úÏÇ¨Îäî ÏàòÏàòÎ£åÏùò 10% Î∂ÄÍ∞ÄÏÑ∏ Î≥ÑÎèÑ. Í∞ÑÏù¥Í≥ºÏÑ∏ÏûêÎäî Î∂ÄÍ∞ÄÏÑ∏ ÏóÜÏùå.</div>
                            </div>
                        </div>
                        
                        <div class="commission-save-section">
                            <div class="commission-save-title"><i class="fas fa-piggy-bank"></i> Ï§ëÍ∞úÏàòÏàòÎ£å ÏïÑÎÅºÎäî ÍøÄÌåÅ</div>
                            <div class="commission-save-item">
                                <div class="commission-save-item-title">1. ÏÉÅÌïúÏöîÏú®ÏùÄ 'ÏµúÎåÄ'Ïù¥ÏßÄ 'Í≥†Ï†ï'Ïù¥ ÏïÑÎãàÎã§</div>
                                <div class="commission-save-item-content">ÏÉÅÌïúÏöîÏú® Ïù¥ÎÇ¥ÏóêÏÑú ÌòëÏùò Í∞ÄÎä•Ìï©ÎãàÎã§. ÌäπÌûà ÎπÑÏ£ºÍ±∞Ïö©(ÏÉÅÍ∞Ä, ÌÜ†ÏßÄ)ÏùÄ 0.9% Ïù¥ÎÇ¥ ÌòëÏÉÅ Ïó¨ÏßÄÍ∞Ä ÌÅΩÎãàÎã§.</div>
                            </div>
                            <div class="commission-save-item">
                                <div class="commission-save-item-title">2. Ï§ëÍ∞úÏÇ¨ ÎπÑÍµêÌïòÍ∏∞</div>
                                <div class="commission-save-item-content">Ïó¨Îü¨ Ï§ëÍ∞úÏÇ¨Ïóê ÏàòÏàòÎ£åÎ•º Î¨∏ÏùòÌïòÏÑ∏Ïöî. Í∞ôÏùÄ Í±∞ÎûòÎèÑ Ï§ëÍ∞úÏÇ¨ÎßàÎã§ ÏöîÏú®Ïù¥ Îã§Î•º Ïàò ÏûàÏäµÎãàÎã§.</div>
                            </div>
                            <div class="commission-save-item">
                                <div class="commission-save-item-title">3. ÏßÅÍ±∞Îûò ÌîåÎû´Ìèº ÌôúÏö©</div>
                                <div class="commission-save-item-content">ÎãπÍ∑ºÎßàÏºì, ÌîºÌÑ∞Ìå¨Ïùò Ï¢ãÏùÄÎ∞© Íµ¨ÌïòÍ∏∞ Îì± ÏßÅÍ±∞Îûò ÌîåÎû´ÌèºÏùÑ ÌôúÏö©ÌïòÎ©¥ ÏàòÏàòÎ£åÎ•º Ï†àÏïΩÌï† Ïàò ÏûàÏäµÎãàÎã§.</div>
                            </div>
                            <div class="commission-save-item">
                                <div class="commission-save-item-title">4. ÎÑ§Í≥† ÌÉÄÏù¥Î∞ç</div>
                                <div class="commission-save-item-content">ÎπÑÏàòÍ∏∞(Ïó¨Î¶Ñ, Í≤®Ïö∏)ÎÇò Í∏âÎß§Î¨º Í±∞Îûò Ïãú ÏàòÏàòÎ£å ÌòëÏÉÅÏù¥ Îçî ÏàòÏõîÌï©ÎãàÎã§.</div>
                            </div>
                            <div class="commission-save-item">
                                <div class="commission-save-item-title">5. Í∞ÑÏù¥Í≥ºÏÑ∏Ïûê Ï§ëÍ∞úÏÇ¨ Ïù¥Ïö©</div>
                                <div class="commission-save-item-content">Í∞ÑÏù¥Í≥ºÏÑ∏ÏûêÎäî Î∂ÄÍ∞ÄÏÑ∏(10%)Í∞Ä ÏóÜÏñ¥ Ïã§ÏßàÏ†ÅÏúºÎ°ú Ï†ÄÎ†¥Ìï©ÎãàÎã§. Îã§Îßå, ÏùºÎ∞òÍ≥ºÏÑ∏ÏûêÎ≥¥Îã§ ÎìúÎ¨º Ïàò ÏûàÏùå.</div>
                            </div>
                            <div class="commission-save-item">
                                <div class="commission-save-item-title">6. Ï†ÑÏÜçÏ§ëÍ∞úÍ≥ÑÏïΩ ÌôúÏö©</div>
                                <div class="commission-save-item-content">Ìïú Ï§ëÍ∞úÏÇ¨Ïóê Ï†ÑÏÜçÏúºÎ°ú Îß°Í∏∞Î©¥ ÏàòÏàòÎ£å Ìï†Ïù∏ ÌòúÌÉùÏùÑ Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§.</div>
                            </div>
                        </div>
                        
                        <div class="commission-warning">
                            <strong>‚ö†Ô∏è Ï£ºÏùòÏÇ¨Ìï≠:</strong><br>
                            ‚Ä¢ 2021ÎÖÑ 10Ïõî 19Ïùº Í∞úÏ†ïÎêú ÏöîÏú® Í∏∞Ï§ÄÏûÖÎãàÎã§.<br>
                            ‚Ä¢ ÏßÄÏó≠Ïóê Îî∞Îùº Ï°∞Î°ÄÎ°ú Îã§Î•∏ ÏöîÏú®Ïù¥ Ï†ÅÏö©Îê† Ïàò ÏûàÏäµÎãàÎã§.<br>
                            ‚Ä¢ Ïã§Ï†ú ÏàòÏàòÎ£åÎäî Ï§ëÍ∞úÏÇ¨ÏôÄ ÌòëÏùòÌïòÏó¨ Í≤∞Ï†ïÎê©ÎãàÎã§.<br>
                            ‚Ä¢ Ï§ëÍ∞úÏàòÏàòÎ£å Ïô∏ Î∂ÄÍ∞ÄÏÑ∏, Ïã§ÎπÑ(Îì±Í∏∞ÎπÑÏö© Îì±)Îäî Î≥ÑÎèÑÏûÖÎãàÎã§.
                        </div>
                    </div>
                </div>
            `;
        }

        function updateCommissionOptions() {
            const propertyType = document.getElementById('propertyType').value;
            const transactionType = document.getElementById('transactionType').value;
            const priceLabel = document.getElementById('priceLabel');
            const monthlyRentGroup = document.getElementById('monthlyRentGroup');
            
            // Update price label
            if (transactionType === 'sale') {
                priceLabel.textContent = 'Îß§Îß§Í∞Ä';
            } else if (transactionType === 'jeonse') {
                priceLabel.textContent = 'Ï†ÑÏÑ∏Í∏à';
            } else {
                priceLabel.textContent = 'Î≥¥Ï¶ùÍ∏à';
            }
            
            // Show/hide monthly rent field
            if (transactionType === 'monthly') {
                monthlyRentGroup.classList.add('active');
            } else {
                monthlyRentGroup.classList.remove('active');
            }
        }

        function calculateCommission(e) {
            e.preventDefault();
            
            const propertyType = document.getElementById('propertyType').value;
            const transactionType = document.getElementById('transactionType').value;
            const price = parseNumberFromComma(document.getElementById('propertyPrice').value);
            const monthlyRent = parseNumberFromComma(document.getElementById('monthlyRent').value) || 0;
            
            let transactionAmount = price;
            
            // Calculate transaction amount for monthly rent
            if (transactionType === 'monthly') {
                const method1 = price + (monthlyRent * 100);
                const method2 = price + (monthlyRent * 70);
                transactionAmount = method1 < 50000000 ? Math.max(method1, method2) : method1;
            }
            
            let rate = 0;
            let maxFee = null;
            let rateTableHTML = '';
            let rateTableTitle = '';
            
            // Determine rate based on property type and transaction type
            const isResidential = ['apartment', 'villa', 'house', 'officetel'].includes(propertyType);
            const isCommercial = ['commercial', 'building', 'land', 'officetel-commercial'].includes(propertyType);
            
            if (isResidential) {
                if (transactionType === 'sale') {
                    // Ï£ºÌÉù Îß§Îß§
                    if (transactionAmount < 50000000) {
                        rate = 0.006; maxFee = 250000;
                    } else if (transactionAmount < 200000000) {
                        rate = 0.005; maxFee = 800000;
                    } else if (transactionAmount < 900000000) {
                        rate = 0.004;
                    } else if (transactionAmount < 1200000000) {
                        rate = 0.005;
                    } else if (transactionAmount < 1500000000) {
                        rate = 0.006;
                    } else {
                        rate = 0.007;
                    }
                    rateTableTitle = 'Ï£ºÌÉù Îß§Îß§ Ï§ëÍ∞úÏàòÏàòÎ£å ÏöîÏú®Ìëú';
                    rateTableHTML = getResidentialSaleRateTable(transactionAmount);
                } else {
                    // Ï£ºÌÉù Ï†ÑÏÑ∏/ÏõîÏÑ∏
                    if (transactionAmount < 50000000) {
                        rate = 0.005; maxFee = 200000;
                    } else if (transactionAmount < 100000000) {
                        rate = 0.004; maxFee = 300000;
                    } else if (transactionAmount < 600000000) {
                        rate = 0.003;
                    } else if (transactionAmount < 1200000000) {
                        rate = 0.004;
                    } else if (transactionAmount < 1500000000) {
                        rate = 0.005;
                    } else {
                        rate = 0.006;
                    }
                    rateTableTitle = 'Ï£ºÌÉù ÏûÑÎåÄÏ∞® Ï§ëÍ∞úÏàòÏàòÎ£å ÏöîÏú®Ìëú';
                    rateTableHTML = getResidentialRentRateTable(transactionAmount);
                }
            } else if (propertyType === 'officetel-commercial') {
                // Ïò§ÌîºÏä§ÌÖî ÏóÖÎ¨¥Ïö©
                if (transactionType === 'sale') {
                    rate = 0.005;
                } else {
                    rate = 0.004;
                }
                rateTableTitle = 'Ïò§ÌîºÏä§ÌÖî(ÏóÖÎ¨¥Ïö©) Ï§ëÍ∞úÏàòÏàòÎ£å ÏöîÏú®Ìëú';
                rateTableHTML = getOfficetelCommercialRateTable(transactionType);
            } else {
                // ÏÉÅÍ∞Ä, Í±¥Î¨º, ÌÜ†ÏßÄ (ÎπÑÏ£ºÍ±∞Ïö©)
                rate = 0.009;
                rateTableTitle = 'ÎπÑÏ£ºÍ±∞Ïö© Î∂ÄÎèôÏÇ∞ Ï§ëÍ∞úÏàòÏàòÎ£å ÏöîÏú®Ìëú';
                rateTableHTML = getCommercialRateTable();
            }
            
            // Calculate commission
            let commission = transactionAmount * rate;
            if (maxFee && commission > maxFee) {
                commission = maxFee;
            }
            
            const commissionWithVat = commission * 1.1;
            
            // Display results
            const resultSection = document.getElementById('commissionResultSection');
            resultSection.classList.add('active');
            
            document.getElementById('commissionResultValue').textContent = Math.round(commission).toLocaleString() + 'Ïõê';
            document.getElementById('commissionResultSub').textContent = 
                `ÏÉÅÌïúÏöîÏú® ${(rate * 100).toFixed(1)}% Ï†ÅÏö©` + (maxFee ? ` (ÌïúÎèÑ ${maxFee.toLocaleString()}Ïõê)` : '');
            
            document.getElementById('detailPrice').textContent = transactionAmount.toLocaleString() + 'Ïõê';
            document.getElementById('detailRate').textContent = (rate * 100).toFixed(1) + '%';
            document.getElementById('detailVat').textContent = Math.round(commissionWithVat).toLocaleString() + 'Ïõê';
            
            document.getElementById('rateTableTitle').textContent = rateTableTitle;
            document.getElementById('commissionRateTable').innerHTML = rateTableHTML;
            
            // Scroll to result
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Re-setup comma inputs
            setTimeout(() => setupCommaInputs(), 100);
        }

        function getResidentialSaleRateTable(currentAmount) {
            const ranges = [
                { min: 0, max: 50000000, rate: '0.6%', limit: '25ÎßåÏõê', label: '5Ï≤úÎßåÏõê ÎØ∏Îßå' },
                { min: 50000000, max: 200000000, rate: '0.5%', limit: '80ÎßåÏõê', label: '5Ï≤úÎßåÏõê~2ÏñµÏõê ÎØ∏Îßå' },
                { min: 200000000, max: 900000000, rate: '0.4%', limit: '-', label: '2ÏñµÏõê~9ÏñµÏõê ÎØ∏Îßå' },
                { min: 900000000, max: 1200000000, rate: '0.5%', limit: '-', label: '9ÏñµÏõê~12ÏñµÏõê ÎØ∏Îßå' },
                { min: 1200000000, max: 1500000000, rate: '0.6%', limit: '-', label: '12ÏñµÏõê~15ÏñµÏõê ÎØ∏Îßå' },
                { min: 1500000000, max: Infinity, rate: '0.7%', limit: '-', label: '15ÏñµÏõê Ïù¥ÏÉÅ' }
            ];
            
            return generateRateTable(ranges, currentAmount, ['Í±∞ÎûòÍ∏àÏï°', 'ÏÉÅÌïúÏöîÏú®', 'ÌïúÎèÑÏï°']);
        }

        function getResidentialRentRateTable(currentAmount) {
            const ranges = [
                { min: 0, max: 50000000, rate: '0.5%', limit: '20ÎßåÏõê', label: '5Ï≤úÎßåÏõê ÎØ∏Îßå' },
                { min: 50000000, max: 100000000, rate: '0.4%', limit: '30ÎßåÏõê', label: '5Ï≤úÎßåÏõê~1ÏñµÏõê ÎØ∏Îßå' },
                { min: 100000000, max: 600000000, rate: '0.3%', limit: '-', label: '1ÏñµÏõê~6ÏñµÏõê ÎØ∏Îßå' },
                { min: 600000000, max: 1200000000, rate: '0.4%', limit: '-', label: '6ÏñµÏõê~12ÏñµÏõê ÎØ∏Îßå' },
                { min: 1200000000, max: 1500000000, rate: '0.5%', limit: '-', label: '12ÏñµÏõê~15ÏñµÏõê ÎØ∏Îßå' },
                { min: 1500000000, max: Infinity, rate: '0.6%', limit: '-', label: '15ÏñµÏõê Ïù¥ÏÉÅ' }
            ];
            
            return generateRateTable(ranges, currentAmount, ['Í±∞ÎûòÍ∏àÏï°', 'ÏÉÅÌïúÏöîÏú®', 'ÌïúÎèÑÏï°']);
        }

        function getOfficetelCommercialRateTable(transactionType) {
            return `
                <thead>
                    <tr>
                        <th>Í±∞ÎûòÏú†Ìòï</th>
                        <th>ÏÉÅÌïúÏöîÏú®</th>
                        <th>ÎπÑÍ≥†</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="${transactionType === 'sale' ? 'active-row' : ''}">
                        <td>Îß§Îß§/ÍµêÌôò</td>
                        <td>0.5%</td>
                        <td>ÌïúÎèÑ ÏóÜÏùå</td>
                    </tr>
                    <tr class="${transactionType !== 'sale' ? 'active-row' : ''}">
                        <td>ÏûÑÎåÄÏ∞®</td>
                        <td>0.4%</td>
                        <td>ÌïúÎèÑ ÏóÜÏùå</td>
                    </tr>
                </tbody>
            `;
        }

        function getCommercialRateTable() {
            return `
                <thead>
                    <tr>
                        <th>Î∂ÄÎèôÏÇ∞ Ï¢ÖÎ•ò</th>
                        <th>ÏÉÅÌïúÏöîÏú®</th>
                        <th>ÎπÑÍ≥†</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ÏÉÅÍ∞Ä/Ï†êÌè¨</td>
                        <td>0.9% Ïù¥ÎÇ¥</td>
                        <td>ÌòëÏùò</td>
                    </tr>
                    <tr>
                        <td>Í±¥Î¨º/ÎπåÎî©</td>
                        <td>0.9% Ïù¥ÎÇ¥</td>
                        <td>ÌòëÏùò</td>
                    </tr>
                    <tr>
                        <td>ÌÜ†ÏßÄ/ÎïÖ</td>
                        <td>0.9% Ïù¥ÎÇ¥</td>
                        <td>ÌòëÏùò</td>
                    </tr>
                    <tr>
                        <td>Í≥µÏû•/Ï∞ΩÍ≥†</td>
                        <td>0.9% Ïù¥ÎÇ¥</td>
                        <td>ÌòëÏùò</td>
                    </tr>
                </tbody>
            `;
        }

        function generateRateTable(ranges, currentAmount, headers) {
            let html = `
                <thead>
                    <tr>
                        ${headers.map(h => `<th>${h}</th>`).join('')}
                    </tr>
                </thead>
                <tbody>
            `;
            
            ranges.forEach(range => {
                const isActive = currentAmount >= range.min && currentAmount < range.max;
                html += `
                    <tr class="${isActive ? 'active-row' : ''}">
                        <td>${range.label}</td>
                        <td>${range.rate}</td>
                        <td>${range.limit}</td>
                    </tr>
                `;
            });
            
            html += '</tbody>';
            return html;
        }

        function getAgeCalculator() {
            return `
                <div class="age-calculator-container">
                    <form class="calc-form age-form" onsubmit="calculateAge(event)">
                        <div class="form-group">
                            <label><i class="fas fa-birthday-cake"></i> ÏÉùÎÖÑÏõîÏùº</label>
                            <input type="date" id="birthDate" required>
                        </div>
                        <button type="submit" class="btn-calculate">
                            <i class="fas fa-calculator"></i> ÎÇòÏù¥ Í≥ÑÏÇ∞ÌïòÍ∏∞
                        </button>
                    </form>
                    
                    <div class="age-result-section" id="ageResult"></div>
                    
                    <!-- ÎÇòÏù¥ Î∂ÑÎ•ò ÌåÅ ÏÑπÏÖò -->
                    <div class="age-tips-section">
                        <h3><i class="fas fa-lightbulb"></i> ÎÇòÏù¥ Î∂ÑÎ•ò Í∏∞Ï§Ä ÏïàÎÇ¥</h3>
                        
                        <div class="age-tips-grid">
                            <!-- ÏÉùÏï†Ï£ºÍ∏∞ Î∂ÑÎ•ò -->
                            <div class="age-tip-card life-cycle">
                                <h4><i class="fas fa-users"></i> ÏÉùÏï†Ï£ºÍ∏∞Î≥Ñ Î∂ÑÎ•ò</h4>
                                <div class="tip-content">
                                    <table class="age-table">
                                        <thead>
                                            <tr><th>Î∂ÑÎ•ò</th><th>ÎÇòÏù¥ (Îßå ÎÇòÏù¥)</th><th>ÌäπÏßï</th></tr>
                                        </thead>
                                        <tbody>
                                            <tr><td>üë∂ ÏòÅÏïÑ</td><td>0~1ÏÑ∏</td><td>Ï∂úÏÉù ÌõÑ ÎèåÍπåÏßÄ</td></tr>
                                            <tr><td>üßí Ïú†ÏïÑ</td><td>2~5ÏÑ∏</td><td>Ïñ¥Î¶∞Ïù¥Ïßë/Ïú†ÏπòÏõê ÏãúÍ∏∞</td></tr>
                                            <tr><td>üë¶ ÏïÑÎèô</td><td>6~12ÏÑ∏</td><td>Ï¥àÎì±ÌïôÍµê ÏãúÍ∏∞</td></tr>
                                            <tr><td>üßë Ï≤≠ÏÜåÎÖÑ</td><td>13~18ÏÑ∏</td><td>Ï§ë¬∑Í≥†Îì±ÌïôÍµê ÏãúÍ∏∞</td></tr>
                                            <tr><td>üë® Ï≤≠ÎÖÑ</td><td>19~29ÏÑ∏</td><td>ÎåÄÌïôÏÉù/ÏÇ¨Ìöå Ï¥àÎÖÑÏÉù</td></tr>
                                            <tr><td>üßî Ï§ëÎÖÑ</td><td>30~49ÏÑ∏</td><td>ÏÇ¨ÌöåÌôúÎèô Ï†ÑÏÑ±Í∏∞</td></tr>
                                            <tr><td>üë¥ Ïû•ÎÖÑ</td><td>50~64ÏÑ∏</td><td>Ïù∏ÏÉùÏùò ÏõêÏàôÍ∏∞</td></tr>
                                            <tr><td>üßì ÎÖ∏ÎÖÑ</td><td>65ÏÑ∏ Ïù¥ÏÉÅ</td><td>ÎÖ∏Ïù∏Î≥µÏßÄÎ≤ïÏÉÅ ÎÖ∏Ïù∏</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Ïó∞Î†πÎåÄ Î™ÖÏπ≠ -->
                            <div class="age-tip-card decade-names">
                                <h4><i class="fas fa-scroll"></i> Ïó∞Î†πÎåÄÎ≥Ñ Ï†ÑÌÜµ Î™ÖÏπ≠</h4>
                                <div class="tip-content">
                                    <table class="age-table">
                                        <thead>
                                            <tr><th>ÎÇòÏù¥</th><th>Î™ÖÏπ≠</th><th>ÏùòÎØ∏/Ïú†Îûò</th></tr>
                                        </thead>
                                        <tbody>
                                            <tr><td>15ÏÑ∏</td><td>ÏßÄÌïô(ÂøóÂ≠∏)</td><td>ÌïôÎ¨∏Ïóê ÎúªÏùÑ Îë†</td></tr>
                                            <tr><td>20ÏÑ∏</td><td>ÏïΩÍ¥Ä(Âº±ÂÜ†)</td><td>Í∞ìÏùÑ Ïì∞Îäî ÎÇòÏù¥</td></tr>
                                            <tr><td>30ÏÑ∏</td><td>Ïù¥Î¶Ω(ËÄåÁ´ã)</td><td>ÎúªÏùÑ ÏÑ∏Ïö∞Îäî ÎÇòÏù¥</td></tr>
                                            <tr><td>40ÏÑ∏</td><td>Î∂àÌòπ(‰∏çÊÉë)</td><td>ÎØ∏ÌòπÎêòÏßÄ ÏïäÎäî ÎÇòÏù¥</td></tr>
                                            <tr><td>50ÏÑ∏</td><td>ÏßÄÏ≤úÎ™Ö(Áü•Â§©ÂëΩ)</td><td>ÌïòÎäòÏùò ÎúªÏùÑ ÏïÑÎäî ÎÇòÏù¥</td></tr>
                                            <tr><td>60ÏÑ∏</td><td>Ïù¥Ïàú(ËÄ≥È†Ü)</td><td>Í∑ÄÍ∞Ä ÏàúÌï¥ÏßÄÎäî ÎÇòÏù¥</td></tr>
                                            <tr><td>61ÏÑ∏</td><td>ÌôòÍ∞ë(ÈÇÑÁî≤)</td><td>Ïú°Ïã≠Í∞ëÏûêÍ∞Ä ÎèåÏïÑÏò¥</td></tr>
                                            <tr><td>70ÏÑ∏</td><td>Í≥†Ìù¨(Âè§Á®Ä)</td><td>ÏòàÎ∂ÄÌÑ∞ ÎìúÎ¨∏ ÎÇòÏù¥</td></tr>
                                            <tr><td>77ÏÑ∏</td><td>Ìù¨Ïàò(ÂñúÂ£Ω)</td><td>ÂñúÎ•º Ï¥àÏÑúÎ°ú Ïì∞Î©¥ ‰∏ÉÂçÅ‰∏É</td></tr>
                                            <tr><td>80ÏÑ∏</td><td>ÏÇ∞Ïàò(ÂÇòÂ£Ω)</td><td>ÂÇòÏùò ÏïΩÏûêÍ∞Ä ÂÖ´ÂçÅ</td></tr>
                                            <tr><td>88ÏÑ∏</td><td>ÎØ∏Ïàò(Á±≥Â£Ω)</td><td>Á±≥Î•º ÌíÄÎ©¥ ÂÖ´ÂçÅÂÖ´</td></tr>
                                            <tr><td>90ÏÑ∏</td><td>Ï°∏Ïàò(ÂçíÂ£Ω)</td><td>ÂçíÏùò ÏïΩÏûêÍ∞Ä ‰πùÂçÅ</td></tr>
                                            <tr><td>99ÏÑ∏</td><td>Î∞±Ïàò(ÁôΩÂ£Ω)</td><td>ÁôæÏóêÏÑú ‰∏ÄÏùÑ ÎπºÎ©¥ ÁôΩ</td></tr>
                                            <tr><td>100ÏÑ∏</td><td>ÏÉÅÏàò(‰∏äÂ£Ω)</td><td>Í∞ÄÏû• ÎÜíÏùÄ ÎÇòÏù¥</td></tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <!-- Îπ†Î•∏ÎÖÑÏÉù ÏÑ§Î™Ö -->
                            <div class="age-tip-card fast-year">
                                <h4><i class="fas fa-bolt"></i> Îπ†Î•∏ÎÖÑÏÉùÏù¥ÎûÄ?</h4>
                                <div class="tip-content">
                                    <div class="fast-year-info">
                                        <p><strong>üìå Ï†ïÏùò:</strong> 1~2ÏõîÏÉùÏúºÎ°ú Í∞ôÏùÄ Ìï¥ 3Ïõî Ïù¥ÌõÑ Ï∂úÏÉùÏûêÎ≥¥Îã§ Ìïú ÌïôÎÖÑ ÏúÑÎ°ú ÏûÖÌïôÌïòÎäî Í≤ΩÏö∞</p>
                                        <p><strong>üìå Í∏∞Ï§Ä:</strong> 3Ïõî 1Ïùº ~ Îã§ÏùåÌï¥ 2Ïõî ÎßêÍπåÏßÄÍ∞Ä Í∞ôÏùÄ ÌïôÎÖÑ</p>
                                        <p><strong>üìå ÏòàÏãú:</strong> 2000ÎÖÑ 1ÏõîÏÉù = 1999ÎÖÑ 3Ïõî~12ÏõîÏÉùÍ≥º Í∞ôÏùÄ ÌïôÎÖÑ</p>
                                        <div class="fast-year-note">
                                            <i class="fas fa-info-circle"></i>
                                            <span>ÌòÑÏû¨ Ï¥àÎì±ÌïôÍµê ÏûÖÌïô Í∏∞Ï§ÄÏùºÏùÄ <strong>1Ïõî 1Ïùº</strong>Î°ú Î≥ÄÍ≤ΩÎê® (2009ÎÖÑ Ïù¥ÌõÑ Ï∂úÏÉùÏûêÎ∂ÄÌÑ∞ Ï†ÅÏö©)</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ÌïôÍµê ÏûÖÌïô ÎÇòÏù¥ -->
                            <div class="age-tip-card school-age">
                                <h4><i class="fas fa-graduation-cap"></i> ÌïôÍµê ÏûÖÌïô Í∏∞Ï§Ä ÎÇòÏù¥</h4>
                                <div class="tip-content">
                                    <table class="age-table school-table">
                                        <thead>
                                            <tr><th>ÌïôÍµê</th><th>ÏûÖÌïô ÎÇòÏù¥</th><th>Ï°∏ÏóÖ ÎÇòÏù¥</th><th>ÎπÑÍ≥†</th></tr>
                                        </thead>
                                        <tbody>
                                            <tr><td>üéí Ï¥àÎì±ÌïôÍµê</td><td>Îßå 6ÏÑ∏</td><td>Îßå 12ÏÑ∏</td><td>6ÎÖÑ Í≥ºÏ†ï</td></tr>
                                            <tr><td>üìö Ï§ëÌïôÍµê</td><td>Îßå 13ÏÑ∏</td><td>Îßå 15ÏÑ∏</td><td>3ÎÖÑ Í≥ºÏ†ï</td></tr>
                                            <tr><td>üè´ Í≥†Îì±ÌïôÍµê</td><td>Îßå 16ÏÑ∏</td><td>Îßå 18ÏÑ∏</td><td>3ÎÖÑ Í≥ºÏ†ï</td></tr>
                                            <tr><td>üéì ÎåÄÌïôÍµê</td><td>Îßå 19ÏÑ∏</td><td>Îßå 22~23ÏÑ∏</td><td>4ÎÖÑ Í≥ºÏ†ï (ÏùòÎåÄ 6ÎÖÑ)</td></tr>
                                        </tbody>
                                    </table>
                                    <div class="school-note">
                                        <i class="fas fa-calendar-alt"></i>
                                        <span>ÏûÖÌïô Í∏∞Ï§ÄÏùº: Ìï¥Îãπ Ïó∞ÎèÑ <strong>3Ïõî 1Ïùº</strong> Í∏∞Ï§Ä (2009ÎÖÑ Ïù¥Ï†Ñ Ï∂úÏÉùÏûê)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <style>
                    .age-calculator-container {
                        max-width: 100%;
                    }
                    
                    .age-form {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        padding: 30px;
                        border-radius: 20px;
                        margin-bottom: 30px;
                    }
                    
                    .age-form .form-group label {
                        color: white;
                        font-size: 16px;
                        font-weight: 600;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    
                    .age-form input[type="date"] {
                        padding: 15px;
                        font-size: 18px;
                        border-radius: 12px;
                        border: none;
                        background: rgba(255,255,255,0.95);
                    }
                    
                    .age-form .btn-calculate {
                        background: white;
                        color: #667eea;
                        font-weight: 700;
                        padding: 15px 30px;
                        font-size: 18px;
                    }
                    
                    .age-form .btn-calculate:hover {
                        background: #f0f0f0;
                        transform: translateY(-2px);
                    }
                    
                    /* Í≤∞Í≥º ÏÑπÏÖò */
                    .age-result-section {
                        margin-bottom: 40px;
                    }
                    
                    .age-result-card {
                        background: white;
                        border-radius: 20px;
                        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
                        overflow: hidden;
                        animation: fadeInUp 0.5s ease;
                    }
                    
                    .age-result-header {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 25px 30px;
                        text-align: center;
                    }
                    
                    .age-result-header h3 {
                        font-size: 24px;
                        margin-bottom: 5px;
                    }
                    
                    .age-result-header p {
                        opacity: 0.9;
                        font-size: 14px;
                    }
                    
                    .age-main-result {
                        display: grid;
                        grid-template-columns: repeat(3, 1fr);
                        gap: 20px;
                        padding: 30px;
                        background: #f8fafc;
                    }
                    
                    .age-main-item {
                        text-align: center;
                        padding: 20px;
                        background: white;
                        border-radius: 16px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
                    }
                    
                    .age-main-item .age-number {
                        font-size: 42px;
                        font-weight: 700;
                        color: #667eea;
                        line-height: 1;
                    }
                    
                    .age-main-item .age-unit {
                        font-size: 20px;
                        color: #667eea;
                    }
                    
                    .age-main-item .age-label {
                        font-size: 14px;
                        color: #718096;
                        margin-top: 8px;
                        font-weight: 500;
                    }
                    
                    .age-detail-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        padding: 25px 30px;
                    }
                    
                    .age-detail-item {
                        display: flex;
                        align-items: center;
                        gap: 15px;
                        padding: 18px 20px;
                        background: linear-gradient(135deg, #f8fafc 0%, #edf2f7 100%);
                        border-radius: 14px;
                        transition: all 0.3s ease;
                    }
                    
                    .age-detail-item:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 6px 20px rgba(0,0,0,0.08);
                    }
                    
                    .age-detail-icon {
                        width: 50px;
                        height: 50px;
                        border-radius: 12px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 22px;
                        flex-shrink: 0;
                    }
                    
                    .age-detail-info {
                        flex: 1;
                    }
                    
                    .age-detail-info .detail-label {
                        font-size: 13px;
                        color: #718096;
                        margin-bottom: 2px;
                    }
                    
                    .age-detail-info .detail-value {
                        font-size: 18px;
                        font-weight: 700;
                        color: #2d3748;
                    }
                    
                    .age-detail-info .detail-sub {
                        font-size: 12px;
                        color: #a0aec0;
                        margin-top: 2px;
                    }
                    
                    /* ÏÉùÏï†Ï£ºÍ∏∞ Î±ÉÏßÄ */
                    .life-stage-section {
                        padding: 25px 30px;
                        background: white;
                        border-top: 1px solid #e2e8f0;
                    }
                    
                    .life-stage-badge {
                        display: inline-flex;
                        align-items: center;
                        gap: 12px;
                        padding: 15px 25px;
                        border-radius: 50px;
                        font-size: 18px;
                        font-weight: 600;
                        margin-right: 15px;
                        margin-bottom: 10px;
                    }
                    
                    .life-stage-badge i {
                        font-size: 24px;
                    }
                    
                    /* Ï†ÑÌÜµ Î™ÖÏπ≠ ÏÑπÏÖò */
                    .traditional-name-section {
                        padding: 25px 30px;
                        background: linear-gradient(135deg, #fef9e7 0%, #fdf2e9 100%);
                        border-top: 1px solid #e2e8f0;
                    }
                    
                    .traditional-name-badge {
                        display: inline-flex;
                        align-items: center;
                        gap: 10px;
                        padding: 12px 20px;
                        background: linear-gradient(135deg, #d35400 0%, #c0392b 100%);
                        color: white;
                        border-radius: 12px;
                        font-size: 16px;
                        font-weight: 600;
                    }
                    
                    .traditional-name-desc {
                        margin-top: 12px;
                        font-size: 14px;
                        color: #7f8c8d;
                        line-height: 1.6;
                    }
                    
                    /* ÌïôÍµê Ï†ïÎ≥¥ ÏÑπÏÖò */
                    .school-info-section {
                        padding: 25px 30px;
                        background: #f0f9ff;
                        border-top: 1px solid #e2e8f0;
                    }
                    
                    .school-info-badge {
                        display: inline-flex;
                        align-items: center;
                        gap: 10px;
                        padding: 12px 20px;
                        background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
                        color: white;
                        border-radius: 12px;
                        font-size: 16px;
                        font-weight: 600;
                    }
                    
                    /* ÌåÅ ÏÑπÏÖò */
                    .age-tips-section {
                        margin-top: 40px;
                    }
                    
                    .age-tips-section > h3 {
                        font-size: 22px;
                        color: #2d3748;
                        margin-bottom: 25px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    
                    .age-tips-section > h3 i {
                        color: #f6ad55;
                    }
                    
                    .age-tips-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 25px;
                    }
                    
                    .age-tip-card {
                        background: white;
                        border-radius: 16px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                        overflow: hidden;
                    }
                    
                    .age-tip-card h4 {
                        padding: 18px 22px;
                        font-size: 16px;
                        font-weight: 600;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        margin: 0;
                    }
                    
                    .age-tip-card.life-cycle h4 {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                    }
                    
                    .age-tip-card.decade-names h4 {
                        background: linear-gradient(135deg, #d35400 0%, #c0392b 100%);
                        color: white;
                    }
                    
                    .age-tip-card.fast-year h4 {
                        background: linear-gradient(135deg, #f6ad55 0%, #ed8936 100%);
                        color: white;
                    }
                    
                    .age-tip-card.school-age h4 {
                        background: linear-gradient(135deg, #38b2ac 0%, #319795 100%);
                        color: white;
                    }
                    
                    .tip-content {
                        padding: 20px 22px;
                        max-height: 350px;
                        overflow-y: auto;
                    }
                    
                    .age-table {
                        width: 100%;
                        border-collapse: collapse;
                        font-size: 13px;
                    }
                    
                    .age-table th, .age-table td {
                        padding: 10px 12px;
                        text-align: left;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    
                    .age-table th {
                        background: #f8fafc;
                        font-weight: 600;
                        color: #4a5568;
                    }
                    
                    .age-table tr:last-child td {
                        border-bottom: none;
                    }
                    
                    .age-table tr:hover td {
                        background: #f7fafc;
                    }
                    
                    /* Îπ†Î•∏ÎÖÑÏÉù Ï†ïÎ≥¥ */
                    .fast-year-info {
                        font-size: 14px;
                        line-height: 1.8;
                        color: #4a5568;
                    }
                    
                    .fast-year-info p {
                        margin-bottom: 12px;
                    }
                    
                    .fast-year-note, .school-note {
                        margin-top: 15px;
                        padding: 12px 15px;
                        background: #fff8e1;
                        border-radius: 10px;
                        font-size: 13px;
                        display: flex;
                        align-items: flex-start;
                        gap: 10px;
                        color: #7f6000;
                    }
                    
                    .school-note {
                        background: #e3f2fd;
                        color: #1565c0;
                    }
                    
                    /* D-Day ÏÑπÏÖò */
                    .birthday-dday-section {
                        padding: 20px 30px;
                        background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
                        border-top: 1px solid #e2e8f0;
                        text-align: center;
                    }
                    
                    .dday-info {
                        display: inline-flex;
                        align-items: center;
                        gap: 15px;
                        font-size: 18px;
                        font-weight: 600;
                        color: #c0392b;
                    }
                    
                    .dday-info i {
                        font-size: 28px;
                    }
                    
                    .dday-number {
                        font-size: 32px;
                        font-weight: 800;
                    }
                    
                    @media (max-width: 768px) {
                        .age-main-result {
                            grid-template-columns: 1fr;
                            gap: 15px;
                        }
                        
                        .age-detail-grid {
                            grid-template-columns: 1fr;
                        }
                        
                        .age-tips-grid {
                            grid-template-columns: 1fr;
                        }
                        
                        .age-main-item .age-number {
                            font-size: 36px;
                        }
                    }
                    
                    @keyframes fadeInUp {
                        from {
                            opacity: 0;
                            transform: translateY(20px);
                        }
                        to {
                            opacity: 1;
                            transform: translateY(0);
                        }
                    }
                </style>
            `;
        }

        function calculateAge(e) {
            e.preventDefault();
            const birthDateInput = document.getElementById('birthDate').value;
            const birthDate = new Date(birthDateInput);
            const today = new Date();
            
            const birthYear = birthDate.getFullYear();
            const birthMonth = birthDate.getMonth() + 1;
            const birthDay = birthDate.getDate();
            
            // Îßå ÎÇòÏù¥ Í≥ÑÏÇ∞
            let internationalAge = today.getFullYear() - birthYear;
            const monthDiff = today.getMonth() - birthDate.getMonth();
            if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDay)) {
                internationalAge--;
            }
            
            // ÌïúÍµ≠ ÎÇòÏù¥ (ÏÑ∏Îäî ÎÇòÏù¥)
            const koreanAge = today.getFullYear() - birthYear + 1;
            
            // Îπ†Î•∏ÎÖÑÏÉù Ïó¨Î∂Ä ÌôïÏù∏
            const isFastBorn = birthMonth <= 2;
            const fastBornYear = isFastBorn ? birthYear - 1 : birthYear;
            
            // ÏÉùÏùºÍπåÏßÄ D-Day Í≥ÑÏÇ∞
            const nextBirthday = new Date(today.getFullYear(), birthDate.getMonth(), birthDay);
            if (nextBirthday < today) {
                nextBirthday.setFullYear(today.getFullYear() + 1);
            }
            const dDay = Math.ceil((nextBirthday - today) / (1000 * 60 * 60 * 24));
            const isBirthdayToday = dDay === 0 || (today.getMonth() === birthDate.getMonth() && today.getDate() === birthDay);
            
            // ÌÉúÏñ¥ÎÇú ÏßÄ Î©∞Ïπ†
            const daysSinceBirth = Math.floor((today - birthDate) / (1000 * 60 * 60 * 24));
            
            // Ïó∞Î†πÎåÄ (10ÎåÄ, 20ÎåÄ Îì±)
            const decade = Math.floor(internationalAge / 10) * 10;
            const decadeText = decade >= 10 ? `${decade}ÎåÄ` : '10ÏÑ∏ ÎØ∏Îßå';
            
            // ÏÉùÏï†Ï£ºÍ∏∞ Î∂ÑÎ•ò
            const lifeStage = getLifeStage(internationalAge);
            
            // Ï†ÑÌÜµ Î™ÖÏπ≠
            const traditionalName = getTraditionalName(internationalAge);
            
            // ÌïôÍµê Ï†ïÎ≥¥
            const schoolInfo = getSchoolInfo(internationalAge);
            
            // Îù† Í≥ÑÏÇ∞
            const zodiac = getZodiac(birthYear);
            
            // Î≥ÑÏûêÎ¶¨ Í≥ÑÏÇ∞
            const constellation = getConstellation(birthMonth, birthDay);
            
            // Í≤∞Í≥º ÌëúÏãú
            const resultBox = document.getElementById('ageResult');
            resultBox.innerHTML = `
                <div class="age-result-card">
                    <div class="age-result-header">
                        <h3><i class="fas fa-birthday-cake"></i> ÎÇòÏù¥ Í≥ÑÏÇ∞ Í≤∞Í≥º</h3>
                        <p>${birthYear}ÎÖÑ ${birthMonth}Ïõî ${birthDay}Ïùº Ï∂úÏÉù</p>
                    </div>
                    
                    <div class="age-main-result">
                        <div class="age-main-item">
                            <div class="age-number">${internationalAge}<span class="age-unit">ÏÑ∏</span></div>
                            <div class="age-label">Îßå ÎÇòÏù¥ (Íµ≠Ï†ú ÌëúÏ§Ä)</div>
                        </div>
                        <div class="age-main-item">
                            <div class="age-number">${koreanAge}<span class="age-unit">ÏÑ∏</span></div>
                            <div class="age-label">ÌïúÍµ≠ ÎÇòÏù¥ (ÏÑ∏Îäî ÎÇòÏù¥)</div>
                        </div>
                        <div class="age-main-item">
                            <div class="age-number">${decadeText}</div>
                            <div class="age-label">Ïó∞Î†πÎåÄ</div>
                        </div>
                    </div>
                    
                    <div class="age-detail-grid">
                        <div class="age-detail-item">
                            <div class="age-detail-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                                <i class="fas fa-calendar-day"></i>
                            </div>
                            <div class="age-detail-info">
                                <div class="detail-label">ÌÉúÏñ¥ÎÇú ÏßÄ</div>
                                <div class="detail-value">${daysSinceBirth.toLocaleString()}Ïùº</div>
                                <div class="detail-sub">ÏïΩ ${Math.floor(daysSinceBirth / 365)}ÎÖÑ ${daysSinceBirth % 365}Ïùº</div>
                            </div>
                        </div>
                        
                        <div class="age-detail-item">
                            <div class="age-detail-icon" style="background: linear-gradient(135deg, #f6ad55 0%, #ed8936 100%); color: white;">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="age-detail-info">
                                <div class="detail-label">Îπ†Î•∏ÎÖÑÏÉù</div>
                                <div class="detail-value">${isFastBorn ? `Ïòà (${fastBornYear}ÎÖÑÏÉùÍ≥º ÎèôÍ∏â)` : 'ÏïÑÎãàÏò§'}</div>
                                <div class="detail-sub">${isFastBorn ? '1~2Ïõî Ï∂úÏÉùÏûê' : '3Ïõî Ïù¥ÌõÑ Ï∂úÏÉù'}</div>
                            </div>
                        </div>
                        
                        <div class="age-detail-item">
                            <div class="age-detail-icon" style="background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%); color: white;">
                                <i class="fas fa-paw"></i>
                            </div>
                            <div class="age-detail-info">
                                <div class="detail-label">Îù†</div>
                                <div class="detail-value">${zodiac.emoji} ${zodiac.name}Îù†</div>
                                <div class="detail-sub">${zodiac.hanja}</div>
                            </div>
                        </div>
                        
                        <div class="age-detail-item">
                            <div class="age-detail-icon" style="background: linear-gradient(135deg, #9f7aea 0%, #805ad5 100%); color: white;">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="age-detail-info">
                                <div class="detail-label">Î≥ÑÏûêÎ¶¨</div>
                                <div class="detail-value">${constellation.emoji} ${constellation.name}</div>
                                <div class="detail-sub">${constellation.period}</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÏÉùÏï†Ï£ºÍ∏∞ -->
                    <div class="life-stage-section">
                        <div class="life-stage-badge" style="background: ${lifeStage.color}; color: white;">
                            <i class="${lifeStage.icon}"></i>
                            ${lifeStage.name}
                        </div>
                        <span style="color: #718096; font-size: 14px;">${lifeStage.description}</span>
                    </div>
                    
                    ${traditionalName ? `
                    <!-- Ï†ÑÌÜµ Î™ÖÏπ≠ -->
                    <div class="traditional-name-section">
                        <div class="traditional-name-badge">
                            <i class="fas fa-scroll"></i>
                            ${traditionalName.name} (${traditionalName.hanja})
                        </div>
                        <div class="traditional-name-desc">
                            <strong>ÏùòÎØ∏:</strong> ${traditionalName.meaning}
                        </div>
                    </div>
                    ` : ''}
                    
                    <!-- ÌïôÍµê Ï†ïÎ≥¥ -->
                    ${schoolInfo ? `
                    <div class="school-info-section">
                        <div class="school-info-badge">
                            <i class="${schoolInfo.icon}"></i>
                            ${schoolInfo.status}
                        </div>
                    </div>
                    ` : ''}
                    
                    <!-- ÏÉùÏùº D-Day -->
                    <div class="birthday-dday-section">
                        ${isBirthdayToday ? `
                            <div class="dday-info">
                                <i class="fas fa-gift"></i>
                                üéâ Ïò§ÎäòÏù¥ ÏÉùÏùºÏûÖÎãàÎã§! ÏÉùÏùº Ï∂ïÌïòÌï©ÎãàÎã§! üéÇ
                            </div>
                        ` : `
                            <div class="dday-info">
                                <i class="fas fa-hourglass-half"></i>
                                Îã§Ïùå ÏÉùÏùºÍπåÏßÄ <span class="dday-number">D-${dDay}</span>
                            </div>
                        `}
                    </div>
                </div>
            `;
        }
        
        // ÏÉùÏï†Ï£ºÍ∏∞ Î∂ÑÎ•ò
        function getLifeStage(age) {
            if (age <= 1) return { name: 'ÏòÅÏïÑ', icon: 'fas fa-baby', color: '#f093fb', description: 'Ï∂úÏÉù ÌõÑ ÎèåÍπåÏßÄÏùò ÏãúÍ∏∞' };
            if (age <= 5) return { name: 'Ïú†ÏïÑ', icon: 'fas fa-baby-carriage', color: '#f5576c', description: 'Ïñ¥Î¶∞Ïù¥Ïßë/Ïú†ÏπòÏõê ÏãúÍ∏∞' };
            if (age <= 12) return { name: 'ÏïÑÎèô', icon: 'fas fa-child', color: '#4facfe', description: 'Ï¥àÎì±ÌïôÍµê ÏãúÍ∏∞' };
            if (age <= 18) return { name: 'Ï≤≠ÏÜåÎÖÑ', icon: 'fas fa-user-graduate', color: '#00f2fe', description: 'Ï§ë¬∑Í≥†Îì±ÌïôÍµê ÏãúÍ∏∞' };
            if (age <= 29) return { name: 'Ï≤≠ÎÖÑ', icon: 'fas fa-user', color: '#667eea', description: 'ÎåÄÌïôÏÉù/ÏÇ¨Ìöå Ï¥àÎÖÑÏÉù ÏãúÍ∏∞' };
            if (age <= 49) return { name: 'Ï§ëÎÖÑ', icon: 'fas fa-user-tie', color: '#764ba2', description: 'ÏÇ¨ÌöåÌôúÎèô Ï†ÑÏÑ±Í∏∞' };
            if (age <= 64) return { name: 'Ïû•ÎÖÑ', icon: 'fas fa-user-check', color: '#f093fb', description: 'Ïù∏ÏÉùÏùò ÏõêÏàôÍ∏∞' };
            return { name: 'ÎÖ∏ÎÖÑ', icon: 'fas fa-user-clock', color: '#718096', description: 'ÎÖ∏Ïù∏Î≥µÏßÄÎ≤ïÏÉÅ ÎÖ∏Ïù∏ (65ÏÑ∏ Ïù¥ÏÉÅ)' };
        }
        
        // Ï†ÑÌÜµ Î™ÖÏπ≠
        function getTraditionalName(age) {
            const names = {
                15: { name: 'ÏßÄÌïô', hanja: 'ÂøóÂ≠∏', meaning: 'ÌïôÎ¨∏Ïóê ÎúªÏùÑ ÎëêÎäî ÎÇòÏù¥. Í≥µÏûêÍ∞Ä 15ÏÑ∏Ïóê ÌïôÎ¨∏Ïóê ÎúªÏùÑ ÎëêÏóàÎã§Í≥† Ìï®.' },
                20: { name: 'ÏïΩÍ¥Ä', hanja: 'Âº±ÂÜ†', meaning: 'ÏÑ±Ïù∏Ïù¥ ÎêòÏñ¥ Í∞ìÏùÑ Ïì∞Îäî ÎÇòÏù¥. ÏïÑÏßÅ Ï†äÏñ¥ Í¥ÄÎ°ÄÎ•º ÏïΩÌïòÍ≤å ÏπòÎ¶Ñ.' },
                30: { name: 'Ïù¥Î¶Ω', hanja: 'ËÄåÁ´ã', meaning: 'ÏûêÎ¶ΩÌïòÏó¨ ÎúªÏùÑ ÌôïÍ≥†Ìûà ÏÑ∏Ïö∞Îäî ÎÇòÏù¥. Ïù∏ÏÉùÏùò Í∏∞ÌãÄÏùÑ Îã§Ïßê.' },
                40: { name: 'Î∂àÌòπ', hanja: '‰∏çÊÉë', meaning: 'ÏÑ∏ÏÉÅÏùºÏóê ÎØ∏ÌòπÎêòÏßÄ ÏïäÎäî ÎÇòÏù¥. ÌåêÎã®Î†•Ïù¥ ÏÑ±ÏàôÌï¥Ïßê.' },
                50: { name: 'ÏßÄÏ≤úÎ™Ö', hanja: 'Áü•Â§©ÂëΩ', meaning: 'ÌïòÎäòÏùò ÎúªÏùÑ ÏïÑÎäî ÎÇòÏù¥. Ïù∏ÏÉùÏùò ÏÇ¨Î™ÖÏùÑ Íπ®Îã¨Ïùå.' },
                60: { name: 'Ïù¥Ïàú', hanja: 'ËÄ≥È†Ü', meaning: 'Í∑ÄÍ∞Ä ÏàúÌï¥ÏßÄÎäî ÎÇòÏù¥. Ïñ¥Îñ§ ÎßêÎèÑ ÏàúÏàúÌûà Î∞õÏïÑÎì§ÏûÑ.' },
                61: { name: 'ÌôòÍ∞ë', hanja: 'ÈÇÑÁî≤', meaning: '60Í∞ëÏûêÍ∞Ä Ìïú Î∞îÌÄ¥ ÎèåÏïÑÏò¥. ÌöåÍ∞ë(ÂõûÁî≤), ÌôîÍ∞ë(ËèØÁî≤)Ïù¥ÎùºÍ≥†ÎèÑ Ìï®.' },
                70: { name: 'Í≥†Ìù¨', hanja: 'Âè§Á®Ä', meaning: 'ÏòàÎ°úÎ∂ÄÌÑ∞ ÎìúÎ¨∏ ÎÇòÏù¥. ÎëêÎ≥¥Ïùò ÏãúÏóêÏÑú Ïú†Îûò.' },
                77: { name: 'Ìù¨Ïàò', hanja: 'ÂñúÂ£Ω', meaning: 'ÂñúÎ•º Ï¥àÏÑúÎ°ú Ïì∞Î©¥ ‰∏ÉÂçÅ‰∏ÉÏù¥ Îê®.' },
                80: { name: 'ÏÇ∞Ïàò', hanja: 'ÂÇòÂ£Ω', meaning: 'ÂÇòÏùò ÏïΩÏûêÍ∞Ä ÂÖ´ÂçÅÏùÑ ÎãÆÏùå.' },
                88: { name: 'ÎØ∏Ïàò', hanja: 'Á±≥Â£Ω', meaning: 'Á±≥Î•º ÌíÄÏñ¥Ïì∞Î©¥ ÂÖ´ÂçÅÂÖ´Ïù¥ Îê®.' },
                90: { name: 'Ï°∏Ïàò', hanja: 'ÂçíÂ£Ω', meaning: 'ÂçíÏùò ÏïΩÏûêÍ∞Ä ‰πùÂçÅÏùÑ ÎãÆÏùå.' },
                99: { name: 'Î∞±Ïàò', hanja: 'ÁôΩÂ£Ω', meaning: 'ÁôæÏóêÏÑú ‰∏ÄÏùÑ ÎπºÎ©¥ ÁôΩÏù¥ Îê®.' },
                100: { name: 'ÏÉÅÏàò', hanja: '‰∏äÂ£Ω', meaning: 'ÏµúÍ≥†Ïùò ÎÇòÏù¥, Í∞ÄÏû• ÎÜíÏùÄ ÏàòÎ™Ö.' }
            };
            return names[age] || null;
        }
        
        // ÌïôÍµê Ï†ïÎ≥¥
        function getSchoolInfo(age) {
            if (age < 6) return { status: `Ï¥àÎì±ÌïôÍµê ÏûÖÌïôÍπåÏßÄ ${6 - age}ÎÖÑ`, icon: 'fas fa-hourglass-start' };
            if (age <= 11) return { status: `Ï¥àÎì±ÌïôÍµê ${age - 5}ÌïôÎÖÑ (ÏòàÏÉÅ)`, icon: 'fas fa-backpack' };
            if (age === 12) return { status: 'Ï¥àÎì±ÌïôÍµê 6ÌïôÎÖÑ / Ï°∏ÏóÖ ÏòàÏ†ï', icon: 'fas fa-backpack' };
            if (age <= 14) return { status: `Ï§ëÌïôÍµê ${age - 12}ÌïôÎÖÑ (ÏòàÏÉÅ)`, icon: 'fas fa-school' };
            if (age === 15) return { status: 'Ï§ëÌïôÍµê 3ÌïôÎÖÑ / Ï°∏ÏóÖ ÏòàÏ†ï', icon: 'fas fa-school' };
            if (age <= 17) return { status: `Í≥†Îì±ÌïôÍµê ${age - 15}ÌïôÎÖÑ (ÏòàÏÉÅ)`, icon: 'fas fa-building' };
            if (age === 18) return { status: 'Í≥†Îì±ÌïôÍµê 3ÌïôÎÖÑ / Ï°∏ÏóÖ ÏòàÏ†ï', icon: 'fas fa-building' };
            if (age <= 22) return { status: `ÎåÄÌïôÍµê ${age - 18}ÌïôÎÖÑ (ÏòàÏÉÅ)`, icon: 'fas fa-university' };
            if (age <= 24) return { status: 'ÎåÄÌïôÍµê Ï°∏ÏóÖ ÎòêÎäî ÎåÄÌïôÏõê', icon: 'fas fa-graduation-cap' };
            return null;
        }
        
        // Îù† Í≥ÑÏÇ∞
        function getZodiac(year) {
            const zodiacs = [
                { name: 'ÏõêÏà≠Ïù¥', hanja: 'Áî≥', emoji: 'üêµ' },
                { name: 'Îã≠', hanja: 'ÈÖâ', emoji: 'üêî' },
                { name: 'Í∞ú', hanja: 'Êàå', emoji: 'üêï' },
                { name: 'ÎèºÏßÄ', hanja: '‰∫•', emoji: 'üê∑' },
                { name: 'Ï•ê', hanja: 'Â≠ê', emoji: 'üê≠' },
                { name: 'ÏÜå', hanja: '‰∏ë', emoji: 'üêÆ' },
                { name: 'Ìò∏ÎûëÏù¥', hanja: 'ÂØÖ', emoji: 'üêØ' },
                { name: 'ÌÜ†ÎÅº', hanja: 'ÂçØ', emoji: 'üê∞' },
                { name: 'Ïö©', hanja: 'Ëæ∞', emoji: 'üê≤' },
                { name: 'Î±Ä', hanja: 'Â∑≥', emoji: 'üêç' },
                { name: 'Îßê', hanja: 'Âçà', emoji: 'üê¥' },
                { name: 'Ïñë', hanja: 'Êú™', emoji: 'üêë' }
            ];
            return zodiacs[year % 12];
        }
        
        // Î≥ÑÏûêÎ¶¨ Í≥ÑÏÇ∞
        function getConstellation(month, day) {
            const constellations = [
                { name: 'ÏóºÏÜåÏûêÎ¶¨', emoji: '‚ôë', period: '12/22 ~ 1/19' },
                { name: 'Î¨ºÎ≥ëÏûêÎ¶¨', emoji: '‚ôí', period: '1/20 ~ 2/18' },
                { name: 'Î¨ºÍ≥†Í∏∞ÏûêÎ¶¨', emoji: '‚ôì', period: '2/19 ~ 3/20' },
                { name: 'ÏñëÏûêÎ¶¨', emoji: '‚ôà', period: '3/21 ~ 4/19' },
                { name: 'Ìô©ÏÜåÏûêÎ¶¨', emoji: '‚ôâ', period: '4/20 ~ 5/20' },
                { name: 'ÏåçÎë•Ïù¥ÏûêÎ¶¨', emoji: '‚ôä', period: '5/21 ~ 6/21' },
                { name: 'Í≤åÏûêÎ¶¨', emoji: '‚ôã', period: '6/22 ~ 7/22' },
                { name: 'ÏÇ¨ÏûêÏûêÎ¶¨', emoji: '‚ôå', period: '7/23 ~ 8/22' },
                { name: 'Ï≤òÎÖÄÏûêÎ¶¨', emoji: '‚ôç', period: '8/23 ~ 9/22' },
                { name: 'Ï≤úÏπ≠ÏûêÎ¶¨', emoji: '‚ôé', period: '9/23 ~ 10/22' },
                { name: 'Ï†ÑÍ∞àÏûêÎ¶¨', emoji: '‚ôè', period: '10/23 ~ 11/21' },
                { name: 'ÏÇ¨ÏàòÏûêÎ¶¨', emoji: '‚ôê', period: '11/22 ~ 12/21' }
            ];
            
            const dates = [20, 19, 21, 20, 21, 22, 23, 23, 23, 23, 22, 22];
            let index = month - 1;
            if (day < dates[index]) {
                index = (index + 11) % 12;
            }
            return constellations[index];
        }

        // ============ Îã®ÏúÑÌôòÏÇ∞ Í≥ÑÏÇ∞Í∏∞ ============
        const unitConversionData = {
            length: {
                name: 'Í∏∏Ïù¥',
                icon: 'fas fa-ruler',
                color: '#667eea',
                description: 'Í∏∏Ïù¥Îäî Î¨ºÏ≤¥Ïùò Ìïú ÎÅùÏóêÏÑú Îã§Î•∏ ÎÅùÍπåÏßÄÏùò Í±∞Î¶¨ÏûÖÎãàÎã§. SI Í∏∞Î≥∏Îã®ÏúÑÎäî ÎØ∏ÌÑ∞(m)ÏûÖÎãàÎã§.',
                units: {
                    'km': { name: 'ÌÇ¨Î°úÎØ∏ÌÑ∞ (km)', toBase: 1000 },
                    'm': { name: 'ÎØ∏ÌÑ∞ (m)', toBase: 1 },
                    'cm': { name: 'ÏÑºÌã∞ÎØ∏ÌÑ∞ (cm)', toBase: 0.01 },
                    'mm': { name: 'Î∞ÄÎ¶¨ÎØ∏ÌÑ∞ (mm)', toBase: 0.001 },
                    'in': { name: 'Ïù∏Ïπò (in)', toBase: 0.0254 },
                    'ft': { name: 'ÌîºÌä∏ (ft)', toBase: 0.3048 },
                    'yd': { name: 'ÏïºÎìú (yd)', toBase: 0.9144 },
                    'mi': { name: 'ÎßàÏùº (mi)', toBase: 1609.344 },
                    'nm': { name: 'Ìï¥Î¶¨ (nm)', toBase: 1852 },
                    'li': { name: 'Î¶¨ (Èáå)', toBase: 392.727 },
                    'ja': { name: 'Ïûê (Â∞∫)', toBase: 0.303 }
                },
                tips: [
                    { icon: 'fas fa-running', title: 'ÎßàÎùºÌÜ§', desc: 'ÌíÄ ÎßàÎùºÌÜ§ÏùÄ 42.195km (ÏïΩ 26.2ÎßàÏùº)' },
                    { icon: 'fas fa-plane', title: 'ÎπÑÌñâÍ∏∞ Í≥†ÎèÑ', desc: 'ÏàúÌï≠ Í≥†ÎèÑ ÏïΩ 10,000m (33,000ft)' },
                    { icon: 'fas fa-child', title: 'Ïã†Ïû• ÌôòÏÇ∞', desc: '180cm = ÏïΩ 5ÌîºÌä∏ 11Ïù∏Ïπò' }
                ]
            },
            area: {
                name: 'ÎÑìÏù¥',
                icon: 'fas fa-vector-square',
                color: '#f093fb',
                description: 'ÎÑìÏù¥Îäî 2Ï∞®Ïõê ÌèâÎ©¥Ïù¥ Ï∞®ÏßÄÌïòÎäî Í≥µÍ∞ÑÏùò ÌÅ¨Í∏∞ÏûÖÎãàÎã§. SI Îã®ÏúÑÎäî Ï†úÍ≥±ÎØ∏ÌÑ∞(m¬≤)ÏûÖÎãàÎã§.',
                units: {
                    'km2': { name: 'Ï†úÍ≥±ÌÇ¨Î°úÎØ∏ÌÑ∞ (km¬≤)', toBase: 1000000 },
                    'm2': { name: 'Ï†úÍ≥±ÎØ∏ÌÑ∞ (m¬≤)', toBase: 1 },
                    'cm2': { name: 'Ï†úÍ≥±ÏÑºÌã∞ÎØ∏ÌÑ∞ (cm¬≤)', toBase: 0.0001 },
                    'ha': { name: 'Ìó•ÌÉÄÎ•¥ (ha)', toBase: 10000 },
                    'ac': { name: 'ÏóêÏù¥Ïª§ (ac)', toBase: 4046.8564224 },
                    'pyeong': { name: 'Ìèâ (Âù™)', toBase: 3.305785 },
                    'ft2': { name: 'Ï†úÍ≥±ÌîºÌä∏ (ft¬≤)', toBase: 0.09290304 },
                    'in2': { name: 'Ï†úÍ≥±Ïù∏Ïπò (in¬≤)', toBase: 0.00064516 },
                    'yd2': { name: 'Ï†úÍ≥±ÏïºÎìú (yd¬≤)', toBase: 0.83612736 }
                },
                tips: [
                    { icon: 'fas fa-home', title: 'ÏïÑÌååÌä∏ ÌèâÏàò', desc: '30Ìèâ = ÏïΩ 99.17m¬≤ (Ï†ÑÏö©Î©¥Ï†Å)' },
                    { icon: 'fas fa-futbol', title: 'Ï∂ïÍµ¨Ïû•', desc: 'ÏïΩ 7,140m¬≤ (ÏïΩ 2,160Ìèâ)' },
                    { icon: 'fas fa-city', title: 'ÏÑúÏö∏ Î©¥Ï†Å', desc: 'ÏïΩ 605km¬≤ (ÏïΩ 1Ïñµ 8Ï≤úÎßåÌèâ)' }
                ]
            },
            speed: {
                name: 'ÏÜçÎèÑ',
                icon: 'fas fa-tachometer-alt',
                color: '#4facfe',
                description: 'ÏÜçÎèÑÎäî Î¨ºÏ≤¥Í∞Ä Îã®ÏúÑ ÏãúÍ∞Ñ ÎèôÏïà Ïù¥ÎèôÌïú Í±∞Î¶¨ÏûÖÎãàÎã§. SI Îã®ÏúÑÎäî m/sÏûÖÎãàÎã§.',
                units: {
                    'mps': { name: 'ÎØ∏ÌÑ∞/Ï¥à (m/s)', toBase: 1 },
                    'kmh': { name: 'ÌÇ¨Î°úÎØ∏ÌÑ∞/Ïãú (km/h)', toBase: 0.277778 },
                    'mph': { name: 'ÎßàÏùº/Ïãú (mph)', toBase: 0.44704 },
                    'knot': { name: 'ÎÖ∏Ìä∏ (knot)', toBase: 0.514444 },
                    'fps': { name: 'ÌîºÌä∏/Ï¥à (ft/s)', toBase: 0.3048 },
                    'mach': { name: 'ÎßàÌïò (Mach)', toBase: 343 }
                },
                tips: [
                    { icon: 'fas fa-car', title: 'Í≥†ÏÜçÎèÑÎ°ú', desc: '100km/h = ÏïΩ 62mph = ÏïΩ 27.8m/s' },
                    { icon: 'fas fa-fighter-jet', title: 'ÏùåÏÜç', desc: 'ÎßàÌïò 1 = ÏïΩ 1,235km/h (Ìï¥ÏàòÎ©¥ Í∏∞Ï§Ä)' },
                    { icon: 'fas fa-ship', title: 'ÏÑ†Î∞ï ÏÜçÎèÑ', desc: '1ÎÖ∏Ìä∏ = ÏïΩ 1.852km/h' }
                ]
            },
            temperature: {
                name: 'Ïò®ÎèÑ',
                icon: 'fas fa-thermometer-half',
                color: '#fa709a',
                description: 'Ïò®ÎèÑÎäî Î¨ºÏ≤¥Ïùò Ïó¥Ï†Å ÏÉÅÌÉúÎ•º ÎÇòÌÉÄÎÇ¥Îäî Î¨ºÎ¶¨ÎüâÏûÖÎãàÎã§. SI Îã®ÏúÑÎäî ÏºàÎπà(K)ÏûÖÎãàÎã§.',
                units: {
                    'c': { name: 'ÏÑ≠Ïî® (¬∞C)', toBase: 'special' },
                    'f': { name: 'ÌôîÏî® (¬∞F)', toBase: 'special' },
                    'k': { name: 'ÏºàÎπà (K)', toBase: 'special' }
                },
                tips: [
                    { icon: 'fas fa-snowflake', title: 'Î¨ºÏùò Ïñ¥ÎäîÏ†ê', desc: '0¬∞C = 32¬∞F = 273.15K' },
                    { icon: 'fas fa-fire', title: 'Î¨ºÏùò ÎÅìÎäîÏ†ê', desc: '100¬∞C = 212¬∞F = 373.15K' },
                    { icon: 'fas fa-user', title: 'Ï≤¥Ïò®', desc: '36.5¬∞C = ÏïΩ 97.7¬∞F' }
                ]
            },
            pressure: {
                name: 'ÏïïÎ†•',
                icon: 'fas fa-compress-arrows-alt',
                color: '#30cfd0',
                description: 'ÏïïÎ†•ÏùÄ Îã®ÏúÑ Î©¥Ï†ÅÎãπ Í∞ÄÌï¥ÏßÄÎäî ÌûòÏûÖÎãàÎã§. SI Îã®ÏúÑÎäî ÌååÏä§Ïπº(Pa)ÏûÖÎãàÎã§.',
                units: {
                    'pa': { name: 'ÌååÏä§Ïπº (Pa)', toBase: 1 },
                    'kpa': { name: 'ÌÇ¨Î°úÌååÏä§Ïπº (kPa)', toBase: 1000 },
                    'mpa': { name: 'Î©îÍ∞ÄÌååÏä§Ïπº (MPa)', toBase: 1000000 },
                    'bar': { name: 'Î∞î (bar)', toBase: 100000 },
                    'atm': { name: 'Í∏∞Ïïï (atm)', toBase: 101325 },
                    'psi': { name: 'ÌååÏö¥Îìú/Ï†úÍ≥±Ïù∏Ïπò (psi)', toBase: 6894.757 },
                    'mmhg': { name: 'ÏàòÏùÄÏ£ºÎ∞ÄÎ¶¨ÎØ∏ÌÑ∞ (mmHg)', toBase: 133.322 },
                    'torr': { name: 'ÌÜ†Î•¥ (Torr)', toBase: 133.322 }
                },
                tips: [
                    { icon: 'fas fa-cloud', title: 'ÎåÄÍ∏∞Ïïï', desc: '1Í∏∞Ïïï = 101,325Pa = ÏïΩ 14.7psi' },
                    { icon: 'fas fa-car', title: 'ÌÉÄÏù¥Ïñ¥ ÏïïÎ†•', desc: 'ÏïΩ 32psi = ÏïΩ 2.2bar' },
                    { icon: 'fas fa-heartbeat', title: 'ÌòàÏïï', desc: 'Ï†ïÏÉÅ ÌòàÏïï: 120/80 mmHg' }
                ]
            },
            weight: {
                name: 'Î¨¥Í≤å',
                icon: 'fas fa-weight-hanging',
                color: '#f5576c',
                description: 'Î¨¥Í≤å(ÏßàÎüâ)ÏùÄ Î¨ºÏ≤¥Í∞Ä Í∞ÄÏßÑ Î¨ºÏßàÏùò ÏñëÏûÖÎãàÎã§. SI Îã®ÏúÑÎäî ÌÇ¨Î°úÍ∑∏Îû®(kg)ÏûÖÎãàÎã§.',
                units: {
                    't': { name: 'ÌÜ§ (t)', toBase: 1000 },
                    'kg': { name: 'ÌÇ¨Î°úÍ∑∏Îû® (kg)', toBase: 1 },
                    'g': { name: 'Í∑∏Îû® (g)', toBase: 0.001 },
                    'mg': { name: 'Î∞ÄÎ¶¨Í∑∏Îû® (mg)', toBase: 0.000001 },
                    'lb': { name: 'ÌååÏö¥Îìú (lb)', toBase: 0.453592 },
                    'oz': { name: 'Ïò®Ïä§ (oz)', toBase: 0.0283495 },
                    'geun': { name: 'Í∑º (Êñ§)', toBase: 0.6 },
                    'don': { name: 'Îèà (Èå¢)', toBase: 0.00375 }
                },
                tips: [
                    { icon: 'fas fa-dumbbell', title: 'ÌååÏö¥Îìú ÌôòÏÇ∞', desc: '1kg = ÏïΩ 2.2lb' },
                    { icon: 'fas fa-apple-alt', title: 'Ìïú Í∑º', desc: 'Í≥ºÏùº/ÏïºÏ±Ñ 1Í∑º = 600g' },
                    { icon: 'fas fa-ring', title: 'Í∏à Îèà', desc: '1Îèà = 3.75g (Í∏àÎ∞òÏßÄ Í∏∞Ï§Ä)' }
                ]
            },
            volume: {
                name: 'Î∂ÄÌîº',
                icon: 'fas fa-cube',
                color: '#764ba2',
                description: 'Î∂ÄÌîºÎäî 3Ï∞®Ïõê Í≥µÍ∞ÑÏóêÏÑú Î¨ºÏ≤¥Í∞Ä Ï∞®ÏßÄÌïòÎäî Í≥µÍ∞ÑÏùò ÌÅ¨Í∏∞ÏûÖÎãàÎã§. SI Îã®ÏúÑÎäî ÏÑ∏Ï†úÍ≥±ÎØ∏ÌÑ∞(m¬≥)ÏûÖÎãàÎã§.',
                units: {
                    'm3': { name: 'ÏÑ∏Ï†úÍ≥±ÎØ∏ÌÑ∞ (m¬≥)', toBase: 1 },
                    'l': { name: 'Î¶¨ÌÑ∞ (L)', toBase: 0.001 },
                    'ml': { name: 'Î∞ÄÎ¶¨Î¶¨ÌÑ∞ (mL)', toBase: 0.000001 },
                    'cm3': { name: 'ÏÑ∏Ï†úÍ≥±ÏÑºÌã∞ÎØ∏ÌÑ∞ (cm¬≥)', toBase: 0.000001 },
                    'gal': { name: 'Í∞§Îü∞ (US gal)', toBase: 0.00378541 },
                    'qt': { name: 'ÏøºÌä∏ (qt)', toBase: 0.000946353 },
                    'pt': { name: 'ÌååÏù∏Ìä∏ (pt)', toBase: 0.000473176 },
                    'cup': { name: 'Ïªµ (cup)', toBase: 0.000236588 },
                    'floz': { name: 'Ïï°ÎüâÏò®Ïä§ (fl oz)', toBase: 0.0000295735 }
                },
                tips: [
                    { icon: 'fas fa-tint', title: 'Î¨º 1Î¶¨ÌÑ∞', desc: '1L = 1,000mL = ÏïΩ 0.264Í∞§Îü∞' },
                    { icon: 'fas fa-gas-pump', title: 'Í∏∞Î¶Ñ Í∞§Îü∞', desc: '1Í∞§Îü∞(US) = ÏïΩ 3.785L' },
                    { icon: 'fas fa-mug-hot', title: 'Ïª§Ìîº Ìïú Ïûî', desc: 'ÏïΩ 240mL = 1Ïªµ(US)' }
                ]
            },
            data: {
                name: 'Îç∞Ïù¥ÌÑ∞(ÎπÑÌä∏)',
                icon: 'fas fa-database',
                color: '#10b981',
                description: 'Îç∞Ïù¥ÌÑ∞ ÌÅ¨Í∏∞Îäî ÎîîÏßÄÌÑ∏ Ï†ïÎ≥¥Ïùò ÏñëÏùÑ ÎÇòÌÉÄÎÉÖÎãàÎã§. Í∏∞Î≥∏ Îã®ÏúÑÎäî ÎπÑÌä∏(bit)ÏôÄ Î∞îÏù¥Ìä∏(byte)ÏûÖÎãàÎã§. 1Î∞îÏù¥Ìä∏ = 8ÎπÑÌä∏ÏûÖÎãàÎã§.',
                units: {
                    'bit': { name: 'ÎπÑÌä∏ (bit)', toBase: 1 },
                    'byte': { name: 'Î∞îÏù¥Ìä∏ (B)', toBase: 8 },
                    'kb': { name: 'ÌÇ¨Î°úÎ∞îÏù¥Ìä∏ (KB)', toBase: 8000 },
                    'kib': { name: 'ÌÇ§ÎπÑÎ∞îÏù¥Ìä∏ (KiB)', toBase: 8192 },
                    'mb': { name: 'Î©îÍ∞ÄÎ∞îÏù¥Ìä∏ (MB)', toBase: 8000000 },
                    'mib': { name: 'Î©îÎπÑÎ∞îÏù¥Ìä∏ (MiB)', toBase: 8388608 },
                    'gb': { name: 'Í∏∞Í∞ÄÎ∞îÏù¥Ìä∏ (GB)', toBase: 8000000000 },
                    'gib': { name: 'Í∏∞ÎπÑÎ∞îÏù¥Ìä∏ (GiB)', toBase: 8589934592 },
                    'tb': { name: 'ÌÖåÎùºÎ∞îÏù¥Ìä∏ (TB)', toBase: 8000000000000 },
                    'tib': { name: 'ÌÖåÎπÑÎ∞îÏù¥Ìä∏ (TiB)', toBase: 8796093022208 },
                    'pb': { name: 'ÌéòÌÉÄÎ∞îÏù¥Ìä∏ (PB)', toBase: 8000000000000000 },
                    'pib': { name: 'ÌéòÎπÑÎ∞îÏù¥Ìä∏ (PiB)', toBase: 9007199254740992 },
                    'kbit': { name: 'ÌÇ¨Î°úÎπÑÌä∏ (Kbit)', toBase: 1000 },
                    'mbit': { name: 'Î©îÍ∞ÄÎπÑÌä∏ (Mbit)', toBase: 1000000 },
                    'gbit': { name: 'Í∏∞Í∞ÄÎπÑÌä∏ (Gbit)', toBase: 1000000000 }
                },
                tips: [
                    { icon: 'fas fa-wifi', title: 'Ïù∏ÌÑ∞ÎÑ∑ ÏÜçÎèÑ', desc: '100Mbps = Ï¥àÎãπ ÏïΩ 12.5MB Îã§Ïö¥Î°úÎìú' },
                    { icon: 'fas fa-hdd', title: 'SSD/HDD', desc: '1TB = ÏïΩ 1,000GB = ÏïΩ 8Ï°∞ ÎπÑÌä∏' },
                    { icon: 'fas fa-memory', title: 'RAM Î©îÎ™®Î¶¨', desc: '8GB = 64Í∏∞Í∞ÄÎπÑÌä∏ = ÏïΩ 68Ïñµ ÎπÑÌä∏' },
                    { icon: 'fas fa-film', title: '4K ÏòÅÌôî', desc: '4K ÏòÅÌôî 1Ìé∏ ‚âà ÏïΩ 25~100GB' },
                    { icon: 'fas fa-info-circle', title: 'KB vs KiB', desc: 'KB(1000)Îäî SIÎã®ÏúÑ, KiB(1024)Îäî Ïù¥ÏßÑÎã®ÏúÑ' }
                ]
            }
        };

        function getUnitConverterCalculator() {
            return `
                <div class="unit-converter-container">
                    <div class="unit-category-tabs">
                        ${Object.entries(unitConversionData).map(([key, cat]) => `
                            <button class="unit-cat-tab ${key === 'length' ? 'active' : ''}" 
                                    onclick="selectUnitCategory('${key}', this)"
                                    style="--cat-color: ${cat.color}">
                                <i class="${cat.icon}"></i>
                                <span>${cat.name}</span>
                            </button>
                        `).join('')}
                    </div>

                    <div class="unit-description" id="unitDescription">
                        <i class="fas fa-info-circle"></i>
                        <span>${unitConversionData.length.description}</span>
                    </div>

                    <div class="unit-converter-main">
                        <div class="unit-input-group">
                            <label><i class="fas fa-arrow-right"></i> Î≥ÄÌôòÌï† Í∞í</label>
                            <div class="unit-input-row">
                                <input type="number" step="any" id="unitValueFrom" placeholder="1" oninput="convertUnit('from')">
                                <select id="unitSelectFrom" onchange="convertUnit('from')"></select>
                            </div>
                        </div>

                        <button class="unit-swap-btn" onclick="swapUnits()" title="Îã®ÏúÑ ÍµêÌôò">
                            <i class="fas fa-exchange-alt"></i>
                        </button>

                        <div class="unit-input-group">
                            <label><i class="fas fa-arrow-left"></i> Î≥ÄÌôò Í≤∞Í≥º</label>
                            <div class="unit-input-row">
                                <input type="number" step="any" id="unitValueTo" placeholder="Í≤∞Í≥º" oninput="convertUnit('to')">
                                <select id="unitSelectTo" onchange="convertUnit('from')"></select>
                            </div>
                        </div>
                    </div>

                    <div class="unit-result-box" id="unitResultBox">
                        <div class="unit-result-formula" id="unitFormula"></div>
                    </div>

                    <div class="unit-all-conversions" id="unitAllConversions">
                        <h4><i class="fas fa-list"></i> Î™®Îì† Îã®ÏúÑÎ°ú Î≥ÄÌôò</h4>
                        <div class="unit-grid" id="unitGrid"></div>
                    </div>

                    <div class="unit-tips-section" id="unitTips">
                        <h4><i class="fas fa-lightbulb"></i> ÏïåÏïÑÎëêÎ©¥ Ïú†Ïö©Ìïú ÌåÅ</h4>
                        <div class="unit-tips-grid" id="unitTipsGrid"></div>
                    </div>
                </div>

                <style>
                    .unit-converter-container {
                        max-width: 100%;
                    }
                    .unit-category-tabs {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 8px;
                        margin-bottom: 20px;
                    }
                    .unit-cat-tab {
                        padding: 12px 16px;
                        border: 2px solid #e2e8f0;
                        background: white;
                        border-radius: 12px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        font-size: 14px;
                        font-weight: 500;
                    }
                    .unit-cat-tab i {
                        font-size: 18px;
                        color: var(--cat-color);
                    }
                    .unit-cat-tab:hover {
                        border-color: var(--cat-color);
                        transform: translateY(-2px);
                        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                    }
                    .unit-cat-tab.active {
                        background: var(--cat-color);
                        border-color: var(--cat-color);
                        color: white;
                    }
                    .unit-cat-tab.active i {
                        color: white;
                    }
                    .unit-description {
                        background: linear-gradient(135deg, #f0f4ff 0%, #faf5ff 100%);
                        padding: 15px 20px;
                        border-radius: 12px;
                        margin-bottom: 25px;
                        display: flex;
                        align-items: flex-start;
                        gap: 12px;
                        font-size: 14px;
                        color: #4a5568;
                        line-height: 1.6;
                    }
                    .unit-description i {
                        color: var(--primary-color);
                        font-size: 20px;
                        margin-top: 2px;
                    }
                    .unit-converter-main {
                        background: white;
                        border-radius: 16px;
                        padding: 25px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                        display: flex;
                        flex-direction: column;
                        gap: 15px;
                        position: relative;
                    }
                    .unit-input-group {
                        flex: 1;
                    }
                    .unit-input-group label {
                        display: block;
                        font-weight: 600;
                        margin-bottom: 10px;
                        color: var(--text-dark);
                        font-size: 14px;
                    }
                    .unit-input-group label i {
                        color: var(--primary-color);
                        margin-right: 5px;
                    }
                    .unit-input-row {
                        display: flex;
                        gap: 10px;
                    }
                    .unit-input-row input {
                        flex: 1;
                        padding: 15px;
                        border: 2px solid #e2e8f0;
                        border-radius: 12px;
                        font-size: 18px;
                        font-weight: 600;
                        transition: all 0.3s ease;
                    }
                    .unit-input-row input:focus {
                        outline: none;
                        border-color: var(--primary-color);
                        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
                    }
                    .unit-input-row select {
                        min-width: 180px;
                        padding: 15px;
                        border: 2px solid #e2e8f0;
                        border-radius: 12px;
                        font-size: 14px;
                        font-weight: 500;
                        background: white;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    }
                    .unit-input-row select:focus {
                        outline: none;
                        border-color: var(--primary-color);
                    }
                    .unit-swap-btn {
                        align-self: center;
                        width: 50px;
                        height: 50px;
                        border-radius: 50%;
                        border: none;
                        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
                        color: white;
                        font-size: 20px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                    }
                    .unit-swap-btn:hover {
                        transform: rotate(180deg) scale(1.1);
                    }
                    .unit-result-box {
                        margin-top: 20px;
                        padding: 20px;
                        background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
                        border-radius: 16px;
                        color: white;
                        display: none;
                    }
                    .unit-result-box.active {
                        display: block;
                    }
                    .unit-result-formula {
                        text-align: center;
                        font-size: 22px;
                        font-weight: 700;
                    }
                    .unit-all-conversions {
                        margin-top: 25px;
                        padding: 25px;
                        background: #f8fafc;
                        border-radius: 16px;
                        display: none;
                    }
                    .unit-all-conversions.active {
                        display: block;
                    }
                    .unit-all-conversions h4 {
                        margin-bottom: 20px;
                        color: var(--text-dark);
                        font-size: 16px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .unit-all-conversions h4 i {
                        color: var(--primary-color);
                    }
                    .unit-grid {
                        display: grid;
                        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                        gap: 12px;
                    }
                    .unit-grid-item {
                        background: white;
                        padding: 15px;
                        border-radius: 12px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                        transition: all 0.3s ease;
                        cursor: pointer;
                    }
                    .unit-grid-item:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.15);
                    }
                    .unit-grid-item .unit-name {
                        font-size: 13px;
                        color: var(--text-light);
                    }
                    .unit-grid-item .unit-value {
                        font-size: 16px;
                        font-weight: 700;
                        color: var(--primary-color);
                    }
                    .unit-tips-section {
                        margin-top: 30px;
                        padding: 25px;
                        background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
                        border-radius: 16px;
                        border: 1px solid #fcd34d;
                    }
                    .unit-tips-section h4 {
                        margin-bottom: 20px;
                        color: #92400e;
                        font-size: 16px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .unit-tips-section h4 i {
                        color: #f59e0b;
                    }
                    .unit-tips-grid {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
                        gap: 15px;
                    }
                    .unit-tip-item {
                        background: white;
                        padding: 18px;
                        border-radius: 12px;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
                    }
                    .unit-tip-item i {
                        font-size: 28px;
                        color: var(--primary-color);
                        margin-bottom: 10px;
                        display: block;
                    }
                    .unit-tip-item strong {
                        display: block;
                        margin-bottom: 8px;
                        color: var(--text-dark);
                        font-size: 14px;
                    }
                    .unit-tip-item p {
                        font-size: 13px;
                        color: var(--text-light);
                        line-height: 1.5;
                    }
                    @media (max-width: 600px) {
                        .unit-category-tabs {
                            justify-content: center;
                        }
                        .unit-cat-tab {
                            padding: 10px 12px;
                            font-size: 12px;
                        }
                        .unit-cat-tab span {
                            display: none;
                        }
                        .unit-cat-tab i {
                            margin: 0;
                        }
                        .unit-input-row {
                            flex-direction: column;
                        }
                        .unit-input-row select {
                            min-width: 100%;
                        }
                    }
                </style>
            `;
        }

        let currentUnitCategory = 'length';

        function initUnitConverter() {
            selectUnitCategory('length', document.querySelector('.unit-cat-tab'));
        }

        function selectUnitCategory(category, btn) {
            currentUnitCategory = category;
            
            // ÌÉ≠ ÌôúÏÑ±Ìôî
            document.querySelectorAll('.unit-cat-tab').forEach(tab => tab.classList.remove('active'));
            if (btn) btn.classList.add('active');
            
            const catData = unitConversionData[category];
            
            // ÏÑ§Î™Ö ÏóÖÎç∞Ïù¥Ìä∏
            document.getElementById('unitDescription').innerHTML = `
                <i class="fas fa-info-circle"></i>
                <span>${catData.description}</span>
            `;
            
            // ÏÖÄÎ†âÌä∏ ÏòµÏÖò ÏóÖÎç∞Ïù¥Ìä∏
            const selectFrom = document.getElementById('unitSelectFrom');
            const selectTo = document.getElementById('unitSelectTo');
            
            const options = Object.entries(catData.units).map(([key, unit]) => 
                `<option value="${key}">${unit.name}</option>`
            ).join('');
            
            selectFrom.innerHTML = options;
            selectTo.innerHTML = options;
            
            // Îëê Î≤àÏß∏ Îã®ÏúÑ Í∏∞Î≥∏Í∞í ÏÑ§Ï†ï
            if (Object.keys(catData.units).length > 1) {
                selectTo.selectedIndex = 1;
            }
            
            // ÏûÖÎ†•Í∞í Ï¥àÍ∏∞Ìôî
            document.getElementById('unitValueFrom').value = '1';
            document.getElementById('unitValueTo').value = '';
            
            // ÌåÅ ÏóÖÎç∞Ïù¥Ìä∏
            updateUnitTips(catData.tips);
            
            // Î≥ÄÌôò Ïã§Ìñâ
            convertUnit('from');
        }

        function updateUnitTips(tips) {
            const tipsGrid = document.getElementById('unitTipsGrid');
            tipsGrid.innerHTML = tips.map(tip => `
                <div class="unit-tip-item">
                    <i class="${tip.icon}"></i>
                    <strong>${tip.title}</strong>
                    <p>${tip.desc}</p>
                </div>
            `).join('');
        }

        function convertUnit(direction) {
            const catData = unitConversionData[currentUnitCategory];
            const fromUnit = document.getElementById('unitSelectFrom').value;
            const toUnit = document.getElementById('unitSelectTo').value;
            const inputFrom = document.getElementById('unitValueFrom');
            const inputTo = document.getElementById('unitValueTo');
            
            let value, result;
            
            if (direction === 'from') {
                value = parseFloat(inputFrom.value);
                if (isNaN(value)) {
                    inputTo.value = '';
                    hideUnitResults();
                    return;
                }
                result = convertValue(value, fromUnit, toUnit, catData);
                inputTo.value = formatUnitValue(result);
            } else {
                value = parseFloat(inputTo.value);
                if (isNaN(value)) {
                    inputFrom.value = '';
                    hideUnitResults();
                    return;
                }
                result = convertValue(value, toUnit, fromUnit, catData);
                inputFrom.value = formatUnitValue(result);
                value = result;
                result = parseFloat(inputTo.value);
            }
            
            // Í≤∞Í≥º ÌëúÏãú
            showUnitResults(value, fromUnit, result, toUnit, catData);
        }

        function convertValue(value, from, to, catData) {
            // Ïò®ÎèÑÎäî ÌäπÎ≥Ñ Ï≤òÎ¶¨
            if (currentUnitCategory === 'temperature') {
                return convertTemperature(value, from, to);
            }
            
            // ÏùºÎ∞ò Î≥ÄÌôò: Í∞í ‚Üí Í∏∞Ï§ÄÎã®ÏúÑ ‚Üí Î™©ÌëúÎã®ÏúÑ
            const baseValue = value * catData.units[from].toBase;
            return baseValue / catData.units[to].toBase;
        }

        function convertTemperature(value, from, to) {
            let celsius;
            
            // Î®ºÏ†Ä ÏÑ≠Ïî®Î°ú Î≥ÄÌôò
            switch(from) {
                case 'c': celsius = value; break;
                case 'f': celsius = (value - 32) * 5 / 9; break;
                case 'k': celsius = value - 273.15; break;
            }
            
            // ÏÑ≠Ïî®ÏóêÏÑú Î™©Ìëú Îã®ÏúÑÎ°ú Î≥ÄÌôò
            switch(to) {
                case 'c': return celsius;
                case 'f': return celsius * 9 / 5 + 32;
                case 'k': return celsius + 273.15;
            }
        }

        function formatUnitValue(value) {
            if (Math.abs(value) >= 1000000 || (Math.abs(value) < 0.0001 && value !== 0)) {
                return value.toExponential(6);
            }
            // ÏÜåÏàòÏ†ê Ï≤òÎ¶¨
            const fixed = parseFloat(value.toPrecision(10));
            return fixed;
        }

        function showUnitResults(fromValue, fromUnit, toValue, toUnit, catData) {
            const resultBox = document.getElementById('unitResultBox');
            const formula = document.getElementById('unitFormula');
            const allConversions = document.getElementById('unitAllConversions');
            const unitGrid = document.getElementById('unitGrid');
            
            // Î©îÏù∏ Í≤∞Í≥º
            resultBox.classList.add('active');
            formula.innerHTML = `${formatUnitValue(fromValue)} ${catData.units[fromUnit].name.split(' ')[0]} = ${formatUnitValue(toValue)} ${catData.units[toUnit].name.split(' ')[0]}`;
            
            // Î™®Îì† Îã®ÏúÑ Î≥ÄÌôò
            allConversions.classList.add('active');
            unitGrid.innerHTML = Object.entries(catData.units).map(([key, unit]) => {
                const converted = convertValue(fromValue, fromUnit, key, catData);
                return `
                    <div class="unit-grid-item" onclick="selectTargetUnit('${key}')">
                        <span class="unit-name">${unit.name}</span>
                        <span class="unit-value">${formatUnitValue(converted)}</span>
                    </div>
                `;
            }).join('');
        }

        function hideUnitResults() {
            document.getElementById('unitResultBox').classList.remove('active');
            document.getElementById('unitAllConversions').classList.remove('active');
        }

        function selectTargetUnit(unitKey) {
            document.getElementById('unitSelectTo').value = unitKey;
            convertUnit('from');
        }

        function swapUnits() {
            const selectFrom = document.getElementById('unitSelectFrom');
            const selectTo = document.getElementById('unitSelectTo');
            const inputFrom = document.getElementById('unitValueFrom');
            const inputTo = document.getElementById('unitValueTo');
            
            // Îã®ÏúÑ ÍµêÌôò
            const tempUnit = selectFrom.value;
            selectFrom.value = selectTo.value;
            selectTo.value = tempUnit;
            
            // Í∞í ÍµêÌôò
            const tempValue = inputFrom.value;
            inputFrom.value = inputTo.value;
            inputTo.value = tempValue;
            
            // Ïû¨Í≥ÑÏÇ∞
            convertUnit('from');
        }

        // ============ Îã®ÏúÑÌôòÏÇ∞ Í≥ÑÏÇ∞Í∏∞ ÎÅù ============

        // ============ Îã®Í∞Ä Í≥ÑÏÇ∞Í∏∞ ÏãúÏûë ============
        let unitPriceItems = [];
        let unitPriceIdCounter = 0;
        let unitPriceSortOrder = 'desc'; // 'asc' ÎòêÎäî 'desc'

        function getUnitPriceCalculator() {
            return `
                <style>
                    .unit-price-container {
                        display: flex;
                        flex-direction: column;
                        gap: 25px;
                    }
                    
                    /* ÏûÖÎ†• ÏòÅÏó≠ Ïä§ÌÉÄÏùº - Ïπ¥ÎìúÌòï ÎîîÏûêÏù∏ */
                    .unit-price-input-section {
                        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
                        padding: 25px;
                        border-radius: 20px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
                    }
                    
                    .unit-price-section-title {
                        font-size: 16px;
                        font-weight: 700;
                        color: #334155;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    
                    .unit-price-section-title i {
                        color: #6366f1;
                        font-size: 18px;
                    }
                    
                    .unit-price-items-list {
                        display: grid;
                        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                        gap: 15px;
                    }
                    
                    .unit-price-card {
                        background: white;
                        border-radius: 16px;
                        padding: 20px;
                        box-shadow: 0 2px 12px rgba(0,0,0,0.06);
                        transition: all 0.3s ease;
                        border: 2px solid transparent;
                        position: relative;
                    }
                    
                    .unit-price-card:hover {
                        box-shadow: 0 8px 25px rgba(99, 102, 241, 0.15);
                        border-color: #c7d2fe;
                        transform: translateY(-2px);
                    }
                    
                    .unit-price-card-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 15px;
                    }
                    
                    .unit-price-card-num {
                        width: 28px;
                        height: 28px;
                        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
                        color: white;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 13px;
                        font-weight: 700;
                    }
                    
                    .unit-price-delete-btn {
                        width: 32px;
                        height: 32px;
                        border-radius: 50%;
                        border: none;
                        background: #f1f5f9;
                        color: #94a3b8;
                        font-size: 14px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                    }
                    
                    .unit-price-delete-btn:hover {
                        background: linear-gradient(135deg, #f87171 0%, #ef4444 100%);
                        color: white;
                        transform: scale(1.1);
                    }
                    
                    .unit-price-card-body {
                        display: flex;
                        flex-direction: column;
                        gap: 12px;
                    }
                    
                    .unit-price-input-group {
                        display: flex;
                        flex-direction: column;
                        gap: 6px;
                    }
                    
                    .unit-price-input-group label {
                        font-size: 12px;
                        font-weight: 600;
                        color: #64748b;
                        display: flex;
                        align-items: center;
                        gap: 5px;
                    }
                    
                    .unit-price-input-group label i {
                        font-size: 11px;
                        color: #94a3b8;
                    }
                    
                    .unit-price-card input {
                        width: 100%;
                        padding: 12px 14px;
                        border: 2px solid #e2e8f0;
                        border-radius: 10px;
                        font-size: 15px;
                        font-weight: 500;
                        color: #1f2937;
                        transition: all 0.3s ease;
                        background: #f8fafc;
                    }
                    
                    .unit-price-card input:focus {
                        outline: none;
                        border-color: #6366f1;
                        background: white;
                        box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
                    }
                    
                    .unit-price-card input::placeholder {
                        color: #cbd5e1;
                    }
                    
                    .unit-price-card input.name-input {
                        border-color: #c7d2fe;
                        background: #eef2ff;
                    }
                    
                    .unit-price-card input.name-input:focus {
                        border-color: #6366f1;
                        background: white;
                    }
                    
                    .unit-price-row-group {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 10px;
                    }
                    
                    .unit-price-card .calculated-result {
                        margin-top: 5px;
                        padding: 14px;
                        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                        border-radius: 10px;
                        text-align: center;
                        border: 2px solid #fcd34d;
                    }
                    
                    .unit-price-card .calculated-result .result-label {
                        font-size: 11px;
                        font-weight: 600;
                        color: #92400e;
                        margin-bottom: 4px;
                        display: block;
                    }
                    
                    .unit-price-card .calculated-result .result-value {
                        font-size: 18px;
                        font-weight: 800;
                        color: #b45309;
                    }
                    
                    .unit-price-add-btn {
                        margin-top: 15px;
                        padding: 16px 25px;
                        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
                        color: white;
                        border: none;
                        border-radius: 12px;
                        font-size: 15px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 8px;
                        width: 100%;
                    }
                    
                    .unit-price-add-btn:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 6px 20px rgba(99, 102, 241, 0.4);
                    }
                    
                    /* Í≤∞Í≥º ÌÖåÏù¥Î∏î ÏÑπÏÖò */
                    .unit-price-result-section {
                        background: linear-gradient(135deg, #fef7ed 0%, #fef3c7 100%);
                        padding: 25px;
                        border-radius: 20px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
                    }
                    
                    .unit-price-result-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 20px;
                    }
                    
                    .unit-price-result-title {
                        font-size: 18px;
                        font-weight: 700;
                        color: #92400e;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    
                    .unit-price-result-title i {
                        color: #f59e0b;
                    }
                    
                    .unit-price-table {
                        width: 100%;
                        border-collapse: collapse;
                        background: white;
                        border-radius: 15px;
                        overflow: hidden;
                        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
                    }
                    
                    .unit-price-table th {
                        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                        padding: 15px 12px;
                        text-align: center;
                        font-weight: 600;
                        color: #92400e;
                        font-size: 14px;
                    }
                    
                    .unit-price-table th.sortable {
                        cursor: pointer;
                        transition: all 0.3s ease;
                        user-select: none;
                    }
                    
                    .unit-price-table th.sortable:hover {
                        background: linear-gradient(135deg, #fde68a 0%, #fcd34d 100%);
                    }
                    
                    .unit-price-table th.sortable.active {
                        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
                        color: white;
                    }
                    
                    .unit-price-table th .sort-icon {
                        margin-left: 5px;
                        font-size: 12px;
                    }
                    
                    .unit-price-table td {
                        padding: 14px 12px;
                        text-align: center;
                        border-bottom: 1px solid #fef3c7;
                        font-size: 14px;
                        color: #374151;
                    }
                    
                    .unit-price-table tr:last-child td {
                        border-bottom: none;
                    }
                    
                    .unit-price-table tr:hover td {
                        background: #fffbeb;
                    }
                    
                    .unit-price-table .item-name {
                        font-weight: 600;
                        color: #1f2937;
                    }
                    
                    .unit-price-table .unit-price-value {
                        font-weight: 700;
                        color: #dc2626;
                    }
                    
                    .unit-price-empty {
                        text-align: center;
                        padding: 40px;
                        color: #9ca3af;
                        font-size: 15px;
                    }
                    
                    .unit-price-empty i {
                        font-size: 40px;
                        margin-bottom: 15px;
                        display: block;
                        color: #d1d5db;
                    }
                    
                    /* ÌôúÏö© ÌåÅ ÏÑπÏÖò */
                    .unit-price-tips-section {
                        background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%);
                        padding: 25px;
                        border-radius: 20px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
                    }
                    
                    .unit-price-tips-title {
                        font-size: 18px;
                        font-weight: 700;
                        color: #5b21b6;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    
                    .unit-price-tips-title i {
                        color: #8b5cf6;
                    }
                    
                    .unit-price-tips-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                    }
                    
                    @media (max-width: 768px) {
                        .unit-price-tips-grid {
                            grid-template-columns: 1fr;
                        }
                    }
                    
                    .unit-price-tip-card {
                        background: white;
                        padding: 18px;
                        border-radius: 12px;
                        display: flex;
                        align-items: flex-start;
                        gap: 12px;
                        transition: all 0.3s ease;
                        box-shadow: 0 2px 8px rgba(0,0,0,0.03);
                    }
                    
                    .unit-price-tip-card:hover {
                        transform: translateY(-3px);
                        box-shadow: 0 6px 20px rgba(139, 92, 246, 0.15);
                    }
                    
                    .unit-price-tip-icon {
                        font-size: 24px;
                        flex-shrink: 0;
                    }
                    
                    .unit-price-tip-content h4 {
                        font-size: 14px;
                        font-weight: 600;
                        color: #1f2937;
                        margin-bottom: 5px;
                    }
                    
                    .unit-price-tip-content p {
                        font-size: 13px;
                        color: #6b7280;
                        line-height: 1.5;
                    }
                    
                    @media (max-width: 600px) {
                        .unit-price-items-list {
                            grid-template-columns: 1fr;
                        }
                        .unit-price-row-group {
                            grid-template-columns: 1fr;
                        }
                    }
                </style>
                
                <div class="unit-price-container">
                    <!-- ÏûÖÎ†• ÏòÅÏó≠ - Ïπ¥Îìú ÌòïÏãù -->
                    <div class="unit-price-input-section">
                        <div class="unit-price-section-title">
                            <i class="fas fa-edit"></i> ÌíàÎ™© Ï†ïÎ≥¥ ÏûÖÎ†•
                        </div>
                        <div class="unit-price-items-list" id="unitPriceItemsList">
                            <!-- Ïπ¥ÎìúÌòï ÏïÑÏù¥ÌÖúÎì§Ïù¥ Ïó¨Í∏∞Ïóê Ï∂îÍ∞ÄÎê® -->
                        </div>
                        <button class="unit-price-add-btn" onclick="addUnitPriceItem()">
                            <i class="fas fa-plus"></i> ÌíàÎ™© Ï∂îÍ∞Ä
                        </button>
                    </div>
                    
                    <!-- Í≤∞Í≥º ÌÖåÏù¥Î∏î -->
                    <div class="unit-price-result-section">
                        <div class="unit-price-result-header">
                            <div class="unit-price-result-title">
                                <i class="fas fa-chart-bar"></i> Îã®Í∞Ä ÎπÑÍµêÌëú
                            </div>
                        </div>
                        <div id="unitPriceResultTable">
                            <div class="unit-price-empty">
                                <i class="fas fa-box-open"></i>
                                ÌíàÎ™©ÏùÑ Ï∂îÍ∞ÄÌïòÎ©¥ Îã®Í∞Ä ÎπÑÍµêÌëúÍ∞Ä ÌëúÏãúÎê©ÎãàÎã§
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÌôúÏö© ÌåÅ -->
                    <div class="unit-price-tips-section">
                        <div class="unit-price-tips-title">
                            <i class="fas fa-lightbulb"></i> ÌôúÏö© ÌåÅ
                        </div>
                        <div class="unit-price-tips-grid">
                            <div class="unit-price-tip-card">
                                <span class="unit-price-tip-icon">üõí</span>
                                <div class="unit-price-tip-content">
                                    <h4>ÎßàÌä∏ Ïû•Î≥¥Í∏∞</h4>
                                    <p>ÎåÄÏö©Îüâ vs ÏÜåÏö©Îüâ Ï†úÌíàÏùò Ïã§Ï†ú Îã®Í∞ÄÎ•º ÎπÑÍµêÌï¥Î≥¥ÏÑ∏Ïöî</p>
                                </div>
                            </div>
                            <div class="unit-price-tip-card">
                                <span class="unit-price-tip-icon">üì¶</span>
                                <div class="unit-price-tip-content">
                                    <h4>Ïò®ÎùºÏù∏ ÏáºÌïë</h4>
                                    <p>Î∞∞ÏÜ°ÎπÑ Ìè¨Ìï®Ìïú Ïã§Ï†ú Îã®Í∞ÄÎ•º ÎπÑÍµêÌï¥Î≥¥ÏÑ∏Ïöî</p>
                                </div>
                            </div>
                            <div class="unit-price-tip-card">
                                <span class="unit-price-tip-icon">üè≠</span>
                                <div class="unit-price-tip-content">
                                    <h4>ÎèÑÎß§ vs ÏÜåÎß§</h4>
                                    <p>ÎåÄÎüâ Íµ¨Îß§Ïãú Ï†àÏïΩÌï† Ïàò ÏûàÎäî Í∏àÏï°ÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî</p>
                                </div>
                            </div>
                            <div class="unit-price-tip-card">
                                <span class="unit-price-tip-icon">üè∑Ô∏è</span>
                                <div class="unit-price-tip-content">
                                    <h4>Ìï†Ïù∏ ÏÉÅÌíà ÎπÑÍµê</h4>
                                    <p>1+1, 2+1 ÌñâÏÇ¨Ïùò Ïã§Ï†ú Îã®Í∞ÄÎ•º Í≥ÑÏÇ∞Ìï¥Î≥¥ÏÑ∏Ïöî</p>
                                </div>
                            </div>
                            <div class="unit-price-tip-card">
                                <span class="unit-price-tip-icon">‚òï</span>
                                <div class="unit-price-tip-content">
                                    <h4>ÏùåÎ£å/ÏãùÌíà ÎπÑÍµê</h4>
                                    <p>mlÎãπ, gÎãπ Í∞ÄÍ≤©ÏùÑ ÎπÑÍµêÌï¥Î≥¥ÏÑ∏Ïöî</p>
                                </div>
                            </div>
                            <div class="unit-price-tip-card">
                                <span class="unit-price-tip-icon">üíº</span>
                                <div class="unit-price-tip-content">
                                    <h4>ÏÇ¨ÏóÖÏûêÏö©</h4>
                                    <p>Í≥µÍ∏âÏóÖÏ≤¥ Í≤¨Ï†ÅÏùò Îã®Í∞ÄÎ•º ÎπÑÍµê Î∂ÑÏÑùÌïòÏÑ∏Ïöî</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function initUnitPriceCalculator() {
            unitPriceItems = [];
            unitPriceIdCounter = 0;
            addUnitPriceItem();
        }

        function addUnitPriceItem() {
            const id = ++unitPriceIdCounter;
            unitPriceItems.push({ id, name: '', price: '', quantity: '' });
            renderUnitPriceItems();
            
            // ÏÉàÎ°ú Ï∂îÍ∞ÄÎêú ÏûÖÎ†•ÌïÑÎìúÏóê Ìè¨Ïª§Ïä§
            setTimeout(() => {
                const nameInput = document.querySelector(`#unitPriceItem_${id} .name-input`);
                if (nameInput) nameInput.focus();
            }, 100);
        }

        function removeUnitPriceItem(id) {
            unitPriceItems = unitPriceItems.filter(item => item.id !== id);
            renderUnitPriceItems();
            updateUnitPriceTable();
        }

        function updateUnitPriceItem(id, field, value) {
            const item = unitPriceItems.find(item => item.id === id);
            if (item) {
                item[field] = value;
                
                // Îã®Í∞Ä ÏûêÎèô Í≥ÑÏÇ∞
                if (field === 'price' || field === 'quantity') {
                    const price = parseFloat(item.price.replace(/,/g, '')) || 0;
                    const quantity = parseFloat(item.quantity.replace(/,/g, '')) || 0;
                    const unitPrice = quantity > 0 ? price / quantity : 0;
                    
                    const unitPriceDisplay = document.querySelector(`#unitPriceItem_${id} .result-value`);
                    if (unitPriceDisplay) {
                        unitPriceDisplay.textContent = unitPrice > 0 ? unitPrice.toLocaleString('ko-KR', { maximumFractionDigits: 2 }) + 'Ïõê' : '-';
                    }
                }
                
                updateUnitPriceTable();
            }
        }

        function renderUnitPriceItems() {
            const container = document.getElementById('unitPriceItemsList');
            if (!container) return;
            
            container.innerHTML = unitPriceItems.map((item, index) => {
                const price = parseFloat(item.price.replace(/,/g, '')) || 0;
                const quantity = parseFloat(item.quantity.replace(/,/g, '')) || 0;
                const unitPrice = quantity > 0 ? price / quantity : 0;
                
                return `
                    <div class="unit-price-card" id="unitPriceItem_${item.id}">
                        <div class="unit-price-card-header">
                            <div class="unit-price-card-num">${index + 1}</div>
                            <button class="unit-price-delete-btn" onclick="removeUnitPriceItem(${item.id})" title="ÏÇ≠Ï†ú">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="unit-price-card-body">
                            <div class="unit-price-input-group">
                                <label><i class="fas fa-tag"></i> ÌíàÎ™©Î™Ö</label>
                                <input type="text" class="name-input" placeholder="Ïòà: Ïö∞Ïú† 1L" 
                                       value="${item.name}" 
                                       onchange="updateUnitPriceItem(${item.id}, 'name', this.value)">
                            </div>
                            <div class="unit-price-row-group">
                                <div class="unit-price-input-group">
                                    <label><i class="fas fa-won-sign"></i> Í∞ÄÍ≤©</label>
                                    <input type="text" inputmode="numeric" placeholder="3,500" 
                                           value="${item.price}" 
                                           oninput="this.value = formatNumberInput(this.value); updateUnitPriceItem(${item.id}, 'price', this.value)">
                                </div>
                                <div class="unit-price-input-group">
                                    <label><i class="fas fa-cubes"></i> ÏàòÎüâ</label>
                                    <input type="text" inputmode="numeric" placeholder="12" 
                                           value="${item.quantity}" 
                                           oninput="this.value = formatNumberInput(this.value); updateUnitPriceItem(${item.id}, 'quantity', this.value)">
                                </div>
                            </div>
                            <div class="calculated-result">
                                <span class="result-label">Í∞úÎãπ Îã®Í∞Ä</span>
                                <span class="result-value">${unitPrice > 0 ? unitPrice.toLocaleString('ko-KR', { maximumFractionDigits: 2 }) + 'Ïõê' : '-'}</span>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function formatNumberInput(value) {
            // Ïà´ÏûêÏôÄ ÏÜåÏàòÏ†êÎßå ÌóàÏö©
            let cleaned = value.replace(/[^\d.]/g, '');
            
            // ÏÜåÏàòÏ†êÏù¥ Ïó¨Îü¨ Í∞úÏù∏ Í≤ΩÏö∞ Ï≤´ Î≤àÏß∏Îßå Ïú†ÏßÄ
            const parts = cleaned.split('.');
            if (parts.length > 2) {
                cleaned = parts[0] + '.' + parts.slice(1).join('');
            }
            
            // Ï†ïÏàò Î∂ÄÎ∂ÑÏóê ÏΩ§Îßà Ï∂îÍ∞Ä
            if (cleaned) {
                const [intPart, decPart] = cleaned.split('.');
                const formattedInt = parseInt(intPart || 0).toLocaleString('ko-KR');
                return decPart !== undefined ? formattedInt + '.' + decPart : formattedInt;
            }
            
            return cleaned;
        }

        function toggleUnitPriceSort() {
            unitPriceSortOrder = unitPriceSortOrder === 'desc' ? 'asc' : 'desc';
            updateUnitPriceTable();
        }

        function updateUnitPriceTable() {
            const container = document.getElementById('unitPriceResultTable');
            if (!container) return;
            
            // Ïú†Ìö®Ìïú ÏïÑÏù¥ÌÖúÎßå ÌïÑÌÑ∞ÎßÅ (Ïù¥Î¶Ñ, Í∞ÄÍ≤©, ÏàòÎüâÏù¥ Î™®Îëê ÏûàÎäî Í≤É)
            const validItems = unitPriceItems.filter(item => {
                const price = parseFloat(item.price.replace(/,/g, '')) || 0;
                const quantity = parseFloat(item.quantity.replace(/,/g, '')) || 0;
                return item.name && price > 0 && quantity > 0;
            }).map(item => {
                const price = parseFloat(item.price.replace(/,/g, ''));
                const quantity = parseFloat(item.quantity.replace(/,/g, ''));
                return {
                    ...item,
                    priceNum: price,
                    quantityNum: quantity,
                    unitPrice: price / quantity
                };
            });
            
            if (validItems.length === 0) {
                container.innerHTML = `
                    <div class="unit-price-empty">
                        <i class="fas fa-box-open"></i>
                        ÌíàÎ™©ÏùÑ Ï∂îÍ∞ÄÌïòÎ©¥ Îã®Í∞Ä ÎπÑÍµêÌëúÍ∞Ä ÌëúÏãúÎê©ÎãàÎã§
                    </div>
                `;
                return;
            }
            
            // Îã®Í∞Ä Í∏∞Ï§Ä Ï†ïÎ†¨
            validItems.sort((a, b) => {
                return unitPriceSortOrder === 'desc' 
                    ? b.unitPrice - a.unitPrice 
                    : a.unitPrice - b.unitPrice;
            });
            
            const sortIcon = unitPriceSortOrder === 'desc' ? '‚Üì' : '‚Üë';
            
            container.innerHTML = `
                <table class="unit-price-table">
                    <thead>
                        <tr>
                            <th>ÌíàÎ™©Î™Ö</th>
                            <th>Í∞ÄÍ≤©</th>
                            <th>ÏàòÎüâ</th>
                            <th class="sortable active" onclick="toggleUnitPriceSort()">
                                Îã®Í∞Ä <span class="sort-icon">${sortIcon}</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        ${validItems.map(item => `
                            <tr>
                                <td class="item-name">${item.name}</td>
                                <td>${item.priceNum.toLocaleString('ko-KR')}</td>
                                <td>${item.quantityNum.toLocaleString('ko-KR')}</td>
                                <td class="unit-price-value">${item.unitPrice.toLocaleString('ko-KR', { maximumFractionDigits: 2 })}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        let dividendList = [];
        let dividendIdCounter = 0;

        function getDividendCalculator() {
            return `
                <style>
                    .dividend-container {
                        display: flex;
                        flex-direction: column;
                        gap: 30px;
                    }
                    .dividend-form-section {
                        background: #f8fafc;
                        padding: 25px;
                        border-radius: 15px;
                    }
                    .dividend-form-row {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 20px;
                    }
                    .dividend-form-row-3 {
                        display: grid;
                        grid-template-columns: 1fr 1fr 1fr;
                        gap: 20px;
                    }
                    .dividend-result-section {
                        display: none;
                    }
                    .dividend-result-section.active {
                        display: block;
                        animation: fadeIn 0.5s ease;
                    }
                    .dividend-summary {
                        display: grid;
                        grid-template-columns: repeat(4, 1fr);
                        gap: 15px;
                        margin-bottom: 30px;
                    }
                    .dividend-summary-card {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        padding: 20px;
                        border-radius: 15px;
                        color: white;
                        text-align: center;
                    }
                    .dividend-summary-card.pretax {
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                    }
                    .dividend-summary-card.tax {
                        background: linear-gradient(135deg, #fc8181 0%, #f56565 100%);
                    }
                    .dividend-summary-card.aftertax {
                        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
                    }
                    .dividend-summary-card.monthly {
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                    }
                    .dividend-summary-label {
                        font-size: 13px;
                        opacity: 0.9;
                        margin-bottom: 8px;
                    }
                    .dividend-summary-value {
                        font-size: 18px;
                        font-weight: 700;
                    }
                    .dividend-list-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                    }
                    .dividend-list-header {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 20px;
                        padding-bottom: 15px;
                        border-bottom: 2px solid #e2e8f0;
                    }
                    .dividend-list-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .dividend-list-title i {
                        color: #667eea;
                    }
                    .dividend-clear-all-btn {
                        background: #fc8181;
                        color: white;
                        border: none;
                        padding: 10px 20px;
                        border-radius: 10px;
                        font-size: 14px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    .dividend-clear-all-btn:hover {
                        background: #f56565;
                        transform: translateY(-2px);
                    }
                    .dividend-table {
                        width: 100%;
                        border-collapse: collapse;
                        font-size: 14px;
                    }
                    .dividend-table th {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 12px 10px;
                        text-align: center;
                        font-weight: 600;
                        white-space: nowrap;
                    }
                    .dividend-table th:first-child {
                        border-radius: 10px 0 0 0;
                    }
                    .dividend-table th:last-child {
                        border-radius: 0 10px 0 0;
                    }
                    .dividend-table td {
                        padding: 12px 10px;
                        text-align: center;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .dividend-table tr:hover {
                        background: #f7fafc;
                    }
                    .dividend-country-badge {
                        display: inline-block;
                        padding: 4px 10px;
                        border-radius: 20px;
                        font-size: 12px;
                        font-weight: 600;
                    }
                    .dividend-country-badge.korea {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                    }
                    .dividend-country-badge.usa {
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                        color: white;
                    }
                    .dividend-delete-btn {
                        background: #fc8181;
                        color: white;
                        border: none;
                        padding: 6px 12px;
                        border-radius: 8px;
                        font-size: 12px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    }
                    .dividend-delete-btn:hover {
                        background: #f56565;
                        transform: scale(1.05);
                    }
                    .pretax-cell {
                        color: #4facfe;
                        font-weight: 600;
                    }
                    .aftertax-cell {
                        color: #38a169;
                        font-weight: 600;
                    }
                    .dividend-empty {
                        text-align: center;
                        padding: 40px;
                        color: #a0aec0;
                        font-size: 16px;
                    }
                    .dividend-chart-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                    }
                    .dividend-chart-grid {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 30px;
                        align-items: center;
                    }
                    .dividend-tips-container {
                        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                    }
                    .dividend-tips-title {
                        font-size: 18px;
                        font-weight: 600;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .dividend-tips-title i {
                        color: #ffd700;
                    }
                    .dividend-terms-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        margin-bottom: 25px;
                    }
                    .dividend-term-card {
                        background: rgba(255,255,255,0.1);
                        padding: 18px;
                        border-radius: 12px;
                        backdrop-filter: blur(10px);
                    }
                    .dividend-term-name {
                        font-weight: 700;
                        font-size: 15px;
                        margin-bottom: 8px;
                        color: #ffd700;
                    }
                    .dividend-term-desc {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .dividend-top10-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .dividend-top10-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    .dividend-top10-grid {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 20px;
                    }
                    .dividend-top10-list {
                        background: rgba(255,255,255,0.05);
                        border-radius: 12px;
                        padding: 15px;
                    }
                    .dividend-top10-list-title {
                        font-weight: 700;
                        margin-bottom: 12px;
                        padding-bottom: 10px;
                        border-bottom: 1px solid rgba(255,255,255,0.1);
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    .dividend-top10-item {
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        padding: 8px 0;
                        border-bottom: 1px solid rgba(255,255,255,0.05);
                        font-size: 13px;
                    }
                    .dividend-top10-item:last-child {
                        border-bottom: none;
                    }
                    .dividend-top10-rank {
                        background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
                        color: #1a1a2e;
                        width: 22px;
                        height: 22px;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-weight: 700;
                        font-size: 11px;
                        margin-right: 10px;
                    }
                    .dividend-top10-name {
                        flex: 1;
                    }
                    .dividend-top10-yield {
                        font-weight: 700;
                        color: #38ef7d;
                    }
                    .dividend-note {
                        margin-top: 20px;
                        padding: 15px;
                        background: rgba(255,215,0,0.1);
                        border-radius: 10px;
                        border-left: 4px solid #ffd700;
                        font-size: 13px;
                        line-height: 1.6;
                    }
                    .dividend-table-wrapper {
                        overflow-x: auto;
                        -webkit-overflow-scrolling: touch;
                        margin: 0 -10px;
                        padding: 0 10px;
                    }
                    .dividend-table {
                        min-width: 600px;
                    }
                    @media (max-width: 768px) {
                        .dividend-summary {
                            grid-template-columns: repeat(2, 1fr);
                        }
                        .dividend-form-row, .dividend-form-row-3 {
                            grid-template-columns: 1fr;
                        }
                        .dividend-terms-grid, .dividend-top10-grid, .dividend-chart-grid {
                            grid-template-columns: 1fr;
                        }
                        .dividend-summary-value {
                            font-size: 15px;
                        }
                        .dividend-list-container {
                            padding: 15px;
                        }
                        .dividend-table {
                            font-size: 12px;
                            min-width: 550px;
                        }
                        .dividend-table th, .dividend-table td {
                            padding: 8px 5px;
                        }
                        .dividend-list-header {
                            flex-direction: column;
                            gap: 10px;
                            align-items: flex-start;
                        }
                    }
                    @media (max-width: 480px) {
                        .dividend-summary {
                            grid-template-columns: 1fr;
                        }
                        .dividend-list-container {
                            padding: 10px;
                        }
                        .dividend-table {
                            font-size: 11px;
                            min-width: 500px;
                        }
                        .dividend-table th, .dividend-table td {
                            padding: 6px 4px;
                        }
                        .dividend-country-badge {
                            padding: 3px 6px;
                            font-size: 10px;
                        }
                        .dividend-delete-btn {
                            padding: 4px 8px;
                            font-size: 10px;
                        }
                    }
                </style>
                <div class="dividend-container">
                    <div class="dividend-form-section">
                        <form class="calc-form" onsubmit="calculateDividend(event)">
                            <div class="dividend-form-row">
                                <div class="form-group">
                                    <label><i class="fas fa-globe" style="color: #667eea; margin-right: 8px;"></i>Ìà¨Ïûê Íµ≠Í∞Ä</label>
                                    <select id="dividendCountry" onchange="updateDividendCurrency()">
                                        <option value="korea">üá∞üá∑ ÌïúÍµ≠</option>
                                        <option value="usa">üá∫üá∏ ÎØ∏Íµ≠</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-chart-pie" style="color: #667eea; margin-right: 8px;"></i>Ìà¨Ïûê Ïú†Ìòï</label>
                                    <select id="dividendType">
                                        <option value="etf">ETF</option>
                                        <option value="stock">Í∞úÎ≥Ñ Ï£ºÏãù</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label><i class="fas fa-tag" style="color: #667eea; margin-right: 8px;"></i>Ï¢ÖÎ™©Î™Ö</label>
                                <input type="text" id="dividendName" placeholder="Ïòà: SCHD, TIGER Î∞∞ÎãπÏÑ±Ïû•" required>
                            </div>
                            <div class="dividend-form-row-3">
                                <div class="form-group">
                                    <label><i class="fas fa-layer-group" style="color: #667eea; margin-right: 8px;"></i>Î≥¥Ïú† Ï£ºÏãùÏàò</label>
                                    <input type="text" id="dividendShares" data-comma="true" placeholder="100" required>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-coins" style="color: #667eea; margin-right: 8px;"></i>1Ï£ºÎãπ Î∞∞ÎãπÍ∏à</label>
                                    <input type="text" id="dividendPerShare" data-comma="true" placeholder="1,000" required>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-won-sign" style="color: #667eea; margin-right: 8px;"></i>ÌÜµÌôî</label>
                                    <select id="dividendCurrency">
                                        <option value="KRW">Ïõê (KRW)</option>
                                        <option value="USD">Îã¨Îü¨ (USD)</option>
                                    </select>
                                </div>
                            </div>
                            <button type="submit" class="btn-calculate">
                                <i class="fas fa-plus-circle" style="margin-right: 8px;"></i>Î∞∞ÎãπÍ∏à Ï∂îÍ∞ÄÌïòÍ∏∞
                            </button>
                        </form>
                    </div>
                    
                    <div class="dividend-result-section" id="dividendResultSection">
                        <div class="dividend-summary" id="dividendSummary"></div>
                        <div class="dividend-chart-container">
                            <div class="dividend-list-title" style="margin-bottom: 20px;"><i class="fas fa-chart-pie"></i> Î∞∞ÎãπÍ∏à Î∂ÑÏÑù</div>
                            <div class="dividend-chart-grid">
                                <canvas id="dividendPieChart"></canvas>
                                <canvas id="dividendBarChart"></canvas>
                            </div>
                        </div>
                        <div class="dividend-list-container">
                            <div class="dividend-list-header">
                                <div class="dividend-list-title"><i class="fas fa-list"></i> Î∞∞ÎãπÍ∏à Î™©Î°ù</div>
                                <button class="dividend-clear-all-btn" onclick="clearAllDividends()">
                                    <i class="fas fa-trash"></i> Ï†ÑÏ≤¥ ÏÇ≠Ï†ú
                                </button>
                            </div>
                            <div id="dividendTableContainer"></div>
                        </div>
                    </div>
                    
                    <div class="dividend-tips-container">
                        <div class="dividend-tips-title"><i class="fas fa-book"></i> ETF/Î∞∞Îãπ Ìà¨Ïûê Ïö©Ïñ¥ ÏÇ¨Ï†Ñ</div>
                        <div class="dividend-terms-grid">
                            <div class="dividend-term-card">
                                <div class="dividend-term-name">üí∞ Î∞∞ÎãπÏàòÏùµÎ•† (Dividend Yield)</div>
                                <div class="dividend-term-desc">Ï£ºÍ∞Ä ÎåÄÎπÑ Ïó∞Í∞Ñ Î∞∞ÎãπÍ∏àÏùò ÎπÑÏú®. Î∞∞ÎãπÏàòÏùµÎ•† = (Ïó∞Í∞Ñ Î∞∞ÎãπÍ∏à √∑ ÌòÑÏû¨ Ï£ºÍ∞Ä) √ó 100</div>
                            </div>
                            <div class="dividend-term-card">
                                <div class="dividend-term-name">üìÖ Î∞∞ÎãπÎùΩÏùº (Ex-Dividend Date)</div>
                                <div class="dividend-term-desc">Ïù¥ ÎÇ†Ïßú Ïù¥Ï†ÑÏóê Ï£ºÏãùÏùÑ Î≥¥Ïú†Ìï¥Ïïº Î∞∞ÎãπÏùÑ Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§. Î∞∞ÎãπÎùΩÏùº ÎãπÏùº Îß§Ïàò Ïãú Î∞∞Îãπ Î∂àÍ∞Ä.</div>
                            </div>
                            <div class="dividend-term-card">
                                <div class="dividend-term-name">üìä Î∞∞ÎãπÏÑ±Ìñ• (Payout Ratio)</div>
                                <div class="dividend-term-desc">ÏàúÏù¥Ïùµ Ï§ë Î∞∞ÎãπÍ∏àÏúºÎ°ú ÏßÄÍ∏âÌïòÎäî ÎπÑÏú®. ÎÑàÎ¨¥ ÎÜíÏúºÎ©¥ ÏßÄÏÜçÍ∞ÄÎä•ÏÑ±Ïù¥ ÎÇÆÏùÑ Ïàò ÏûàÏäµÎãàÎã§.</div>
                            </div>
                            <div class="dividend-term-card">
                                <div class="dividend-term-name">üëë Î∞∞ÎãπÍ∑ÄÏ°± (Dividend Aristocrats)</div>
                                <div class="dividend-term-desc">25ÎÖÑ Ïù¥ÏÉÅ Ïó∞ÏÜçÏúºÎ°ú Î∞∞ÎãπÏùÑ Ïù∏ÏÉÅÌïú Í∏∞ÏóÖ. S&P 500 ÎÇ¥ Ïö∞Îüâ Î∞∞ÎãπÏ£ºÎì§ÏûÖÎãàÎã§.</div>
                            </div>
                            <div class="dividend-term-card">
                                <div class="dividend-term-name">üîÑ DRIP (Î∞∞Îãπ Ïû¨Ìà¨Ïûê)</div>
                                <div class="dividend-term-desc">Î∞∞ÎãπÍ∏àÏúºÎ°ú ÏûêÎèôÏúºÎ°ú Í∞ôÏùÄ Ï£ºÏãùÏùÑ Ïû¨Îß§ÏàòÌïòÎäî Ï†úÎèÑ. Î≥µÎ¶¨ Ìö®Í≥ºÎ•º Í∑πÎåÄÌôîÌï©ÎãàÎã§.</div>
                            </div>
                            <div class="dividend-term-card">
                                <div class="dividend-term-name">üíµ Ï¥ùÎ≥¥Ïàò (Expense Ratio)</div>
                                <div class="dividend-term-desc">ETF Ïö¥Ïö©Ïóê ÎìúÎäî ÎπÑÏö© ÎπÑÏú®. ÎÇÆÏùÑÏàòÎ°ù Ìà¨ÏûêÏûêÏóêÍ≤å Ïú†Î¶¨Ìï©ÎãàÎã§. (Ïòà: 0.03%~0.5%)</div>
                            </div>
                            <div class="dividend-term-card">
                                <div class="dividend-term-name">üá∞üá∑ ÌïúÍµ≠ Î∞∞ÎãπÏÑ∏ (15.4%)</div>
                                <div class="dividend-term-desc">Î∞∞ÎãπÏÜåÎìùÏÑ∏ 14% + ÏßÄÎ∞©ÏÜåÎìùÏÑ∏ 1.4%. Í∏àÏúµÏÜåÎìù 2Ï≤úÎßåÏõê Ï¥àÍ≥º Ïãú Ï¢ÖÌï©Í≥ºÏÑ∏.</div>
                            </div>
                            <div class="dividend-term-card">
                                <div class="dividend-term-name">üá∫üá∏ ÎØ∏Íµ≠ Î∞∞ÎãπÏÑ∏ (15%)</div>
                                <div class="dividend-term-desc">ÎØ∏Íµ≠ ÏõêÏ≤úÏßïÏàòÏÑ∏ 15%. ÌïúÎØ∏ Ï°∞ÏÑ∏Ï°∞ÏïΩÏúºÎ°ú Íµ≠ÎÇ¥ Ï∂îÍ∞Ä Í≥ºÏÑ∏ ÏóÜÏùå (2Ï≤úÎßåÏõê Ïù¥Ìïò).</div>
                            </div>
                        </div>
                        
                        <div class="dividend-top10-section">
                            <div class="dividend-top10-title"><i class="fas fa-trophy" style="color: #ffd700;"></i> ÏµúÍ∑º 10ÎÖÑ Í≥†Î∞∞Îãπ ETF TOP 10</div>
                            <div class="dividend-top10-grid">
                                <div class="dividend-top10-list">
                                    <div class="dividend-top10-list-title">üá∫üá∏ ÎØ∏Íµ≠ ETF</div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">1</span>
                                        <span class="dividend-top10-name">JEPI (JPÎ™®Í±¥ ÌîÑÎ¶¨ÎØ∏ÏóÑ)</span>
                                        <span class="dividend-top10-yield">~9.5%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">2</span>
                                        <span class="dividend-top10-name">QYLD (ÎÇòÏä§Îã• Ïª§Î≤ÑÎìúÏΩú)</span>
                                        <span class="dividend-top10-yield">~11.8%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">3</span>
                                        <span class="dividend-top10-name">RYLD (Îü¨ÏÖÄ Ïª§Î≤ÑÎìúÏΩú)</span>
                                        <span class="dividend-top10-yield">~12.5%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">4</span>
                                        <span class="dividend-top10-name">SCHD (ÏäàÏôë Î∞∞ÎãπÏÑ±Ïû•)</span>
                                        <span class="dividend-top10-yield">~3.5%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">5</span>
                                        <span class="dividend-top10-name">VYM (Î±ÖÍ∞ÄÎìú Í≥†Î∞∞Îãπ)</span>
                                        <span class="dividend-top10-yield">~3.0%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">6</span>
                                        <span class="dividend-top10-name">HDV (iShares Í≥†Î∞∞Îãπ)</span>
                                        <span class="dividend-top10-yield">~4.0%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">7</span>
                                        <span class="dividend-top10-name">SPYD (S&P500 Í≥†Î∞∞Îãπ)</span>
                                        <span class="dividend-top10-yield">~4.5%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">8</span>
                                        <span class="dividend-top10-name">DVY (iShares Î∞∞Îãπ)</span>
                                        <span class="dividend-top10-yield">~3.8%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">9</span>
                                        <span class="dividend-top10-name">DIVO (Ïï∞ÌîåÎ¶¨ÌååÏù¥)</span>
                                        <span class="dividend-top10-yield">~4.8%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">10</span>
                                        <span class="dividend-top10-name">NOBL (Î∞∞ÎãπÍ∑ÄÏ°±)</span>
                                        <span class="dividend-top10-yield">~2.0%</span>
                                    </div>
                                </div>
                                <div class="dividend-top10-list">
                                    <div class="dividend-top10-list-title">üá∞üá∑ ÌïúÍµ≠ ETF</div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">1</span>
                                        <span class="dividend-top10-name">TIGER ÎØ∏Íµ≠Î∞∞ÎãπÎã§Ïö∞Ï°¥Ïä§</span>
                                        <span class="dividend-top10-yield">~3.5%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">2</span>
                                        <span class="dividend-top10-name">KODEX Í≥†Î∞∞Îãπ</span>
                                        <span class="dividend-top10-yield">~5.0%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">3</span>
                                        <span class="dividend-top10-name">ARIRANG Í≥†Î∞∞ÎãπÏ£º</span>
                                        <span class="dividend-top10-yield">~4.8%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">4</span>
                                        <span class="dividend-top10-name">TIGER Î∞∞ÎãπÏÑ±Ïû•</span>
                                        <span class="dividend-top10-yield">~3.2%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">5</span>
                                        <span class="dividend-top10-name">KBSTAR Í≥†Î∞∞Îãπ</span>
                                        <span class="dividend-top10-yield">~4.5%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">6</span>
                                        <span class="dividend-top10-name">HANARO Í≥†Î∞∞Îãπ</span>
                                        <span class="dividend-top10-yield">~4.3%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">7</span>
                                        <span class="dividend-top10-name">KODEX Î∞∞ÎãπÏÑ±Ïû•</span>
                                        <span class="dividend-top10-yield">~2.8%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">8</span>
                                        <span class="dividend-top10-name">TIGER ÏùÄÌñâÍ≥†Î∞∞ÎãπÌîåÎü¨Ïä§</span>
                                        <span class="dividend-top10-yield">~6.0%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">9</span>
                                        <span class="dividend-top10-name">SOL ÎØ∏Íµ≠Î∞∞ÎãπÎã§Ïö∞Ï°¥Ïä§</span>
                                        <span class="dividend-top10-yield">~3.4%</span>
                                    </div>
                                    <div class="dividend-top10-item">
                                        <span class="dividend-top10-rank">10</span>
                                        <span class="dividend-top10-name">ACE ÎØ∏Íµ≠Î∞∞ÎãπÎã§Ïö∞Ï°¥Ïä§</span>
                                        <span class="dividend-top10-yield">~3.3%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="dividend-note">
                                <strong>üí° Î∞∞Îãπ Ìà¨Ïûê ÌåÅ:</strong> Î∞∞ÎãπÏàòÏùµÎ•†Îßå Î≥¥ÏßÄ ÎßêÍ≥† Î∞∞ÎãπÏÑ±Ïû•Î•†ÎèÑ Ìï®Íªò ÌôïÏù∏ÌïòÏÑ∏Ïöî. 
                                SCHDÏ≤òÎüº Î∞∞ÎãπÏàòÏùµÎ•†ÏùÄ ÎÇÆÏßÄÎßå 10ÎÖÑÍ∞Ñ Î∞∞ÎãπÏùÑ Íæ∏Ï§ÄÌûà Ïù∏ÏÉÅÌïú ETFÍ∞Ä Ïû•Í∏∞Ï†ÅÏúºÎ°ú Ïú†Î¶¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                                ÎòêÌïú, Í≥†Î∞∞Îãπ Ïª§Î≤ÑÎìúÏΩú ETF(QYLD, RYLD)Îäî Î∞∞ÎãπÏùÄ ÎÜíÏßÄÎßå Ï£ºÍ∞Ä ÏÉÅÏäπÏù¥ Ï†úÌïúÎêòÎØÄÎ°ú Ìà¨Ïûê Î™©Ï†ÅÏóê ÎßûÍ≤å ÏÑ†ÌÉùÌïòÏÑ∏Ïöî.
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function updateDividendCurrency() {
            const country = document.getElementById('dividendCountry').value;
            const currencySelect = document.getElementById('dividendCurrency');
            if (country === 'korea') {
                currencySelect.value = 'KRW';
            } else {
                currencySelect.value = 'USD';
            }
        }

        let dividendPieChartInstance = null;
        let dividendBarChartInstance = null;

        function calculateDividend(e) {
            e.preventDefault();
            const country = document.getElementById('dividendCountry').value;
            const type = document.getElementById('dividendType').value;
            const name = document.getElementById('dividendName').value;
            const shares = parseNumberFromComma(document.getElementById('dividendShares').value);
            const perShare = parseNumberFromComma(document.getElementById('dividendPerShare').value);
            const currency = document.getElementById('dividendCurrency').value;
            
            const yearlyDividend = shares * perShare;
            const taxRate = country === 'korea' ? 0.154 : 0.15;
            const taxAmount = yearlyDividend * taxRate;
            const netDividend = yearlyDividend - taxAmount;
            const monthlyDividend = netDividend / 12;
            
            // Add to list
            dividendIdCounter++;
            dividendList.push({
                id: dividendIdCounter,
                country: country,
                type: type,
                name: name,
                shares: shares,
                perShare: perShare,
                currency: currency,
                yearlyPretax: yearlyDividend,
                tax: taxAmount,
                yearlyAftertax: netDividend,
                monthly: monthlyDividend
            });
            
            updateDividendUI();
            
            // Clear form
            document.getElementById('dividendName').value = '';
            document.getElementById('dividendShares').value = '';
            document.getElementById('dividendPerShare').value = '';
        }

        function updateDividendUI() {
            const resultSection = document.getElementById('dividendResultSection');
            
            if (dividendList.length === 0) {
                resultSection.classList.remove('active');
                return;
            }
            
            resultSection.classList.add('active');
            
            // Calculate totals (convert USD to KRW for summary)
            const exchangeRate = 1320;
            let totalPretaxKRW = 0;
            let totalTaxKRW = 0;
            let totalAftertaxKRW = 0;
            
            dividendList.forEach(item => {
                const rate = item.currency === 'USD' ? exchangeRate : 1;
                totalPretaxKRW += item.yearlyPretax * rate;
                totalTaxKRW += item.tax * rate;
                totalAftertaxKRW += item.yearlyAftertax * rate;
            });
            
            const totalMonthlyKRW = totalAftertaxKRW / 12;
            
            // Update summary
            document.getElementById('dividendSummary').innerHTML = `
                <div class="dividend-summary-card pretax">
                    <div class="dividend-summary-label">Ïó∞Í∞Ñ Î∞∞ÎãπÍ∏à (ÏÑ∏Ï†Ñ)</div>
                    <div class="dividend-summary-value">${Math.round(totalPretaxKRW).toLocaleString()}Ïõê</div>
                </div>
                <div class="dividend-summary-card tax">
                    <div class="dividend-summary-label">Î∞∞ÎãπÏÜåÎìùÏÑ∏</div>
                    <div class="dividend-summary-value">-${Math.round(totalTaxKRW).toLocaleString()}Ïõê</div>
                </div>
                <div class="dividend-summary-card aftertax">
                    <div class="dividend-summary-label">Ïó∞Í∞Ñ Ïã§ÏàòÎ†πÏï°</div>
                    <div class="dividend-summary-value">${Math.round(totalAftertaxKRW).toLocaleString()}Ïõê</div>
                </div>
                <div class="dividend-summary-card monthly">
                    <div class="dividend-summary-label">Ïõî ÌèâÍ∑† Î∞∞ÎãπÍ∏à</div>
                    <div class="dividend-summary-value">${Math.round(totalMonthlyKRW).toLocaleString()}Ïõê</div>
                </div>
            `;
            
            // Update table
            let tableHTML = `
                <div class="dividend-table-wrapper">
                <table class="dividend-table">
                    <thead>
                        <tr>
                            <th>Íµ≠Í∞Ä</th>
                            <th>Ï¢ÖÎ™©Î™Ö</th>
                            <th>Ïú†Ìòï</th>
                            <th>Ï£ºÏãùÏàò</th>
                            <th>1Ï£ºÎãπ Î∞∞Îãπ</th>
                            <th>ÏÑ∏Ï†Ñ Î∞∞Îãπ</th>
                            <th>ÏÑ∏ÌõÑ Î∞∞Îãπ</th>
                            <th>ÏÇ≠Ï†ú</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            dividendList.forEach(item => {
                const currencySymbol = item.currency === 'USD' ? '$' : '';
                const currencySuffix = item.currency === 'KRW' ? 'Ïõê' : '';
                tableHTML += `
                    <tr>
                        <td><span class="dividend-country-badge ${item.country}">${item.country === 'korea' ? 'üá∞üá∑ ÌïúÍµ≠' : 'üá∫üá∏ ÎØ∏Íµ≠'}</span></td>
                        <td><strong>${item.name}</strong></td>
                        <td>${item.type === 'etf' ? 'ETF' : 'Ï£ºÏãù'}</td>
                        <td>${item.shares.toLocaleString()}Ï£º</td>
                        <td>${currencySymbol}${item.perShare.toLocaleString()}${currencySuffix}</td>
                        <td class="pretax-cell">${currencySymbol}${Math.round(item.yearlyPretax).toLocaleString()}${currencySuffix}</td>
                        <td class="aftertax-cell">${currencySymbol}${Math.round(item.yearlyAftertax).toLocaleString()}${currencySuffix}</td>
                        <td><button class="dividend-delete-btn" onclick="deleteDividend(${item.id})"><i class="fas fa-trash"></i></button></td>
                    </tr>
                `;
            });
            
            tableHTML += '</tbody></table></div>';
            document.getElementById('dividendTableContainer').innerHTML = tableHTML;
            
            // Update charts
            updateDividendCharts();
        }

        function updateDividendCharts() {
            const exchangeRate = 1320;
            
            // Prepare data for charts
            const labels = dividendList.map(item => item.name);
            const pretaxData = dividendList.map(item => {
                const rate = item.currency === 'USD' ? exchangeRate : 1;
                return Math.round(item.yearlyPretax * rate);
            });
            const aftertaxData = dividendList.map(item => {
                const rate = item.currency === 'USD' ? exchangeRate : 1;
                return Math.round(item.yearlyAftertax * rate);
            });
            
            // Pie chart
            const pieCtx = document.getElementById('dividendPieChart').getContext('2d');
            
            if (dividendPieChartInstance) {
                dividendPieChartInstance.destroy();
            }
            
            const colors = [
                '#667eea', '#f093fb', '#4facfe', '#fa709a', '#30cfd0',
                '#43e97b', '#ff9a9e', '#a1c4fd', '#ffecd2', '#d299c2'
            ];
            
            dividendPieChartInstance = new Chart(pieCtx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: aftertaxData,
                        backgroundColor: colors.slice(0, labels.length),
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: { size: 11 }
                            }
                        },
                        title: {
                            display: true,
                            text: 'Ï¢ÖÎ™©Î≥Ñ Î∞∞Îãπ ÎπÑÏ§ë',
                            font: { size: 14, weight: 'bold' }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const value = context.raw;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${context.label}: ${value.toLocaleString()}Ïõê (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
            
            // Bar chart
            const barCtx = document.getElementById('dividendBarChart').getContext('2d');
            
            if (dividendBarChartInstance) {
                dividendBarChartInstance.destroy();
            }
            
            dividendBarChartInstance = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'ÏÑ∏Ï†Ñ Î∞∞Îãπ',
                            data: pretaxData,
                            backgroundColor: 'rgba(79, 172, 254, 0.7)',
                            borderRadius: 5
                        },
                        {
                            label: 'ÏÑ∏ÌõÑ Î∞∞Îãπ',
                            data: aftertaxData,
                            backgroundColor: 'rgba(56, 239, 125, 0.7)',
                            borderRadius: 5
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                usePointStyle: true,
                                font: { size: 11 }
                            }
                        },
                        title: {
                            display: true,
                            text: 'ÏÑ∏Ï†Ñ/ÏÑ∏ÌõÑ Î∞∞Îãπ ÎπÑÍµê',
                            font: { size: 14, weight: 'bold' }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.raw.toLocaleString() + 'Ïõê';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    if (value >= 10000) {
                                        return (value / 10000).toFixed(0) + 'Îßå';
                                    }
                                    return value;
                                }
                            },
                            grid: { color: 'rgba(0, 0, 0, 0.05)' }
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        function deleteDividend(id) {
            dividendList = dividendList.filter(item => item.id !== id);
            updateDividendUI();
        }

        function clearAllDividends() {
            if (confirm('Î™®Îì† Î∞∞ÎãπÍ∏à Í∏∞Î°ùÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) {
                dividendList = [];
                updateDividendUI();
            }
        }

        function getExchangeCalculator() {
            return `
                <style>
                    .exchange-container {
                        display: flex;
                        flex-direction: column;
                        gap: 30px;
                    }
                    .exchange-header {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                        text-align: center;
                    }
                    .exchange-header-title {
                        font-size: 24px;
                        font-weight: 700;
                        margin-bottom: 10px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                    }
                    .exchange-update-time {
                        font-size: 14px;
                        opacity: 0.9;
                    }
                    .exchange-loading {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                        padding: 20px;
                        color: #667eea;
                        font-size: 16px;
                    }
                    .exchange-loading i {
                        animation: spin 1s linear infinite;
                    }
                    @keyframes spin {
                        from { transform: rotate(0deg); }
                        to { transform: rotate(360deg); }
                    }
                    .exchange-grid {
                        display: grid;
                        grid-template-columns: repeat(3, 1fr);
                        gap: 20px;
                    }
                    .currency-card {
                        background: white;
                        border-radius: 15px;
                        padding: 20px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        transition: all 0.3s ease;
                        border: 2px solid transparent;
                    }
                    .currency-card:hover {
                        transform: translateY(-5px);
                        box-shadow: 0 8px 25px rgba(0,0,0,0.15);
                    }
                    .currency-card.active {
                        border-color: #667eea;
                        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
                    }
                    .currency-header {
                        display: flex;
                        align-items: center;
                        gap: 12px;
                        margin-bottom: 15px;
                    }
                    .currency-flag {
                        font-size: 36px;
                        line-height: 1;
                    }
                    .currency-info {
                        flex: 1;
                    }
                    .currency-name {
                        font-size: 18px;
                        font-weight: 700;
                        color: #2d3748;
                    }
                    .currency-code {
                        font-size: 14px;
                        color: #718096;
                    }
                    .currency-input-wrapper {
                        position: relative;
                    }
                    .currency-input {
                        width: 100%;
                        padding: 15px;
                        padding-right: 60px;
                        border: 2px solid #e2e8f0;
                        border-radius: 10px;
                        font-size: 20px;
                        font-weight: 600;
                        color: #2d3748;
                        transition: all 0.3s ease;
                        text-align: right;
                    }
                    .currency-input:focus {
                        outline: none;
                        border-color: #667eea;
                        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
                    }
                    .currency-symbol {
                        position: absolute;
                        right: 15px;
                        top: 50%;
                        transform: translateY(-50%);
                        font-size: 16px;
                        font-weight: 600;
                        color: #718096;
                    }
                    .currency-rate {
                        margin-top: 12px;
                        padding-top: 12px;
                        border-top: 1px solid #e2e8f0;
                        font-size: 13px;
                        color: #718096;
                        display: flex;
                        justify-content: space-between;
                    }
                    .rate-value {
                        font-weight: 600;
                        color: #667eea;
                    }
                    .exchange-rate-table {
                        background: white;
                        border-radius: 15px;
                        padding: 25px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                    }
                    .rate-table-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .rate-table-title i {
                        color: #667eea;
                    }
                    .rate-table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    .rate-table th {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 12px 15px;
                        text-align: center;
                        font-weight: 600;
                        font-size: 14px;
                    }
                    .rate-table th:first-child {
                        border-radius: 10px 0 0 0;
                    }
                    .rate-table th:last-child {
                        border-radius: 0 10px 0 0;
                    }
                    .rate-table td {
                        padding: 12px 15px;
                        text-align: center;
                        border-bottom: 1px solid #e2e8f0;
                        font-size: 14px;
                    }
                    .rate-table tr:hover {
                        background: #f7fafc;
                    }
                    .rate-table .flag-cell {
                        font-size: 24px;
                    }
                    .rate-table .rate-cell {
                        font-weight: 600;
                        color: #667eea;
                    }
                    .exchange-tips {
                        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                    }
                    .exchange-tips-title {
                        font-size: 18px;
                        font-weight: 600;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .exchange-tips-title i {
                        color: #ffd700;
                    }
                    .exchange-tip-item {
                        background: rgba(255,255,255,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 10px;
                        border-left: 4px solid #ffd700;
                    }
                    .exchange-tip-item:last-child {
                        margin-bottom: 0;
                    }
                    .exchange-tip-title {
                        font-weight: 600;
                        margin-bottom: 5px;
                        color: #ffd700;
                    }
                    .exchange-tip-content {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .refresh-btn {
                        background: rgba(255,255,255,0.2);
                        border: none;
                        padding: 8px 16px;
                        border-radius: 8px;
                        color: white;
                        font-size: 14px;
                        cursor: pointer;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        margin-top: 15px;
                        transition: all 0.3s ease;
                    }
                    .refresh-btn:hover {
                        background: rgba(255,255,255,0.3);
                    }
                    .api-error {
                        background: #fed7d7;
                        color: #c53030;
                        padding: 15px;
                        border-radius: 10px;
                        text-align: center;
                        margin-bottom: 20px;
                    }
                    @media (max-width: 768px) {
                        .exchange-grid {
                            grid-template-columns: repeat(2, 1fr);
                        }
                        .currency-input {
                            font-size: 16px;
                            padding: 12px;
                            padding-right: 50px;
                        }
                        .currency-flag {
                            font-size: 28px;
                        }
                        .currency-name {
                            font-size: 16px;
                        }
                    }
                    @media (max-width: 480px) {
                        .exchange-grid {
                            grid-template-columns: 1fr;
                        }
                        .currency-card {
                            padding: 15px;
                        }
                        .rate-table {
                            font-size: 12px;
                        }
                        .rate-table th, .rate-table td {
                            padding: 8px 5px;
                        }
                    }
                </style>
                <div class="exchange-container">
                    <div class="exchange-header">
                        <div class="exchange-header-title">
                            <i class="fas fa-sync-alt"></i>
                            Ïã§ÏãúÍ∞Ñ ÌôòÏú® Í≥ÑÏÇ∞Í∏∞
                        </div>
                        <div class="exchange-update-time" id="exchangeUpdateTime">ÌôòÏú® Ï†ïÎ≥¥Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...</div>
                        <button class="refresh-btn" onclick="refreshExchangeRates()">
                            <i class="fas fa-redo"></i> ÌôòÏú® ÏÉàÎ°úÍ≥†Ïπ®
                        </button>
                    </div>
                    
                    <div id="exchangeError" class="api-error" style="display: none;"></div>
                    
                    <div class="exchange-grid" id="exchangeGrid">
                        <div class="exchange-loading">
                            <i class="fas fa-spinner"></i>
                            ÌôòÏú® Ï†ïÎ≥¥Î•º Î∂àÎü¨Ïò§Îäî Ï§ë...
                        </div>
                    </div>
                    
                    <div class="exchange-rate-table">
                        <div class="rate-table-title"><i class="fas fa-table"></i> ÌòÑÏû¨ ÌôòÏú®Ìëú (1 USD Í∏∞Ï§Ä)</div>
                        <table class="rate-table" id="rateTable">
                            <thead>
                                <tr>
                                    <th>Íµ≠Í∞Ä</th>
                                    <th>ÌÜµÌôî</th>
                                    <th>ÌôòÏú®</th>
                                    <th>1Îã®ÏúÑÎãπ ÏõêÌôî</th>
                                </tr>
                            </thead>
                            <tbody id="rateTableBody">
                                <tr><td colspan="4">Î°úÎî© Ï§ë...</td></tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="exchange-tips">
                        <div class="exchange-tips-title"><i class="fas fa-lightbulb"></i> ÌôòÏ†Ñ ÍøÄÌåÅ</div>
                        <div class="exchange-tip-item">
                            <div class="exchange-tip-title">üí± ÏùÄÌñâ vs ÌôòÏ†ÑÏÜå</div>
                            <div class="exchange-tip-content">ÏãúÏ§ë ÏùÄÌñâÎ≥¥Îã§ ÏÇ¨ÏÑ§ ÌôòÏ†ÑÏÜåÍ∞Ä ÎåÄÏ≤¥Î°ú ÌôòÏú®Ïù¥ Ï¢ãÏäµÎãàÎã§. Î™ÖÎèô, Í∞ïÎÇ® Îì± Í≤ΩÏüÅÏù¥ ÏπòÏó¥Ìïú ÏßÄÏó≠Ïùò ÌôòÏ†ÑÏÜåÎ•º Ïù¥Ïö©ÌïòÏÑ∏Ïöî.</div>
                        </div>
                        <div class="exchange-tip-item">
                            <div class="exchange-tip-title">üì± ÌôòÏú® Ïö∞ÎåÄ Ïø†Ìè∞</div>
                            <div class="exchange-tip-content">ÏùÄÌñâ Ïï±ÏóêÏÑú ÌôòÏú® Ïö∞ÎåÄ Ïø†Ìè∞(ÏµúÎåÄ 90%)ÏùÑ Î∞úÍ∏âÎ∞õÏúºÎ©¥ ÏàòÏàòÎ£åÎ•º ÌÅ¨Í≤å Ï†àÏïΩÌï† Ïàò ÏûàÏäµÎãàÎã§.</div>
                        </div>
                        <div class="exchange-tip-item">
                            <div class="exchange-tip-title">üí≥ Ìï¥Ïô∏ Í≤∞Ï†ú Ïπ¥Îìú</div>
                            <div class="exchange-tip-content">Ìä∏ÎûòÎ∏îÏõîÎ†õ, Ìä∏ÎûòÎ∏îÎ°úÍ∑∏ Îì± ÏàòÏàòÎ£å ÏóÜÎäî Ìï¥Ïô∏Í≤∞Ï†ú Ïπ¥ÎìúÎ•º ÌôúÏö©ÌïòÎ©¥ ÌôòÏ†Ñ ÏóÜÏù¥ ÌòÑÏßÄ Í≤∞Ï†úÍ∞Ä Í∞ÄÎä•Ìï©ÎãàÎã§.</div>
                        </div>
                        <div class="exchange-tip-item">
                            <div class="exchange-tip-title">üìä ÌôòÏú® ÌÉÄÏù¥Î∞ç</div>
                            <div class="exchange-tip-content">Í∏âÌïòÏßÄ ÏïäÎã§Î©¥ ÌôòÏú® Ï∂îÏù¥Î•º ÏßÄÏºúÎ≥¥Í≥† ÏõêÌôî Í∞ïÏÑ∏Ïùº Îïå ÌôòÏ†ÑÌïòÏÑ∏Ïöî. ÌôòÏú® ÏïåÎ¶º ÏÑúÎπÑÏä§Î•º ÌôúÏö©ÌïòÎ©¥ Ìé∏Î¶¨Ìï©ÎãàÎã§.</div>
                        </div>
                        <div class="exchange-tip-item">
                            <div class="exchange-tip-title">üè¶ Í≥µÌï≠ ÌôòÏ†Ñ ÌîºÌïòÍ∏∞</div>
                            <div class="exchange-tip-content">Í≥µÌï≠ ÌôòÏ†ÑÏÜåÎäî ÌôòÏú®Ïù¥ Í∞ÄÏû• Î∂àÎ¶¨Ìï©ÎãàÎã§. Ï∂úÍµ≠ Ï†Ñ ÎØ∏Î¶¨ ÌôòÏ†ÑÌïòÍ±∞ÎÇò ÌòÑÏßÄ ATMÏùÑ Ïù¥Ïö©ÌïòÏÑ∏Ïöî.</div>
                        </div>
                    </div>
                </div>
            `;
        }

        let exchangeRates = {};
        let baseCurrency = 'USD';
        
        const currencyData = {
            KRW: { flag: 'üá∞üá∑', name: 'ÎåÄÌïúÎØºÍµ≠', symbol: '‚Ç©', fullName: 'Ïõê' },
            USD: { flag: 'üá∫üá∏', name: 'ÎØ∏Íµ≠', symbol: '$', fullName: 'Îã¨Îü¨' },
            JPY: { flag: 'üáØüáµ', name: 'ÏùºÎ≥∏', symbol: '¬•', fullName: 'Ïóî' },
            GBP: { flag: 'üá¨üáß', name: 'ÏòÅÍµ≠', symbol: '¬£', fullName: 'ÌååÏö¥Îìú' },
            CNY: { flag: 'üá®üá≥', name: 'Ï§ëÍµ≠', symbol: '¬•', fullName: 'ÏúÑÏïà' },
            EUR: { flag: 'üá™üá∫', name: 'Ïú†ÎüΩ', symbol: '‚Ç¨', fullName: 'Ïú†Î°ú' }
        };

        async function fetchExchangeRates() {
            try {
                // Using exchangerate-api.com (free tier)
                const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
                const data = await response.json();
                
                exchangeRates = {
                    USD: 1,
                    KRW: data.rates.KRW,
                    JPY: data.rates.JPY,
                    GBP: data.rates.GBP,
                    CNY: data.rates.CNY,
                    EUR: data.rates.EUR
                };
                
                const updateTime = new Date().toLocaleString('ko-KR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                document.getElementById('exchangeUpdateTime').textContent = `ÎßàÏßÄÎßâ ÏóÖÎç∞Ïù¥Ìä∏: ${updateTime}`;
                document.getElementById('exchangeError').style.display = 'none';
                
                renderExchangeCards();
                renderRateTable();
                
            } catch (error) {
                console.error('ÌôòÏú® Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§:', error);
                document.getElementById('exchangeError').style.display = 'block';
                document.getElementById('exchangeError').textContent = 'ÌôòÏú® Ï†ïÎ≥¥Î•º Í∞ÄÏ†∏Ïò§ÎäîÎç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî.';
                
                // Use fallback rates
                exchangeRates = {
                    USD: 1,
                    KRW: 1380,
                    JPY: 157,
                    GBP: 0.79,
                    CNY: 7.24,
                    EUR: 0.92
                };
                
                document.getElementById('exchangeUpdateTime').textContent = '‚ö†Ô∏è ÏûÑÏãú ÌôòÏú® ÏÇ¨Ïö© Ï§ë (API Ïó∞Í≤∞ Ïã§Ìå®)';
                renderExchangeCards();
                renderRateTable();
            }
        }

        function renderExchangeCards() {
            const grid = document.getElementById('exchangeGrid');
            const currencies = ['KRW', 'USD', 'JPY', 'GBP', 'CNY', 'EUR'];
            
            grid.innerHTML = currencies.map(code => {
                const currency = currencyData[code];
                const rateToKRW = exchangeRates.KRW / exchangeRates[code];
                
                return `
                    <div class="currency-card" id="card-${code}">
                        <div class="currency-header">
                            <span class="currency-flag">${currency.flag}</span>
                            <div class="currency-info">
                                <div class="currency-name">${currency.name}</div>
                                <div class="currency-code">${code} (${currency.fullName})</div>
                            </div>
                        </div>
                        <div class="currency-input-wrapper">
                            <input type="text" 
                                   class="currency-input" 
                                   id="input-${code}" 
                                   placeholder="0"
                                   oninput="handleCurrencyInput('${code}', this.value)"
                                   onfocus="setActiveCurrency('${code}')">
                            <span class="currency-symbol">${currency.symbol}</span>
                        </div>
                        <div class="currency-rate">
                            <span>1 ${code} =</span>
                            <span class="rate-value">${code === 'KRW' ? '1 KRW' : formatNumber(rateToKRW.toFixed(2)) + ' KRW'}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderRateTable() {
            const tbody = document.getElementById('rateTableBody');
            const currencies = ['KRW', 'JPY', 'GBP', 'CNY', 'EUR'];
            
            tbody.innerHTML = currencies.map(code => {
                const currency = currencyData[code];
                const rateFromUSD = exchangeRates[code];
                const rateToKRW = exchangeRates.KRW / exchangeRates[code];
                
                return `
                    <tr>
                        <td class="flag-cell">${currency.flag} ${currency.name}</td>
                        <td>${code}</td>
                        <td class="rate-cell">${formatNumber(rateFromUSD.toFixed(code === 'KRW' || code === 'JPY' ? 2 : 4))}</td>
                        <td class="rate-cell">${formatNumber(rateToKRW.toFixed(2))} Ïõê</td>
                    </tr>
                `;
            }).join('');
        }

        function formatNumber(num) {
            return parseFloat(num).toLocaleString('ko-KR', { maximumFractionDigits: 4 });
        }

        function handleCurrencyInput(fromCode, value) {
            // Remove commas and parse
            const numValue = parseFloat(value.replace(/,/g, '')) || 0;
            
            // Format input with commas
            const input = document.getElementById(`input-${fromCode}`);
            if (value && !isNaN(numValue)) {
                const cursorPos = input.selectionStart;
                const oldLength = input.value.length;
                
                // Only format if not currently typing decimal
                if (!value.endsWith('.')) {
                    const formatted = formatNumber(numValue);
                    input.value = formatted;
                    
                    // Adjust cursor position
                    const newLength = formatted.length;
                    const diff = newLength - oldLength;
                    input.setSelectionRange(cursorPos + diff, cursorPos + diff);
                }
            }
            
            // Convert to all other currencies
            const currencies = ['KRW', 'USD', 'JPY', 'GBP', 'CNY', 'EUR'];
            
            currencies.forEach(toCode => {
                if (toCode !== fromCode) {
                    const convertedValue = convertCurrency(numValue, fromCode, toCode);
                    const targetInput = document.getElementById(`input-${toCode}`);
                    if (targetInput) {
                        if (numValue === 0) {
                            targetInput.value = '';
                        } else {
                            // Format based on currency
                            if (toCode === 'KRW' || toCode === 'JPY') {
                                targetInput.value = formatNumber(Math.round(convertedValue));
                            } else {
                                targetInput.value = formatNumber(convertedValue.toFixed(2));
                            }
                        }
                    }
                }
            });
        }

        function convertCurrency(amount, fromCode, toCode) {
            if (!exchangeRates[fromCode] || !exchangeRates[toCode]) return 0;
            
            // Convert to USD first, then to target currency
            const usdAmount = amount / exchangeRates[fromCode];
            return usdAmount * exchangeRates[toCode];
        }

        function setActiveCurrency(code) {
            document.querySelectorAll('.currency-card').forEach(card => {
                card.classList.remove('active');
            });
            document.getElementById(`card-${code}`).classList.add('active');
        }

        function refreshExchangeRates() {
            document.getElementById('exchangeUpdateTime').textContent = 'ÌôòÏú® Ï†ïÎ≥¥Î•º ÏÉàÎ°úÍ≥†Ïπ®ÌïòÎäî Ï§ë...';
            fetchExchangeRates();
        }

        function initExchangeCalculator() {
            fetchExchangeRates();
        }

        function getWorldTimeCalculator() {
            return `
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px;">
                    <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 15px; color: white; text-align: center;">
                        <div style="font-size: 16px; margin-bottom: 10px;">üá∞üá∑ ÏÑúÏö∏</div>
                        <div id="timeSeoul" style="font-size: 28px; font-weight: 600;">--:--:--</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 20px; border-radius: 15px; color: white; text-align: center;">
                        <div style="font-size: 16px; margin-bottom: 10px;">üá∫üá∏ Îâ¥Ïöï</div>
                        <div id="timeNewYork" style="font-size: 28px; font-weight: 600;">--:--:--</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); padding: 20px; border-radius: 15px; color: white; text-align: center;">
                        <div style="font-size: 16px; margin-bottom: 10px;">üá¨üáß Îü∞Îçò</div>
                        <div id="timeLondon" style="font-size: 28px; font-weight: 600;">--:--:--</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); padding: 20px; border-radius: 15px; color: white; text-align: center;">
                        <div style="font-size: 16px; margin-bottom: 10px;">üáØüáµ ÎèÑÏøÑ</div>
                        <div id="timeTokyo" style="font-size: 28px; font-weight: 600;">--:--:--</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #30cfd0 0%, #330867 100%); padding: 20px; border-radius: 15px; color: white; text-align: center;">
                        <div style="font-size: 16px; margin-bottom: 10px;">üá®üá≥ Î≤†Ïù¥Ïßï</div>
                        <div id="timeBeijing" style="font-size: 28px; font-weight: 600;">--:--:--</div>
                    </div>
                    <div style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 20px; border-radius: 15px; color: #333; text-align: center;">
                        <div style="font-size: 16px; margin-bottom: 10px;">üá¶üá∫ ÏãúÎìúÎãà</div>
                        <div id="timeSydney" style="font-size: 28px; font-weight: 600;">--:--:--</div>
                    </div>
                </div>
            `;
        }

        let worldTimeInterval;

        function initWorldTime() {
            updateWorldTime();
            worldTimeInterval = setInterval(updateWorldTime, 1000);
        }

        function updateWorldTime() {
            const now = new Date();
            
            const formatTime = (date) => {
                return date.toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
            };
            
            document.getElementById('timeSeoul').textContent = formatTime(new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Seoul' })));
            document.getElementById('timeNewYork').textContent = formatTime(new Date(now.toLocaleString('en-US', { timeZone: 'America/New_York' })));
            document.getElementById('timeLondon').textContent = formatTime(new Date(now.toLocaleString('en-US', { timeZone: 'Europe/London' })));
            document.getElementById('timeTokyo').textContent = formatTime(new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Tokyo' })));
            document.getElementById('timeBeijing').textContent = formatTime(new Date(now.toLocaleString('en-US', { timeZone: 'Asia/Shanghai' })));
            document.getElementById('timeSydney').textContent = formatTime(new Date(now.toLocaleString('en-US', { timeZone: 'Australia/Sydney' })));
        }

        function getCapitalGainsTaxCalculator() {
            return `
                <style>
                    .cgt-container {
                        display: flex;
                        flex-direction: column;
                        gap: 30px;
                    }
                    .cgt-form-section {
                        background: #f8fafc;
                        padding: 25px;
                        border-radius: 15px;
                    }
                    .cgt-form-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        padding-bottom: 15px;
                        border-bottom: 2px solid #e2e8f0;
                    }
                    .cgt-form-title i {
                        color: #667eea;
                    }
                    .cgt-form-grid {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 20px;
                    }
                    .cgt-form-grid-3 {
                        display: grid;
                        grid-template-columns: 1fr 1fr 1fr;
                        gap: 20px;
                    }
                    .cgt-checkbox-group {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 15px;
                        margin-top: 10px;
                    }
                    .cgt-checkbox-item {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        background: white;
                        padding: 12px 16px;
                        border-radius: 10px;
                        border: 2px solid #e2e8f0;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    }
                    .cgt-checkbox-item:hover {
                        border-color: #667eea;
                    }
                    .cgt-checkbox-item.checked {
                        border-color: #667eea;
                        background: #ebf4ff;
                    }
                    .cgt-checkbox-item input {
                        width: 18px;
                        height: 18px;
                        cursor: pointer;
                    }
                    .cgt-checkbox-item label {
                        cursor: pointer;
                        font-size: 14px;
                        font-weight: 500;
                    }
                    .cgt-info-box {
                        background: linear-gradient(135deg, #ebf4ff 0%, #e0e7ff 100%);
                        padding: 15px;
                        border-radius: 10px;
                        margin-top: 15px;
                        border-left: 4px solid #667eea;
                    }
                    .cgt-info-box p {
                        font-size: 13px;
                        color: #4c51bf;
                        line-height: 1.6;
                    }
                    .cgt-result-section {
                        display: none;
                    }
                    .cgt-result-section.active {
                        display: block;
                        animation: fadeIn 0.5s ease;
                    }
                    .cgt-result-summary {
                        display: grid;
                        grid-template-columns: repeat(4, 1fr);
                        gap: 15px;
                        margin-bottom: 30px;
                    }
                    .cgt-summary-card {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        padding: 20px;
                        border-radius: 15px;
                        color: white;
                        text-align: center;
                    }
                    .cgt-summary-card.profit {
                        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
                    }
                    .cgt-summary-card.deduction {
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                    }
                    .cgt-summary-card.tax {
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                    }
                    .cgt-summary-card.total {
                        background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                    }
                    .cgt-summary-label {
                        font-size: 13px;
                        opacity: 0.9;
                        margin-bottom: 8px;
                    }
                    .cgt-summary-value {
                        font-size: 18px;
                        font-weight: 700;
                    }
                    .cgt-detail-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                    }
                    .cgt-detail-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .cgt-detail-title i {
                        color: #667eea;
                    }
                    .cgt-detail-table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    .cgt-detail-table th {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 12px 15px;
                        text-align: left;
                        font-weight: 600;
                    }
                    .cgt-detail-table th:first-child {
                        border-radius: 10px 0 0 0;
                    }
                    .cgt-detail-table th:last-child {
                        border-radius: 0 10px 0 0;
                        text-align: right;
                    }
                    .cgt-detail-table td {
                        padding: 12px 15px;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .cgt-detail-table td:last-child {
                        text-align: right;
                        font-weight: 600;
                    }
                    .cgt-detail-table tr:hover {
                        background: #f7fafc;
                    }
                    .cgt-detail-table tr.highlight {
                        background: #ebf4ff;
                    }
                    .cgt-detail-table tr.total-row {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                    }
                    .cgt-detail-table tr.total-row td {
                        border-bottom: none;
                        font-weight: 700;
                        font-size: 16px;
                    }
                    .cgt-rate-table-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                        overflow-x: auto;
                    }
                    .cgt-rate-table {
                        width: 100%;
                        border-collapse: collapse;
                        font-size: 13px;
                    }
                    .cgt-rate-table th {
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                        color: white;
                        padding: 10px;
                        text-align: center;
                        font-weight: 600;
                    }
                    .cgt-rate-table td {
                        padding: 10px;
                        text-align: center;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .cgt-rate-table tr.active-row {
                        background: #fef5f7;
                        font-weight: 600;
                    }
                    .cgt-tips-container {
                        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                    }
                    .cgt-tips-title {
                        font-size: 18px;
                        font-weight: 600;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .cgt-tips-title i {
                        color: #ffd700;
                    }
                    .cgt-terms-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        margin-bottom: 25px;
                    }
                    .cgt-term-card {
                        background: rgba(255,255,255,0.1);
                        padding: 18px;
                        border-radius: 12px;
                        backdrop-filter: blur(10px);
                    }
                    .cgt-term-name {
                        font-weight: 700;
                        font-size: 15px;
                        margin-bottom: 8px;
                        color: #ffd700;
                    }
                    .cgt-term-desc {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .cgt-exemption-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .cgt-exemption-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #38ef7d;
                    }
                    .cgt-exemption-item {
                        background: rgba(56,239,125,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 10px;
                        border-left: 4px solid #38ef7d;
                    }
                    .cgt-exemption-item-title {
                        font-weight: 600;
                        margin-bottom: 5px;
                        color: #38ef7d;
                    }
                    .cgt-exemption-item-content {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .cgt-save-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .cgt-save-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #ffd700;
                    }
                    .cgt-save-item {
                        background: rgba(255,215,0,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 10px;
                        border-left: 4px solid #ffd700;
                    }
                    .cgt-save-item-title {
                        font-weight: 600;
                        margin-bottom: 5px;
                        color: #ffd700;
                    }
                    .cgt-save-item-content {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .cgt-warning-box {
                        margin-top: 20px;
                        padding: 15px;
                        background: rgba(252,129,129,0.1);
                        border-radius: 10px;
                        border-left: 4px solid #fc8181;
                        font-size: 13px;
                        line-height: 1.6;
                    }
                    .exemption-badge {
                        display: inline-block;
                        background: linear-gradient(135deg, #38ef7d 0%, #11998e 100%);
                        color: white;
                        padding: 5px 12px;
                        border-radius: 20px;
                        font-size: 12px;
                        font-weight: 600;
                        margin-left: 10px;
                    }
                    @media (max-width: 768px) {
                        .cgt-result-summary {
                            grid-template-columns: repeat(2, 1fr);
                        }
                        .cgt-form-grid, .cgt-form-grid-3 {
                            grid-template-columns: 1fr;
                        }
                        .cgt-terms-grid {
                            grid-template-columns: 1fr;
                        }
                        .cgt-summary-value {
                            font-size: 15px;
                        }
                        .cgt-checkbox-group {
                            flex-direction: column;
                        }
                    }
                    @media (max-width: 480px) {
                        .cgt-result-summary {
                            grid-template-columns: 1fr;
                        }
                    }
                </style>
                <div class="cgt-container">
                    <div class="cgt-form-section">
                        <div class="cgt-form-title"><i class="fas fa-building"></i> Î∂ÄÎèôÏÇ∞ Ï†ïÎ≥¥</div>
                        <form class="calc-form" onsubmit="calculateCapitalGainsTax(event)">
                            <div class="cgt-form-grid">
                                <div class="form-group">
                                    <label><i class="fas fa-home" style="color: #667eea; margin-right: 8px;"></i>Î∂ÄÎèôÏÇ∞ Ï¢ÖÎ•ò</label>
                                    <select id="cgtPropertyType" onchange="updateCgtOptions()">
                                        <option value="apartment">ÏïÑÌååÌä∏</option>
                                        <option value="officetel">Ïò§ÌîºÏä§ÌÖî (Ï£ºÍ±∞Ïö©)</option>
                                        <option value="villa">ÎπåÎùº/Ïó∞Î¶Ω/Îã§ÏÑ∏ÎåÄ</option>
                                        <option value="house">Îã®ÎèÖÏ£ºÌÉù/Îã§Í∞ÄÍµ¨</option>
                                        <option value="officetel-commercial">Ïò§ÌîºÏä§ÌÖî (ÏóÖÎ¨¥Ïö©)</option>
                                        <option value="commercial">ÏÉÅÍ∞Ä/Ï†êÌè¨</option>
                                        <option value="land">ÌÜ†ÏßÄ/ÎïÖ</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-map-marker-alt" style="color: #667eea; margin-right: 8px;"></i>ÏßÄÏó≠ Íµ¨Î∂Ñ</label>
                                    <select id="cgtRegion">
                                        <option value="regulated">Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠</option>
                                        <option value="normal">ÎπÑÍ∑úÏ†úÏßÄÏó≠</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="cgt-form-title" style="margin-top: 25px;"><i class="fas fa-user"></i> Î≥¥Ïú† ÌòÑÌô©</div>
                            <div class="cgt-form-grid-3">
                                <div class="form-group">
                                    <label><i class="fas fa-home" style="color: #667eea; margin-right: 8px;"></i>Î≥¥Ïú† Ï£ºÌÉù Ïàò</label>
                                    <select id="cgtHouseCount" onchange="updateCgtOptions()">
                                        <option value="1">1Ï£ºÌÉù</option>
                                        <option value="2">2Ï£ºÌÉù</option>
                                        <option value="3">3Ï£ºÌÉù Ïù¥ÏÉÅ</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-calendar" style="color: #667eea; margin-right: 8px;"></i>Î≥¥Ïú† Í∏∞Í∞Ñ</label>
                                    <select id="cgtHoldingPeriod">
                                        <option value="0.5">1ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="1.5">1ÎÖÑ Ïù¥ÏÉÅ 2ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="2">2ÎÖÑ Ïù¥ÏÉÅ 3ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="3">3ÎÖÑ Ïù¥ÏÉÅ 4ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="5">4ÎÖÑ Ïù¥ÏÉÅ 5ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="7">5ÎÖÑ Ïù¥ÏÉÅ 10ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="10">10ÎÖÑ Ïù¥ÏÉÅ 15ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="15">15ÎÖÑ Ïù¥ÏÉÅ</option>
                                    </select>
                                </div>
                                <div class="form-group" id="cgtResidencePeriodGroup">
                                    <label><i class="fas fa-house-user" style="color: #667eea; margin-right: 8px;"></i>Ïã§Í±∞Ï£º Í∏∞Í∞Ñ</label>
                                    <select id="cgtResidencePeriod">
                                        <option value="0">Í±∞Ï£º ÏïàÌï®</option>
                                        <option value="1">1ÎÖÑ Ïù¥ÏÉÅ 2ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="2">2ÎÖÑ Ïù¥ÏÉÅ 3ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="3">3ÎÖÑ Ïù¥ÏÉÅ 4ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="5">5ÎÖÑ Ïù¥ÏÉÅ 10ÎÖÑ ÎØ∏Îßå</option>
                                        <option value="10">10ÎÖÑ Ïù¥ÏÉÅ</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="cgt-form-title" style="margin-top: 25px;"><i class="fas fa-won-sign"></i> Í∏àÏï° Ï†ïÎ≥¥</div>
                            <div class="cgt-form-grid">
                                <div class="form-group">
                                    <label><i class="fas fa-arrow-down" style="color: #667eea; margin-right: 8px;"></i>Ï∑®ÎìùÍ∞ÄÏï° (Ïõê)</label>
                                    <input type="text" id="cgtAcquisitionPrice" data-comma="true" placeholder="500,000,000" required>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-arrow-up" style="color: #667eea; margin-right: 8px;"></i>ÏñëÎèÑÍ∞ÄÏï° (Ïõê)</label>
                                    <input type="text" id="cgtSalePrice" data-comma="true" placeholder="800,000,000" required>
                                </div>
                            </div>
                            <div class="cgt-form-grid">
                                <div class="form-group">
                                    <label><i class="fas fa-file-invoice-dollar" style="color: #667eea; margin-right: 8px;"></i>Ï∑®Îìù Ïãú ÌïÑÏöîÍ≤ΩÎπÑ (Ïõê)</label>
                                    <input type="text" id="cgtAcquisitionCost" data-comma="true" placeholder="Ï∑®ÎìùÏÑ∏, Î≤ïÎ¨¥ÏÇ¨ÎπÑÏö© Îì±" value="0">
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-tools" style="color: #667eea; margin-right: 8px;"></i>ÏñëÎèÑ Ïãú ÌïÑÏöîÍ≤ΩÎπÑ (Ïõê)</label>
                                    <input type="text" id="cgtSaleCost" data-comma="true" placeholder="Ï§ëÍ∞úÏàòÏàòÎ£å, Ïù∏ÌÖåÎ¶¨Ïñ¥ Îì±" value="0">
                                </div>
                            </div>
                            
                            <div class="cgt-form-title" style="margin-top: 25px;"><i class="fas fa-gift"></i> ÏÑ∏Í∏à ÌäπÎ°Ä Ï†ÅÏö©</div>
                            <div class="cgt-checkbox-group">
                                <div class="cgt-checkbox-item" id="exemptionCheck1" onclick="toggleCheckbox('cgtExemption1')">
                                    <input type="checkbox" id="cgtExemption1">
                                    <label>1ÏÑ∏ÎåÄ 1Ï£ºÌÉù ÎπÑÍ≥ºÏÑ∏</label>
                                </div>
                                <div class="cgt-checkbox-item" id="exemptionCheck2" onclick="toggleCheckbox('cgtExemption2')">
                                    <input type="checkbox" id="cgtExemption2">
                                    <label>ÏùºÏãúÏ†Å 2Ï£ºÌÉù (Í∏∞Ï°¥Ï£ºÌÉù 3ÎÖÑ ÎÇ¥ Îß§ÎèÑ)</label>
                                </div>
                                <div class="cgt-checkbox-item" id="exemptionCheck3" onclick="toggleCheckbox('cgtExemption3')">
                                    <input type="checkbox" id="cgtExemption3">
                                    <label>ÏÉÅÏÜçÏ£ºÌÉù ÌäπÎ°Ä</label>
                                </div>
                                <div class="cgt-checkbox-item" id="exemptionCheck4" onclick="toggleCheckbox('cgtExemption4')">
                                    <input type="checkbox" id="cgtExemption4">
                                    <label>ÎÜçÏñ¥Ï¥åÏ£ºÌÉù ÌäπÎ°Ä</label>
                                </div>
                            </div>
                            <div class="cgt-info-box">
                                <p><strong>üí° 1ÏÑ∏ÎåÄ 1Ï£ºÌÉù ÎπÑÍ≥ºÏÑ∏ ÏöîÍ±¥:</strong> 2ÎÖÑ Ïù¥ÏÉÅ Î≥¥Ïú† (Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠: 2ÎÖÑ Ïù¥ÏÉÅ Í±∞Ï£º ÌïÑÏàò), ÏñëÎèÑÍ∞ÄÏï° 12ÏñµÏõê Ïù¥Ìïò Ï†ÑÏï° ÎπÑÍ≥ºÏÑ∏, 12Ïñµ Ï¥àÍ≥ºÎ∂ÑÏùÄ Í≥ºÏÑ∏</p>
                            </div>
                            
                            <button type="submit" class="btn-calculate" style="margin-top: 25px;">
                                <i class="fas fa-calculator" style="margin-right: 8px;"></i>ÏñëÎèÑÏÜåÎìùÏÑ∏ Í≥ÑÏÇ∞ÌïòÍ∏∞
                            </button>
                        </form>
                    </div>
                    
                    <div class="cgt-result-section" id="cgtResultSection">
                        <div class="cgt-result-summary" id="cgtResultSummary"></div>
                        
                        <div class="cgt-detail-container">
                            <div class="cgt-detail-title"><i class="fas fa-list-alt"></i> ÏñëÎèÑÏÜåÎìùÏÑ∏ Í≥ÑÏÇ∞ ÏÉÅÏÑ∏</div>
                            <table class="cgt-detail-table" id="cgtDetailTable"></table>
                        </div>
                        
                        <div class="cgt-rate-table-container">
                            <div class="cgt-detail-title"><i class="fas fa-percentage"></i> ÏñëÎèÑÏÜåÎìùÏÑ∏ ÏÑ∏Ïú®Ìëú (2024ÎÖÑ Í∏∞Ï§Ä)</div>
                            <table class="cgt-rate-table" id="cgtRateTable"></table>
                        </div>
                    </div>
                    
                    <div class="cgt-tips-container">
                        <div class="cgt-tips-title"><i class="fas fa-book"></i> ÏñëÎèÑÏÜåÎìùÏÑ∏ Ïö©Ïñ¥ ÏÇ¨Ï†Ñ</div>
                        <div class="cgt-terms-grid">
                            <div class="cgt-term-card">
                                <div class="cgt-term-name">üìä ÏñëÎèÑÏ∞®Ïùµ</div>
                                <div class="cgt-term-desc">ÏñëÎèÑÍ∞ÄÏï°ÏóêÏÑú Ï∑®ÎìùÍ∞ÄÏï°Í≥º ÌïÑÏöîÍ≤ΩÎπÑÎ•º Î∫Ä Í∏àÏï°. Ïã§Ï†úÎ°ú Î≤à ÎèàÏùÑ ÏùòÎØ∏Ìï©ÎãàÎã§.</div>
                            </div>
                            <div class="cgt-term-card">
                                <div class="cgt-term-name">üìâ Ïû•Í∏∞Î≥¥Ïú†ÌäπÎ≥ÑÍ≥µÏ†ú</div>
                                <div class="cgt-term-desc">3ÎÖÑ Ïù¥ÏÉÅ Î≥¥Ïú† Ïãú ÏñëÎèÑÏ∞®ÏùµÏùò ÏùºÎ∂ÄÎ•º Í≥µÏ†ú. 1ÏÑ∏ÎåÄ 1Ï£ºÌÉùÏùÄ ÏµúÎåÄ 80%, ÏùºÎ∞òÏùÄ ÏµúÎåÄ 30%ÍπåÏßÄ Í≥µÏ†ú.</div>
                            </div>
                            <div class="cgt-term-card">
                                <div class="cgt-term-name">üéØ Í∏∞Î≥∏Í≥µÏ†ú</div>
                                <div class="cgt-term-desc">ÏñëÎèÑÏÜåÎìù Í≥ºÏÑ∏ÌëúÏ§ÄÏóêÏÑú Ïó∞ 250ÎßåÏõêÏùÑ Í≥µÏ†ú. Î™®Îì† ÏñëÎèÑÏóê Ï†ÅÏö©Îê©ÎãàÎã§.</div>
                            </div>
                            <div class="cgt-term-card">
                                <div class="cgt-term-name">üìç Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠</div>
                                <div class="cgt-term-desc">Ï†ïÎ∂ÄÍ∞Ä ÏßÄÏ†ïÌïú Ìà¨Í∏∞Í≥ºÏó¥ÏßÄÍµ¨ Î∞è Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠. ÏÑ∏Ïú® Ï§ëÍ≥º Î∞è Ïû•ÌäπÍ≥µÏ†ú Ï†úÌïúÏù¥ Ï†ÅÏö©Îê©ÎãàÎã§.</div>
                            </div>
                            <div class="cgt-term-card">
                                <div class="cgt-term-name">üè† 1ÏÑ∏ÎåÄ 1Ï£ºÌÉù</div>
                                <div class="cgt-term-desc">ÏÑ∏ÎåÄÏõê Ï†ÑÏõêÏù¥ 1Ï£ºÌÉùÎßå Î≥¥Ïú†. 2ÎÖÑ Ïù¥ÏÉÅ Î≥¥Ïú†(Ï°∞Ï†ïÏßÄÏó≠: Í±∞Ï£º ÌïÑÏàò) Ïãú ÎπÑÍ≥ºÏÑ∏ ÌòúÌÉù.</div>
                            </div>
                            <div class="cgt-term-card">
                                <div class="cgt-term-name">‚öñÔ∏è Îã§Ï£ºÌÉùÏûê Ï§ëÍ≥º</div>
                                <div class="cgt-term-desc">2Ï£ºÌÉùÏûê +20%p, 3Ï£ºÌÉùÏûê Ïù¥ÏÉÅ +30%p ÏÑ∏Ïú® Ï§ëÍ≥º (2024ÎÖÑ ÌïúÏãú Ïú†Ïòà Ï§ë).</div>
                            </div>
                            <div class="cgt-term-card">
                                <div class="cgt-term-name">üí∞ ÌïÑÏöîÍ≤ΩÎπÑ</div>
                                <div class="cgt-term-desc">Ï∑®ÎìùÏÑ∏, Îì±Í∏∞ÎπÑÏö©, Î≤ïÎ¨¥ÏÇ¨ÎπÑ, Ï§ëÍ∞úÏàòÏàòÎ£å, Ïù∏ÌÖåÎ¶¨Ïñ¥ÎπÑ(ÏûêÎ≥∏Ï†Å ÏßÄÏ∂ú) Îì± Ïù∏Ï†ïÎêòÎäî ÎπÑÏö©.</div>
                            </div>
                            <div class="cgt-term-card">
                                <div class="cgt-term-name">üè¢ ÎπÑÏÇ¨ÏóÖÏö© ÌÜ†ÏßÄ</div>
                                <div class="cgt-term-desc">ÎÜçÏßÄ, ÏûÑÏïº Îì± ÏÇ¨ÏóÖÏóê ÏÇ¨Ïö©ÌïòÏßÄ ÏïäÎäî ÌÜ†ÏßÄ. Í∏∞Î≥∏ÏÑ∏Ïú® +10%p Ï§ëÍ≥º Ï†ÅÏö©.</div>
                            </div>
                        </div>
                        
                        <div class="cgt-exemption-section">
                            <div class="cgt-exemption-title"><i class="fas fa-check-circle"></i> ÎπÑÍ≥ºÏÑ∏/Í∞êÎ©¥ ÏöîÍ±¥</div>
                            <div class="cgt-exemption-item">
                                <div class="cgt-exemption-item-title">üè† 1ÏÑ∏ÎåÄ 1Ï£ºÌÉù ÎπÑÍ≥ºÏÑ∏</div>
                                <div class="cgt-exemption-item-content">
                                    ‚Ä¢ 2ÎÖÑ Ïù¥ÏÉÅ Î≥¥Ïú† (Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠: 2ÎÖÑ Ïù¥ÏÉÅ Í±∞Ï£º ÌïÑÏàò)<br>
                                    ‚Ä¢ ÏñëÎèÑÍ∞ÄÏï° 12ÏñµÏõê Ïù¥Ìïò: Ï†ÑÏï° ÎπÑÍ≥ºÏÑ∏<br>
                                    ‚Ä¢ ÏñëÎèÑÍ∞ÄÏï° 12ÏñµÏõê Ï¥àÍ≥º: (ÏñëÎèÑÏ∞®Ïùµ √ó 12Ïñµ Ï¥àÍ≥ºÎ∂Ñ/ÏñëÎèÑÍ∞ÄÏï°) Îßå Í≥ºÏÑ∏<br>
                                    ‚Ä¢ 2017ÎÖÑ 8Ïõî 2Ïùº Ïù¥Ï†Ñ Ï∑®Îìù Ïãú Í±∞Ï£ºÏöîÍ±¥ Î©¥Ï†ú
                                </div>
                            </div>
                            <div class="cgt-exemption-item">
                                <div class="cgt-exemption-item-title">üîÑ ÏùºÏãúÏ†Å 2Ï£ºÌÉù ÎπÑÍ≥ºÏÑ∏</div>
                                <div class="cgt-exemption-item-content">
                                    ‚Ä¢ Ï¢ÖÏ†ÑÏ£ºÌÉù Ï∑®Îìù ÌõÑ 1ÎÖÑ Ïù¥ÏÉÅ ÏßÄÎÇòÏÑú Ïã†Í∑úÏ£ºÌÉù Ï∑®Îìù<br>
                                    ‚Ä¢ Ïã†Í∑úÏ£ºÌÉù Ï∑®Îìù ÌõÑ 3ÎÖÑ Ïù¥ÎÇ¥ Ï¢ÖÏ†ÑÏ£ºÌÉù Îß§ÎèÑ<br>
                                    ‚Ä¢ Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠: Ïã†Í∑úÏ£ºÌÉù Ï∑®Îìù ÌõÑ 2ÎÖÑ ÎÇ¥ Ï¢ÖÏ†ÑÏ£ºÌÉù Îß§ÎèÑ & Ïã†Í∑úÏ£ºÌÉù 1ÎÖÑ ÎÇ¥ Ï†ÑÏûÖ
                                </div>
                            </div>
                            <div class="cgt-exemption-item">
                                <div class="cgt-exemption-item-title">üë¥ ÏÉÅÏÜçÏ£ºÌÉù ÌäπÎ°Ä</div>
                                <div class="cgt-exemption-item-content">
                                    ‚Ä¢ ÏÉÅÏÜçÎ∞õÏùÄ Ï£ºÌÉùÏùÄ Ï£ºÌÉù ÏàòÏóêÏÑú Ï†úÏô∏ (5ÎÖÑÍ∞Ñ)<br>
                                    ‚Ä¢ ÌîºÏÉÅÏÜçÏù∏Ïù¥ 1ÏÑ∏ÎåÄ 1Ï£ºÌÉù ÏöîÍ±¥ Ï∂©Ï°± Ïãú ÏÉÅÏÜçÏù∏ÎèÑ ÎπÑÍ≥ºÏÑ∏ Í∞ÄÎä•
                                </div>
                            </div>
                            <div class="cgt-exemption-item">
                                <div class="cgt-exemption-item-title">üìà Ïû•Í∏∞Î≥¥Ïú†ÌäπÎ≥ÑÍ≥µÏ†úÏú®</div>
                                <div class="cgt-exemption-item-content">
                                    <strong>ÏùºÎ∞ò Î∂ÄÎèôÏÇ∞:</strong> 3ÎÖÑ 6% ‚Üí 15ÎÖÑ Ïù¥ÏÉÅ 30%<br>
                                    <strong>1ÏÑ∏ÎåÄ 1Ï£ºÌÉù (2ÎÖÑ Í±∞Ï£º):</strong> 3ÎÖÑ 24% ‚Üí 10ÎÖÑ Ïù¥ÏÉÅ 80%<br>
                                    ‚Äª Îã§Ï£ºÌÉùÏûê Ï°∞Ï†ïÏßÄÏó≠ Îß§ÎèÑ Ïãú Ïû•ÌäπÍ≥µÏ†ú Î∞∞Ï†ú
                                </div>
                            </div>
                        </div>
                        
                        <div class="cgt-save-section">
                            <div class="cgt-save-title"><i class="fas fa-piggy-bank"></i> ÏñëÎèÑÏÜåÎìùÏÑ∏ Ï†àÏÑ∏ ÌåÅ</div>
                            <div class="cgt-save-item">
                                <div class="cgt-save-item-title">1. 2ÎÖÑ Î≥¥Ïú†/Í±∞Ï£º ÏöîÍ±¥ Ï∂©Ï°±ÌïòÍ∏∞</div>
                                <div class="cgt-save-item-content">1ÏÑ∏ÎåÄ 1Ï£ºÌÉù ÎπÑÍ≥ºÏÑ∏Î•º ÏúÑÌï¥ Î∞òÎìúÏãú 2ÎÖÑ Ïù¥ÏÉÅ Î≥¥Ïú†ÌïòÍ≥†, Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠ÏùÄ Ïã§Í±∞Ï£º 2ÎÖÑÏùÑ Ï±ÑÏö∞ÏÑ∏Ïöî.</div>
                            </div>
                            <div class="cgt-save-item">
                                <div class="cgt-save-item-title">2. ÌïÑÏöîÍ≤ΩÎπÑ ÏòÅÏàòÏ¶ù Íº≠ Î≥¥Í¥Ä</div>
                                <div class="cgt-save-item-content">Ï∑®ÎìùÏÑ∏, Îì±Í∏∞ÎπÑÏö©, Ï§ëÍ∞úÏàòÏàòÎ£å, Ïù∏ÌÖåÎ¶¨Ïñ¥ÎπÑÏö©(ÏûêÎ≥∏Ï†Å ÏßÄÏ∂ú) Îì± Î™®Îì† ÏòÅÏàòÏ¶ùÏùÑ 10ÎÖÑÍ∞Ñ Î≥¥Í¥ÄÌïòÏÑ∏Ïöî.</div>
                            </div>
                            <div class="cgt-save-item">
                                <div class="cgt-save-item-title">3. Ïû•Í∏∞Î≥¥Ïú†ÌäπÎ≥ÑÍ≥µÏ†ú ÏµúÎåÄ ÌôúÏö©</div>
                                <div class="cgt-save-item-content">Í∞ÄÎä•ÌïòÎ©¥ 3ÎÖÑ Ïù¥ÏÉÅ Î≥¥Ïú†ÌïòÏó¨ Ïû•ÌäπÍ≥µÏ†úÎ•º Î∞õÏúºÏÑ∏Ïöî. 1ÏÑ∏ÎåÄ 1Ï£ºÌÉùÏùÄ 10ÎÖÑ Î≥¥Ïú†+Í±∞Ï£º Ïãú 80% Í≥µÏ†ú!</div>
                            </div>
                            <div class="cgt-save-item">
                                <div class="cgt-save-item-title">4. ÏñëÎèÑ ÏãúÍ∏∞ Ï°∞Ï†àÌïòÍ∏∞</div>
                                <div class="cgt-save-item-content">Ïó∞ÎßêÎ≥¥Îã§ Ïó∞Ï¥àÏóê ÏñëÎèÑÌïòÎ©¥ Í∏∞Î≥∏Í≥µÏ†ú 250ÎßåÏõêÏùÑ ÌôúÏö©ÌïòÍ∏∞ Ïú†Î¶¨Ìï©ÎãàÎã§. Îã§Î•∏ ÏñëÎèÑÏÜåÎìùÍ≥º Ìï©ÏÇ∞ÎêòÍ∏∞ ÎïåÎ¨∏ÏûÖÎãàÎã§.</div>
                            </div>
                            <div class="cgt-save-item">
                                <div class="cgt-save-item-title">5. ÏùºÏãúÏ†Å 2Ï£ºÌÉù ÌäπÎ°Ä ÌôúÏö©</div>
                                <div class="cgt-save-item-content">Ïù¥ÏÇ¨ Îì±ÏúºÎ°ú 2Ï£ºÌÉùÏù¥ Îêú Í≤ΩÏö∞, 3ÎÖÑ(Ï°∞Ï†ïÏßÄÏó≠ 2ÎÖÑ) ÎÇ¥ Í∏∞Ï°¥Ï£ºÌÉù Îß§ÎèÑ Ïãú ÎπÑÍ≥ºÏÑ∏ Ï†ÅÏö©Îê©ÎãàÎã§.</div>
                            </div>
                            <div class="cgt-save-item">
                                <div class="cgt-save-item-title">6. 2024ÎÖÑ Îã§Ï£ºÌÉùÏûê Ï§ëÍ≥º Ïú†Ïòà ÌôúÏö©</div>
                                <div class="cgt-save-item-content">ÌòÑÏû¨ Îã§Ï£ºÌÉùÏûê Ï§ëÍ≥ºÏÑ∏Ïú®Ïù¥ ÌïúÏãú Ïú†Ïòà Ï§ëÏûÖÎãàÎã§. Ï§ëÍ≥º Ïú†Ïòà Í∏∞Í∞Ñ ÎÇ¥ Îß§ÎèÑÎ•º Í≥†Î†§Ìï¥Î≥¥ÏÑ∏Ïöî.</div>
                            </div>
                        </div>
                        
                        <div class="cgt-warning-box">
                            <strong>‚ö†Ô∏è Ï£ºÏùòÏÇ¨Ìï≠:</strong><br>
                            ‚Ä¢ Î≥∏ Í≥ÑÏÇ∞Í∏∞Îäî Ï∞∏Í≥†Ïö©Ïù¥Î©∞, Ï†ïÌôïÌïú ÏÑ∏Í∏àÏùÄ ÏÑ∏Î¨¥ÏÇ¨ ÏÉÅÎã¥ÏùÑ Í∂åÏû•Ìï©ÎãàÎã§.<br>
                            ‚Ä¢ 2024ÎÖÑ ÌòÑÏû¨ Îã§Ï£ºÌÉùÏûê Ï§ëÍ≥ºÏÑ∏Ïú®ÏùÄ ÌïúÏãúÏ†ÅÏúºÎ°ú Ïú†ÏòàÎêòÏñ¥ Í∏∞Î≥∏ÏÑ∏Ïú®Ïù¥ Ï†ÅÏö©Îê©ÎãàÎã§.<br>
                            ‚Ä¢ Í∞úÏù∏ ÏÉÅÌô©Ïóê Îî∞Îùº Ï∂îÍ∞Ä Í∞êÎ©¥Ïù¥ÎÇò Ï§ëÍ≥ºÍ∞Ä Ï†ÅÏö©Îê† Ïàò ÏûàÏäµÎãàÎã§.<br>
                            ‚Ä¢ ÏßÄÎ∞©ÏÜåÎìùÏÑ∏(ÏñëÎèÑÏÑ∏Ïùò 10%)Í∞Ä Î≥ÑÎèÑÎ°ú Î∂ÄÍ≥ºÎê©ÎãàÎã§.
                        </div>
                    </div>
                </div>
            `;
        }

        function toggleCheckbox(id) {
            const checkbox = document.getElementById(id);
            checkbox.checked = !checkbox.checked;
            const parent = checkbox.closest('.cgt-checkbox-item');
            if (checkbox.checked) {
                parent.classList.add('checked');
            } else {
                parent.classList.remove('checked');
            }
        }

        function updateCgtOptions() {
            const propertyType = document.getElementById('cgtPropertyType').value;
            const houseCount = document.getElementById('cgtHouseCount').value;
            const residenceGroup = document.getElementById('cgtResidencePeriodGroup');
            
            // Ï£ºÍ±∞Ïö© Î∂ÄÎèôÏÇ∞Îßå Í±∞Ï£ºÍ∏∞Í∞Ñ ÌëúÏãú
            if (['apartment', 'officetel', 'villa', 'house'].includes(propertyType)) {
                residenceGroup.style.display = 'block';
            } else {
                residenceGroup.style.display = 'none';
            }
        }

        function calculateCapitalGainsTax(e) {
            e.preventDefault();
            
            const propertyType = document.getElementById('cgtPropertyType').value;
            const region = document.getElementById('cgtRegion').value;
            const houseCount = parseInt(document.getElementById('cgtHouseCount').value);
            const holdingPeriod = parseFloat(document.getElementById('cgtHoldingPeriod').value);
            const residencePeriod = parseFloat(document.getElementById('cgtResidencePeriod').value);
            
            const acquisitionPrice = parseNumberFromComma(document.getElementById('cgtAcquisitionPrice').value);
            const salePrice = parseNumberFromComma(document.getElementById('cgtSalePrice').value);
            const acquisitionCost = parseNumberFromComma(document.getElementById('cgtAcquisitionCost').value) || 0;
            const saleCost = parseNumberFromComma(document.getElementById('cgtSaleCost').value) || 0;
            
            const exemption1 = document.getElementById('cgtExemption1').checked; // 1ÏÑ∏ÎåÄ1Ï£ºÌÉù
            const exemption2 = document.getElementById('cgtExemption2').checked; // ÏùºÏãúÏ†Å2Ï£ºÌÉù
            
            const isResidential = ['apartment', 'officetel', 'villa', 'house'].includes(propertyType);
            
            // 1. ÏñëÎèÑÏ∞®Ïùµ Í≥ÑÏÇ∞
            const totalCost = acquisitionPrice + acquisitionCost + saleCost;
            let capitalGain = salePrice - totalCost;
            
            // 2. ÎπÑÍ≥ºÏÑ∏ Ïó¨Î∂Ä ÌôïÏù∏
            let isExempt = false;
            let exemptAmount = 0;
            let taxableGain = capitalGain;
            
            if (isResidential && houseCount === 1 && exemption1) {
                // 1ÏÑ∏ÎåÄ 1Ï£ºÌÉù ÎπÑÍ≥ºÏÑ∏ Ï°∞Í±¥ ÌôïÏù∏
                const meetsHoldingReq = holdingPeriod >= 2;
                const meetsResidenceReq = region === 'normal' || residencePeriod >= 2;
                
                if (meetsHoldingReq && meetsResidenceReq) {
                    if (salePrice <= 1200000000) {
                        // 12Ïñµ Ïù¥Ìïò Ï†ÑÏï° ÎπÑÍ≥ºÏÑ∏
                        isExempt = true;
                        exemptAmount = capitalGain;
                        taxableGain = 0;
                    } else {
                        // 12Ïñµ Ï¥àÍ≥ºÎ∂ÑÎßå Í≥ºÏÑ∏
                        const excessRatio = (salePrice - 1200000000) / salePrice;
                        taxableGain = Math.round(capitalGain * excessRatio);
                        exemptAmount = capitalGain - taxableGain;
                    }
                }
            }
            
            // ÏùºÏãúÏ†Å 2Ï£ºÌÉù ÎπÑÍ≥ºÏÑ∏
            if (exemption2 && houseCount === 2) {
                isExempt = true;
                exemptAmount = capitalGain;
                taxableGain = 0;
            }
            
            // 3. Ïû•Í∏∞Î≥¥Ïú†ÌäπÎ≥ÑÍ≥µÏ†ú Í≥ÑÏÇ∞
            let longTermDeductionRate = 0;
            let longTermDeduction = 0;
            
            if (taxableGain > 0 && holdingPeriod >= 3) {
                if (isResidential && houseCount === 1 && residencePeriod >= 2) {
                    // 1ÏÑ∏ÎåÄ 1Ï£ºÌÉù Ïû•ÌäπÍ≥µÏ†ú (Î≥¥Ïú†+Í±∞Ï£º)
                    const holdingRate = Math.min(Math.floor(holdingPeriod) * 4, 40); // Ïó∞ 4%, ÏµúÎåÄ 40%
                    const residenceRate = Math.min(Math.floor(residencePeriod) * 4, 40); // Ïó∞ 4%, ÏµúÎåÄ 40%
                    longTermDeductionRate = Math.min(holdingRate + residenceRate, 80);
                } else {
                    // ÏùºÎ∞ò Ïû•ÌäπÍ≥µÏ†ú
                    const years = Math.floor(holdingPeriod);
                    if (years >= 3 && years < 4) longTermDeductionRate = 6;
                    else if (years >= 4 && years < 5) longTermDeductionRate = 8;
                    else if (years >= 5 && years < 6) longTermDeductionRate = 10;
                    else if (years >= 6 && years < 7) longTermDeductionRate = 12;
                    else if (years >= 7 && years < 8) longTermDeductionRate = 14;
                    else if (years >= 8 && years < 9) longTermDeductionRate = 16;
                    else if (years >= 9 && years < 10) longTermDeductionRate = 18;
                    else if (years >= 10 && years < 11) longTermDeductionRate = 20;
                    else if (years >= 11 && years < 12) longTermDeductionRate = 22;
                    else if (years >= 12 && years < 13) longTermDeductionRate = 24;
                    else if (years >= 13 && years < 14) longTermDeductionRate = 26;
                    else if (years >= 14 && years < 15) longTermDeductionRate = 28;
                    else if (years >= 15) longTermDeductionRate = 30;
                }
                
                longTermDeduction = Math.round(taxableGain * longTermDeductionRate / 100);
            }
            
            // 4. Í≥ºÏÑ∏ÌëúÏ§Ä Í≥ÑÏÇ∞
            const afterLongTermDeduction = taxableGain - longTermDeduction;
            const basicDeduction = 2500000; // Í∏∞Î≥∏Í≥µÏ†ú 250ÎßåÏõê
            const taxBase = Math.max(afterLongTermDeduction - basicDeduction, 0);
            
            // 5. ÏÑ∏Ïú® Ï†ÅÏö©
            let taxRate = 0;
            let progressiveDeduction = 0;
            let additionalRate = 0;
            
            // Îã®Í∏∞ ÏñëÎèÑ (Ï£ºÌÉù)
            if (isResidential) {
                if (holdingPeriod < 1) {
                    taxRate = 70;
                } else if (holdingPeriod < 2) {
                    taxRate = 60;
                } else {
                    // Í∏∞Î≥∏ÏÑ∏Ïú®
                    if (taxBase <= 14000000) { taxRate = 6; progressiveDeduction = 0; }
                    else if (taxBase <= 50000000) { taxRate = 15; progressiveDeduction = 1260000; }
                    else if (taxBase <= 88000000) { taxRate = 24; progressiveDeduction = 5760000; }
                    else if (taxBase <= 150000000) { taxRate = 35; progressiveDeduction = 15440000; }
                    else if (taxBase <= 300000000) { taxRate = 38; progressiveDeduction = 19940000; }
                    else if (taxBase <= 500000000) { taxRate = 40; progressiveDeduction = 25940000; }
                    else if (taxBase <= 1000000000) { taxRate = 42; progressiveDeduction = 35940000; }
                    else { taxRate = 45; progressiveDeduction = 65940000; }
                }
            } else {
                // ÎπÑÏ£ºÍ±∞Ïö© (ÏÉÅÍ∞Ä, ÌÜ†ÏßÄ Îì±)
                if (holdingPeriod < 1) {
                    taxRate = 50;
                } else if (holdingPeriod < 2) {
                    taxRate = 40;
                } else {
                    // Í∏∞Î≥∏ÏÑ∏Ïú®
                    if (taxBase <= 14000000) { taxRate = 6; progressiveDeduction = 0; }
                    else if (taxBase <= 50000000) { taxRate = 15; progressiveDeduction = 1260000; }
                    else if (taxBase <= 88000000) { taxRate = 24; progressiveDeduction = 5760000; }
                    else if (taxBase <= 150000000) { taxRate = 35; progressiveDeduction = 15440000; }
                    else if (taxBase <= 300000000) { taxRate = 38; progressiveDeduction = 19940000; }
                    else if (taxBase <= 500000000) { taxRate = 40; progressiveDeduction = 25940000; }
                    else if (taxBase <= 1000000000) { taxRate = 42; progressiveDeduction = 35940000; }
                    else { taxRate = 45; progressiveDeduction = 65940000; }
                }
            }
            
            // 6. ÏÑ∏Ïï° Í≥ÑÏÇ∞
            let calculatedTax = 0;
            if (holdingPeriod < 2 && isResidential) {
                calculatedTax = Math.round(taxBase * taxRate / 100);
            } else {
                calculatedTax = Math.round(taxBase * taxRate / 100 - progressiveDeduction);
            }
            calculatedTax = Math.max(calculatedTax, 0);
            
            // ÏßÄÎ∞©ÏÜåÎìùÏÑ∏
            const localTax = Math.round(calculatedTax * 0.1);
            const totalTax = calculatedTax + localTax;
            
            // Í≤∞Í≥º ÌëúÏãú
            const resultSection = document.getElementById('cgtResultSection');
            resultSection.classList.add('active');
            
            // ÏöîÏïΩ Ïπ¥Îìú
            document.getElementById('cgtResultSummary').innerHTML = `
                <div class="cgt-summary-card profit">
                    <div class="cgt-summary-label">ÏñëÎèÑÏ∞®Ïùµ</div>
                    <div class="cgt-summary-value">${capitalGain.toLocaleString()}Ïõê</div>
                </div>
                <div class="cgt-summary-card deduction">
                    <div class="cgt-summary-label">Ïû•Í∏∞Î≥¥Ïú†ÌäπÎ≥ÑÍ≥µÏ†ú</div>
                    <div class="cgt-summary-value">-${longTermDeduction.toLocaleString()}Ïõê</div>
                </div>
                <div class="cgt-summary-card tax">
                    <div class="cgt-summary-label">ÏñëÎèÑÏÜåÎìùÏÑ∏</div>
                    <div class="cgt-summary-value">${calculatedTax.toLocaleString()}Ïõê</div>
                </div>
                <div class="cgt-summary-card total">
                    <div class="cgt-summary-label">Ï¥ù ÎÇ©Î∂ÄÏÑ∏Ïï° (ÏßÄÎ∞©ÏÑ∏ Ìè¨Ìï®)</div>
                    <div class="cgt-summary-value">${totalTax.toLocaleString()}Ïõê</div>
                </div>
            `;
            
            // ÏÉÅÏÑ∏ ÌÖåÏù¥Î∏î
            let exemptBadge = isExempt ? '<span class="exemption-badge">ÎπÑÍ≥ºÏÑ∏ Ï†ÅÏö©</span>' : '';
            if (exemptAmount > 0 && !isExempt) {
                exemptBadge = '<span class="exemption-badge">Î∂ÄÎ∂Ñ ÎπÑÍ≥ºÏÑ∏</span>';
            }
            
            document.getElementById('cgtDetailTable').innerHTML = `
                <thead>
                    <tr>
                        <th>Ìï≠Î™©</th>
                        <th>Í∏àÏï°</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ÏñëÎèÑÍ∞ÄÏï°</td>
                        <td>${salePrice.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>(-) Ï∑®ÎìùÍ∞ÄÏï°</td>
                        <td>${acquisitionPrice.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>(-) ÌïÑÏöîÍ≤ΩÎπÑ</td>
                        <td>${(acquisitionCost + saleCost).toLocaleString()}Ïõê</td>
                    </tr>
                    <tr class="highlight">
                        <td>= ÏñëÎèÑÏ∞®Ïùµ ${exemptBadge}</td>
                        <td>${capitalGain.toLocaleString()}Ïõê</td>
                    </tr>
                    ${exemptAmount > 0 ? `
                    <tr>
                        <td>(-) ÎπÑÍ≥ºÏÑ∏ ÏñëÎèÑÏ∞®Ïùµ</td>
                        <td>${exemptAmount.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>= Í≥ºÏÑ∏ÎåÄÏÉÅ ÏñëÎèÑÏ∞®Ïùµ</td>
                        <td>${taxableGain.toLocaleString()}Ïõê</td>
                    </tr>
                    ` : ''}
                    <tr>
                        <td>(-) Ïû•Í∏∞Î≥¥Ïú†ÌäπÎ≥ÑÍ≥µÏ†ú (${longTermDeductionRate}%)</td>
                        <td>${longTermDeduction.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>= ÏñëÎèÑÏÜåÎìùÍ∏àÏï°</td>
                        <td>${afterLongTermDeduction.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>(-) Í∏∞Î≥∏Í≥µÏ†ú</td>
                        <td>${basicDeduction.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr class="highlight">
                        <td>= Í≥ºÏÑ∏ÌëúÏ§Ä</td>
                        <td>${taxBase.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>Ï†ÅÏö©ÏÑ∏Ïú®</td>
                        <td>${taxRate}%</td>
                    </tr>
                    <tr>
                        <td>ÏÇ∞Ï∂úÏÑ∏Ïï° (ÏñëÎèÑÏÜåÎìùÏÑ∏)</td>
                        <td>${calculatedTax.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>(+) ÏßÄÎ∞©ÏÜåÎìùÏÑ∏ (10%)</td>
                        <td>${localTax.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr class="total-row">
                        <td>Ï¥ù ÎÇ©Î∂ÄÏÑ∏Ïï°</td>
                        <td>${totalTax.toLocaleString()}Ïõê</td>
                    </tr>
                </tbody>
            `;
            
            // ÏÑ∏Ïú®Ìëú
            const rateTableData = [
                { range: '1,400ÎßåÏõê Ïù¥Ìïò', rate: '6%', deduction: '-' },
                { range: '1,400ÎßåÏõê ~ 5,000ÎßåÏõê', rate: '15%', deduction: '126ÎßåÏõê' },
                { range: '5,000ÎßåÏõê ~ 8,800ÎßåÏõê', rate: '24%', deduction: '576ÎßåÏõê' },
                { range: '8,800ÎßåÏõê ~ 1.5ÏñµÏõê', rate: '35%', deduction: '1,544ÎßåÏõê' },
                { range: '1.5ÏñµÏõê ~ 3ÏñµÏõê', rate: '38%', deduction: '1,994ÎßåÏõê' },
                { range: '3ÏñµÏõê ~ 5ÏñµÏõê', rate: '40%', deduction: '2,594ÎßåÏõê' },
                { range: '5ÏñµÏõê ~ 10ÏñµÏõê', rate: '42%', deduction: '3,594ÎßåÏõê' },
                { range: '10ÏñµÏõê Ï¥àÍ≥º', rate: '45%', deduction: '6,594ÎßåÏõê' }
            ];
            
            let rateTableHTML = `
                <thead>
                    <tr>
                        <th>Í≥ºÏÑ∏ÌëúÏ§Ä</th>
                        <th>ÏÑ∏Ïú®</th>
                        <th>ÎàÑÏßÑÍ≥µÏ†ú</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            rateTableData.forEach((row, idx) => {
                const isActive = (idx === 0 && taxBase <= 14000000) ||
                    (idx === 1 && taxBase > 14000000 && taxBase <= 50000000) ||
                    (idx === 2 && taxBase > 50000000 && taxBase <= 88000000) ||
                    (idx === 3 && taxBase > 88000000 && taxBase <= 150000000) ||
                    (idx === 4 && taxBase > 150000000 && taxBase <= 300000000) ||
                    (idx === 5 && taxBase > 300000000 && taxBase <= 500000000) ||
                    (idx === 6 && taxBase > 500000000 && taxBase <= 1000000000) ||
                    (idx === 7 && taxBase > 1000000000);
                
                rateTableHTML += `
                    <tr class="${isActive ? 'active-row' : ''}">
                        <td>${row.range}</td>
                        <td>${row.rate}</td>
                        <td>${row.deduction}</td>
                    </tr>
                `;
            });
            
            rateTableHTML += '</tbody>';
            document.getElementById('cgtRateTable').innerHTML = rateTableHTML;
            
            // Í≤∞Í≥ºÎ°ú Ïä§ÌÅ¨Î°§
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // ÏΩ§Îßà ÏûÖÎ†• Ïû¨ÏÑ§Ï†ï
            setTimeout(() => setupCommaInputs(), 100);
        }

        function getAcquisitionTaxCalculator() {
            return `
                <style>
                    .acq-container {
                        display: flex;
                        flex-direction: column;
                        gap: 30px;
                    }
                    .acq-form-section {
                        background: #f8fafc;
                        padding: 25px;
                        border-radius: 15px;
                    }
                    .acq-form-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        padding-bottom: 15px;
                        border-bottom: 2px solid #e2e8f0;
                    }
                    .acq-form-title i {
                        color: #43e97b;
                    }
                    .acq-form-grid {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 20px;
                    }
                    .acq-form-grid-3 {
                        display: grid;
                        grid-template-columns: 1fr 1fr 1fr;
                        gap: 20px;
                    }
                    .acq-checkbox-group {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 15px;
                        margin-top: 10px;
                    }
                    .acq-checkbox-item {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        background: white;
                        padding: 12px 16px;
                        border-radius: 10px;
                        border: 2px solid #e2e8f0;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    }
                    .acq-checkbox-item:hover {
                        border-color: #43e97b;
                    }
                    .acq-checkbox-item.checked {
                        border-color: #43e97b;
                        background: #f0fff4;
                    }
                    .acq-checkbox-item input {
                        width: 18px;
                        height: 18px;
                        cursor: pointer;
                    }
                    .acq-checkbox-item label {
                        cursor: pointer;
                        font-size: 14px;
                        font-weight: 500;
                    }
                    .acq-info-box {
                        background: linear-gradient(135deg, #f0fff4 0%, #c6f6d5 100%);
                        padding: 15px;
                        border-radius: 10px;
                        margin-top: 15px;
                        border-left: 4px solid #43e97b;
                    }
                    .acq-info-box p {
                        font-size: 13px;
                        color: #276749;
                        line-height: 1.6;
                    }
                    .acq-result-section {
                        display: none;
                    }
                    .acq-result-section.active {
                        display: block;
                        animation: fadeIn 0.5s ease;
                    }
                    .acq-result-summary {
                        display: grid;
                        grid-template-columns: repeat(4, 1fr);
                        gap: 15px;
                        margin-bottom: 30px;
                    }
                    .acq-summary-card {
                        background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
                        padding: 20px;
                        border-radius: 15px;
                        color: white;
                        text-align: center;
                    }
                    .acq-summary-card.tax {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    }
                    .acq-summary-card.local {
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                    }
                    .acq-summary-card.special {
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                    }
                    .acq-summary-card.total {
                        background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                    }
                    .acq-summary-label {
                        font-size: 13px;
                        opacity: 0.9;
                        margin-bottom: 8px;
                    }
                    .acq-summary-value {
                        font-size: 18px;
                        font-weight: 700;
                    }
                    .acq-detail-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                    }
                    .acq-detail-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .acq-detail-title i {
                        color: #43e97b;
                    }
                    .acq-detail-table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    .acq-detail-table th {
                        background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
                        color: white;
                        padding: 12px 15px;
                        text-align: left;
                        font-weight: 600;
                    }
                    .acq-detail-table th:first-child {
                        border-radius: 10px 0 0 0;
                    }
                    .acq-detail-table th:last-child {
                        border-radius: 0 10px 0 0;
                        text-align: right;
                    }
                    .acq-detail-table td {
                        padding: 12px 15px;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .acq-detail-table td:last-child {
                        text-align: right;
                        font-weight: 600;
                    }
                    .acq-detail-table tr:hover {
                        background: #f7fafc;
                    }
                    .acq-detail-table tr.highlight {
                        background: #f0fff4;
                    }
                    .acq-detail-table tr.total-row {
                        background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
                        color: white;
                    }
                    .acq-detail-table tr.total-row td {
                        border-bottom: none;
                        font-weight: 700;
                        font-size: 16px;
                    }
                    .acq-rate-table-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                        overflow-x: auto;
                    }
                    .acq-rate-table {
                        width: 100%;
                        border-collapse: collapse;
                        font-size: 13px;
                    }
                    .acq-rate-table th {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 10px;
                        text-align: center;
                        font-weight: 600;
                    }
                    .acq-rate-table td {
                        padding: 10px;
                        text-align: center;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .acq-rate-table tr.active-row {
                        background: #ebf4ff;
                        font-weight: 600;
                    }
                    .acq-tips-container {
                        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                    }
                    .acq-tips-title {
                        font-size: 18px;
                        font-weight: 600;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .acq-tips-title i {
                        color: #ffd700;
                    }
                    .acq-terms-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        margin-bottom: 25px;
                    }
                    .acq-term-card {
                        background: rgba(255,255,255,0.1);
                        padding: 18px;
                        border-radius: 12px;
                        backdrop-filter: blur(10px);
                    }
                    .acq-term-name {
                        font-weight: 700;
                        font-size: 15px;
                        margin-bottom: 8px;
                        color: #ffd700;
                    }
                    .acq-term-desc {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .acq-exemption-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .acq-exemption-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #38ef7d;
                    }
                    .acq-exemption-item {
                        background: rgba(56,239,125,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 10px;
                        border-left: 4px solid #38ef7d;
                    }
                    .acq-exemption-item-title {
                        font-weight: 600;
                        margin-bottom: 5px;
                        color: #38ef7d;
                    }
                    .acq-exemption-item-content {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .acq-save-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .acq-save-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #ffd700;
                    }
                    .acq-save-item {
                        background: rgba(255,215,0,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 10px;
                        border-left: 4px solid #ffd700;
                    }
                    .acq-save-item-title {
                        font-weight: 600;
                        margin-bottom: 5px;
                        color: #ffd700;
                    }
                    .acq-save-item-content {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .acq-warning-box {
                        margin-top: 20px;
                        padding: 15px;
                        background: rgba(252,129,129,0.1);
                        border-radius: 10px;
                        border-left: 4px solid #fc8181;
                        font-size: 13px;
                        line-height: 1.6;
                    }
                    .exemption-badge {
                        display: inline-block;
                        background: linear-gradient(135deg, #38ef7d 0%, #11998e 100%);
                        color: white;
                        padding: 5px 12px;
                        border-radius: 20px;
                        font-size: 12px;
                        font-weight: 600;
                        margin-left: 10px;
                    }
                    .reduction-badge {
                        display: inline-block;
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                        color: white;
                        padding: 5px 12px;
                        border-radius: 20px;
                        font-size: 12px;
                        font-weight: 600;
                        margin-left: 10px;
                    }
                    .surcharge-badge {
                        display: inline-block;
                        background: linear-gradient(135deg, #fc8181 0%, #f56565 100%);
                        color: white;
                        padding: 5px 12px;
                        border-radius: 20px;
                        font-size: 12px;
                        font-weight: 600;
                        margin-left: 10px;
                    }
                    @media (max-width: 768px) {
                        .acq-result-summary {
                            grid-template-columns: repeat(2, 1fr);
                        }
                        .acq-form-grid, .acq-form-grid-3 {
                            grid-template-columns: 1fr;
                        }
                        .acq-terms-grid {
                            grid-template-columns: 1fr;
                        }
                        .acq-summary-value {
                            font-size: 15px;
                        }
                        .acq-checkbox-group {
                            flex-direction: column;
                        }
                    }
                    @media (max-width: 480px) {
                        .acq-result-summary {
                            grid-template-columns: 1fr;
                        }
                    }
                </style>
                <div class="acq-container">
                    <div class="acq-form-section">
                        <div class="acq-form-title"><i class="fas fa-building"></i> Î∂ÄÎèôÏÇ∞ Ï†ïÎ≥¥</div>
                        <form class="calc-form" onsubmit="calculateAcquisitionTax(event)">
                            <div class="acq-form-grid">
                                <div class="form-group">
                                    <label><i class="fas fa-home" style="color: #43e97b; margin-right: 8px;"></i>Î∂ÄÎèôÏÇ∞ Ï¢ÖÎ•ò</label>
                                    <select id="acqPropertyType" onchange="updateAcqOptions()">
                                        <option value="apartment">ÏïÑÌååÌä∏</option>
                                        <option value="officetel">Ïò§ÌîºÏä§ÌÖî (Ï£ºÍ±∞Ïö©)</option>
                                        <option value="villa">ÎπåÎùº/Ïó∞Î¶Ω/Îã§ÏÑ∏ÎåÄ</option>
                                        <option value="house">Îã®ÎèÖÏ£ºÌÉù/Îã§Í∞ÄÍµ¨</option>
                                        <option value="officetel-commercial">Ïò§ÌîºÏä§ÌÖî (ÏóÖÎ¨¥Ïö©)</option>
                                        <option value="commercial">ÏÉÅÍ∞Ä/Ï†êÌè¨</option>
                                        <option value="land">ÌÜ†ÏßÄ/ÎïÖ</option>
                                        <option value="farm-land">ÎÜçÏßÄ</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-exchange-alt" style="color: #43e97b; margin-right: 8px;"></i>Ï∑®Îìù Ïú†Ìòï</label>
                                    <select id="acqType" onchange="updateAcqOptions()">
                                        <option value="purchase">Îß§Îß§ (Ïú†ÏÉÅÏ∑®Îìù)</option>
                                        <option value="inheritance">ÏÉÅÏÜç</option>
                                        <option value="gift">Ï¶ùÏó¨</option>
                                        <option value="auction">Í≤ΩÎß§/Í≥µÎß§</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="acq-form-title" style="margin-top: 25px;"><i class="fas fa-map-marker-alt"></i> ÏßÄÏó≠ Î∞è Î≥¥Ïú† ÌòÑÌô©</div>
                            <div class="acq-form-grid-3">
                                <div class="form-group">
                                    <label><i class="fas fa-map" style="color: #43e97b; margin-right: 8px;"></i>ÏßÄÏó≠ Íµ¨Î∂Ñ</label>
                                    <select id="acqRegion">
                                        <option value="regulated">Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠</option>
                                        <option value="normal">ÎπÑÍ∑úÏ†úÏßÄÏó≠</option>
                                    </select>
                                </div>
                                <div class="form-group" id="acqHouseCountGroup">
                                    <label><i class="fas fa-home" style="color: #43e97b; margin-right: 8px;"></i>Î≥¥Ïú† Ï£ºÌÉù Ïàò (Ï∑®Îìù ÌõÑ)</label>
                                    <select id="acqHouseCount">
                                        <option value="1">1Ï£ºÌÉù</option>
                                        <option value="2">2Ï£ºÌÉù</option>
                                        <option value="3">3Ï£ºÌÉù</option>
                                        <option value="4">4Ï£ºÌÉù Ïù¥ÏÉÅ</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-user" style="color: #43e97b; margin-right: 8px;"></i>Ï∑®ÎìùÏûê Íµ¨Î∂Ñ</label>
                                    <select id="acqBuyerType">
                                        <option value="individual">Í∞úÏù∏</option>
                                        <option value="corporation">Î≤ïÏù∏</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="acq-form-title" style="margin-top: 25px;"><i class="fas fa-won-sign"></i> Ï∑®Îìù Í∏àÏï°</div>
                            <div class="acq-form-grid">
                                <div class="form-group">
                                    <label><i class="fas fa-tag" style="color: #43e97b; margin-right: 8px;"></i>Ï∑®ÎìùÍ∞ÄÏï° (Ïõê)</label>
                                    <input type="text" id="acqPrice" data-comma="true" placeholder="500,000,000" required>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-ruler-combined" style="color: #43e97b; margin-right: 8px;"></i>Ï†ÑÏö©Î©¥Ï†Å („é°)</label>
                                    <input type="text" id="acqArea" placeholder="84" value="84">
                                </div>
                            </div>
                            
                            <div class="acq-form-title" style="margin-top: 25px;"><i class="fas fa-gift"></i> ÏÑ∏Í∏à Í∞êÎ©¥/ÌäπÎ°Ä Ï†ÅÏö©</div>
                            <div class="acq-checkbox-group">
                                <div class="acq-checkbox-item" id="acqExemptCheck1" onclick="toggleAcqCheckbox('acqExemption1')">
                                    <input type="checkbox" id="acqExemption1">
                                    <label>ÏÉùÏï†ÏµúÏ¥à Ï£ºÌÉù Íµ¨ÏûÖ</label>
                                </div>
                                <div class="acq-checkbox-item" id="acqExemptCheck2" onclick="toggleAcqCheckbox('acqExemption2')">
                                    <input type="checkbox" id="acqExemption2">
                                    <label>Ïã†ÌòºÎ∂ÄÎ∂Ä (ÌòºÏù∏ 7ÎÖÑ Ïù¥ÎÇ¥)</label>
                                </div>
                                <div class="acq-checkbox-item" id="acqExemptCheck3" onclick="toggleAcqCheckbox('acqExemption3')">
                                    <input type="checkbox" id="acqExemption3">
                                    <label>Îã§ÏûêÎÖÄ Í∞ÄÍµ¨ (3ÏûêÎÖÄ Ïù¥ÏÉÅ)</label>
                                </div>
                                <div class="acq-checkbox-item" id="acqExemptCheck4" onclick="toggleAcqCheckbox('acqExemption4')">
                                    <input type="checkbox" id="acqExemption4">
                                    <label>ÎÜçÏñ¥Ï¥å Ï£ºÌÉù</label>
                                </div>
                            </div>
                            <div class="acq-info-box">
                                <p><strong>üí° ÏÉùÏï†ÏµúÏ¥à Ï£ºÌÉù Íµ¨ÏûÖ Í∞êÎ©¥:</strong> 2024ÎÖÑ Í∏∞Ï§Ä, ÏàòÎèÑÍ∂å 4Ïñµ¬∑ÎπÑÏàòÎèÑÍ∂å 3Ïñµ Ïù¥Ìïò Ï£ºÌÉù Ï∑®Îìù Ïãú Ï∑®ÎìùÏÑ∏ 100% Í∞êÎ©¥ (1.5Ïñµ ÌïúÎèÑ). Ï†ÑÏö©Î©¥Ï†Å 60„é° Ïù¥Ìïò ÏÜåÌòïÏ£ºÌÉùÏùÄ 200ÎßåÏõê ÌïúÎèÑ Ï∂îÍ∞Ä Í∞êÎ©¥.</p>
                            </div>
                            
                            <button type="submit" class="btn-calculate" style="margin-top: 25px;">
                                <i class="fas fa-calculator" style="margin-right: 8px;"></i>Ï∑®ÎìùÏÑ∏ Í≥ÑÏÇ∞ÌïòÍ∏∞
                            </button>
                        </form>
                    </div>
                    
                    <div class="acq-result-section" id="acqResultSection">
                        <div class="acq-result-summary" id="acqResultSummary"></div>
                        
                        <div class="acq-detail-container">
                            <div class="acq-detail-title"><i class="fas fa-list-alt"></i> Ï∑®ÎìùÏÑ∏ Í≥ÑÏÇ∞ ÏÉÅÏÑ∏</div>
                            <table class="acq-detail-table" id="acqDetailTable"></table>
                        </div>
                        
                        <div class="acq-rate-table-container">
                            <div class="acq-detail-title"><i class="fas fa-percentage"></i> Ï∑®ÎìùÏÑ∏ ÏÑ∏Ïú®Ìëú (2024ÎÖÑ Í∏∞Ï§Ä)</div>
                            <table class="acq-rate-table" id="acqRateTable"></table>
                        </div>
                    </div>
                    
                    <div class="acq-tips-container">
                        <div class="acq-tips-title"><i class="fas fa-book"></i> Ï∑®ÎìùÏÑ∏ Ïö©Ïñ¥ ÏÇ¨Ï†Ñ</div>
                        <div class="acq-terms-grid">
                            <div class="acq-term-card">
                                <div class="acq-term-name">üè† Ï∑®ÎìùÏÑ∏</div>
                                <div class="acq-term-desc">Î∂ÄÎèôÏÇ∞ÏùÑ Ï∑®ÎìùÌï† Îïå ÎÇ¥Îäî ÏßÄÎ∞©ÏÑ∏. Ï∑®ÎìùÍ∞ÄÏï°Ïóê ÏÑ∏Ïú®ÏùÑ Í≥±ÌïòÏó¨ Í≥ÑÏÇ∞Ìï©ÎãàÎã§. Ï∑®ÎìùÏùºÎ°úÎ∂ÄÌÑ∞ 60Ïùº Ïù¥ÎÇ¥ Ïã†Í≥†¬∑ÎÇ©Î∂ÄÌï¥Ïïº Ìï©ÎãàÎã§.</div>
                            </div>
                            <div class="acq-term-card">
                                <div class="acq-term-name">üìö ÏßÄÎ∞©ÍµêÏú°ÏÑ∏</div>
                                <div class="acq-term-desc">Ï∑®ÎìùÏÑ∏Ïùò 10%Î•º Ï∂îÍ∞ÄÎ°ú ÎÇ©Î∂ÄÌïòÎäî ÏÑ∏Í∏à. ÍµêÏú°Ïû¨Ï†ï ÌôïÏ∂©ÏùÑ ÏúÑÌïú Î™©Ï†ÅÏÑ∏ÏûÖÎãàÎã§. Ï∑®ÎìùÏÑ∏ÏôÄ Ìï®Íªò ÎÇ©Î∂ÄÌï©ÎãàÎã§.</div>
                            </div>
                            <div class="acq-term-card">
                                <div class="acq-term-name">üåæ ÎÜçÏñ¥Ï¥åÌäπÎ≥ÑÏÑ∏</div>
                                <div class="acq-term-desc">Ï∑®ÎìùÏÑ∏Ïùò 10%Î•º Ï∂îÍ∞Ä ÎÇ©Î∂Ä (Ï†ÑÏö© 85„é° Ï¥àÍ≥º Ïãú). ÎÜçÏñ¥Ï¥å Î∞úÏ†ÑÏùÑ ÏúÑÌïú Î™©Ï†ÅÏÑ∏ÏûÖÎãàÎã§.</div>
                            </div>
                            <div class="acq-term-card">
                                <div class="acq-term-name">üìç Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠</div>
                                <div class="acq-term-desc">Ï†ïÎ∂ÄÍ∞Ä ÏßÄÏ†ïÌïú Î∂ÄÎèôÏÇ∞ Í≥ºÏó¥ ÏßÄÏó≠. Îã§Ï£ºÌÉùÏûê Ï∑®ÎìùÏÑ∏ Ï§ëÍ≥º, ÎåÄÏ∂ú Í∑úÏ†ú Îì±Ïù¥ Ï†ÅÏö©Îê©ÎãàÎã§.</div>
                            </div>
                            <div class="acq-term-card">
                                <div class="acq-term-name">üè¢ Ï§ëÍ≥ºÏÑ∏Ïú®</div>
                                <div class="acq-term-desc">Îã§Ï£ºÌÉùÏûê, Î≤ïÏù∏, Í≥†Í∞ÄÏ£ºÌÉù Îì±Ïóê Ï†ÅÏö©ÎêòÎäî ÎÜíÏùÄ ÏÑ∏Ïú®. ÏùºÎ∞ò ÏÑ∏Ïú®Ïùò 3~4Î∞∞ÍπåÏßÄ Î∂ÄÍ≥ºÎê† Ïàò ÏûàÏäµÎãàÎã§.</div>
                            </div>
                            <div class="acq-term-card">
                                <div class="acq-term-name">üí∞ Í≥ºÏÑ∏ÌëúÏ§Ä</div>
                                <div class="acq-term-desc">ÏÑ∏Í∏àÏùÑ Í≥ÑÏÇ∞ÌïòÎäî Í∏∞Ï§Ä Í∏àÏï°. Ïã§Í±∞ÎûòÍ∞ÄÏôÄ ÏãúÍ∞ÄÌëúÏ§ÄÏï° Ï§ë ÎÜíÏùÄ Í∏àÏï°Ïù¥ Ï†ÅÏö©Îê©ÎãàÎã§.</div>
                            </div>
                            <div class="acq-term-card">
                                <div class="acq-term-name">üéÅ Ï¶ùÏó¨Ï∑®Îìù</div>
                                <div class="acq-term-desc">Î¨¥ÏÉÅÏúºÎ°ú Î∂ÄÎèôÏÇ∞ÏùÑ Î∞õÎäî Í≤ΩÏö∞. ÏãúÍ∞ÄÌëúÏ§ÄÏï°Ïùò 3.5%Í∞Ä Ï∑®ÎìùÏÑ∏Î°ú Î∂ÄÍ≥ºÎê©ÎãàÎã§ (Ï£ºÌÉù Ïô∏).</div>
                            </div>
                            <div class="acq-term-card">
                                <div class="acq-term-name">üìú ÏÉÅÏÜçÏ∑®Îìù</div>
                                <div class="acq-term-desc">ÏÇ¨ÎßùÏúºÎ°ú Ïù∏Ìï¥ Î∂ÄÎèôÏÇ∞ÏùÑ Î∞õÎäî Í≤ΩÏö∞. ÏùºÎ∞ò ÏÉÅÏÜçÏùÄ 2.8%, ÎÜçÏßÄ ÏÉÅÏÜçÏùÄ 2.3%Í∞Ä Ï†ÅÏö©Îê©ÎãàÎã§.</div>
                            </div>
                        </div>
                        
                        <div class="acq-exemption-section">
                            <div class="acq-exemption-title"><i class="fas fa-check-circle"></i> Ï∑®ÎìùÏÑ∏ Í∞êÎ©¥ ÌòúÌÉù (2024ÎÖÑ Í∏∞Ï§Ä)</div>
                            <div class="acq-exemption-item">
                                <div class="acq-exemption-item-title">üè† ÏÉùÏï†ÏµúÏ¥à Ï£ºÌÉù Íµ¨ÏûÖ Í∞êÎ©¥</div>
                                <div class="acq-exemption-item-content">
                                    ‚Ä¢ <strong>ÏàòÎèÑÍ∂å 4ÏñµÏõê¬∑ÎπÑÏàòÎèÑÍ∂å 3ÏñµÏõê Ïù¥Ìïò</strong>: Ï∑®ÎìùÏÑ∏ 100% Í∞êÎ©¥ (1.5Ïñµ ÌïúÎèÑ)<br>
                                    ‚Ä¢ Î≥∏Ïù∏Í≥º Î∞∞Ïö∞Ïûê Î™®Îëê Ï£ºÌÉùÏùÑ ÏÜåÏú†Ìïú Ï†Å ÏóÜÏñ¥Ïïº Ìï®<br>
                                    ‚Ä¢ Ï∑®ÎìùÏùºÎ°úÎ∂ÄÌÑ∞ 3Í∞úÏõî ÎÇ¥ Ï†ÑÏûÖ, 3ÎÖÑÍ∞Ñ Í±∞Ï£º ÏùòÎ¨¥<br>
                                    ‚Ä¢ 2025ÎÖÑ 12Ïõî 31ÏùºÍπåÏßÄ ÌïúÏãú Ï†ÅÏö©
                                </div>
                            </div>
                            <div class="acq-exemption-item">
                                <div class="acq-exemption-item-title">üíë Ïã†ÌòºÎ∂ÄÎ∂Ä Ï∑®ÎìùÏÑ∏ Í∞êÎ©¥</div>
                                <div class="acq-exemption-item-content">
                                    ‚Ä¢ ÌòºÏù∏Ïã†Í≥†ÏùºÎ°úÎ∂ÄÌÑ∞ 7ÎÖÑ Ïù¥ÎÇ¥ Î∂ÄÎ∂Ä<br>
                                    ‚Ä¢ Î∂ÄÎ∂ÄÌï©ÏÇ∞ Ïó∞ÏÜåÎìù 7Ï≤úÎßåÏõê Ïù¥Ìïò (ÎßûÎ≤åÏù¥ 8.5Ï≤úÎßåÏõê)<br>
                                    ‚Ä¢ Ï∑®ÎìùÍ∞ÄÏï° 3ÏñµÏõê Ïù¥Ìïò Ï£ºÌÉù: 50% Í∞êÎ©¥<br>
                                    ‚Ä¢ ÏÉùÏï†ÏµúÏ¥àÏôÄ Ï§ëÎ≥µ Ï†ÅÏö© Î∂àÍ∞Ä
                                </div>
                            </div>
                            <div class="acq-exemption-item">
                                <div class="acq-exemption-item-title">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Îã§ÏûêÎÖÄ Í∞ÄÍµ¨ Í∞êÎ©¥</div>
                                <div class="acq-exemption-item-content">
                                    ‚Ä¢ 18ÏÑ∏ ÎØ∏Îßå ÏûêÎÖÄ 3Î™Ö Ïù¥ÏÉÅ Í∞ÄÍµ¨<br>
                                    ‚Ä¢ Ï∑®ÎìùÏÑ∏ 50% Í∞êÎ©¥ (200ÎßåÏõê ÌïúÎèÑ)<br>
                                    ‚Ä¢ Ï∑®Îìù ÌõÑ 5ÎÖÑÍ∞Ñ Ìï¥Îãπ Ï£ºÌÉù Í±∞Ï£º ÏùòÎ¨¥
                                </div>
                            </div>
                            <div class="acq-exemption-item">
                                <div class="acq-exemption-item-title">üåæ ÎÜçÏßÄ Ï∑®Îìù Í∞êÎ©¥</div>
                                <div class="acq-exemption-item-content">
                                    ‚Ä¢ ÏûêÍ≤ΩÎÜçÎØº ÎÜçÏßÄ Ï∑®Îìù: 50% Í∞êÎ©¥<br>
                                    ‚Ä¢ 8ÎÖÑ Ïù¥ÏÉÅ ÏûêÍ≤Ω Ïãú Ï†ÑÏï° Í∞êÎ©¥<br>
                                    ‚Ä¢ Í∑ÄÎÜçÏù∏ ÎÜçÏßÄ Ï∑®Îìù: 50% Í∞êÎ©¥ (1Ìöå ÌïúÏ†ï)
                                </div>
                            </div>
                        </div>
                        
                        <div class="acq-save-section">
                            <div class="acq-save-title"><i class="fas fa-piggy-bank"></i> Ï∑®ÎìùÏÑ∏ Ï†àÏÑ∏ ÌåÅ</div>
                            <div class="acq-save-item">
                                <div class="acq-save-item-title">1. ÏÉùÏï†ÏµúÏ¥à Í∞êÎ©¥ ÏûêÍ≤© ÌôïÏù∏</div>
                                <div class="acq-save-item-content">Î≥∏Ïù∏Í≥º Î∞∞Ïö∞Ïûê Î™®Îëê Í≥ºÍ±∞ Ï£ºÌÉù ÏÜåÏú† Ïù¥Î†•Ïù¥ ÏóÜÎã§Î©¥ ÏµúÎåÄ 200ÎßåÏõêÍπåÏßÄ Í∞êÎ©¥Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§.</div>
                            </div>
                            <div class="acq-save-item">
                                <div class="acq-save-item-title">2. 6ÏñµÏõê / 9ÏñµÏõê Í∏∞Ï§Ä ÌôïÏù∏</div>
                                <div class="acq-save-item-content">6Ïñµ Ïù¥Ìïò 1%, 6~9Ïñµ 1~3% ÎàÑÏßÑ, 9Ïñµ Ï¥àÍ≥º 3%ÏûÖÎãàÎã§. Í∞ÄÍ≤© ÌòëÏÉÅ Ïãú Í∏∞Ï§ÄÏÑ†ÏùÑ Í≥†Î†§ÌïòÏÑ∏Ïöî.</div>
                            </div>
                            <div class="acq-save-item">
                                <div class="acq-save-item-title">3. 85„é° Î©¥Ï†Å Í∏∞Ï§Ä ÌôïÏù∏</div>
                                <div class="acq-save-item-content">Ï†ÑÏö©Î©¥Ï†Å 85„é° Ï¥àÍ≥º Ïãú ÎÜçÏñ¥Ï¥åÌäπÎ≥ÑÏÑ∏(Ï∑®ÎìùÏÑ∏Ïùò 10%)Í∞Ä Ï∂îÍ∞ÄÎê©ÎãàÎã§. 84„é° Ï£ºÌÉùÏù¥ Ïú†Î¶¨Ìï† Ïàò ÏûàÏäµÎãàÎã§.</div>
                            </div>
                            <div class="acq-save-item">
                                <div class="acq-save-item-title">4. Ï∑®Îìù ÏãúÍ∏∞ Ï°∞Ï†à</div>
                                <div class="acq-save-item-content">Í∏∞Ï°¥ Ï£ºÌÉù Ï≤òÎ∂Ñ ÌõÑ Ïã†Í∑ú Ï£ºÌÉù Ï∑®Îìù Ïãú 1Ï£ºÌÉùÏûê ÏÑ∏Ïú® Ï†ÅÏö©. Ï≤òÎ∂Ñ ÏãúÍ∏∞Î•º Ï°∞Ï†àÌïòÏó¨ Ï§ëÍ≥º ÌöåÌîº Í∞ÄÎä•Ìï©ÎãàÎã§.</div>
                            </div>
                            <div class="acq-save-item">
                                <div class="acq-save-item-title">5. Ï¶ùÏó¨Î≥¥Îã§ Îß§Îß§Í∞Ä Ïú†Î¶¨Ìïú Í≤ΩÏö∞</div>
                                <div class="acq-save-item-content">Ï†ÄÍ∞Ä Ï£ºÌÉùÏùÄ Ï¶ùÏó¨ÏÑ∏(10~50%) + Ï∑®ÎìùÏÑ∏(3.5%)Î≥¥Îã§ Îß§Îß§ Ï∑®ÎìùÏÑ∏(1~3%)Í∞Ä ÎÇÆÏùÑ Ïàò ÏûàÏäµÎãàÎã§.</div>
                            </div>
                            <div class="acq-save-item">
                                <div class="acq-save-item-title">6. ÏùºÏãúÏ†Å 2Ï£ºÌÉù ÌôúÏö©</div>
                                <div class="acq-save-item-content">Í∏∞Ï°¥ Ï£ºÌÉùÏùÑ 3ÎÖÑ ÎÇ¥ Ï≤òÎ∂Ñ Ï°∞Í±¥ÏúºÎ°ú Ïã†Í∑ú Ï£ºÌÉù Ï∑®Îìù Ïãú 1Ï£ºÌÉùÏûê ÏÑ∏Ïú®Ïù¥ Ï†ÅÏö©Îê©ÎãàÎã§.</div>
                            </div>
                        </div>
                        
                        <div class="acq-warning-box">
                            <strong>‚ö†Ô∏è Ï£ºÏùòÏÇ¨Ìï≠:</strong><br>
                            ‚Ä¢ Î≥∏ Í≥ÑÏÇ∞Í∏∞Îäî Ï∞∏Í≥†Ïö©Ïù¥Î©∞, Ï†ïÌôïÌïú ÏÑ∏Í∏àÏùÄ Í¥ÄÌï† Íµ¨Ï≤≠/ÏÑ∏Î¨¥ÏÑúÏóê ÌôïÏù∏ÌïòÏÑ∏Ïöî.<br>
                            ‚Ä¢ 2024ÎÖÑ Í∏∞Ï§Ä ÏÑ∏Ïú®Ïù¥Î©∞, Ï†ïÏ±Ö Î≥ÄÍ≤ΩÏóê Îî∞Îùº Îã¨ÎùºÏßà Ïàò ÏûàÏäµÎãàÎã§.<br>
                            ‚Ä¢ Î≤ïÏù∏ÏùÄ Ï£ºÌÉù Ï∑®Îìù Ïãú 12% Ï§ëÍ≥ºÏÑ∏Ïú®Ïù¥ Ï†ÅÏö©Îê©ÎãàÎã§.<br>
                            ‚Ä¢ Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠ 2Ï£ºÌÉù Ïù¥ÏÉÅÏùÄ 8~12% Ï§ëÍ≥ºÎê† Ïàò ÏûàÏäµÎãàÎã§.<br>
                            ‚Ä¢ Ï∑®ÎìùÏùºÎ°úÎ∂ÄÌÑ∞ 60Ïùº ÎÇ¥ Ïã†Í≥†¬∑ÎÇ©Î∂ÄÌï¥Ïïº Í∞ÄÏÇ∞ÏÑ∏Í∞Ä Î©¥Ï†úÎê©ÎãàÎã§.
                        </div>
                    </div>
                </div>
            `;
        }

        function toggleAcqCheckbox(id) {
            const checkbox = document.getElementById(id);
            checkbox.checked = !checkbox.checked;
            const parent = checkbox.closest('.acq-checkbox-item');
            if (checkbox.checked) {
                parent.classList.add('checked');
            } else {
                parent.classList.remove('checked');
            }
        }

        function updateAcqOptions() {
            const propertyType = document.getElementById('acqPropertyType').value;
            const acqType = document.getElementById('acqType').value;
            const houseCountGroup = document.getElementById('acqHouseCountGroup');
            
            // Ï£ºÍ±∞Ïö© Î∂ÄÎèôÏÇ∞Îßå Ï£ºÌÉù Ïàò ÌëúÏãú
            const isResidential = ['apartment', 'officetel', 'villa', 'house'].includes(propertyType);
            houseCountGroup.style.display = isResidential ? 'block' : 'none';
        }

        function calculateAcquisitionTax(e) {
            e.preventDefault();
            
            const propertyType = document.getElementById('acqPropertyType').value;
            const acqType = document.getElementById('acqType').value;
            const region = document.getElementById('acqRegion').value;
            const houseCount = parseInt(document.getElementById('acqHouseCount').value);
            const buyerType = document.getElementById('acqBuyerType').value;
            const price = parseNumberFromComma(document.getElementById('acqPrice').value);
            const area = parseFloat(document.getElementById('acqArea').value) || 84;
            
            const exemption1 = document.getElementById('acqExemption1').checked; // ÏÉùÏï†ÏµúÏ¥à
            const exemption2 = document.getElementById('acqExemption2').checked; // Ïã†ÌòºÎ∂ÄÎ∂Ä
            const exemption3 = document.getElementById('acqExemption3').checked; // Îã§ÏûêÎÖÄ
            const exemption4 = document.getElementById('acqExemption4').checked; // ÎÜçÏñ¥Ï¥å
            
            const isResidential = ['apartment', 'officetel', 'villa', 'house'].includes(propertyType);
            const isRegulated = region === 'regulated';
            const isCorporation = buyerType === 'corporation';
            
            let taxRate = 0;
            let statusBadge = '';
            let rateDescription = '';
            
            // Ï∑®ÎìùÏÑ∏Ïú® Í≤∞Ï†ï
            if (acqType === 'inheritance') {
                // ÏÉÅÏÜç
                if (propertyType === 'farm-land') {
                    taxRate = 2.3;
                    rateDescription = 'ÎÜçÏßÄ ÏÉÅÏÜç';
                } else {
                    taxRate = 2.8;
                    rateDescription = 'ÏùºÎ∞ò ÏÉÅÏÜç';
                }
            } else if (acqType === 'gift') {
                // Ï¶ùÏó¨
                if (isResidential) {
                    taxRate = 3.5;
                    rateDescription = 'Ï£ºÌÉù Ï¶ùÏó¨';
                } else {
                    taxRate = 3.5;
                    rateDescription = 'ÎπÑÏ£ºÍ±∞ Ï¶ùÏó¨';
                }
            } else {
                // Îß§Îß§/Í≤ΩÎß§ (Ïú†ÏÉÅÏ∑®Îìù)
                if (isResidential) {
                    // Ï£ºÌÉù
                    if (isCorporation) {
                        // Î≤ïÏù∏
                        taxRate = 12;
                        rateDescription = 'Î≤ïÏù∏ Ï£ºÌÉù Ï∑®Îìù';
                        statusBadge = '<span class="surcharge-badge">Î≤ïÏù∏ Ï§ëÍ≥º</span>';
                    } else if (isRegulated && houseCount >= 3) {
                        // Ï°∞Ï†ïÏßÄÏó≠ 3Ï£ºÌÉù Ïù¥ÏÉÅ
                        taxRate = 12;
                        rateDescription = 'Ï°∞Ï†ïÏßÄÏó≠ 3Ï£ºÌÉù Ïù¥ÏÉÅ';
                        statusBadge = '<span class="surcharge-badge">Ï§ëÍ≥ºÏÑ∏Ïú®</span>';
                    } else if (isRegulated && houseCount === 2) {
                        // Ï°∞Ï†ïÏßÄÏó≠ 2Ï£ºÌÉù
                        taxRate = 8;
                        rateDescription = 'Ï°∞Ï†ïÏßÄÏó≠ 2Ï£ºÌÉù';
                        statusBadge = '<span class="surcharge-badge">Ï§ëÍ≥ºÏÑ∏Ïú®</span>';
                    } else if (!isRegulated && houseCount >= 4) {
                        // ÎπÑÍ∑úÏ†ú 4Ï£ºÌÉù Ïù¥ÏÉÅ
                        taxRate = 12;
                        rateDescription = 'ÎπÑÍ∑úÏ†ú 4Ï£ºÌÉù Ïù¥ÏÉÅ';
                        statusBadge = '<span class="surcharge-badge">Ï§ëÍ≥ºÏÑ∏Ïú®</span>';
                    } else if (!isRegulated && houseCount === 3) {
                        // ÎπÑÍ∑úÏ†ú 3Ï£ºÌÉù
                        taxRate = 8;
                        rateDescription = 'ÎπÑÍ∑úÏ†ú 3Ï£ºÌÉù';
                        statusBadge = '<span class="surcharge-badge">Ï§ëÍ≥ºÏÑ∏Ïú®</span>';
                    } else {
                        // 1Ï£ºÌÉùÏûê ÎòêÎäî ÎπÑÍ∑úÏ†ú 2Ï£ºÌÉù
                        if (price <= 600000000) {
                            taxRate = 1;
                            rateDescription = '6Ïñµ Ïù¥Ìïò';
                        } else if (price <= 900000000) {
                            // 6Ïñµ~9Ïñµ: ÎàÑÏßÑÏÑ∏Ïú® (1% + Ï¥àÍ≥ºÎ∂ÑÏóê ÎåÄÌï¥)
                            taxRate = 1 + ((price - 600000000) / 300000000) * 2;
                            rateDescription = '6Ïñµ~9Ïñµ ÎàÑÏßÑ';
                        } else {
                            taxRate = 3;
                            rateDescription = '9Ïñµ Ï¥àÍ≥º';
                        }
                    }
                } else if (propertyType === 'officetel-commercial') {
                    // ÏóÖÎ¨¥Ïö© Ïò§ÌîºÏä§ÌÖî
                    taxRate = 4;
                    rateDescription = 'ÏóÖÎ¨¥Ïö© Ïò§ÌîºÏä§ÌÖî';
                } else if (propertyType === 'commercial') {
                    // ÏÉÅÍ∞Ä
                    taxRate = 4;
                    rateDescription = 'ÏÉÅÍ∞Ä/Ï†êÌè¨';
                } else if (propertyType === 'land') {
                    // ÌÜ†ÏßÄ
                    taxRate = 4;
                    rateDescription = 'ÌÜ†ÏßÄ';
                } else if (propertyType === 'farm-land') {
                    // ÎÜçÏßÄ
                    taxRate = 3;
                    rateDescription = 'ÎÜçÏßÄ Îß§Îß§';
                }
            }
            
            // Í∏∞Î≥∏ Ï∑®ÎìùÏÑ∏ Í≥ÑÏÇ∞
            let acquisitionTax = Math.round(price * (taxRate / 100));
            let originalTax = acquisitionTax;
            
            // Í∞êÎ©¥ Ï†ÅÏö©
            let reductionAmount = 0;
            let reductionReason = '';
            
            if (exemption1 && isResidential && houseCount === 1) {
                // ÏÉùÏï†ÏµúÏ¥à Ï£ºÌÉù Íµ¨ÏûÖ Í∞êÎ©¥
                if (price <= 400000000) { // ÏàòÎèÑÍ∂å 4Ïñµ Ïù¥Ìïò
                    reductionAmount = Math.min(acquisitionTax, 2000000);
                    reductionReason = 'ÏÉùÏï†ÏµúÏ¥à Ï£ºÌÉù Í∞êÎ©¥';
                    statusBadge = '<span class="exemption-badge">ÏÉùÏï†ÏµúÏ¥à Í∞êÎ©¥</span>';
                }
            } else if (exemption2 && isResidential && houseCount === 1) {
                // Ïã†ÌòºÎ∂ÄÎ∂Ä Í∞êÎ©¥ (50%)
                if (price <= 300000000) {
                    reductionAmount = Math.round(acquisitionTax * 0.5);
                    reductionReason = 'Ïã†ÌòºÎ∂ÄÎ∂Ä Í∞êÎ©¥ 50%';
                    statusBadge = '<span class="reduction-badge">Ïã†Ìòº Í∞êÎ©¥</span>';
                }
            } else if (exemption3 && isResidential) {
                // Îã§ÏûêÎÖÄ Í∞ÄÍµ¨ Í∞êÎ©¥
                reductionAmount = Math.min(Math.round(acquisitionTax * 0.5), 2000000);
                reductionReason = 'Îã§ÏûêÎÖÄ Í∞ÄÍµ¨ Í∞êÎ©¥';
                statusBadge = '<span class="reduction-badge">Îã§ÏûêÎÖÄ Í∞êÎ©¥</span>';
            }
            
            acquisitionTax = acquisitionTax - reductionAmount;
            
            // ÏßÄÎ∞©ÍµêÏú°ÏÑ∏ (Ï∑®ÎìùÏÑ∏Ïùò 10%)
            const localEducationTax = Math.round(acquisitionTax * 0.1);
            
            // ÎÜçÏñ¥Ï¥åÌäπÎ≥ÑÏÑ∏ (85„é° Ï¥àÍ≥º Ïãú Ï∑®ÎìùÏÑ∏Ïùò 10%)
            let ruralTax = 0;
            if (area > 85 && isResidential && acqType !== 'inheritance') {
                ruralTax = Math.round(acquisitionTax * 0.1);
            }
            
            // Ï¥ù ÏÑ∏Í∏à
            const totalTax = acquisitionTax + localEducationTax + ruralTax;
            
            // Í≤∞Í≥º ÏÑπÏÖò ÌëúÏãú
            const resultSection = document.getElementById('acqResultSection');
            resultSection.classList.add('active');
            
            // ÏöîÏïΩ Ïπ¥Îìú
            document.getElementById('acqResultSummary').innerHTML = `
                <div class="acq-summary-card tax">
                    <div class="acq-summary-label">Ï∑®ÎìùÏÑ∏ (${taxRate.toFixed(1)}%)</div>
                    <div class="acq-summary-value">${acquisitionTax.toLocaleString()}Ïõê</div>
                </div>
                <div class="acq-summary-card local">
                    <div class="acq-summary-label">ÏßÄÎ∞©ÍµêÏú°ÏÑ∏ (10%)</div>
                    <div class="acq-summary-value">${localEducationTax.toLocaleString()}Ïõê</div>
                </div>
                <div class="acq-summary-card special">
                    <div class="acq-summary-label">ÎÜçÏñ¥Ï¥åÌäπÎ≥ÑÏÑ∏</div>
                    <div class="acq-summary-value">${ruralTax.toLocaleString()}Ïõê</div>
                </div>
                <div class="acq-summary-card total">
                    <div class="acq-summary-label">Ï¥ù ÎÇ©Î∂ÄÏÑ∏Ïï°</div>
                    <div class="acq-summary-value">${totalTax.toLocaleString()}Ïõê</div>
                </div>
            `;
            
            // ÏÉÅÏÑ∏ ÌÖåÏù¥Î∏î
            document.getElementById('acqDetailTable').innerHTML = `
                <thead>
                    <tr>
                        <th>Ìï≠Î™©</th>
                        <th>Í∏àÏï°/ÏÑ∏Ïú®</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Ï∑®ÎìùÍ∞ÄÏï°</td>
                        <td>${price.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>Ï†ÑÏö©Î©¥Ï†Å</td>
                        <td>${area}„é° ${area > 85 ? '(85„é° Ï¥àÍ≥º - ÎÜçÌäπÏÑ∏ Î∂ÄÍ≥º)' : '(85„é° Ïù¥Ìïò)'}</td>
                    </tr>
                    <tr class="highlight">
                        <td>Ï†ÅÏö© ÏÑ∏Ïú® ${statusBadge}</td>
                        <td>${taxRate.toFixed(1)}% (${rateDescription})</td>
                    </tr>
                    ${reductionAmount > 0 ? `
                    <tr>
                        <td>Í∞êÎ©¥ Ï†Ñ Ï∑®ÎìùÏÑ∏</td>
                        <td>${originalTax.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr style="color: #38a169;">
                        <td>(-) ${reductionReason}</td>
                        <td>-${reductionAmount.toLocaleString()}Ïõê</td>
                    </tr>
                    ` : ''}
                    <tr>
                        <td>Ï∑®ÎìùÏÑ∏</td>
                        <td>${acquisitionTax.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>(+) ÏßÄÎ∞©ÍµêÏú°ÏÑ∏ (Ï∑®ÎìùÏÑ∏ √ó 10%)</td>
                        <td>${localEducationTax.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>(+) ÎÜçÏñ¥Ï¥åÌäπÎ≥ÑÏÑ∏ ${area <= 85 ? '(85„é° Ïù¥Ìïò Î©¥Ï†ú)' : '(Ï∑®ÎìùÏÑ∏ √ó 10%)'}</td>
                        <td>${ruralTax.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr class="total-row">
                        <td>Ï¥ù ÎÇ©Î∂ÄÏÑ∏Ïï°</td>
                        <td>${totalTax.toLocaleString()}Ïõê</td>
                    </tr>
                </tbody>
            `;
            
            // ÏÑ∏Ïú®Ìëú
            const isCurrentResidential = isResidential && acqType === 'purchase' && !isCorporation;
            document.getElementById('acqRateTable').innerHTML = `
                <thead>
                    <tr>
                        <th>Íµ¨Î∂Ñ</th>
                        <th>Ï∑®ÎìùÍ∞ÄÏï°/Ï°∞Í±¥</th>
                        <th>Ï∑®ÎìùÏÑ∏Ïú®</th>
                        <th>ÎπÑÍ≥†</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="${isCurrentResidential && price <= 600000000 && houseCount === 1 ? 'active-row' : ''}">
                        <td rowspan="3">1Ï£ºÌÉùÏûê<br>(ÎπÑÍ∑úÏ†ú/Í∑úÏ†ú)</td>
                        <td>6ÏñµÏõê Ïù¥Ìïò</td>
                        <td>1%</td>
                        <td>Í∏∞Î≥∏ÏÑ∏Ïú®</td>
                    </tr>
                    <tr class="${isCurrentResidential && price > 600000000 && price <= 900000000 && houseCount === 1 ? 'active-row' : ''}">
                        <td>6Ïñµ~9ÏñµÏõê</td>
                        <td>1~3%</td>
                        <td>ÎàÑÏßÑÏÑ∏Ïú®</td>
                    </tr>
                    <tr class="${isCurrentResidential && price > 900000000 && houseCount === 1 ? 'active-row' : ''}">
                        <td>9ÏñµÏõê Ï¥àÍ≥º</td>
                        <td>3%</td>
                        <td>Í∏∞Î≥∏ÏÑ∏Ïú®</td>
                    </tr>
                    <tr class="${isCurrentResidential && houseCount === 2 && isRegulated ? 'active-row' : ''}">
                        <td>2Ï£ºÌÉùÏûê</td>
                        <td>Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠</td>
                        <td>8%</td>
                        <td>Ï§ëÍ≥ºÏÑ∏Ïú®</td>
                    </tr>
                    <tr class="${isCurrentResidential && houseCount >= 3 && isRegulated ? 'active-row' : ''}">
                        <td>3Ï£ºÌÉù Ïù¥ÏÉÅ</td>
                        <td>Ï°∞Ï†ïÎåÄÏÉÅÏßÄÏó≠</td>
                        <td>12%</td>
                        <td>Ï§ëÍ≥ºÏÑ∏Ïú®</td>
                    </tr>
                    <tr class="${isCorporation && isResidential ? 'active-row' : ''}">
                        <td>Î≤ïÏù∏</td>
                        <td>Ï£ºÌÉù Ï∑®Îìù</td>
                        <td>12%</td>
                        <td>Ï§ëÍ≥ºÏÑ∏Ïú®</td>
                    </tr>
                    <tr class="${propertyType === 'commercial' || propertyType === 'officetel-commercial' || propertyType === 'land' ? 'active-row' : ''}">
                        <td>ÎπÑÏ£ºÍ±∞Ïö©</td>
                        <td>ÏÉÅÍ∞Ä/ÌÜ†ÏßÄ Îì±</td>
                        <td>4%</td>
                        <td>ÏùºÎ∞òÏÑ∏Ïú®</td>
                    </tr>
                    <tr class="${acqType === 'inheritance' ? 'active-row' : ''}">
                        <td>ÏÉÅÏÜç</td>
                        <td>ÏùºÎ∞ò/ÎÜçÏßÄ</td>
                        <td>2.8%/2.3%</td>
                        <td>ÏÉÅÏÜçÏÑ∏Ïú®</td>
                    </tr>
                    <tr class="${acqType === 'gift' ? 'active-row' : ''}">
                        <td>Ï¶ùÏó¨</td>
                        <td>Ï†ÑÏ≤¥</td>
                        <td>3.5%</td>
                        <td>Ï¶ùÏó¨ÏÑ∏Ïú®</td>
                    </tr>
                </tbody>
            `;
            
            // Í≤∞Í≥ºÎ°ú Ïä§ÌÅ¨Î°§
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // ÏΩ§Îßà ÏûÖÎ†• Ïû¨ÏÑ§Ï†ï
            setTimeout(() => setupCommaInputs(), 100);
        }

        function getCarTaxCalculator() {
            return `
                <style>
                    .car-container {
                        display: flex;
                        flex-direction: column;
                        gap: 30px;
                    }
                    .car-form-section {
                        background: #f8fafc;
                        padding: 25px;
                        border-radius: 15px;
                    }
                    .car-form-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        padding-bottom: 15px;
                        border-bottom: 2px solid #e2e8f0;
                    }
                    .car-form-title i {
                        color: #fa709a;
                    }
                    .car-form-grid {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 20px;
                    }
                    .car-form-grid-3 {
                        display: grid;
                        grid-template-columns: 1fr 1fr 1fr;
                        gap: 20px;
                    }
                    .car-checkbox-group {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 15px;
                        margin-top: 10px;
                    }
                    .car-checkbox-item {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        background: white;
                        padding: 12px 16px;
                        border-radius: 10px;
                        border: 2px solid #e2e8f0;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    }
                    .car-checkbox-item:hover {
                        border-color: #fa709a;
                    }
                    .car-checkbox-item.checked {
                        border-color: #fa709a;
                        background: #fff5f7;
                    }
                    .car-checkbox-item input {
                        width: 18px;
                        height: 18px;
                        cursor: pointer;
                    }
                    .car-checkbox-item label {
                        cursor: pointer;
                        font-size: 14px;
                        font-weight: 500;
                    }
                    .car-info-box {
                        background: linear-gradient(135deg, #fff5f7 0%, #ffe0e6 100%);
                        padding: 15px;
                        border-radius: 10px;
                        margin-top: 15px;
                        border-left: 4px solid #fa709a;
                    }
                    .car-info-box p {
                        font-size: 13px;
                        color: #9b2c2c;
                        line-height: 1.6;
                    }
                    .car-info-box.electric {
                        background: linear-gradient(135deg, #e6fffa 0%, #b2f5ea 100%);
                        border-left-color: #38b2ac;
                    }
                    .car-info-box.electric p {
                        color: #234e52;
                    }
                    .car-result-section {
                        display: none;
                    }
                    .car-result-section.active {
                        display: block;
                        animation: fadeIn 0.5s ease;
                    }
                    .car-result-summary {
                        display: grid;
                        grid-template-columns: repeat(4, 1fr);
                        gap: 15px;
                        margin-bottom: 30px;
                    }
                    .car-summary-card {
                        background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                        padding: 20px;
                        border-radius: 15px;
                        color: white;
                        text-align: center;
                    }
                    .car-summary-card.tax {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    }
                    .car-summary-card.local {
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                    }
                    .car-summary-card.discount {
                        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
                    }
                    .car-summary-card.total {
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                    }
                    .car-summary-label {
                        font-size: 13px;
                        opacity: 0.9;
                        margin-bottom: 8px;
                    }
                    .car-summary-value {
                        font-size: 18px;
                        font-weight: 700;
                    }
                    .car-detail-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                    }
                    .car-detail-title {
                        font-size: 18px;
                        font-weight: 600;
                        color: #2d3748;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .car-detail-title i {
                        color: #fa709a;
                    }
                    .car-detail-table {
                        width: 100%;
                        border-collapse: collapse;
                    }
                    .car-detail-table th {
                        background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                        color: white;
                        padding: 12px 15px;
                        text-align: left;
                        font-weight: 600;
                    }
                    .car-detail-table th:first-child {
                        border-radius: 10px 0 0 0;
                    }
                    .car-detail-table th:last-child {
                        border-radius: 0 10px 0 0;
                        text-align: right;
                    }
                    .car-detail-table td {
                        padding: 12px 15px;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .car-detail-table td:last-child {
                        text-align: right;
                        font-weight: 600;
                    }
                    .car-detail-table tr:hover {
                        background: #f7fafc;
                    }
                    .car-detail-table tr.highlight {
                        background: #fff5f7;
                    }
                    .car-detail-table tr.total-row {
                        background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
                        color: white;
                    }
                    .car-detail-table tr.total-row td {
                        border-bottom: none;
                        font-weight: 700;
                        font-size: 16px;
                    }
                    .car-rate-table-container {
                        background: white;
                        padding: 25px;
                        border-radius: 15px;
                        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
                        margin-bottom: 30px;
                        overflow-x: auto;
                    }
                    .car-rate-table {
                        width: 100%;
                        border-collapse: collapse;
                        font-size: 13px;
                    }
                    .car-rate-table th {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 10px;
                        text-align: center;
                        font-weight: 600;
                    }
                    .car-rate-table td {
                        padding: 10px;
                        text-align: center;
                        border-bottom: 1px solid #e2e8f0;
                    }
                    .car-rate-table tr.active-row {
                        background: #ebf4ff;
                        font-weight: 600;
                    }
                    .car-tips-container {
                        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                        padding: 25px;
                        border-radius: 15px;
                        color: white;
                    }
                    .car-tips-title {
                        font-size: 18px;
                        font-weight: 600;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    .car-tips-title i {
                        color: #ffd700;
                    }
                    .car-terms-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        margin-bottom: 25px;
                    }
                    .car-term-card {
                        background: rgba(255,255,255,0.1);
                        padding: 18px;
                        border-radius: 12px;
                        backdrop-filter: blur(10px);
                    }
                    .car-term-name {
                        font-weight: 700;
                        font-size: 15px;
                        margin-bottom: 8px;
                        color: #ffd700;
                    }
                    .car-term-desc {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .car-electric-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .car-electric-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #38ef7d;
                    }
                    .car-electric-grid {
                        display: grid;
                        grid-template-columns: repeat(3, 1fr);
                        gap: 15px;
                    }
                    .car-electric-card {
                        background: rgba(56,239,125,0.1);
                        padding: 18px;
                        border-radius: 12px;
                        border-left: 4px solid #38ef7d;
                        text-align: center;
                    }
                    .car-electric-card-title {
                        font-weight: 600;
                        margin-bottom: 8px;
                        color: #38ef7d;
                        font-size: 14px;
                    }
                    .car-electric-card-value {
                        font-size: 24px;
                        font-weight: 700;
                        margin-bottom: 5px;
                    }
                    .car-electric-card-desc {
                        font-size: 12px;
                        opacity: 0.8;
                    }
                    .car-prepay-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .car-prepay-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #4facfe;
                    }
                    .car-prepay-grid {
                        display: grid;
                        grid-template-columns: repeat(4, 1fr);
                        gap: 15px;
                    }
                    .car-prepay-card {
                        background: rgba(79,172,254,0.1);
                        padding: 15px;
                        border-radius: 12px;
                        text-align: center;
                        border: 2px solid rgba(79,172,254,0.3);
                    }
                    .car-prepay-month {
                        font-size: 14px;
                        color: #4facfe;
                        font-weight: 600;
                        margin-bottom: 5px;
                    }
                    .car-prepay-rate {
                        font-size: 24px;
                        font-weight: 700;
                    }
                    .car-prepay-desc {
                        font-size: 11px;
                        opacity: 0.8;
                        margin-top: 5px;
                    }
                    .car-save-section {
                        margin-top: 25px;
                        padding-top: 25px;
                        border-top: 1px solid rgba(255,255,255,0.2);
                    }
                    .car-save-title {
                        font-size: 16px;
                        font-weight: 600;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        color: #ffd700;
                    }
                    .car-save-item {
                        background: rgba(255,215,0,0.1);
                        padding: 15px;
                        border-radius: 10px;
                        margin-bottom: 10px;
                        border-left: 4px solid #ffd700;
                    }
                    .car-save-item-title {
                        font-weight: 600;
                        margin-bottom: 5px;
                        color: #ffd700;
                    }
                    .car-save-item-content {
                        font-size: 13px;
                        opacity: 0.9;
                        line-height: 1.5;
                    }
                    .car-warning-box {
                        margin-top: 20px;
                        padding: 15px;
                        background: rgba(252,129,129,0.1);
                        border-radius: 10px;
                        border-left: 4px solid #fc8181;
                        font-size: 13px;
                        line-height: 1.6;
                    }
                    .car-type-badge {
                        display: inline-block;
                        padding: 5px 12px;
                        border-radius: 20px;
                        font-size: 12px;
                        font-weight: 600;
                        margin-left: 10px;
                    }
                    .car-type-badge.electric {
                        background: linear-gradient(135deg, #38ef7d 0%, #11998e 100%);
                        color: white;
                    }
                    .car-type-badge.hybrid {
                        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
                        color: white;
                    }
                    .car-type-badge.discount {
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                        color: white;
                    }
                    .cc-group {
                        display: block;
                    }
                    .cc-group.hidden {
                        display: none;
                    }
                    @media (max-width: 768px) {
                        .car-result-summary {
                            grid-template-columns: repeat(2, 1fr);
                        }
                        .car-form-grid, .car-form-grid-3 {
                            grid-template-columns: 1fr;
                        }
                        .car-terms-grid {
                            grid-template-columns: 1fr;
                        }
                        .car-summary-value {
                            font-size: 15px;
                        }
                        .car-checkbox-group {
                            flex-direction: column;
                        }
                        .car-electric-grid {
                            grid-template-columns: 1fr;
                        }
                        .car-prepay-grid {
                            grid-template-columns: repeat(2, 1fr);
                        }
                    }
                    @media (max-width: 480px) {
                        .car-result-summary {
                            grid-template-columns: 1fr;
                        }
                        .car-prepay-grid {
                            grid-template-columns: 1fr;
                        }
                    }
                </style>
                <div class="car-container">
                    <div class="car-form-section">
                        <div class="car-form-title"><i class="fas fa-car"></i> Ï∞®Îüâ Ï†ïÎ≥¥</div>
                        <form class="calc-form" onsubmit="calculateCarTax(event)">
                            <div class="car-form-grid">
                                <div class="form-group">
                                    <label><i class="fas fa-car-side" style="color: #fa709a; margin-right: 8px;"></i>Ï∞®Îüâ Ï¢ÖÎ•ò</label>
                                    <select id="carVehicleType" onchange="updateCarOptions()">
                                        <option value="passenger">ÏäπÏö©Ï∞®</option>
                                        <option value="van">ÏäπÌï©Ï∞® (11Ïù∏ Ïù¥ÏÉÅ)</option>
                                        <option value="truck">ÌôîÎ¨ºÏ∞®</option>
                                        <option value="special">ÌäπÏàòÏ∞®</option>
                                        <option value="motorcycle">Ïù¥Î•úÏ∞® (Ïò§ÌÜ†Î∞îÏù¥)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-gas-pump" style="color: #fa709a; margin-right: 8px;"></i>Ïó∞Î£å Ïú†Ìòï</label>
                                    <select id="carFuelType" onchange="updateCarOptions()">
                                        <option value="gasoline">ÌúòÎ∞úÏú†/ÎîîÏ†§</option>
                                        <option value="lpg">LPG</option>
                                        <option value="electric">Ï†ÑÍ∏∞Ï∞®</option>
                                        <option value="hybrid">ÌïòÏù¥Î∏åÎ¶¨Îìú</option>
                                        <option value="hydrogen">ÏàòÏÜåÏ∞®</option>
                                    </select>
                                </div>
                            </div>
                            <div class="car-form-grid">
                                <div class="form-group">
                                    <label><i class="fas fa-briefcase" style="color: #fa709a; margin-right: 8px;"></i>Ïö©ÎèÑ Íµ¨Î∂Ñ</label>
                                    <select id="carUsageType">
                                        <option value="private">ÎπÑÏòÅÏóÖÏö© (ÏûêÍ∞ÄÏö©)</option>
                                        <option value="business">ÏòÅÏóÖÏö© (ÏÇ¨ÏóÖÏö©)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label><i class="fas fa-calendar-alt" style="color: #fa709a; margin-right: 8px;"></i>ÏµúÏ¥à Îì±Î°ùÎÖÑÎèÑ</label>
                                    <input type="number" id="carYear" placeholder="2020" value="2024" min="1990" max="2026">
                                    <small style="color: #718096; font-size: 12px; margin-top: 5px;">* Ï∞®ÎüâÎì±Î°ùÏ¶ùÏùò ÏµúÏ¥àÎì±Î°ùÏùº Í∏∞Ï§Ä (Ïòà: 2020)</small>
                                </div>
                            </div>
                            
                            <div class="form-group cc-group" id="ccGroup">
                                <label><i class="fas fa-tachometer-alt" style="color: #fa709a; margin-right: 8px;"></i>Î∞∞Í∏∞Îüâ (cc)</label>
                                <input type="text" id="carCC" data-comma="true" placeholder="2,000" value="2000">
                            </div>
                            
                            <div class="car-info-box electric" id="electricInfo" style="display: none;">
                                <p><strong>‚ö° Ï†ÑÍ∏∞Ï∞®/ÏàòÏÜåÏ∞® ÏïàÎÇ¥:</strong> Ï†ÑÍ∏∞Ï∞®ÏôÄ ÏàòÏÜåÏ∞®Îäî Î∞∞Í∏∞ÎüâÏù¥ ÏóÜÏñ¥ <strong>ÎπÑÏòÅÏóÖÏö© Ïó∞ 10ÎßåÏõê, ÏòÅÏóÖÏö© Ïó∞ 2ÎßåÏõê</strong>Ïùò Í≥†Ï†ï ÏÑ∏Í∏àÏù¥ Î∂ÄÍ≥ºÎê©ÎãàÎã§. ÎòêÌïú Ï∑®ÎìùÏÑ∏ Í∞êÎ©¥ ÌòúÌÉùÎèÑ Î∞õÏùÑ Ïàò ÏûàÏäµÎãàÎã§!</p>
                            </div>
                            
                            <div class="car-form-title" style="margin-top: 25px;"><i class="fas fa-gift"></i> ÏÑ∏Í∏à Í∞êÎ©¥ ÌòúÌÉù</div>
                            <div class="car-checkbox-group">
                                <div class="car-checkbox-item" id="carExemptCheck1" onclick="toggleCarCheckbox('carExemption1')">
                                    <input type="checkbox" id="carExemption1">
                                    <label>Ïû•Ïï†Ïù∏ Ï∞®Îüâ</label>
                                </div>
                                <div class="car-checkbox-item" id="carExemptCheck2" onclick="toggleCarCheckbox('carExemption2')">
                                    <input type="checkbox" id="carExemption2">
                                    <label>Íµ≠Í∞ÄÏú†Í≥µÏûê</label>
                                </div>
                                <div class="car-checkbox-item" id="carExemptCheck3" onclick="toggleCarCheckbox('carExemption3')">
                                    <input type="checkbox" id="carExemption3">
                                    <label>Îã§ÏûêÎÖÄ Í∞ÄÍµ¨ (3ÏûêÎÖÄ+)</label>
                                </div>
                                <div class="car-checkbox-item" id="carExemptCheck4" onclick="toggleCarCheckbox('carExemption4')">
                                    <input type="checkbox" id="carExemption4">
                                    <label>Í≤ΩÏ∞® (1,000cc Ïù¥Ìïò)</label>
                                </div>
                            </div>
                            <div class="car-info-box">
                                <p><strong>üí° Í∞êÎ©¥ ÌòúÌÉù ÏïàÎÇ¥:</strong> Ïû•Ïï†Ïù∏¬∑Íµ≠Í∞ÄÏú†Í≥µÏûêÎäî 2,000cc Ïù¥Ìïò Ï∞®Îüâ Ï∑®ÎìùÏÑ∏ Î©¥Ï†ú Î∞è ÏûêÎèôÏ∞®ÏÑ∏ Í∞êÎ©¥ ÌòúÌÉùÏù¥ ÏûàÏäµÎãàÎã§. Í≤ΩÏ∞®(1,000cc Ïù¥Ìïò)Îäî Ï∑®ÎìùÏÑ∏ 75ÎßåÏõê ÌïúÎèÑ Î©¥Ï†ú!</p>
                            </div>
                            
                            <button type="submit" class="btn-calculate" style="margin-top: 25px;">
                                <i class="fas fa-calculator" style="margin-right: 8px;"></i>ÏûêÎèôÏ∞®ÏÑ∏ Í≥ÑÏÇ∞ÌïòÍ∏∞
                            </button>
                        </form>
                    </div>
                    
                    <div class="car-result-section" id="carResultSection">
                        <div class="car-result-summary" id="carResultSummary"></div>
                        
                        <div class="car-detail-container">
                            <div class="car-detail-title"><i class="fas fa-list-alt"></i> ÏûêÎèôÏ∞®ÏÑ∏ Í≥ÑÏÇ∞ ÏÉÅÏÑ∏</div>
                            <table class="car-detail-table" id="carDetailTable"></table>
                        </div>
                        
                        <div class="car-rate-table-container">
                            <div class="car-detail-title"><i class="fas fa-percentage"></i> ÏûêÎèôÏ∞®ÏÑ∏ ÏÑ∏Ïú®Ìëú (2026ÎÖÑ ÏµúÏã† Í∏∞Ï§Ä)</div>
                            <table class="car-rate-table" id="carRateTable"></table>
                        </div>
                    </div>
                    
                    <div class="car-tips-container">
                        <div class="car-tips-title"><i class="fas fa-book"></i> ÏûêÎèôÏ∞®ÏÑ∏ Ïö©Ïñ¥ ÏÇ¨Ï†Ñ</div>
                        <div class="car-terms-grid">
                            <div class="car-term-card">
                                <div class="car-term-name">üöó ÏûêÎèôÏ∞®ÏÑ∏</div>
                                <div class="car-term-desc">ÏûêÎèôÏ∞® ÏÜåÏú†Ïóê ÎåÄÌï¥ Î∂ÄÍ≥ºÎêòÎäî ÏßÄÎ∞©ÏÑ∏. Î∞∞Í∏∞Îüâ(cc)Ïóê Îî∞Îùº ÏÑ∏Í∏àÏù¥ Í≤∞Ï†ïÎêòÎ©∞, Îß§ÎÖÑ 6ÏõîÍ≥º 12ÏõîÏóê ÎÇ©Î∂ÄÌï©ÎãàÎã§.</div>
                            </div>
                            <div class="car-term-card">
                                <div class="car-term-name">üìö ÏßÄÎ∞©ÍµêÏú°ÏÑ∏</div>
                                <div class="car-term-desc">ÏûêÎèôÏ∞®ÏÑ∏Ïùò 30%Í∞Ä ÏßÄÎ∞©ÍµêÏú°ÏÑ∏Î°ú Ï∂îÍ∞Ä Î∂ÄÍ≥ºÎê©ÎãàÎã§. ÍµêÏú°Ïû¨Ï†ï ÌôïÏ∂©ÏùÑ ÏúÑÌïú Î™©Ï†ÅÏÑ∏ÏûÖÎãàÎã§.</div>
                            </div>
                            <div class="car-term-card">
                                <div class="car-term-name">üìâ Ï∞®Î†π Í≤ΩÍ∞ê</div>
                                <div class="car-term-desc">Ï∞®Îüâ Ïó∞ÏãùÏóê Îî∞Îùº ÏÑ∏Í∏àÏù¥ Í≤ΩÍ∞êÎê©ÎãàÎã§. 3ÎÖÑÏ∞®Î∂ÄÌÑ∞ Îß§ÎÖÑ 5%Ïî© ÏµúÎåÄ 50%ÍπåÏßÄ Í≤ΩÍ∞ê (12ÎÖÑ Ïù¥ÏÉÅ).</div>
                            </div>
                            <div class="car-term-card">
                                <div class="car-term-name">üí∞ Ïó∞ÎÇ© Ìï†Ïù∏</div>
                                <div class="car-term-desc">1ÎÖÑÏπò ÏÑ∏Í∏àÏùÑ 1ÏõîÏóê ÌïúÍ∫ºÎ≤àÏóê ÎÇ©Î∂ÄÌïòÎ©¥ ÏïΩ 4.57% Ìï†Ïù∏! 3Ïõî ÎÇ©Î∂Ä Ïãú ÏïΩ 3.76% Ìï†Ïù∏.</div>
                            </div>
                            <div class="car-term-card">
                                <div class="car-term-name">üè¢ ÏòÅÏóÖÏö© vs ÎπÑÏòÅÏóÖÏö©</div>
                                <div class="car-term-desc">ÏòÅÏóÖÏö©(ÌÉùÏãú, Î≤ÑÏä§ Îì±)ÏùÄ ÎπÑÏòÅÏóÖÏö©Î≥¥Îã§ ÏÑ∏Ïú®Ïù¥ ÌòÑÏ†ÄÌûà ÎÇÆÏäµÎãàÎã§. ÏïΩ 1/10 ÏàòÏ§Ä.</div>
                            </div>
                            <div class="car-term-card">
                                <div class="car-term-name">‚ö° ÏπúÌôòÍ≤ΩÏ∞®</div>
                                <div class="car-term-desc">Ï†ÑÍ∏∞Ï∞®, ÏàòÏÜåÏ∞®Îäî Î∞∞Í∏∞Îüâ ÏóÜÏù¥ Í≥†Ï†ï ÏÑ∏Ïï°. ÎπÑÏòÅÏóÖÏö© 10ÎßåÏõê, ÏòÅÏóÖÏö© 2ÎßåÏõê (Ïó∞Í∞Ñ).</div>
                            </div>
                            <div class="car-term-card">
                                <div class="car-term-name">üîã ÌïòÏù¥Î∏åÎ¶¨Îìú</div>
                                <div class="car-term-desc">ÌïòÏù¥Î∏åÎ¶¨Îìú Ï∞®ÎüâÏùÄ ÏùºÎ∞ò ÎÇ¥Ïó∞Í∏∞Í¥ÄÍ≥º ÎèôÏùºÌïòÍ≤å Î∞∞Í∏∞Îüâ Í∏∞Ï§ÄÏúºÎ°ú Í≥ºÏÑ∏Îê©ÎãàÎã§.</div>
                            </div>
                            <div class="car-term-card">
                                <div class="car-term-name">üõµ Ïù¥Î•úÏ∞®</div>
                                <div class="car-term-desc">125cc Ï¥àÍ≥º Ïù¥Î•úÏ∞®(Ïò§ÌÜ†Î∞îÏù¥)ÎèÑ ÏûêÎèôÏ∞®ÏÑ∏ ÎåÄÏÉÅ. Î∞∞Í∏∞ÎüâÎ≥Ñ Ï∞®Îì± Í≥ºÏÑ∏.</div>
                            </div>
                        </div>
                        
                        <div class="car-electric-section">
                            <div class="car-electric-title"><i class="fas fa-bolt"></i> Ï†ÑÍ∏∞Ï∞®¬∑ÏàòÏÜåÏ∞® ÏÑ∏Í∏à ÌòúÌÉù (2026ÎÖÑ ÏµúÏã†)</div>
                            <div class="car-electric-grid">
                                <div class="car-electric-card">
                                    <div class="car-electric-card-title">üöó ÏûêÎèôÏ∞®ÏÑ∏</div>
                                    <div class="car-electric-card-value">10ÎßåÏõê</div>
                                    <div class="car-electric-card-desc">ÎπÑÏòÅÏóÖÏö© Ïó∞Í∞Ñ (ÏòÅÏóÖÏö© 2ÎßåÏõê)</div>
                                </div>
                                <div class="car-electric-card">
                                    <div class="car-electric-card-title">üíµ Ï∑®ÎìùÏÑ∏ Í∞êÎ©¥</div>
                                    <div class="car-electric-card-value">ÏµúÎåÄ 140ÎßåÏõê</div>
                                    <div class="car-electric-card-desc">Ï†ÑÍ∏∞Ï∞® Ï∑®ÎìùÏÑ∏ Í∞êÎ©¥ ÌïúÎèÑ</div>
                                </div>
                                <div class="car-electric-card">
                                    <div class="car-electric-card-title">üÖøÔ∏è Í≥µÏòÅÏ£ºÏ∞®Ïû•</div>
                                    <div class="car-electric-card-value">50% Ìï†Ïù∏</div>
                                    <div class="car-electric-card-desc">ÏßÄÏûêÏ≤¥Î≥Ñ ÏÉÅÏù¥</div>
                                </div>
                            </div>
                            <div class="car-info-box electric" style="margin-top: 15px;">
                                <p><strong>üå± ÏπúÌôòÍ≤ΩÏ∞® Ï∂îÍ∞Ä ÌòúÌÉù:</strong> Í≥†ÏÜçÎèÑÎ°ú ÌÜµÌñâÎ£å 50% Ìï†Ïù∏, ÌòºÏû°ÌÜµÌñâÎ£å Î©¥Ï†ú, Í≥µÏòÅÏ£ºÏ∞®Ïû• Ìï†Ïù∏, Ï∂©Ï†ÑÏöîÍ∏à Ìï†Ïù∏ Îì± Îã§ÏñëÌïú ÌòúÌÉùÏù¥ ÏûàÏäµÎãàÎã§. ÏßÄÏûêÏ≤¥Î≥ÑÎ°ú Ï∂îÍ∞Ä ÌòúÌÉùÏù¥ Îã§Î•º Ïàò ÏûàÏúºÎãà ÌôïÏù∏ÌïòÏÑ∏Ïöî!</p>
                            </div>
                        </div>
                        
                        <div class="car-prepay-section">
                            <div class="car-prepay-title"><i class="fas fa-calendar-check"></i> Ïó∞ÎÇ© Ìï†Ïù∏ Ï†úÎèÑ</div>
                            <div class="car-prepay-grid">
                                <div class="car-prepay-card">
                                    <div class="car-prepay-month">1Ïõî Ïó∞ÎÇ©</div>
                                    <div class="car-prepay-rate">4.57%</div>
                                    <div class="car-prepay-desc">1.16~1.31 Ïã†Ï≤≠</div>
                                </div>
                                <div class="car-prepay-card">
                                    <div class="car-prepay-month">3Ïõî Ïó∞ÎÇ©</div>
                                    <div class="car-prepay-rate">3.76%</div>
                                    <div class="car-prepay-desc">3.16~3.31 Ïã†Ï≤≠</div>
                                </div>
                                <div class="car-prepay-card">
                                    <div class="car-prepay-month">6Ïõî Ïó∞ÎÇ©</div>
                                    <div class="car-prepay-rate">2.52%</div>
                                    <div class="car-prepay-desc">6.16~6.30 Ïã†Ï≤≠</div>
                                </div>
                                <div class="car-prepay-card">
                                    <div class="car-prepay-month">9Ïõî Ïó∞ÎÇ©</div>
                                    <div class="car-prepay-rate">1.26%</div>
                                    <div class="car-prepay-desc">9.16~9.30 Ïã†Ï≤≠</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="car-save-section">
                            <div class="car-save-title"><i class="fas fa-piggy-bank"></i> ÏûêÎèôÏ∞®ÏÑ∏ Ï†àÏÑ∏ ÌåÅ</div>
                            <div class="car-save-item">
                                <div class="car-save-item-title">1. 1Ïõî Ïó∞ÎÇ© Ïã†Ï≤≠ÌïòÍ∏∞</div>
                                <div class="car-save-item-content">Îß§ÎÖÑ 1ÏõîÏóê Ïó∞ÎÇ© Ïã†Ï≤≠ÌïòÎ©¥ 4.57% Ìï†Ïù∏! ÏúÑÌÉùÏä§(wetax.go.kr)ÏóêÏÑú Í∞ÑÌé∏ÌïòÍ≤å Ïã†Ï≤≠ Í∞ÄÎä•Ìï©ÎãàÎã§.</div>
                            </div>
                            <div class="car-save-item">
                                <div class="car-save-item-title">2. Í≤ΩÏ∞® Íµ¨Îß§ Í≥†Î†§</div>
                                <div class="car-save-item-content">1,000cc Ïù¥Ìïò Í≤ΩÏ∞®Îäî Ï∑®ÎìùÏÑ∏ 75ÎßåÏõê ÌïúÎèÑ Î©¥Ï†ú, ÏûêÎèôÏ∞®ÏÑ∏ÎèÑ Ï†ÄÎ†¥Ìï©ÎãàÎã§. Ïó∞ 10ÎßåÏõê Ïù¥Ìïò!</div>
                            </div>
                            <div class="car-save-item">
                                <div class="car-save-item-title">3. Ï†ÑÍ∏∞Ï∞® Ï†ÑÌôò</div>
                                <div class="car-save-item-content">Ï†ÑÍ∏∞Ï∞®Îäî ÏûêÎèôÏ∞®ÏÑ∏Í∞Ä Ïó∞ 10ÎßåÏõê Í≥†Ï†ï! 2,000cc Ï∞®Îüâ ÎåÄÎπÑ Ïó∞ 40ÎßåÏõê Ïù¥ÏÉÅ Ï†àÏïΩ Í∞ÄÎä•Ìï©ÎãàÎã§.</div>
                            </div>
                            <div class="car-save-item">
                                <div class="car-save-item-title">4. Ï∞®Î†π Í≤ΩÍ∞ê ÌôúÏö©</div>
                                <div class="car-save-item-content">Ï∞®ÎüâÏù¥ Ïò§ÎûòÎê†ÏàòÎ°ù ÏÑ∏Í∏àÏù¥ Ï§ÑÏñ¥Îì≠ÎãàÎã§. 12ÎÖÑ Ïù¥ÏÉÅ Î≥¥Ïú† Ïãú ÏµúÎåÄ 50% Í≤ΩÍ∞ê!</div>
                            </div>
                            <div class="car-save-item">
                                <div class="car-save-item-title">5. Í∞êÎ©¥ ÎåÄÏÉÅ ÌôïÏù∏</div>
                                <div class="car-save-item-content">Ïû•Ïï†Ïù∏, Íµ≠Í∞ÄÏú†Í≥µÏûê, Îã§ÏûêÎÖÄ Í∞ÄÍµ¨Îäî Í∞êÎ©¥ ÌòúÌÉùÏù¥ ÏûàÏäµÎãàÎã§. Ìï¥ÎãπÎêòÎ©¥ Íº≠ Ïã†Ï≤≠ÌïòÏÑ∏Ïöî!</div>
                            </div>
                            <div class="car-save-item">
                                <div class="car-save-item-title">6. ÎßêÏÜå Ïãú ÌôòÍ∏â</div>
                                <div class="car-save-item-content">Ï∞®ÎüâÏùÑ ÌèêÏ∞®¬∑ÏàòÏ∂ú¬∑ÏñëÎèÑÌïòÎ©¥ ÎÇ®ÏùÄ Í∏∞Í∞Ñ ÏÑ∏Í∏àÏù¥ ÌôòÍ∏âÎê©ÎãàÎã§. Ïù¥Ï†ÑÎì±Î°ù ÌõÑ ÏûêÎèô Ï†ïÏÇ∞.</div>
                            </div>
                        </div>
                        
                        <div class="car-warning-box">
                            <strong>‚ö†Ô∏è Ï£ºÏùòÏÇ¨Ìï≠:</strong><br>
                            ‚Ä¢ ÏûêÎèôÏ∞®ÏÑ∏Îäî Îß§ÎÖÑ 6Ïõî(1Í∏∞Î∂Ñ), 12Ïõî(2Í∏∞Î∂Ñ)Ïóê ÎÇ©Î∂ÄÌï©ÎãàÎã§.<br>
                            ‚Ä¢ Ïó∞ÎÇ© Ïã†Ï≤≠ÏùÄ ÏúÑÌÉùÏä§(wetax.go.kr) ÎòêÎäî Í¥ÄÌï† Íµ¨Ï≤≠ÏóêÏÑú Í∞ÄÎä•Ìï©ÎãàÎã§.<br>
                            ‚Ä¢ ÎØ∏ÎÇ© Ïãú Í∞ÄÏÇ∞Í∏à(3%)Ïù¥ Î∂ÄÍ≥ºÎêòÎ©∞, Î≤àÌò∏Ìåê ÏòÅÏπòÎê† Ïàò ÏûàÏäµÎãàÎã§.<br>
                            ‚Ä¢ Ï†ÑÍ∏∞Ï∞® ÌòúÌÉùÏùÄ 2026ÎÖÑ ÏµúÏã† Í∏∞Ï§ÄÏù¥Î©∞, Ï†ïÏ±ÖÏóê Îî∞Îùº Î≥ÄÍ≤ΩÎê† Ïàò ÏûàÏäµÎãàÎã§.<br>
                            ‚Ä¢ Ï∞®Î†π Í≤ΩÍ∞êÏùÄ ÏµúÏ¥àÎì±Î°ùÏùº Í∏∞Ï§Ä 3ÎÖÑÏ∞®Î∂ÄÌÑ∞ Ï†ÅÏö©Îê©ÎãàÎã§.
                        </div>
                    </div>
                </div>
            `;
        }

        function toggleCarCheckbox(id) {
            const checkbox = document.getElementById(id);
            checkbox.checked = !checkbox.checked;
            const parent = checkbox.closest('.car-checkbox-item');
            if (checkbox.checked) {
                parent.classList.add('checked');
            } else {
                parent.classList.remove('checked');
            }
        }

        function updateCarOptions() {
            const fuelType = document.getElementById('carFuelType').value;
            const ccGroup = document.getElementById('ccGroup');
            const electricInfo = document.getElementById('electricInfo');
            
            if (fuelType === 'electric' || fuelType === 'hydrogen') {
                ccGroup.classList.add('hidden');
                electricInfo.style.display = 'block';
            } else {
                ccGroup.classList.remove('hidden');
                electricInfo.style.display = 'none';
            }
        }

        function calculateCarTax(e) {
            e.preventDefault();
            
            const vehicleType = document.getElementById('carVehicleType').value;
            const fuelType = document.getElementById('carFuelType').value;
            const usageType = document.getElementById('carUsageType').value;
            const carYear = parseInt(document.getElementById('carYear').value) || 2024;
            const cc = parseNumberFromComma(document.getElementById('carCC').value) || 2000;
            
            const isElectric = fuelType === 'electric' || fuelType === 'hydrogen';
            const isBusiness = usageType === 'business';
            const isPrivate = usageType === 'private';
            
            // Í∞êÎ©¥ Ï≤¥ÌÅ¨
            const isDisabled = document.getElementById('carExemption1').checked;
            const isVeteran = document.getElementById('carExemption2').checked;
            const isMultiChild = document.getElementById('carExemption3').checked;
            const isCompact = document.getElementById('carExemption4').checked || cc <= 1000;
            
            // Ï∞®Î†π Í≥ÑÏÇ∞ (Í≤ΩÍ∞êÎ•†) - 2026ÎÖÑ Í∏∞Ï§Ä
            const currentYear = 2026;
            const vehicleAge = Math.max(currentYear - carYear, 0);
            let ageDiscountRate = 0;
            if (vehicleAge >= 3) {
                ageDiscountRate = Math.min((vehicleAge - 2) * 5, 50); // 3ÎÖÑÏ∞®Î∂ÄÌÑ∞ 5%Ïî©, ÏµúÎåÄ 50%
            }
            
            let baseTax = 0;
            let taxDescription = '';
            let ccPerRate = 0;
            
            // ÏÑ∏Í∏à Í≥ÑÏÇ∞
            if (isElectric) {
                // Ï†ÑÍ∏∞Ï∞®/ÏàòÏÜåÏ∞®
                baseTax = isBusiness ? 20000 : 100000;
                taxDescription = fuelType === 'electric' ? 'Ï†ÑÍ∏∞Ï∞® Í≥†Ï†ïÏÑ∏Ïï°' : 'ÏàòÏÜåÏ∞® Í≥†Ï†ïÏÑ∏Ïï°';
            } else if (vehicleType === 'passenger') {
                // ÏäπÏö©Ï∞®
                if (isBusiness) {
                    // ÏòÅÏóÖÏö©
                    if (cc <= 1600) {
                        ccPerRate = 18;
                    } else if (cc <= 2500) {
                        ccPerRate = 19;
                    } else {
                        ccPerRate = 24;
                    }
                } else {
                    // ÎπÑÏòÅÏóÖÏö©
                    if (cc <= 1000) {
                        ccPerRate = 80;
                    } else if (cc <= 1600) {
                        ccPerRate = 140;
                    } else {
                        ccPerRate = 200;
                    }
                }
                baseTax = cc * ccPerRate;
                taxDescription = `${cc.toLocaleString()}cc √ó ${ccPerRate}Ïõê`;
            } else if (vehicleType === 'van') {
                // ÏäπÌï©Ï∞®
                baseTax = isBusiness ? 25000 : 65000;
                taxDescription = 'ÏäπÌï©Ï∞® Í≥†Ï†ïÏÑ∏Ïï°';
            } else if (vehicleType === 'truck') {
                // ÌôîÎ¨ºÏ∞®
                baseTax = isBusiness ? 6600 : 28500;
                taxDescription = 'ÌôîÎ¨ºÏ∞® Í≥†Ï†ïÏÑ∏Ïï°';
            } else if (vehicleType === 'special') {
                // ÌäπÏàòÏ∞®
                baseTax = isBusiness ? 13500 : 58500;
                taxDescription = 'ÌäπÏàòÏ∞® Í≥†Ï†ïÏÑ∏Ïï°';
            } else if (vehicleType === 'motorcycle') {
                // Ïù¥Î•úÏ∞®
                if (cc <= 125) {
                    baseTax = 0;
                    taxDescription = '125cc Ïù¥Ìïò Î©¥ÏÑ∏';
                } else if (cc <= 260) {
                    baseTax = 18000;
                    taxDescription = '260cc Ïù¥Ìïò';
                } else {
                    baseTax = isBusiness ? 18000 : 36000;
                    taxDescription = '260cc Ï¥àÍ≥º';
                }
            }
            
            // Ï∞®Î†π Í≤ΩÍ∞ê Ï†ÅÏö© (Ï†ÑÍ∏∞Ï∞®/ÏàòÏÜåÏ∞® Ï†úÏô∏)
            let ageDiscount = 0;
            if (!isElectric && ageDiscountRate > 0) {
                ageDiscount = Math.round(baseTax * ageDiscountRate / 100);
            }
            const taxAfterAge = baseTax - ageDiscount;
            
            // ÏßÄÎ∞©ÍµêÏú°ÏÑ∏ (30%)
            const localEducationTax = Math.round(taxAfterAge * 0.3);
            
            // Í∞êÎ©¥ Ï†ÅÏö©
            let exemptionAmount = 0;
            let exemptionReason = '';
            
            if (isDisabled || isVeteran) {
                if (cc <= 2000) {
                    exemptionAmount = taxAfterAge + localEducationTax;
                    exemptionReason = isDisabled ? 'Ïû•Ïï†Ïù∏ Ï∞®Îüâ Ï†ÑÏï° Î©¥Ï†ú' : 'Íµ≠Í∞ÄÏú†Í≥µÏûê Ï†ÑÏï° Î©¥Ï†ú';
                }
            } else if (isMultiChild) {
                exemptionAmount = Math.round((taxAfterAge + localEducationTax) * 0.5);
                exemptionReason = 'Îã§ÏûêÎÖÄ Í∞ÄÍµ¨ 50% Í∞êÎ©¥';
            }
            
            // Ï¥ù ÏÑ∏Í∏à
            const totalBeforeExemption = taxAfterAge + localEducationTax;
            const totalTax = Math.max(totalBeforeExemption - exemptionAmount, 0);
            
            // Ïó∞ÎÇ© Ïãú Ìï†Ïù∏Ïï°
            const annualPayDiscount = Math.round(totalTax * 0.0457);
            const annualPayAmount = totalTax - annualPayDiscount;
            
            // Í≤∞Í≥º ÌëúÏãú
            const resultSection = document.getElementById('carResultSection');
            resultSection.classList.add('active');
            
            // Î∞∞ÏßÄ ÏÉùÏÑ±
            let badge = '';
            if (isElectric) {
                badge = `<span class="car-type-badge electric">‚ö° ${fuelType === 'electric' ? 'Ï†ÑÍ∏∞Ï∞®' : 'ÏàòÏÜåÏ∞®'}</span>`;
            } else if (fuelType === 'hybrid') {
                badge = '<span class="car-type-badge hybrid">üîã ÌïòÏù¥Î∏åÎ¶¨Îìú</span>';
            }
            if (exemptionAmount > 0) {
                badge += `<span class="car-type-badge discount">üí∞ Í∞êÎ©¥ Ï†ÅÏö©</span>`;
            }
            
            // ÏöîÏïΩ Ïπ¥Îìú
            document.getElementById('carResultSummary').innerHTML = `
                <div class="car-summary-card tax">
                    <div class="car-summary-label">ÏûêÎèôÏ∞®ÏÑ∏ (Ïó∞Í∞Ñ)</div>
                    <div class="car-summary-value">${taxAfterAge.toLocaleString()}Ïõê</div>
                </div>
                <div class="car-summary-card local">
                    <div class="car-summary-label">ÏßÄÎ∞©ÍµêÏú°ÏÑ∏ (30%)</div>
                    <div class="car-summary-value">${localEducationTax.toLocaleString()}Ïõê</div>
                </div>
                <div class="car-summary-card discount">
                    <div class="car-summary-label">${exemptionAmount > 0 ? 'Í∞êÎ©¥Ïï°' : 'Ïó∞ÎÇ© Ïãú Ìï†Ïù∏'}</div>
                    <div class="car-summary-value">-${(exemptionAmount > 0 ? exemptionAmount : annualPayDiscount).toLocaleString()}Ïõê</div>
                </div>
                <div class="car-summary-card total">
                    <div class="car-summary-label">Ï¥ù ÎÇ©Î∂ÄÏÑ∏Ïï° (Ïó∞Í∞Ñ)</div>
                    <div class="car-summary-value">${totalTax.toLocaleString()}Ïõê</div>
                </div>
            `;
            
            // ÏÉÅÏÑ∏ ÌÖåÏù¥Î∏î
            document.getElementById('carDetailTable').innerHTML = `
                <thead>
                    <tr>
                        <th>Ìï≠Î™©</th>
                        <th>Í∏àÏï°/ÎÇ¥Ïö©</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Ï∞®Îüâ Ï¢ÖÎ•ò ${badge}</td>
                        <td>${getVehicleTypeName(vehicleType)} (${isBusiness ? 'ÏòÅÏóÖÏö©' : 'ÎπÑÏòÅÏóÖÏö©'})</td>
                    </tr>
                    ${!isElectric ? `
                    <tr>
                        <td>Î∞∞Í∏∞Îüâ</td>
                        <td>${cc.toLocaleString()}cc</td>
                    </tr>
                    ` : ''}
                    <tr>
                        <td>Ï∞®Îüâ Ïó∞Ïãù</td>
                        <td>${carYear}ÎÖÑ (${vehicleAge}ÎÖÑÏ∞®)</td>
                    </tr>
                    <tr class="highlight">
                        <td>Í∏∞Î≥∏ ÏûêÎèôÏ∞®ÏÑ∏</td>
                        <td>${baseTax.toLocaleString()}Ïõê (${taxDescription})</td>
                    </tr>
                    ${ageDiscount > 0 ? `
                    <tr style="color: #38a169;">
                        <td>(-) Ï∞®Î†π Í≤ΩÍ∞ê (${ageDiscountRate}%)</td>
                        <td>-${ageDiscount.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>Í≤ΩÍ∞ê ÌõÑ ÏûêÎèôÏ∞®ÏÑ∏</td>
                        <td>${taxAfterAge.toLocaleString()}Ïõê</td>
                    </tr>
                    ` : ''}
                    <tr>
                        <td>(+) ÏßÄÎ∞©ÍµêÏú°ÏÑ∏ (30%)</td>
                        <td>${localEducationTax.toLocaleString()}Ïõê</td>
                    </tr>
                    ${exemptionAmount > 0 ? `
                    <tr style="color: #38a169;">
                        <td>(-) ${exemptionReason}</td>
                        <td>-${exemptionAmount.toLocaleString()}Ïõê</td>
                    </tr>
                    ` : ''}
                    <tr class="total-row">
                        <td>Ïó∞Í∞Ñ Ï¥ù ÎÇ©Î∂ÄÏÑ∏Ïï°</td>
                        <td>${totalTax.toLocaleString()}Ïõê</td>
                    </tr>
                    <tr>
                        <td>üìÖ 1Ïõî Ïó∞ÎÇ© Ïãú (4.57% Ìï†Ïù∏)</td>
                        <td><strong>${annualPayAmount.toLocaleString()}Ïõê</strong> (-${annualPayDiscount.toLocaleString()}Ïõê)</td>
                    </tr>
                    <tr>
                        <td>üìÖ Î∞òÍ∏∞ ÎÇ©Î∂Ä (6Ïõî/12Ïõî)</td>
                        <td>${Math.round(totalTax / 2).toLocaleString()}Ïõê √ó 2Ìöå</td>
                    </tr>
                </tbody>
            `;
            
            // ÏÑ∏Ïú®Ìëú
            const isPassengerPrivate = vehicleType === 'passenger' && isPrivate && !isElectric;
            const isPassengerBusiness = vehicleType === 'passenger' && isBusiness && !isElectric;
            
            document.getElementById('carRateTable').innerHTML = `
                <thead>
                    <tr>
                        <th>Ï∞®Îüâ Íµ¨Î∂Ñ</th>
                        <th>Î∞∞Í∏∞Îüâ/Ï°∞Í±¥</th>
                        <th>ÏÑ∏Ïï° (Ïó∞Í∞Ñ)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="${isPassengerPrivate && cc <= 1000 ? 'active-row' : ''}">
                        <td rowspan="3">ÎπÑÏòÅÏóÖÏö© ÏäπÏö©Ï∞®</td>
                        <td>1,000cc Ïù¥Ìïò</td>
                        <td>ccÎãπ 80Ïõê</td>
                    </tr>
                    <tr class="${isPassengerPrivate && cc > 1000 && cc <= 1600 ? 'active-row' : ''}">
                        <td>1,000cc~1,600cc</td>
                        <td>ccÎãπ 140Ïõê</td>
                    </tr>
                    <tr class="${isPassengerPrivate && cc > 1600 ? 'active-row' : ''}">
                        <td>1,600cc Ï¥àÍ≥º</td>
                        <td>ccÎãπ 200Ïõê</td>
                    </tr>
                    <tr class="${isPassengerBusiness && cc <= 1600 ? 'active-row' : ''}">
                        <td rowspan="3">ÏòÅÏóÖÏö© ÏäπÏö©Ï∞®</td>
                        <td>1,600cc Ïù¥Ìïò</td>
                        <td>ccÎãπ 18Ïõê</td>
                    </tr>
                    <tr class="${isPassengerBusiness && cc > 1600 && cc <= 2500 ? 'active-row' : ''}">
                        <td>1,600cc~2,500cc</td>
                        <td>ccÎãπ 19Ïõê</td>
                    </tr>
                    <tr class="${isPassengerBusiness && cc > 2500 ? 'active-row' : ''}">
                        <td>2,500cc Ï¥àÍ≥º</td>
                        <td>ccÎãπ 24Ïõê</td>
                    </tr>
                    <tr class="${isElectric && !isBusiness ? 'active-row' : ''}">
                        <td>Ï†ÑÍ∏∞Ï∞®/ÏàòÏÜåÏ∞® (ÎπÑÏòÅÏóÖ)</td>
                        <td>-</td>
                        <td>100,000Ïõê</td>
                    </tr>
                    <tr class="${isElectric && isBusiness ? 'active-row' : ''}">
                        <td>Ï†ÑÍ∏∞Ï∞®/ÏàòÏÜåÏ∞® (ÏòÅÏóÖ)</td>
                        <td>-</td>
                        <td>20,000Ïõê</td>
                    </tr>
                    <tr class="${vehicleType === 'van' ? 'active-row' : ''}">
                        <td>ÏäπÌï©Ï∞®</td>
                        <td>ÎπÑÏòÅÏóÖ/ÏòÅÏóÖ</td>
                        <td>65,000Ïõê / 25,000Ïõê</td>
                    </tr>
                    <tr class="${vehicleType === 'truck' ? 'active-row' : ''}">
                        <td>ÌôîÎ¨ºÏ∞®</td>
                        <td>ÎπÑÏòÅÏóÖ/ÏòÅÏóÖ</td>
                        <td>28,500Ïõê / 6,600Ïõê</td>
                    </tr>
                </tbody>
            `;
            
            // Í≤∞Í≥ºÎ°ú Ïä§ÌÅ¨Î°§
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // ÏΩ§Îßà ÏûÖÎ†• Ïû¨ÏÑ§Ï†ï
            setTimeout(() => setupCommaInputs(), 100);
        }

        function getVehicleTypeName(type) {
            const names = {
                'passenger': 'ÏäπÏö©Ï∞®',
                'van': 'ÏäπÌï©Ï∞®',
                'truck': 'ÌôîÎ¨ºÏ∞®',
                'special': 'ÌäπÏàòÏ∞®',
                'motorcycle': 'Ïù¥Î•úÏ∞®'
            };
            return names[type] || type;
        }

        // ===== Ìù°Ïó∞ Í≥ÑÏÇ∞Í∏∞ =====
        function getSmokingCalculator() {
            return `
                <style>
                    .smoking-calculator {
                        max-width: 800px;
                        margin: 0 auto;
                    }
                    
                    .smoking-form-section {
                        background: #fff;
                        border-radius: 16px;
                        padding: 30px;
                        margin-bottom: 24px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                    }
                    
                    .smoking-form-title {
                        font-size: 20px;
                        font-weight: 700;
                        color: #eb5757;
                        margin-bottom: 24px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    
                    .smoking-form-title i {
                        font-size: 24px;
                    }
                    
                    .smoking-form-group {
                        margin-bottom: 20px;
                    }
                    
                    .smoking-form-group label {
                        display: block;
                        font-weight: 600;
                        color: #333;
                        margin-bottom: 8px;
                        font-size: 15px;
                    }
                    
                    .smoking-form-group .label-hint {
                        font-weight: 400;
                        color: #888;
                        font-size: 13px;
                    }
                    
                    .smoking-radio-group {
                        display: flex;
                        gap: 12px;
                        flex-wrap: wrap;
                    }
                    
                    .smoking-radio-item {
                        flex: 1;
                        min-width: 140px;
                    }
                    
                    .smoking-radio-item input {
                        display: none;
                    }
                    
                    .smoking-radio-item label {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        justify-content: center;
                        padding: 16px 12px;
                        border: 2px solid #e2e8f0;
                        border-radius: 12px;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        text-align: center;
                        background: #fafafa;
                    }
                    
                    .smoking-radio-item label:hover {
                        border-color: #eb5757;
                        background: #fff5f5;
                    }
                    
                    .smoking-radio-item input:checked + label {
                        border-color: #eb5757;
                        background: linear-gradient(135deg, #eb5757 0%, #f2994a 100%);
                        color: white;
                    }
                    
                    .smoking-radio-item label i {
                        font-size: 28px;
                        margin-bottom: 8px;
                    }
                    
                    .smoking-radio-item label span {
                        font-size: 14px;
                        font-weight: 600;
                    }
                    
                    .smoking-input-row {
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 20px;
                    }
                    
                    .smoking-input-field {
                        position: relative;
                    }
                    
                    .smoking-input-field input {
                        width: 100%;
                        padding: 14px 50px 14px 16px;
                        border: 2px solid #e2e8f0;
                        border-radius: 10px;
                        font-size: 16px;
                        transition: all 0.3s ease;
                    }
                    
                    .smoking-input-field input:focus {
                        outline: none;
                        border-color: #eb5757;
                        box-shadow: 0 0 0 3px rgba(235, 87, 87, 0.1);
                    }
                    
                    .smoking-input-suffix {
                        position: absolute;
                        right: 16px;
                        top: 50%;
                        transform: translateY(-50%);
                        color: #888;
                        font-weight: 500;
                    }
                    
                    .smoking-btn-calculate {
                        width: 100%;
                        padding: 18px;
                        background: linear-gradient(135deg, #eb5757 0%, #f2994a 100%);
                        color: white;
                        border: none;
                        border-radius: 12px;
                        font-size: 18px;
                        font-weight: 700;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                        margin-top: 10px;
                    }
                    
                    .smoking-btn-calculate:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 8px 25px rgba(235, 87, 87, 0.4);
                    }
                    
                    .smoking-result-section {
                        display: none;
                    }
                    
                    .smoking-result-section.active {
                        display: block;
                        animation: fadeInUp 0.5s ease;
                    }
                    
                    .smoking-summary-card {
                        background: linear-gradient(135deg, #eb5757 0%, #f2994a 100%);
                        border-radius: 20px;
                        padding: 30px;
                        color: white;
                        text-align: center;
                        margin-bottom: 24px;
                        box-shadow: 0 8px 30px rgba(235, 87, 87, 0.3);
                    }
                    
                    .smoking-summary-title {
                        font-size: 16px;
                        opacity: 0.9;
                        margin-bottom: 8px;
                    }
                    
                    .smoking-summary-days {
                        font-size: 48px;
                        font-weight: 800;
                        margin-bottom: 4px;
                    }
                    
                    .smoking-summary-days span {
                        font-size: 24px;
                        font-weight: 400;
                    }
                    
                    .smoking-summary-subtitle {
                        font-size: 18px;
                        margin-top: 16px;
                        padding-top: 16px;
                        border-top: 1px solid rgba(255,255,255,0.3);
                    }
                    
                    .smoking-summary-tax {
                        font-size: 36px;
                        font-weight: 800;
                        color: #fff700;
                        margin-top: 8px;
                        text-shadow: 0 2px 10px rgba(0,0,0,0.2);
                    }
                    
                    .smoking-cost-card {
                        background: #fff;
                        border-radius: 16px;
                        padding: 24px;
                        margin-bottom: 24px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                    }
                    
                    .smoking-cost-title {
                        font-size: 16px;
                        color: #888;
                        margin-bottom: 8px;
                    }
                    
                    .smoking-cost-amount {
                        font-size: 32px;
                        font-weight: 800;
                        color: #333;
                    }
                    
                    .smoking-cost-desc {
                        font-size: 14px;
                        color: #888;
                        margin-top: 8px;
                    }
                    
                    .smoking-tax-breakdown {
                        background: #fff;
                        border-radius: 16px;
                        padding: 24px;
                        margin-bottom: 24px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                    }
                    
                    .smoking-tax-title {
                        font-size: 18px;
                        font-weight: 700;
                        color: #333;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 10px;
                    }
                    
                    .smoking-tax-item {
                        display: flex;
                        justify-content: space-between;
                        align-items: flex-start;
                        padding: 16px 0;
                        border-bottom: 1px solid #f0f0f0;
                    }
                    
                    .smoking-tax-item:last-child {
                        border-bottom: none;
                    }
                    
                    .smoking-tax-item-left {
                        flex: 1;
                    }
                    
                    .smoking-tax-item-name {
                        font-size: 16px;
                        font-weight: 600;
                        color: #333;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    
                    .smoking-tax-item-name .tax-icon {
                        width: 32px;
                        height: 32px;
                        border-radius: 8px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 16px;
                    }
                    
                    .smoking-tax-item-desc {
                        font-size: 13px;
                        color: #888;
                        margin-top: 4px;
                        padding-left: 40px;
                    }
                    
                    .smoking-tax-item-amount {
                        font-size: 16px;
                        font-weight: 700;
                        color: #333;
                        text-align: right;
                        white-space: nowrap;
                    }
                    
                    .smoking-warning-box {
                        background: linear-gradient(135deg, #fff5f5 0%, #ffebee 100%);
                        border: 2px solid #eb5757;
                        border-radius: 16px;
                        padding: 24px;
                        margin-bottom: 24px;
                    }
                    
                    .smoking-warning-title {
                        font-size: 18px;
                        font-weight: 700;
                        color: #eb5757;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        margin-bottom: 12px;
                    }
                    
                    .smoking-warning-text {
                        font-size: 15px;
                        color: #c0392b;
                        line-height: 1.6;
                    }
                    
                    .smoking-tips-section {
                        background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
                        border-radius: 16px;
                        padding: 24px;
                        margin-bottom: 24px;
                    }
                    
                    .smoking-tips-title {
                        font-size: 18px;
                        font-weight: 700;
                        color: #2e7d32;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        margin-bottom: 16px;
                    }
                    
                    .smoking-tip-item {
                        background: white;
                        border-radius: 12px;
                        padding: 16px;
                        margin-bottom: 12px;
                        box-shadow: 0 2px 10px rgba(0,0,0,0.05);
                    }
                    
                    .smoking-tip-item:last-child {
                        margin-bottom: 0;
                    }
                    
                    .smoking-tip-item-title {
                        font-size: 15px;
                        font-weight: 700;
                        color: #2e7d32;
                        margin-bottom: 6px;
                    }
                    
                    .smoking-tip-item-content {
                        font-size: 14px;
                        color: #555;
                        line-height: 1.5;
                    }
                    
                    .smoking-hotline {
                        background: linear-gradient(135deg, #1976d2 0%, #42a5f5 100%);
                        border-radius: 12px;
                        padding: 20px;
                        color: white;
                        text-align: center;
                        margin-top: 16px;
                    }
                    
                    .smoking-hotline-title {
                        font-size: 14px;
                        opacity: 0.9;
                        margin-bottom: 8px;
                    }
                    
                    .smoking-hotline-number {
                        font-size: 28px;
                        font-weight: 800;
                    }
                    
                    @media (max-width: 600px) {
                        .smoking-input-row {
                            grid-template-columns: 1fr;
                        }
                        
                        .smoking-radio-item {
                            min-width: 100px;
                        }
                        
                        .smoking-summary-days {
                            font-size: 36px;
                        }
                        
                        .smoking-summary-tax {
                            font-size: 28px;
                        }
                        
                        .smoking-cost-amount {
                            font-size: 24px;
                        }
                    }
                </style>
                
                <div class="smoking-calculator">
                    <!-- ÏÉÅÎã® Ï†úÎ™© Ï∂îÍ∞Ä -->
                    <div class="smoking-header" style="text-align: center; margin-bottom: 30px;">
                        <div style="display: inline-flex; align-items: center; justify-content: center; width: 80px; height: 80px; background: linear-gradient(135deg, #eb5757 0%, #f2994a 100%); border-radius: 50%; margin-bottom: 16px; box-shadow: 0 8px 25px rgba(235, 87, 87, 0.3);">
                            <i class="fas fa-smoking" style="font-size: 36px; color: white;"></i>
                        </div>
                        <h2 style="font-size: 28px; font-weight: 700; color: #333; margin-bottom: 8px;">Ìù°Ïó∞ Í≥ÑÏÇ∞Í∏∞</h2>
                        <p style="font-size: 16px; color: #888;">Îã¥Î∞∞Ïóê ÏßÄÏ∂úÌïú ÎπÑÏö©Í≥º ÏÑ∏Í∏àÏùÑ Í≥ÑÏÇ∞Ìï¥Î≥¥ÏÑ∏Ïöî</p>
                    </div>
                    
                    <form class="smoking-form-section" onsubmit="calculateSmoking(event)">
                        <div class="smoking-form-title">
                            <i class="fas fa-smoking"></i>
                            Ìù°Ïó∞ Ï†ïÎ≥¥ ÏûÖÎ†•
                        </div>
                        
                        <div class="smoking-form-group">
                            <label>ÌîºÏö∞Îäî Îã¥Î∞∞ Ï¢ÖÎ•ò</label>
                            <div class="smoking-radio-group">
                                <div class="smoking-radio-item">
                                    <input type="radio" name="cigaretteType" id="typeNormal" value="normal" checked>
                                    <label for="typeNormal">
                                        <i class="fas fa-smoking"></i>
                                        <span>Ïó∞Ï¥à ÏùºÎ∞òÌòï Îã¥Î∞∞</span>
                                    </label>
                                </div>
                                <div class="smoking-radio-item">
                                    <input type="radio" name="cigaretteType" id="typeHeat" value="heat">
                                    <label for="typeHeat">
                                        <i class="fas fa-fire"></i>
                                        <span>Í∂êÎ†®Ìòï Ï†ÑÏûêÎã¥Î∞∞</span>
                                    </label>
                                </div>
                                <div class="smoking-radio-item">
                                    <input type="radio" name="cigaretteType" id="typeLiquid" value="liquid">
                                    <label for="typeLiquid">
                                        <i class="fas fa-tint"></i>
                                        <span>Ïï°ÏÉÅÌòï Ï†ÑÏûêÎã¥Î∞∞</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="smoking-input-row">
                            <div class="smoking-form-group">
                                <label>
                                    Ìù°Ïó∞ Í∏∞Í∞Ñ 
                                    <span class="label-hint">(1ÎÖÑ ÎØ∏ÎßåÏùÄ ÏÜåÏàòÏ†ê ÏûÖÎ†•)</span>
                                </label>
                                <div class="smoking-input-field">
                                    <input type="number" id="smokingYears" step="0.1" min="0.1" max="100" placeholder="Ïòà: 10" required>
                                    <span class="smoking-input-suffix">ÎÖÑ</span>
                                </div>
                            </div>
                            
                            <div class="smoking-form-group">
                                <label>
                                    ÌïòÎ£® Ìù°Ïó∞Îüâ 
                                    <span class="label-hint">(1Í∞ë=1ml)</span>
                                </label>
                                <div class="smoking-input-field">
                                    <input type="number" id="smokingAmount" step="0.1" min="0.1" max="10" placeholder="Ïòà: 1" required>
                                    <span class="smoking-input-suffix">Í∞ë/ml</span>
                                </div>
                            </div>
                        </div>
                        
                        <button type="submit" class="smoking-btn-calculate">
                            <i class="fas fa-calculator"></i>
                            Í≥ÑÏÇ∞ÌïòÍ∏∞
                        </button>
                    </form>
                    
                    <div class="smoking-result-section" id="smokingResult">
                        <!-- Í≤∞Í≥ºÍ∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                    </div>
                </div>
            `;
        }
        
        function calculateSmoking(e) {
            e.preventDefault();
            
            const cigaretteType = document.querySelector('input[name="cigaretteType"]:checked').value;
            const years = parseFloat(document.getElementById('smokingYears').value) || 0;
            const dailyAmount = parseFloat(document.getElementById('smokingAmount').value) || 0;
            
            if (years <= 0 || dailyAmount <= 0) {
                alert('Ïò¨Î∞îÎ•∏ Í∞íÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            // Ï¥ù Ìù°Ïó∞ ÏùºÏàò
            const totalDays = Math.round(years * 365);
            
            // Îã¥Î∞∞ Í∞ÄÍ≤© (2024ÎÖÑ Í∏∞Ï§Ä 4,500Ïõê)
            const pricePerPack = 4500;
            
            // Ï¥ù Îã¥Î∞∞ ÎπÑÏö©
            const totalCost = Math.round(totalDays * dailyAmount * pricePerPack);
            
            // Îã¥Î∞∞ ÏÑ∏Í∏à Íµ¨Ï°∞ (1Í∞ë 4,500Ïõê Í∏∞Ï§Ä)
            // Îã¥Î∞∞ ÏÜåÎπÑÏÑ∏: 1,007Ïõê (ÏïΩ 22.4%)
            // ÏßÄÎ∞©ÍµêÏú°ÏÑ∏: 443Ïõê (ÏïΩ 9.8%)
            // Í±¥Í∞ïÏ¶ùÏßÑÍ∏∞Í∏à: 841Ïõê (ÏïΩ 18.7%)
            // Í∞úÎ≥ÑÏÜåÎπÑÏÑ∏: 594Ïõê (ÏïΩ 13.2%)
            // ÌèêÍ∏∞Î¨ºÎ∂ÄÎã¥Í∏à: 24.4Ïõê (ÏïΩ 0.5%)
            // Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏: 409Ïõê (ÏïΩ 9.1%)
            // Ï¥ù ÏÑ∏Í∏à: ÏïΩ 3,318.4Ïõê (ÏïΩ 73.7%)
            
            let taxRates;
            if (cigaretteType === 'normal') {
                // Ïó∞Ï¥à ÏùºÎ∞òÌòï Îã¥Î∞∞
                taxRates = {
                    cigaretteTax: 1007 / 4500,        // Îã¥Î∞∞ÏÜåÎπÑÏÑ∏
                    localEducationTax: 443 / 4500,   // ÏßÄÎ∞©ÍµêÏú°ÏÑ∏
                    healthFund: 841 / 4500,          // Í±¥Í∞ïÏ¶ùÏßÑÍ∏∞Í∏à
                    individualTax: 594 / 4500,       // Í∞úÎ≥ÑÏÜåÎπÑÏÑ∏
                    wasteFee: 24.4 / 4500,           // ÌèêÍ∏∞Î¨ºÎ∂ÄÎã¥Í∏à
                    vat: 409 / 4500                  // Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏
                };
            } else if (cigaretteType === 'heat') {
                // Í∂êÎ†®Ìòï Ï†ÑÏûêÎã¥Î∞∞ (Ïó∞Ï¥àÏùò 90%)
                taxRates = {
                    cigaretteTax: (1007 * 0.9) / 4500,
                    localEducationTax: (443 * 0.9) / 4500,
                    healthFund: (841 * 0.9) / 4500,
                    individualTax: (594 * 0.9) / 4500,
                    wasteFee: (24.4 * 0.9) / 4500,
                    vat: (409 * 0.9) / 4500
                };
            } else {
                // Ïï°ÏÉÅÌòï Ï†ÑÏûêÎã¥Î∞∞ (ÎãàÏΩîÌã¥ 1mlÎãπ Í∏∞Ï§Ä)
                taxRates = {
                    cigaretteTax: 628 / 4500,
                    localEducationTax: 276 / 4500,
                    healthFund: 525 / 4500,
                    individualTax: 370 / 4500,
                    wasteFee: 15 / 4500,
                    vat: 255 / 4500
                };
            }
            
            // Í∞Å ÏÑ∏Í∏à Í≥ÑÏÇ∞
            const cigaretteTax = Math.round(totalCost * taxRates.cigaretteTax);
            const localEducationTax = Math.round(totalCost * taxRates.localEducationTax);
            const healthFund = Math.round(totalCost * taxRates.healthFund);
            const individualTax = Math.round(totalCost * taxRates.individualTax);
            const wasteFee = Math.round(totalCost * taxRates.wasteFee);
            const vat = Math.round(totalCost * taxRates.vat);
            
            const totalTax = cigaretteTax + localEducationTax + healthFund + individualTax + wasteFee + vat;
            
            // Îã¥Î∞∞ Ï¢ÖÎ•ò Ïù¥Î¶Ñ
            const typeNames = {
                'normal': 'Ïó∞Ï¥à ÏùºÎ∞òÌòï Îã¥Î∞∞',
                'heat': 'Í∂êÎ†®Ìòï Ï†ÑÏûêÎã¥Î∞∞',
                'liquid': 'Ïï°ÏÉÅÌòï Ï†ÑÏûêÎã¥Î∞∞'
            };
            
            const resultHTML = `
                <div class="smoking-summary-card">
                    <div class="smoking-summary-title">ÎãπÏã†Ïù¥ <strong>${typeNames[cigaretteType]}</strong>Î•º ÌîºÏö¥ Í∏∞Í∞Ñ</div>
                    <div class="smoking-summary-days">
                        ${formatNumberWithComma(totalDays)} <span>Ïùº</span>
                    </div>
                    <div class="smoking-summary-subtitle">ÎèôÏïà ÎÇòÎùºÏóê ÏßÄÎ∂àÌïú Îã¥Î±ÉÏÑ∏Îäî Ï¥ù</div>
                    <div class="smoking-summary-tax">${formatNumberWithComma(totalTax)}Ïõê</div>
                </div>
                
                <div class="smoking-cost-card">
                    <div class="smoking-cost-title">üí∏ Í∑∏ÎèôÏïà Îã¥Î∞∞Ïóê Ïì¥ Ï¥ù ÎπÑÏö©</div>
                    <div class="smoking-cost-amount">${formatNumberWithComma(totalCost)}Ïõê</div>
                    <div class="smoking-cost-desc">1Í∞ë ${formatNumberWithComma(pricePerPack)}Ïõê Í∏∞Ï§Ä / ÌïòÎ£® ${dailyAmount}Í∞ë √ó ${formatNumberWithComma(totalDays)}Ïùº</div>
                </div>
                
                <div class="smoking-tax-breakdown">
                    <div class="smoking-tax-title">
                        <i class="fas fa-receipt"></i>
                        Îã¥Î±ÉÏÑ∏ ÏÉÅÏÑ∏ ÎÇ¥Ïó≠
                    </div>
                    
                    <div class="smoking-tax-item">
                        <div class="smoking-tax-item-left">
                            <div class="smoking-tax-item-name">
                                <span class="tax-icon" style="background: #e3f2fd;">üèõÔ∏è</span>
                                Îã¥Î∞∞ÏÜåÎπÑÏÑ∏
                            </div>
                            <div class="smoking-tax-item-desc">ÎÇ¥Í∞Ä ÏÇ¥Í≥† ÏûàÎäî ÎèôÎÑ§(Ïãú, Íµ∞, Íµ¨)Ïùò Ïö¥ÏòÅÎπÑÎ°ú ÏÇ¨Ïö©</div>
                        </div>
                        <div class="smoking-tax-item-amount">${formatNumberWithComma(cigaretteTax)}Ïõê</div>
                    </div>
                    
                    <div class="smoking-tax-item">
                        <div class="smoking-tax-item-left">
                            <div class="smoking-tax-item-name">
                                <span class="tax-icon" style="background: #fff3e0;">üè´</span>
                                ÏßÄÎ∞©ÍµêÏú°ÏÑ∏
                            </div>
                            <div class="smoking-tax-item-desc">ÏÑ†ÏÉùÎãòÎì§Ïùò ÏõîÍ∏â, ÌïôÍµê Ïö¥ÏòÅ Î¨ºÌíà Íµ¨ÏûÖ</div>
                        </div>
                        <div class="smoking-tax-item-amount">${formatNumberWithComma(localEducationTax)}Ïõê</div>
                    </div>
                    
                    <div class="smoking-tax-item">
                        <div class="smoking-tax-item-left">
                            <div class="smoking-tax-item-name">
                                <span class="tax-icon" style="background: #e8f5e9;">üí™</span>
                                Í±¥Í∞ïÏ¶ùÏßÑÍ∏∞Í∏à
                            </div>
                            <div class="smoking-tax-item-desc">Íµ≠ÎØºÍ±¥Í∞ïÎ≥¥Ìóò Ï†ÅÏûê Ï∂©Îãπ, Í∞êÏóºÎ≥ë Í¥ÄÎ¶¨ Í∏∞Ïà† Í∞úÎ∞ú, Íµ≠Í∞ÄÎ≥ëÏõê ÌòÑÎåÄÌôî ÏÇ¨ÏóÖ Îì±</div>
                        </div>
                        <div class="smoking-tax-item-amount">${formatNumberWithComma(healthFund)}Ïõê</div>
                    </div>
                    
                    <div class="smoking-tax-item">
                        <div class="smoking-tax-item-left">
                            <div class="smoking-tax-item-name">
                                <span class="tax-icon" style="background: #ffebee;">üöí</span>
                                Í∞úÎ≥ÑÏÜåÎπÑÏÑ∏
                            </div>
                            <div class="smoking-tax-item-desc">ÏÜåÎ∞©Í¥Ä ÏõîÍ∏â, ÏÜåÎ∞©ÏÑú ÏÑ§ÎπÑ Îì±</div>
                        </div>
                        <div class="smoking-tax-item-amount">${formatNumberWithComma(individualTax)}Ïõê</div>
                    </div>
                    
                    <div class="smoking-tax-item">
                        <div class="smoking-tax-item-left">
                            <div class="smoking-tax-item-name">
                                <span class="tax-icon" style="background: #fce4ec;">üóëÔ∏è</span>
                                ÌèêÍ∏∞Î¨ºÎ∂ÄÎã¥Í∏à
                            </div>
                            <div class="smoking-tax-item-desc">Îã¥Î∞∞ÍΩÅÏ¥à Ï≤òÎ¶¨ ÎπÑÏö©ÏúºÎ°ú ÏÇ¨Ïö©ÎêòÏñ¥Ïïº ÌïòÏßÄ ÏïäÏùÑÍπå? ü§î</div>
                        </div>
                        <div class="smoking-tax-item-amount">${formatNumberWithComma(wasteFee)}Ïõê</div>
                    </div>
                    
                    <div class="smoking-tax-item">
                        <div class="smoking-tax-item-left">
                            <div class="smoking-tax-item-name">
                                <span class="tax-icon" style="background: #f3e5f5;">üíé</span>
                                Î∂ÄÍ∞ÄÍ∞ÄÏπòÏÑ∏
                            </div>
                            <div class="smoking-tax-item-desc">Íµ≠Í∞Ä Ïö¥ÏòÅÏóê ÌïÑÏöîÌïú Íµ≠ÏÑ∏Î°ú ÌôúÏö©</div>
                        </div>
                        <div class="smoking-tax-item-amount">${formatNumberWithComma(vat)}Ïõê</div>
                    </div>
                </div>
                
                <div class="smoking-warning-box">
                    <div class="smoking-warning-title">
                        <i class="fas fa-exclamation-triangle"></i>
                        Ïù¥ Ï§ë Ìïú ÌëºÎèÑ Ìù°Ïó∞ÏûêÎ•º ÏúÑÌï¥ ÏÇ¨Ïö©ÎêòÏßÄ ÏïäÎäîÎã§Îäî ÏÇ¨Ïã§ üò§
                    </div>
                    <div class="smoking-warning-text">
                        Îã¥Î±ÉÏÑ∏Îäî <strong>Ìù°Ïó∞Íµ¨Ïó≠ Ï¶ùÏÑ§</strong>Ïù¥ÎÇò <strong>Ìù°Ïó∞Ïûê Ìé∏ÏùòÏãúÏÑ§</strong>Ïóê ÏÇ¨Ïö©Ìï¥Ïïº ÌïòÏßÄ ÏïäÏùÑÍπåÏöî?<br>
                        Í∑∏Îü∞Îç∞ Îã¥Î±ÉÏÑ∏ Ï§ë Ìù°Ïó∞ÏûêÏóêÍ≤å ÏßÅÏ†ë ÎèåÏïÑÏò§Îäî ÌòúÌÉùÏùÄ Í±∞Ïùò ÏóÜÏäµÎãàÎã§. ü§∑‚Äç‚ôÇÔ∏è
                    </div>
                </div>
                
                <div class="smoking-tips-section">
                    <div class="smoking-tips-title">
                        <i class="fas fa-leaf"></i>
                        Í∏àÏó∞ Í¥ÄÎ†® Ï†ïÎ≥¥ & ÌåÅ
                    </div>
                    
                    <div class="smoking-tip-item">
                        <div class="smoking-tip-item-title">üè• Í∏àÏó∞ÏπòÎ£å ÏßÄÏõêÏÇ¨ÏóÖ</div>
                        <div class="smoking-tip-item-content">
                            Ï†ÑÍµ≠ Î≥¥Í±¥ÏÜåÏóêÏÑú Î¨¥Î£å Í∏àÏó∞ÏÉÅÎã¥ Î∞è Í∏àÏó∞Î≥¥Ï°∞Ï†úÎ•º Ï†úÍ≥µÌï©ÎãàÎã§. 
                            Í∏àÏó∞ Ìå®Ïπò, Íªå, ÏÇ¨ÌÉï Îì±ÏùÑ Î¨¥Î£åÎ°ú Î∞õÏùÑ Ïàò ÏûàÏñ¥Ïöî!
                        </div>
                    </div>
                    
                    <div class="smoking-tip-item">
                        <div class="smoking-tip-item-title">üíä Î≥ëÏõê Í∏àÏó∞ÏπòÎ£å</div>
                        <div class="smoking-tip-item-content">
                            Í±¥Í∞ïÎ≥¥ÌóòÏù¥ Ï†ÅÏö©ÎêòÎäî Í∏àÏó∞ÏπòÎ£å ÌîÑÎ°úÍ∑∏Îû®Ïù¥ ÏûàÏäµÎãàÎã§. 
                            8~12Ï£ºÍ∞Ñ Ï¥ù 6Ìöå ÏßÑÎ£å Ïãú Î≥∏Ïù∏Î∂ÄÎã¥Í∏à ÏµúÎåÄ 6ÎßåÏõêÎßå ÎÇ©Î∂Ä!
                        </div>
                    </div>
                    
                    <div class="smoking-tip-item">
                        <div class="smoking-tip-item-title">üì± Í∏àÏó∞Í∏∏ÎùºÏû°Ïù¥ Ïï±</div>
                        <div class="smoking-tip-item-content">
                            Í∏àÏó∞ ÏßÑÌñâ ÏÉÅÌô© Ï≤¥ÌÅ¨, Í∏àÏó∞ÏúºÎ°ú ÏïÑÎÇÄ Îèà ÌôïÏù∏, Í±¥Í∞ï ÌöåÎ≥µ ÏÉÅÌÉúÎ•º 
                            Ïã§ÏãúÍ∞ÑÏúºÎ°ú ÌôïÏù∏Ìï† Ïàò ÏûàÎäî Î¨¥Î£å Ïï±ÏûÖÎãàÎã§.
                        </div>
                    </div>
                    
                    <div class="smoking-tip-item">
                        <div class="smoking-tip-item-title">‚è∞ Í∏àÏó∞ ÌõÑ Ïã†Ï≤¥ Î≥ÄÌôî</div>
                        <div class="smoking-tip-item-content">
                            ‚Ä¢ 20Î∂Ñ: ÌòàÏïï, Îß•Î∞ï Ï†ïÏÉÅÌôî<br>
                            ‚Ä¢ 8ÏãúÍ∞Ñ: ÌòàÏ§ë ÏùºÏÇ∞ÌôîÌÉÑÏÜå Ï†ïÏÉÅÌôî<br>
                            ‚Ä¢ 48ÏãúÍ∞Ñ: ÌõÑÍ∞Å, ÎØ∏Í∞Å ÌöåÎ≥µ ÏãúÏûë<br>
                            ‚Ä¢ 2Ï£º~3Í∞úÏõî: ÌèêÍ∏∞Îä• 30% Ìñ•ÏÉÅ<br>
                            ‚Ä¢ 1ÎÖÑ: Ïã¨Ïû•Î≥ë ÏúÑÌóò 50% Í∞êÏÜå
                        </div>
                    </div>
                    
                    <div class="smoking-tip-item">
                        <div class="smoking-tip-item-title">üí∞ Í∏àÏó∞ÏúºÎ°ú Ï†àÏïΩÎêòÎäî Í∏àÏï°</div>
                        <div class="smoking-tip-item-content">
                            ÌïòÎ£® 1Í∞ë Í∏∞Ï§ÄÏúºÎ°ú 1ÎÖÑÏù¥Î©¥ ÏïΩ <strong>${formatNumberWithComma(Math.round(pricePerPack * 365))}Ïõê</strong>,<br>
                            10ÎÖÑÏù¥Î©¥ ÏïΩ <strong>${formatNumberWithComma(Math.round(pricePerPack * 365 * 10))}Ïõê</strong>ÏùÑ Ï†àÏïΩÌï† Ïàò ÏûàÏäµÎãàÎã§!
                        </div>
                    </div>
                    
                    <div class="smoking-hotline">
                        <div class="smoking-hotline-title">Í∏àÏó∞ÏÉÅÎã¥Ï†ÑÌôî (Î¨¥Î£å)</div>
                        <div class="smoking-hotline-number">üìû 1544-9030</div>
                    </div>
                </div>
            `;
            
            const resultSection = document.getElementById('smokingResult');
            resultSection.innerHTML = resultHTML;
            resultSection.classList.add('active');
            resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // ==================== ÏùåÎ†•ÏñëÎ†• Î≥ÄÌôòÍ∏∞ ====================
        
        // ÏùåÎ†• Îç∞Ïù¥ÌÑ∞ (1900-2100ÎÖÑ)
        // Í∞Å Ïó∞ÎèÑÎ≥Ñ 16ÎπÑÌä∏: Ïú§Îã¨Ïõî(4ÎπÑÌä∏) + Í∞Å ÏõîÏùò ÎåÄÏÜåÏõî Ï†ïÎ≥¥(12ÎπÑÌä∏)
        const lunarData = [
            0x04bd8, 0x04ae0, 0x0a570, 0x054d5, 0x0d260, 0x0d950, 0x16554, 0x056a0, 0x09ad0, 0x055d2, // 1900-1909
            0x04ae0, 0x0a5b6, 0x0a4d0, 0x0d250, 0x1d255, 0x0b540, 0x0d6a0, 0x0ada2, 0x095b0, 0x14977, // 1910-1919
            0x04970, 0x0a4b0, 0x0b4b5, 0x06a50, 0x06d40, 0x1ab54, 0x02b60, 0x09570, 0x052f2, 0x04970, // 1920-1929
            0x06566, 0x0d4a0, 0x0ea50, 0x06e95, 0x05ad0, 0x02b60, 0x186e3, 0x092e0, 0x1c8d7, 0x0c950, // 1930-1939
            0x0d4a0, 0x1d8a6, 0x0b550, 0x056a0, 0x1a5b4, 0x025d0, 0x092d0, 0x0d2b2, 0x0a950, 0x0b557, // 1940-1949
            0x06ca0, 0x0b550, 0x15355, 0x04da0, 0x0a5b0, 0x14573, 0x052b0, 0x0a9a8, 0x0e950, 0x06aa0, // 1950-1959
            0x0aea6, 0x0ab50, 0x04b60, 0x0aae4, 0x0a570, 0x05260, 0x0f263, 0x0d950, 0x05b57, 0x056a0, // 1960-1969
            0x096d0, 0x04dd5, 0x04ad0, 0x0a4d0, 0x0d4d4, 0x0d250, 0x0d558, 0x0b540, 0x0b6a0, 0x195a6, // 1970-1979
            0x095b0, 0x049b0, 0x0a974, 0x0a4b0, 0x0b27a, 0x06a50, 0x06d40, 0x0af46, 0x0ab60, 0x09570, // 1980-1989
            0x04af5, 0x04970, 0x064b0, 0x074a3, 0x0ea50, 0x06b58, 0x055c0, 0x0ab60, 0x096d5, 0x092e0, // 1990-1999
            0x0c960, 0x0d954, 0x0d4a0, 0x0da50, 0x07552, 0x056a0, 0x0abb7, 0x025d0, 0x092d0, 0x0cab5, // 2000-2009
            0x0a950, 0x0b4a0, 0x0baa4, 0x0ad50, 0x055d9, 0x04ba0, 0x0a5b0, 0x15176, 0x052b0, 0x0a930, // 2010-2019
            0x07954, 0x06aa0, 0x0ad50, 0x05b52, 0x04b60, 0x0a6e6, 0x0a4e0, 0x0d260, 0x0ea65, 0x0d530, // 2020-2029
            0x05aa0, 0x076a3, 0x096d0, 0x04afb, 0x04ad0, 0x0a4d0, 0x1d0b6, 0x0d250, 0x0d520, 0x0dd45, // 2030-2039
            0x0b5a0, 0x056d0, 0x055b2, 0x049b0, 0x0a577, 0x0a4b0, 0x0aa50, 0x1b255, 0x06d20, 0x0ada0, // 2040-2049
            0x14b63, 0x09370, 0x049f8, 0x04970, 0x064b0, 0x168a6, 0x0ea50, 0x06b20, 0x1a6c4, 0x0aae0, // 2050-2059
            0x0a2e0, 0x0d2e3, 0x0c960, 0x0d557, 0x0d4a0, 0x0da50, 0x05d55, 0x056a0, 0x0a6d0, 0x055d4, // 2060-2069
            0x052d0, 0x0a9b8, 0x0a950, 0x0b4a0, 0x0b6a6, 0x0ad50, 0x055a0, 0x0aba4, 0x0a5b0, 0x052b0, // 2070-2079
            0x0b273, 0x06930, 0x07337, 0x06aa0, 0x0ad50, 0x14b55, 0x04b60, 0x0a570, 0x054e4, 0x0d160, // 2080-2089
            0x0e968, 0x0d520, 0x0daa0, 0x16aa6, 0x056d0, 0x04ae0, 0x0a9d4, 0x0a2d0, 0x0d150, 0x0f252, // 2090-2099
            0x0d520 // 2100
        ];

        // Ï≤úÍ∞Ñ (Â§©Âπ≤)
        const heavenlyStems = ['Í∞ë', 'ÏùÑ', 'Î≥ë', 'Ï†ï', 'Î¨¥', 'Í∏∞', 'Í≤Ω', 'Ïã†', 'ÏûÑ', 'Í≥Ñ'];
        // ÏßÄÏßÄ (Âú∞ÊîØ)
        const earthlyBranches = ['Ïûê', 'Ï∂ï', 'Ïù∏', 'Î¨ò', 'ÏßÑ', 'ÏÇ¨', 'Ïò§', 'ÎØ∏', 'Ïã†', 'Ïú†', 'Ïà†', 'Ìï¥'];
        // Îù† ÎèôÎ¨º
        const zodiacAnimals = ['Ï•ê', 'ÏÜå', 'Ìò∏ÎûëÏù¥', 'ÌÜ†ÎÅº', 'Ïö©', 'Î±Ä', 'Îßê', 'Ïñë', 'ÏõêÏà≠Ïù¥', 'Îã≠', 'Í∞ú', 'ÎèºÏßÄ'];
        // Îù† Ïù¥Î™®ÏßÄ
        const zodiacEmojis = ['üêÄ', 'üêÇ', 'üêÖ', 'üêá', 'üêâ', 'üêç', 'üêé', 'üêë', 'üêí', 'üêì', 'üêï', 'üêñ'];

        // Ìï¥Îãπ Ïó∞ÎèÑÏùò Ïú§Îã¨ Ï†ïÎ≥¥ (Ïú§Îã¨Ïù¥ ÏóÜÏúºÎ©¥ 0)
        function getLeapMonth(year) {
            return lunarData[year - 1900] & 0xf;
        }

        // Ìï¥Îãπ Ïó∞ÎèÑÏùò Ïú§Îã¨ ÏùºÏàò
        function getLeapMonthDays(year) {
            if (getLeapMonth(year)) {
                return (lunarData[year - 1900] & 0x10000) ? 30 : 29;
            }
            return 0;
        }

        // Ìï¥Îãπ Ïó∞ÎèÑ, ÏõîÏùò ÏùºÏàò
        function getLunarMonthDays(year, month) {
            return (lunarData[year - 1900] & (0x10000 >> month)) ? 30 : 29;
        }

        // Ìï¥Îãπ Ïó∞ÎèÑÏùò Ï¥ù ÏùºÏàò
        function getLunarYearDays(year) {
            let sum = 348; // 12Í∞úÏõî * 29Ïùº Í∏∞Î≥∏
            for (let i = 0x8000; i > 0x8; i >>= 1) {
                if (lunarData[year - 1900] & i) sum++;
            }
            return sum + getLeapMonthDays(year);
        }

        // ÏñëÎ†•ÏùÑ ÏùåÎ†•ÏúºÎ°ú Î≥ÄÌôò
        function solarToLunar(solarYear, solarMonth, solarDay) {
            // Í∏∞Ï§ÄÏùº: 1900ÎÖÑ 1Ïõî 31Ïùº = ÏùåÎ†• 1900ÎÖÑ 1Ïõî 1Ïùº
            const baseDate = new Date(1900, 0, 31);
            const targetDate = new Date(solarYear, solarMonth - 1, solarDay);
            
            let offset = Math.floor((targetDate - baseDate) / 86400000);
            
            if (offset < 0 || solarYear < 1900 || solarYear > 2100) {
                return null;
            }

            let lunarYear = 1900;
            let lunarMonth = 1;
            let lunarDay = 1;
            let isLeapMonth = false;

            // Ïó∞ÎèÑ Í≥ÑÏÇ∞
            let yearDays;
            while (lunarYear < 2101 && offset >= (yearDays = getLunarYearDays(lunarYear))) {
                offset -= yearDays;
                lunarYear++;
            }

            // Ïõî Í≥ÑÏÇ∞
            let leapMonth = getLeapMonth(lunarYear);
            let month = 1;
            let monthDays;
            let isLeap = false;

            while (month <= 12) {
                if (leapMonth > 0 && month === leapMonth + 1 && !isLeap) {
                    // Ïú§Îã¨ Ï≤òÎ¶¨
                    monthDays = getLeapMonthDays(lunarYear);
                    isLeap = true;
                    month--;
                } else {
                    monthDays = getLunarMonthDays(lunarYear, month);
                    isLeap = false;
                }

                if (offset < monthDays) {
                    break;
                }
                offset -= monthDays;
                month++;
            }

            lunarMonth = month;
            lunarDay = offset + 1;
            isLeapMonth = isLeap;

            return {
                year: lunarYear,
                month: lunarMonth,
                day: lunarDay,
                isLeapMonth: isLeapMonth
            };
        }

        // ÏùåÎ†•ÏùÑ ÏñëÎ†•ÏúºÎ°ú Î≥ÄÌôò
        function lunarToSolar(lunarYear, lunarMonth, lunarDay, isLeapMonth) {
            if (lunarYear < 1900 || lunarYear > 2100) {
                return null;
            }

            let leapMonth = getLeapMonth(lunarYear);
            
            // Ïú§Îã¨ Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
            if (isLeapMonth && leapMonth !== lunarMonth) {
                return null;
            }

            // Ïùº Ïàò Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
            let maxDays;
            if (isLeapMonth) {
                maxDays = getLeapMonthDays(lunarYear);
            } else {
                maxDays = getLunarMonthDays(lunarYear, lunarMonth);
            }
            if (lunarDay > maxDays) {
                return null;
            }

            // Í∏∞Ï§ÄÏùºÎ°úÎ∂ÄÌÑ∞Ïùò ÏùºÏàò Í≥ÑÏÇ∞
            let offset = 0;

            // 1900ÎÖÑÎ∂ÄÌÑ∞ Ìï¥Îãπ Ïó∞ÎèÑ Ï†ÑÍπåÏßÄÏùò ÏùºÏàò
            for (let y = 1900; y < lunarYear; y++) {
                offset += getLunarYearDays(y);
            }

            // Ìï¥Îãπ Ïó∞ÎèÑÏùò 1ÏõîÎ∂ÄÌÑ∞ Ìï¥Îãπ Ïõî Ï†ÑÍπåÏßÄÏùò ÏùºÏàò
            for (let m = 1; m < lunarMonth; m++) {
                offset += getLunarMonthDays(lunarYear, m);
                if (leapMonth === m) {
                    offset += getLeapMonthDays(lunarYear);
                }
            }

            // Ïú§Îã¨Ïù∏ Í≤ΩÏö∞ Ìï¥Îãπ ÏõîÏùò ÏùºÏàòÎèÑ Ï∂îÍ∞Ä
            if (isLeapMonth) {
                offset += getLunarMonthDays(lunarYear, lunarMonth);
            }

            // ÏùºÏàò Ï∂îÍ∞Ä
            offset += lunarDay - 1;

            // Í∏∞Ï§ÄÏùº(1900ÎÖÑ 1Ïõî 31Ïùº)Ïóê ÏùºÏàòÎ•º ÎçîÌï®
            const baseDate = new Date(1900, 0, 31);
            const resultDate = new Date(baseDate.getTime() + offset * 86400000);

            return {
                year: resultDate.getFullYear(),
                month: resultDate.getMonth() + 1,
                day: resultDate.getDate()
            };
        }

        // Í∞ÑÏßÄ Í≥ÑÏÇ∞
        function getGanZhi(year) {
            const stemIndex = (year - 4) % 10;
            const branchIndex = (year - 4) % 12;
            return {
                stem: heavenlyStems[stemIndex < 0 ? stemIndex + 10 : stemIndex],
                branch: earthlyBranches[branchIndex < 0 ? branchIndex + 12 : branchIndex],
                zodiac: zodiacAnimals[branchIndex < 0 ? branchIndex + 12 : branchIndex],
                emoji: zodiacEmojis[branchIndex < 0 ? branchIndex + 12 : branchIndex]
            };
        }

        // ÏöîÏùº Í≥ÑÏÇ∞
        function getDayOfWeek(year, month, day) {
            const days = ['ÏùºÏöîÏùº', 'ÏõîÏöîÏùº', 'ÌôîÏöîÏùº', 'ÏàòÏöîÏùº', 'Î™©ÏöîÏùº', 'Í∏àÏöîÏùº', 'ÌÜ†ÏöîÏùº'];
            const date = new Date(year, month - 1, day);
            return days[date.getDay()];
        }

        // ÏùåÎ†•ÏñëÎ†• Î≥ÄÌôòÍ∏∞ UI
        function getLunarSolarConverter() {
            const today = new Date();
            const currentYear = today.getFullYear();
            
            // Ïó∞ÎèÑ ÏòµÏÖò ÏÉùÏÑ±
            let yearOptions = '';
            for (let y = 1900; y <= 2100; y++) {
                const selected = y === currentYear ? 'selected' : '';
                yearOptions += `<option value="${y}" ${selected}>${y}ÎÖÑ</option>`;
            }
            
            // Ïõî ÏòµÏÖò ÏÉùÏÑ±
            let monthOptions = '';
            for (let m = 1; m <= 12; m++) {
                const selected = m === (today.getMonth() + 1) ? 'selected' : '';
                monthOptions += `<option value="${m}" ${selected}>${m}Ïõî</option>`;
            }
            
            // Ïùº ÏòµÏÖò ÏÉùÏÑ±
            let dayOptions = '';
            for (let d = 1; d <= 31; d++) {
                const selected = d === today.getDate() ? 'selected' : '';
                dayOptions += `<option value="${d}" ${selected}>${d}Ïùº</option>`;
            }

            return `
                <style>
                    .lunar-converter-container {
                        max-width: 500px;
                        margin: 0 auto;
                    }
                    
                    .converter-tabs {
                        display: flex;
                        margin-bottom: 25px;
                        background: #f1f5f9;
                        border-radius: 12px;
                        padding: 5px;
                    }
                    
                    .converter-tab {
                        flex: 1;
                        padding: 14px 20px;
                        border: none;
                        background: transparent;
                        cursor: pointer;
                        font-size: 15px;
                        font-weight: 600;
                        color: #64748b;
                        border-radius: 10px;
                        transition: all 0.3s ease;
                    }
                    
                    .converter-tab.active {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
                    }
                    
                    .converter-tab:hover:not(.active) {
                        background: #e2e8f0;
                    }
                    
                    .converter-section {
                        display: none;
                    }
                    
                    .converter-section.active {
                        display: block;
                        animation: fadeIn 0.3s ease;
                    }
                    
                    .date-input-group {
                        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
                        padding: 25px;
                        border-radius: 16px;
                        margin-bottom: 20px;
                        border: 1px solid #e2e8f0;
                    }
                    
                    .date-input-title {
                        font-size: 14px;
                        font-weight: 600;
                        color: #667eea;
                        margin-bottom: 15px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    
                    .date-input-title i {
                        font-size: 16px;
                    }
                    
                    .date-selects {
                        display: grid;
                        grid-template-columns: 1.2fr 1fr 1fr;
                        gap: 12px;
                    }
                    
                    .date-selects select {
                        padding: 14px 12px;
                        border: 2px solid #e2e8f0;
                        border-radius: 10px;
                        font-size: 15px;
                        font-weight: 500;
                        background: white;
                        cursor: pointer;
                        transition: all 0.3s ease;
                    }
                    
                    .date-selects select:focus {
                        outline: none;
                        border-color: #667eea;
                        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
                    }
                    
                    .leap-month-option {
                        margin-top: 15px;
                        padding-top: 15px;
                        border-top: 1px dashed #e2e8f0;
                    }
                    
                    .leap-month-option label {
                        display: flex;
                        align-items: center;
                        gap: 10px;
                        cursor: pointer;
                        font-size: 14px;
                        color: #64748b;
                    }
                    
                    .leap-month-option input[type="checkbox"] {
                        width: 20px;
                        height: 20px;
                        accent-color: #667eea;
                    }
                    
                    .convert-btn {
                        width: 100%;
                        padding: 16px;
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        border: none;
                        border-radius: 12px;
                        font-size: 16px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                    }
                    
                    .convert-btn:hover {
                        transform: translateY(-2px);
                        box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
                    }
                    
                    .convert-btn:active {
                        transform: translateY(0);
                    }
                    
                    .result-container {
                        margin-top: 25px;
                        display: none;
                    }
                    
                    .result-container.show {
                        display: block;
                        animation: slideUp 0.4s ease;
                    }
                    
                    @keyframes slideUp {
                        from {
                            opacity: 0;
                            transform: translateY(20px);
                        }
                        to {
                            opacity: 1;
                            transform: translateY(0);
                        }
                    }
                    
                    .result-card {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        border-radius: 20px;
                        padding: 30px;
                        color: white;
                        text-align: center;
                        margin-bottom: 20px;
                    }
                    
                    .result-label {
                        font-size: 14px;
                        opacity: 0.9;
                        margin-bottom: 10px;
                    }
                    
                    .result-date {
                        font-size: 32px;
                        font-weight: 700;
                        margin-bottom: 8px;
                    }
                    
                    .result-day {
                        font-size: 16px;
                        opacity: 0.9;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 6px;
                    }
                    
                    .detail-cards {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                    }
                    
                    .detail-card {
                        background: white;
                        border-radius: 16px;
                        padding: 20px;
                        text-align: center;
                        border: 1px solid #e2e8f0;
                        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
                    }
                    
                    .detail-icon {
                        font-size: 28px;
                        margin-bottom: 10px;
                    }
                    
                    .detail-label {
                        font-size: 12px;
                        color: #64748b;
                        margin-bottom: 5px;
                    }
                    
                    .detail-value {
                        font-size: 18px;
                        font-weight: 700;
                        color: #1e293b;
                    }
                    
                    .detail-sub {
                        font-size: 12px;
                        color: #94a3b8;
                        margin-top: 4px;
                    }
                    
                    .leap-badge {
                        display: inline-block;
                        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
                        color: white;
                        padding: 4px 10px;
                        border-radius: 20px;
                        font-size: 12px;
                        font-weight: 600;
                        margin-left: 8px;
                    }
                    
                    .error-message {
                        background: #fef2f2;
                        border: 1px solid #fecaca;
                        color: #dc2626;
                        padding: 15px 20px;
                        border-radius: 12px;
                        text-align: center;
                        margin-top: 20px;
                        display: none;
                    }
                    
                    .error-message.show {
                        display: block;
                        animation: shake 0.5s ease;
                    }
                    
                    @keyframes shake {
                        0%, 100% { transform: translateX(0); }
                        25% { transform: translateX(-5px); }
                        75% { transform: translateX(5px); }
                    }
                </style>
                
                <div class="lunar-converter-container">
                    <div class="converter-tabs">
                        <button class="converter-tab active" onclick="switchConverterTab('solar-to-lunar')">
                            <i class="fas fa-sun"></i> ÏñëÎ†• ‚Üí ÏùåÎ†•
                        </button>
                        <button class="converter-tab" onclick="switchConverterTab('lunar-to-solar')">
                            <i class="fas fa-moon"></i> ÏùåÎ†• ‚Üí ÏñëÎ†•
                        </button>
                    </div>
                    
                    <!-- ÏñëÎ†• ‚Üí ÏùåÎ†• -->
                    <div id="solar-to-lunar-section" class="converter-section active">
                        <div class="date-input-group">
                            <div class="date-input-title">
                                <i class="fas fa-sun"></i> ÏñëÎ†• ÎÇ†Ïßú ÏûÖÎ†•
                            </div>
                            <div class="date-selects">
                                <select id="solarYear">${yearOptions}</select>
                                <select id="solarMonth">${monthOptions}</select>
                                <select id="solarDay">${dayOptions}</select>
                            </div>
                        </div>
                        
                        <button class="convert-btn" onclick="convertSolarToLunar()">
                            <i class="fas fa-exchange-alt"></i> ÏùåÎ†•ÏúºÎ°ú Î≥ÄÌôò
                        </button>
                        
                        <div id="solarToLunarResult" class="result-container"></div>
                        <div id="solarToLunarError" class="error-message">
                            <i class="fas fa-exclamation-circle"></i> Î≥ÄÌôòÌï† Ïàò ÏóÜÎäî ÎÇ†ÏßúÏûÖÎãàÎã§.
                        </div>
                    </div>
                    
                    <!-- ÏùåÎ†• ‚Üí ÏñëÎ†• -->
                    <div id="lunar-to-solar-section" class="converter-section">
                        <div class="date-input-group">
                            <div class="date-input-title">
                                <i class="fas fa-moon"></i> ÏùåÎ†• ÎÇ†Ïßú ÏûÖÎ†•
                            </div>
                            <div class="date-selects">
                                <select id="lunarYear">${yearOptions}</select>
                                <select id="lunarMonth">${monthOptions}</select>
                                <select id="lunarDay">${dayOptions}</select>
                            </div>
                            <div class="leap-month-option">
                                <label>
                                    <input type="checkbox" id="isLeapMonth">
                                    <span>Ïú§Îã¨ (ÈñèÊúà)</span>
                                </label>
                            </div>
                        </div>
                        
                        <button class="convert-btn" onclick="convertLunarToSolar()">
                            <i class="fas fa-exchange-alt"></i> ÏñëÎ†•ÏúºÎ°ú Î≥ÄÌôò
                        </button>
                        
                        <div id="lunarToSolarResult" class="result-container"></div>
                        <div id="lunarToSolarError" class="error-message">
                            <i class="fas fa-exclamation-circle"></i> Î≥ÄÌôòÌï† Ïàò ÏóÜÎäî ÎÇ†ÏßúÏûÖÎãàÎã§.
                        </div>
                    </div>
                </div>
            `;
        }

        // ÌÉ≠ Ï†ÑÌôò
        function switchConverterTab(type) {
            const tabs = document.querySelectorAll('.converter-tab');
            const sections = document.querySelectorAll('.converter-section');
            
            tabs.forEach(tab => tab.classList.remove('active'));
            sections.forEach(section => section.classList.remove('active'));
            
            if (type === 'solar-to-lunar') {
                tabs[0].classList.add('active');
                document.getElementById('solar-to-lunar-section').classList.add('active');
            } else {
                tabs[1].classList.add('active');
                document.getElementById('lunar-to-solar-section').classList.add('active');
            }
        }

        // ÏñëÎ†• ‚Üí ÏùåÎ†• Î≥ÄÌôò Ïã§Ìñâ
        function convertSolarToLunar() {
            const year = parseInt(document.getElementById('solarYear').value);
            const month = parseInt(document.getElementById('solarMonth').value);
            const day = parseInt(document.getElementById('solarDay').value);
            
            const resultContainer = document.getElementById('solarToLunarResult');
            const errorContainer = document.getElementById('solarToLunarError');
            
            // ÎÇ†Ïßú Ïú†Ìö®ÏÑ± Í≤ÄÏÇ¨
            const testDate = new Date(year, month - 1, day);
            if (testDate.getMonth() + 1 !== month || testDate.getDate() !== day) {
                resultContainer.classList.remove('show');
                errorContainer.classList.add('show');
                return;
            }
            
            const result = solarToLunar(year, month, day);
            
            if (!result) {
                resultContainer.classList.remove('show');
                errorContainer.classList.add('show');
                return;
            }
            
            errorContainer.classList.remove('show');
            
            const ganZhi = getGanZhi(result.year);
            const dayOfWeek = getDayOfWeek(year, month, day);
            const leapBadge = result.isLeapMonth ? '<span class="leap-badge">Ïú§Îã¨</span>' : '';
            
            resultContainer.innerHTML = `
                <div class="result-card">
                    <div class="result-label">ÏùåÎ†• ÎÇ†Ïßú</div>
                    <div class="result-date">
                        ${result.year}ÎÖÑ ${result.isLeapMonth ? 'Ïú§' : ''}${result.month}Ïõî ${result.day}Ïùº
                        ${leapBadge}
                    </div>
                    <div class="result-day">
                        <i class="fas fa-calendar-check"></i> ${dayOfWeek}
                    </div>
                </div>
                
                <div class="detail-cards">
                    <div class="detail-card">
                        <div class="detail-icon">üìú</div>
                        <div class="detail-label">Í∞ÑÏßÄ (Ï≤úÍ∞ÑÏßÄÏßÄ)</div>
                        <div class="detail-value">${ganZhi.stem}${ganZhi.branch}ÎÖÑ</div>
                        <div class="detail-sub">${ganZhi.stem}(Â§©Âπ≤) + ${ganZhi.branch}(Âú∞ÊîØ)</div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-icon">${ganZhi.emoji}</div>
                        <div class="detail-label">Îù†</div>
                        <div class="detail-value">${ganZhi.zodiac}Îù†</div>
                        <div class="detail-sub">${result.year}ÎÖÑÏÉù</div>
                    </div>
                </div>
            `;
            
            resultContainer.classList.add('show');
        }

        // ÏùåÎ†• ‚Üí ÏñëÎ†• Î≥ÄÌôò Ïã§Ìñâ
        function convertLunarToSolar() {
            const year = parseInt(document.getElementById('lunarYear').value);
            const month = parseInt(document.getElementById('lunarMonth').value);
            const day = parseInt(document.getElementById('lunarDay').value);
            const isLeap = document.getElementById('isLeapMonth').checked;
            
            const resultContainer = document.getElementById('lunarToSolarResult');
            const errorContainer = document.getElementById('lunarToSolarError');
            
            const result = lunarToSolar(year, month, day, isLeap);
            
            if (!result) {
                resultContainer.classList.remove('show');
                errorContainer.classList.add('show');
                return;
            }
            
            errorContainer.classList.remove('show');
            
            const ganZhi = getGanZhi(year);
            const dayOfWeek = getDayOfWeek(result.year, result.month, result.day);
            
            resultContainer.innerHTML = `
                <div class="result-card">
                    <div class="result-label">ÏñëÎ†• ÎÇ†Ïßú</div>
                    <div class="result-date">
                        ${result.year}ÎÖÑ ${result.month}Ïõî ${result.day}Ïùº
                    </div>
                    <div class="result-day">
                        <i class="fas fa-calendar-check"></i> ${dayOfWeek}
                    </div>
                </div>
                
                <div class="detail-cards">
                    <div class="detail-card">
                        <div class="detail-icon">üìú</div>
                        <div class="detail-label">Í∞ÑÏßÄ (Ï≤úÍ∞ÑÏßÄÏßÄ)</div>
                        <div class="detail-value">${ganZhi.stem}${ganZhi.branch}ÎÖÑ</div>
                        <div class="detail-sub">${ganZhi.stem}(Â§©Âπ≤) + ${ganZhi.branch}(Âú∞ÊîØ)</div>
                    </div>
                    <div class="detail-card">
                        <div class="detail-icon">${ganZhi.emoji}</div>
                        <div class="detail-label">Îù†</div>
                        <div class="detail-value">${ganZhi.zodiac}Îù†</div>
                        <div class="detail-sub">${year}ÎÖÑÏÉù (ÏùåÎ†• Í∏∞Ï§Ä)</div>
                    </div>
                </div>
            `;
            
            resultContainer.classList.add('show');
        }

        // ÏùåÎ†•ÏñëÎ†• Î≥ÄÌôòÍ∏∞ Ï¥àÍ∏∞Ìôî
        function initLunarSolarConverter() {
            // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ïò§Îäò ÎÇ†ÏßúÎ°ú ÏûêÎèô Î≥ÄÌôò
            setTimeout(() => {
                convertSolarToLunar();
            }, 100);
        }

        // ===== Ï§ÄÎπÑÏ§ë Í≥ÑÏÇ∞Í∏∞ =====
        function getPreparingCalculator(calcName) {
            return `
                <div style="text-align: center; padding: 60px 20px;">
                    <div style="display: inline-flex; align-items: center; justify-content: center; width: 100px; height: 100px; background: linear-gradient(135deg, #e2e8f0 0%, #cbd5e1 100%); border-radius: 50%; margin-bottom: 24px;">
                        <i class="fas fa-tools" style="font-size: 42px; color: #64748b;"></i>
                    </div>
                    <h2 style="font-size: 24px; font-weight: 700; color: #334155; margin-bottom: 12px;">${calcName}</h2>
                    <p style="font-size: 18px; color: #64748b; line-height: 1.6;">Ïù¥ Í≥ÑÏÇ∞Í∏∞Îäî Ï§ÄÎπÑÏ§ë ÏûÖÎãàÎã§.</p>
                    <p style="font-size: 14px; color: #94a3b8; margin-top: 16px;">Îπ†Î•∏ ÏãúÏùº ÎÇ¥Ïóê ÏÑúÎπÑÏä§Î•º Ï†úÍ≥µÌï¥ ÎìúÎ¶¨Í≤†ÏäµÎãàÎã§.</p>
                </div>
            `;
        }

        // ===== Î∞∞ÎûÄÏùº Í≥ÑÏÇ∞Í∏∞ =====
        function getOvulationCalculator() {
            return `
                <style>
                    .ovulation-calculator {
                        max-width: 700px;
                        margin: 0 auto;
                    }
                    
                    .ovulation-header {
                        text-align: center;
                        margin-bottom: 30px;
                    }
                    
                    .ovulation-header-icon {
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                        width: 80px;
                        height: 80px;
                        background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
                        border-radius: 50%;
                        margin-bottom: 16px;
                        box-shadow: 0 8px 25px rgba(236, 72, 153, 0.2);
                    }
                    
                    .ovulation-header-icon i {
                        font-size: 36px;
                        color: #ec4899;
                    }
                    
                    .ovulation-header h2 {
                        font-size: 28px;
                        font-weight: 700;
                        color: #333;
                        margin-bottom: 8px;
                    }
                    
                    .ovulation-header p {
                        font-size: 16px;
                        color: #888;
                    }
                    
                    .ovulation-form-section {
                        background: #fff;
                        border-radius: 24px;
                        padding: 30px;
                        margin-bottom: 24px;
                        box-shadow: 0 10px 40px rgba(0,0,0,0.08);
                    }
                    
                    .ovulation-section-title {
                        font-size: 18px;
                        font-weight: 700;
                        color: #ec4899;
                        margin-bottom: 24px;
                        display: flex;
                        align-items: center;
                        gap: 12px;
                    }
                    
                    .ovulation-section-title .step-num {
                        width: 32px;
                        height: 32px;
                        background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 14px;
                        font-weight: 700;
                        color: #ec4899;
                    }
                    
                    .ovulation-form-group {
                        margin-bottom: 24px;
                    }
                    
                    .ovulation-form-group label {
                        display: block;
                        font-weight: 600;
                        color: #333;
                        margin-bottom: 10px;
                        font-size: 15px;
                    }
                    
                    .ovulation-form-group input[type="date"] {
                        width: 100%;
                        padding: 14px 16px;
                        border: 2px solid #fce7f3;
                        border-radius: 12px;
                        font-size: 16px;
                        transition: all 0.3s ease;
                    }
                    
                    .ovulation-form-group input[type="date"]:focus {
                        outline: none;
                        border-color: #ec4899;
                        box-shadow: 0 0 0 3px rgba(236, 72, 153, 0.1);
                    }
                    
                    .ovulation-slider-container {
                        margin-top: 10px;
                    }
                    
                    .ovulation-slider-row {
                        display: flex;
                        align-items: center;
                        gap: 16px;
                    }
                    
                    .ovulation-slider-row input[type="range"] {
                        flex: 1;
                        height: 8px;
                        background: #fce7f3;
                        border-radius: 4px;
                        appearance: none;
                        cursor: pointer;
                    }
                    
                    .ovulation-slider-row input[type="range"]::-webkit-slider-thumb {
                        appearance: none;
                        width: 24px;
                        height: 24px;
                        background: linear-gradient(135deg, #ec4899 0%, #f472b6 100%);
                        border-radius: 50%;
                        cursor: pointer;
                        box-shadow: 0 2px 8px rgba(236, 72, 153, 0.4);
                    }
                    
                    .ovulation-slider-value {
                        font-size: 28px;
                        font-weight: 700;
                        color: #ec4899;
                        min-width: 50px;
                        text-align: center;
                    }
                    
                    .ovulation-slider-hint {
                        font-size: 13px;
                        color: #888;
                        margin-top: 8px;
                    }
                    
                    .ovulation-btn-calculate {
                        width: 100%;
                        padding: 18px;
                        background: linear-gradient(135deg, #ec4899 0%, #f472b6 100%);
                        color: white;
                        border: none;
                        border-radius: 16px;
                        font-size: 18px;
                        font-weight: 700;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 10px;
                        box-shadow: 0 8px 25px rgba(236, 72, 153, 0.3);
                    }
                    
                    .ovulation-btn-calculate:hover {
                        transform: translateY(-3px);
                        box-shadow: 0 12px 30px rgba(236, 72, 153, 0.4);
                    }
                    
                    .ovulation-result-section {
                        display: none;
                    }
                    
                    .ovulation-result-section.active {
                        display: block;
                        animation: fadeInUp 0.5s ease;
                    }
                    
                    .ovulation-result-cards {
                        display: grid;
                        grid-template-columns: repeat(3, 1fr);
                        gap: 16px;
                        margin-bottom: 24px;
                    }
                    
                    .ovulation-result-card {
                        background: #fff;
                        border-radius: 20px;
                        padding: 20px;
                        text-align: center;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                    }
                    
                    .ovulation-result-card.ovulation-date {
                        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
                    }
                    
                    .ovulation-result-card.fertile-window {
                        background: linear-gradient(135deg, #dcfce7 0%, #86efac 100%);
                    }
                    
                    .ovulation-result-card.next-period {
                        background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
                    }
                    
                    .ovulation-result-card-icon {
                        width: 48px;
                        height: 48px;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        margin: 0 auto 12px;
                        font-size: 24px;
                    }
                    
                    .ovulation-date .ovulation-result-card-icon {
                        background: #f59e0b;
                        color: white;
                    }
                    
                    .fertile-window .ovulation-result-card-icon {
                        background: #22c55e;
                        color: white;
                    }
                    
                    .next-period .ovulation-result-card-icon {
                        background: #f87171;
                        color: white;
                    }
                    
                    .ovulation-result-card-label {
                        font-size: 13px;
                        color: #666;
                        margin-bottom: 6px;
                    }
                    
                    .ovulation-result-card-value {
                        font-size: 18px;
                        font-weight: 700;
                        color: #333;
                    }
                    
                    .ovulation-date .ovulation-result-card-value {
                        color: #d97706;
                    }
                    
                    .fertile-window .ovulation-result-card-value {
                        color: #16a34a;
                    }
                    
                    .next-period .ovulation-result-card-value {
                        color: #dc2626;
                    }
                    
                    .ovulation-calendar-section {
                        background: #fff;
                        border-radius: 20px;
                        padding: 24px;
                        margin-bottom: 24px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                    }
                    
                    .ovulation-calendar-title {
                        font-size: 18px;
                        font-weight: 700;
                        color: #333;
                        margin-bottom: 20px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    
                    .ovulation-calendar {
                        background: #f8fafc;
                        border-radius: 16px;
                        padding: 16px;
                    }
                    
                    .ovulation-calendar-month {
                        text-align: center;
                        font-weight: 600;
                        color: #333;
                        margin-bottom: 12px;
                        font-size: 16px;
                    }
                    
                    .ovulation-calendar-grid {
                        display: grid;
                        grid-template-columns: repeat(7, 1fr);
                        gap: 4px;
                        text-align: center;
                    }
                    
                    .ovulation-calendar-header {
                        font-size: 12px;
                        font-weight: 600;
                        padding: 8px 4px;
                        color: #64748b;
                    }
                    
                    .ovulation-calendar-header.sunday {
                        color: #ef4444;
                    }
                    
                    .ovulation-calendar-header.saturday {
                        color: #3b82f6;
                    }
                    
                    .ovulation-calendar-day {
                        padding: 8px 4px;
                        font-size: 14px;
                        border-radius: 8px;
                        color: #333;
                    }
                    
                    .ovulation-calendar-day.period-day {
                        background: linear-gradient(135deg, #fca5a5 0%, #f87171 100%);
                        color: white;
                        font-weight: 600;
                    }
                    
                    .ovulation-calendar-day.fertile-day {
                        background: linear-gradient(135deg, #86efac 0%, #4ade80 100%);
                        color: white;
                        font-weight: 600;
                    }
                    
                    .ovulation-calendar-day.ovulation-day {
                        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
                        color: white;
                        font-weight: 700;
                        animation: pulse 2s infinite;
                    }
                    
                    .ovulation-calendar-day.next-period-day {
                        background: #fecaca;
                        color: #dc2626;
                        font-weight: 600;
                    }
                    
                    .ovulation-calendar-day.today {
                        box-shadow: 0 0 0 2px #ec4899;
                    }
                    
                    .ovulation-calendar-day.sunday {
                        color: #ef4444;
                    }
                    
                    .ovulation-calendar-day.saturday {
                        color: #3b82f6;
                    }
                    
                    @keyframes pulse {
                        0%, 100% { transform: scale(1); }
                        50% { transform: scale(1.05); }
                    }
                    
                    .ovulation-legend {
                        display: flex;
                        flex-wrap: wrap;
                        justify-content: center;
                        gap: 16px;
                        margin-top: 20px;
                        padding-top: 16px;
                        border-top: 1px solid #e2e8f0;
                    }
                    
                    .ovulation-legend-item {
                        display: flex;
                        align-items: center;
                        gap: 6px;
                        font-size: 13px;
                        color: #666;
                    }
                    
                    .ovulation-legend-color {
                        width: 16px;
                        height: 16px;
                        border-radius: 4px;
                    }
                    
                    .ovulation-legend-color.period {
                        background: linear-gradient(135deg, #fca5a5 0%, #f87171 100%);
                    }
                    
                    .ovulation-legend-color.fertile {
                        background: linear-gradient(135deg, #86efac 0%, #4ade80 100%);
                    }
                    
                    .ovulation-legend-color.ovulation {
                        background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
                    }
                    
                    .ovulation-tips-section {
                        background: #fff;
                        border-radius: 20px;
                        padding: 24px;
                        margin-bottom: 24px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                    }
                    
                    .ovulation-tips-title {
                        font-size: 18px;
                        font-weight: 700;
                        color: #333;
                        margin-bottom: 16px;
                        display: flex;
                        align-items: center;
                        gap: 8px;
                    }
                    
                    .ovulation-tip-list {
                        list-style: none;
                        padding: 0;
                        margin: 0;
                    }
                    
                    .ovulation-tip-list li {
                        display: flex;
                        align-items: flex-start;
                        gap: 8px;
                        padding: 10px 0;
                        font-size: 14px;
                        color: #555;
                        line-height: 1.5;
                    }
                    
                    .ovulation-tip-list li::before {
                        content: "‚Ä¢";
                        color: #ec4899;
                        font-weight: bold;
                    }
                    
                    .ovulation-info-section {
                        background: #fff;
                        border-radius: 20px;
                        padding: 24px;
                        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
                    }
                    
                    .ovulation-tabs {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 8px;
                        margin-bottom: 20px;
                    }
                    
                    .ovulation-tab-btn {
                        padding: 10px 16px;
                        border: none;
                        border-radius: 20px;
                        font-size: 13px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.3s ease;
                        background: #f1f5f9;
                        color: #64748b;
                    }
                    
                    .ovulation-tab-btn.active {
                        background: linear-gradient(135deg, #ec4899 0%, #f472b6 100%);
                        color: white;
                    }
                    
                    .ovulation-tab-btn:hover:not(.active) {
                        background: #e2e8f0;
                    }
                    
                    .ovulation-tab-content {
                        display: none;
                    }
                    
                    .ovulation-tab-content.active {
                        display: block;
                    }
                    
                    .ovulation-info-card {
                        background: #fdf2f8;
                        border-radius: 16px;
                        padding: 16px;
                        margin-bottom: 12px;
                    }
                    
                    .ovulation-info-card:last-child {
                        margin-bottom: 0;
                    }
                    
                    .ovulation-info-card h4 {
                        font-size: 15px;
                        font-weight: 700;
                        color: #be185d;
                        margin-bottom: 8px;
                    }
                    
                    .ovulation-info-card p {
                        font-size: 13px;
                        color: #666;
                        line-height: 1.6;
                    }
                    
                    @media (max-width: 600px) {
                        .ovulation-result-cards {
                            grid-template-columns: 1fr;
                        }
                        
                        .ovulation-calendar-day {
                            padding: 6px 2px;
                            font-size: 12px;
                        }
                    }
                </style>
                
                <div class="ovulation-calculator">
                    <div class="ovulation-header">
                        <div class="ovulation-header-icon">
                            <i class="fas fa-heart"></i>
                        </div>
                        <h2>Î∞∞ÎûÄÏùº Í≥ÑÏÇ∞Í∏∞</h2>
                        <p>Ï†ïÌôïÌïú Î∞∞ÎûÄÏùºÍ≥º Í∞ÄÏûÑÍ∏∞Í∞ÑÏùÑ Í≥ÑÏÇ∞Ìï¥Î≥¥ÏÑ∏Ïöî</p>
                    </div>
                    
                    <div class="ovulation-form-section">
                        <div class="ovulation-section-title">
                            <span class="step-num">1</span>
                            Ï†ïÎ≥¥ ÏûÖÎ†•
                        </div>
                        
                        <div class="ovulation-form-group">
                            <label>ÎßàÏßÄÎßâ ÏÉùÎ¶¨ ÏãúÏûëÏùº</label>
                            <input type="date" id="ovulationLastPeriod">
                        </div>
                        
                        <div class="ovulation-form-group">
                            <label>ÌèâÍ∑† ÏÉùÎ¶¨ Ï£ºÍ∏∞ (Ïùº)</label>
                            <div class="ovulation-slider-container">
                                <div class="ovulation-slider-row">
                                    <input type="range" id="ovulationCycleLength" min="21" max="35" value="28" oninput="updateOvulationCycleValue()">
                                    <span class="ovulation-slider-value" id="ovulationCycleValue">28</span>
                                </div>
                                <p class="ovulation-slider-hint">ÏùºÎ∞òÏ†ÅÏúºÎ°ú 21Ïùº ~ 35Ïùº ÏÇ¨Ïù¥ÏûÖÎãàÎã§</p>
                            </div>
                        </div>
                        
                        <div class="ovulation-form-group">
                            <label>ÏÉùÎ¶¨ Í∏∞Í∞Ñ (Ïùº)</label>
                            <div class="ovulation-slider-container">
                                <div class="ovulation-slider-row">
                                    <input type="range" id="ovulationPeriodLength" min="3" max="7" value="5" oninput="updateOvulationPeriodValue()">
                                    <span class="ovulation-slider-value" id="ovulationPeriodValue">5</span>
                                </div>
                            </div>
                        </div>
                        
                        <button type="button" class="ovulation-btn-calculate" onclick="calculateOvulation()">
                            <i class="fas fa-calculator"></i>
                            Í≥ÑÏÇ∞ÌïòÍ∏∞
                        </button>
                    </div>
                    
                    <div class="ovulation-result-section" id="ovulationResults">
                        <div class="ovulation-result-cards">
                            <div class="ovulation-result-card ovulation-date">
                                <div class="ovulation-result-card-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="ovulation-result-card-label">ÏòàÏÉÅ Î∞∞ÎûÄÏùº</div>
                                <div class="ovulation-result-card-value" id="ovulationDateResult"></div>
                            </div>
                            <div class="ovulation-result-card fertile-window">
                                <div class="ovulation-result-card-icon">
                                    <i class="fas fa-heart"></i>
                                </div>
                                <div class="ovulation-result-card-label">Í∞ÄÏûÑÍ∏∞Í∞Ñ</div>
                                <div class="ovulation-result-card-value" id="fertileWindowResult"></div>
                            </div>
                            <div class="ovulation-result-card next-period">
                                <div class="ovulation-result-card-icon">
                                    <i class="fas fa-clock"></i>
                                </div>
                                <div class="ovulation-result-card-label">Îã§Ïùå ÏÉùÎ¶¨ ÏòàÏ†ïÏùº</div>
                                <div class="ovulation-result-card-value" id="nextPeriodResult"></div>
                            </div>
                        </div>
                        
                        <div class="ovulation-calendar-section">
                            <div class="ovulation-calendar-title">
                                üìÖ ÏõîÎ≥Ñ Îã¨Î†•
                            </div>
                            <div class="ovulation-calendar" id="ovulationCalendar"></div>
                            <div class="ovulation-legend">
                                <div class="ovulation-legend-item">
                                    <div class="ovulation-legend-color period"></div>
                                    <span>ÏÉùÎ¶¨Í∏∞Í∞Ñ</span>
                                </div>
                                <div class="ovulation-legend-item">
                                    <div class="ovulation-legend-color fertile"></div>
                                    <span>Í∞ÄÏûÑÍ∏∞Í∞Ñ</span>
                                </div>
                                <div class="ovulation-legend-item">
                                    <div class="ovulation-legend-color ovulation"></div>
                                    <span>Î∞∞ÎûÄÏùº</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="ovulation-tips-section">
                            <div class="ovulation-tips-title">
                                üí° ÏïåÏïÑÎëêÏÑ∏Ïöî
                            </div>
                            <ul class="ovulation-tip-list">
                                <li>Î∞∞ÎûÄÏùÄ Î≥¥ÌÜµ Îã§Ïùå ÏÉùÎ¶¨ ÏãúÏûë <strong>14Ïùº Ï†Ñ</strong>Ïóê ÏùºÏñ¥ÎÇ©ÎãàÎã§.</li>
                                <li>Í∞ÄÏûÑÍ∏∞Í∞ÑÏùÄ Î∞∞ÎûÄÏùº <strong>5Ïùº Ï†ÑÎ∂ÄÌÑ∞ Î∞∞ÎûÄ ÌõÑ 1ÏùºÍπåÏßÄ</strong>ÏûÖÎãàÎã§.</li>
                                <li>Ïù¥ Í≥ÑÏÇ∞Í∏∞Îäî <strong>Ï∞∏Í≥†Ïö©</strong>Ïù¥Î©∞, Ï†ïÌôïÌïú ÏßÑÎã®ÏùÄ Ï†ÑÎ¨∏ÏùòÏôÄ ÏÉÅÎã¥ÌïòÏÑ∏Ïöî.</li>
                                <li>ÏÉùÎ¶¨ Ï£ºÍ∏∞Í∞Ä Î∂àÍ∑úÏπôÌïú Í≤ΩÏö∞ ÏòàÏ∏°Ïù¥ Ï†ïÌôïÌïòÏßÄ ÏïäÏùÑ Ïàò ÏûàÏäµÎãàÎã§.</li>
                            </ul>
                        </div>
                        
                        <div class="ovulation-info-section">
                            <div class="ovulation-tabs">
                                <button class="ovulation-tab-btn active" onclick="showOvulationTab('basics')">Í∏∞Î≥∏ ÏÉÅÏãù</button>
                                <button class="ovulation-tab-btn" onclick="showOvulationTab('symptoms')">ÏÉùÎ¶¨ Ï¶ùÏÉÅ</button>
                                <button class="ovulation-tab-btn" onclick="showOvulationTab('health')">Í±¥Í∞ï Í¥ÄÎ¶¨</button>
                                <button class="ovulation-tab-btn" onclick="showOvulationTab('myths')">Ïò§Ìï¥ÏôÄ ÏßÑÏã§</button>
                            </div>
                            
                            <div class="ovulation-tab-content active" id="ovulation-tab-basics">
                                <div class="ovulation-info-card">
                                    <h4>üîÑ ÏÉùÎ¶¨ Ï£ºÍ∏∞ÎûÄ?</h4>
                                    <p>ÏÉùÎ¶¨ Ï£ºÍ∏∞Îäî ÏÉùÎ¶¨ ÏãúÏûëÏùºÎ∂ÄÌÑ∞ Îã§Ïùå ÏÉùÎ¶¨ ÏãúÏûë Ï†ÑÎÇ†ÍπåÏßÄÏùò Í∏∞Í∞ÑÏûÖÎãàÎã§. Ï†ïÏÉÅÏ†ÅÏù∏ Ï£ºÍ∏∞Îäî <strong>21~35Ïùº</strong>Ïù¥Î©∞, ÌèâÍ∑†Ï†ÅÏúºÎ°ú 28ÏùºÏûÖÎãàÎã§.</p>
                                </div>
                                <div class="ovulation-info-card">
                                    <h4>üíß Ï†ïÏÉÅÏ†ÅÏù∏ ÏÉùÎ¶¨Îüâ</h4>
                                    <p>Ìïú Î≤àÏùò ÏÉùÎ¶¨ Í∏∞Í∞Ñ ÎèôÏïà ÌèâÍ∑† <strong>30~80ml</strong>Ïùò ÌòàÏï°Ïù¥ Î∞∞Ï∂úÎê©ÎãàÎã§. ÏÉùÎ¶¨ÎåÄÎ•º 2ÏãúÍ∞Ñ Ïù¥ÎÇ¥Ïóê ÍµêÏ≤¥Ìï¥Ïïº Ìï† Ï†ïÎèÑÎ©¥ Í≥ºÎã§ÏõîÍ≤ΩÏùÑ ÏùòÏã¨Ìï¥Î≥º Ïàò ÏûàÏäµÎãàÎã§.</p>
                                </div>
                                <div class="ovulation-info-card">
                                    <h4>ü•ö Î∞∞ÎûÄÏùò ÏõêÎ¶¨</h4>
                                    <p>Îß§Ïõî ÎÇúÏÜåÏóêÏÑú ÏÑ±ÏàôÌïú ÎÇúÏûêÍ∞Ä Î∞∞Ï∂úÎêòÎäî ÌòÑÏÉÅÏûÖÎãàÎã§. Î∞∞ÎûÄÎêú ÎÇúÏûêÎäî ÏïΩ <strong>12~24ÏãúÍ∞Ñ</strong> ÎèôÏïà ÏàòÏ†ï Í∞ÄÎä•ÌïòÎ©∞, Ï†ïÏûêÎäî Ïó¨ÏÑ± Ï≤¥ÎÇ¥ÏóêÏÑú ÏµúÎåÄ <strong>5Ïùº</strong>ÍπåÏßÄ ÏÉùÏ°¥Ìï©ÎãàÎã§.</p>
                                </div>
                            </div>
                            
                            <div class="ovulation-tab-content" id="ovulation-tab-symptoms">
                                <div class="ovulation-info-card">
                                    <h4>üò£ ÏÉùÎ¶¨ÌÜµ (ÏõîÍ≤ΩÌÜµ)</h4>
                                    <p>ÏûêÍ∂Å ÏàòÏ∂ïÏúºÎ°ú Ïù∏Ìï¥ Î∞úÏÉùÌïòÎäî ÌïòÎ≥µÎ∂Ä ÌÜµÏ¶ùÏûÖÎãàÎã§. Ïó¨ÏÑ±Ïùò <strong>50~90%</strong>Í∞Ä Í≤ΩÌóòÌïòÎ©∞, ÌîÑÎ°úÏä§ÌÉÄÍ∏ÄÎûÄÎîò Ìò∏Î•¥Î™¨Ïù¥ Ï£ºÏöî ÏõêÏù∏ÏûÖÎãàÎã§.<br>üíä ÏôÑÌôîÎ≤ï: Îî∞ÎúªÌïú Ï∞úÏßà, Í∞ÄÎ≤ºÏö¥ Ïö¥Îèô, ÏßÑÌÜµÏ†ú Î≥µÏö©</p>
                                </div>
                                <div class="ovulation-info-card">
                                    <h4>üò§ ÏÉùÎ¶¨Ï†ÑÏ¶ùÌõÑÍµ∞ (PMS)</h4>
                                    <p>ÏÉùÎ¶¨ 1~2Ï£º Ï†Ñ ÎÇòÌÉÄÎÇòÎäî Ïã†Ï≤¥Ï†Å, Ï†ïÏÑúÏ†Å Î≥ÄÌôîÏûÖÎãàÎã§. <strong>Ïú†Î∞© ÌÜµÏ¶ù, Î≥µÎ∂Ä ÌåΩÎßåÍ∞ê, ÎëêÌÜµ, ÌîºÎ°úÍ∞ê, Í∞êÏ†ï Í∏∞Î≥µ</strong> Îì±Ïù¥ ÎÇòÌÉÄÎÇ† Ïàò ÏûàÏäµÎãàÎã§.<br>üíä ÏôÑÌôîÎ≤ï: Í∑úÏπôÏ†ÅÏù∏ Ïö¥Îèô, Ïπ¥ÌéòÏù∏¬∑ÏóºÎ∂Ñ Ï§ÑÏù¥Í∏∞, Ï∂©Î∂ÑÌïú ÏàòÎ©¥</p>
                                </div>
                                <div class="ovulation-info-card">
                                    <h4>üéØ Î∞∞ÎûÄÌÜµ</h4>
                                    <p>Î∞∞ÎûÄ Ïãú ÎÇúÌè¨Í∞Ä ÌÑ∞ÏßÄÎ©¥ÏÑú Î∞úÏÉùÌïòÎäî ÏùºÏãúÏ†ÅÏù∏ ÌÜµÏ¶ùÏûÖÎãàÎã§. ÌïúÏ™Ω ÌïòÎ≥µÎ∂ÄÏóê <strong>Ïàò Î∂Ñ~48ÏãúÍ∞Ñ</strong> ÏßÄÏÜçÎê† Ïàò ÏûàÏäµÎãàÎã§.</p>
                                </div>
                            </div>
                            
                            <div class="ovulation-tab-content" id="ovulation-tab-health">
                                <div class="ovulation-info-card">
                                    <h4>ü•ó ÏòÅÏñë Í¥ÄÎ¶¨</h4>
                                    <p>‚Ä¢ <strong>Ï≤†Î∂Ñ</strong>: ÏÉùÎ¶¨Î°ú Ïù∏Ìïú Ï≤†Î∂Ñ ÏÜêÏã§ Î≥¥Ï∂©<br>‚Ä¢ <strong>ÏπºÏäò & ÎßàÍ∑∏ÎÑ§Ïäò</strong>: ÏÉùÎ¶¨ÌÜµ ÏôÑÌôîÏóê ÎèÑÏõÄ<br>‚Ä¢ <strong>Ïò§Î©îÍ∞Ä-3</strong>: ÏóºÏ¶ù Í∞êÏÜå Î∞è Í∏∞Î∂Ñ Í∞úÏÑ†<br>‚Ä¢ <strong>ÎπÑÌÉÄÎØº B6</strong>: PMS Ï¶ùÏÉÅ ÏôÑÌôî</p>
                                </div>
                                <div class="ovulation-info-card">
                                    <h4>üèÉ‚Äç‚ôÄÔ∏è Ïö¥Îèô</h4>
                                    <p>Í∑úÏπôÏ†ÅÏù∏ Ïö¥ÎèôÏùÄ ÏÉùÎ¶¨ÌÜµÏùÑ <strong>25%</strong>ÍπåÏßÄ Ï§ÑÏùº Ïàò ÏûàÏäµÎãàÎã§. ÏÉùÎ¶¨ Í∏∞Í∞ÑÏóêÎèÑ Í∞ÄÎ≤ºÏö¥ ÏöîÍ∞Ä, Í±∑Í∏∞, Ïä§Ìä∏Î†àÏπ≠Ïù¥ ÎèÑÏõÄÎê©ÎãàÎã§.</p>
                                </div>
                                <div class="ovulation-info-card">
                                    <h4>ü©∫ Ï†ïÍ∏∞ Í≤ÄÏßÑ</h4>
                                    <p>20ÏÑ∏ Ïù¥ÏÉÅ Ïó¨ÏÑ±ÏùÄ <strong>1~2ÎÖÑÎßàÎã§</strong> ÏÇ∞Î∂ÄÏù∏Í≥º Í≤ÄÏßÑÏùÑ Í∂åÏû•Ìï©ÎãàÎã§. ÏûêÍ∂ÅÍ≤ΩÎ∂ÄÏïî Í≤ÄÏÇ¨, Ï¥àÏùåÌåå Í≤ÄÏÇ¨ Îì±ÏùÑ ÌÜµÌï¥ Í±¥Í∞ïÏùÑ ÌôïÏù∏ÌïòÏÑ∏Ïöî.</p>
                                </div>
                            </div>
                            
                            <div class="ovulation-tab-content" id="ovulation-tab-myths">
                                <div class="ovulation-info-card">
                                    <h4>‚úó "ÏÉùÎ¶¨ Ï§ë Ïö¥ÎèôÌïòÎ©¥ Ïïà ÎêúÎã§"</h4>
                                    <p>‚úì ÏÇ¨Ïã§: Í∞ÄÎ≤ºÏö¥ Ïö¥ÎèôÏùÄ Ïò§ÌûàÎ†§ ÏÉùÎ¶¨ÌÜµ ÏôÑÌôîÏóê ÎèÑÏõÄÏù¥ Îê©ÎãàÎã§.</p>
                                </div>
                                <div class="ovulation-info-card">
                                    <h4>‚úó "ÏÉùÎ¶¨ Ï§ëÏóêÎäî ÏûÑÏã†Ïù¥ Ïïà ÎêúÎã§"</h4>
                                    <p>‚úì ÏÇ¨Ïã§: Í∞ÄÎä•ÏÑ±ÏùÄ ÎÇÆÏßÄÎßå, ÏÉùÎ¶¨ Ï£ºÍ∏∞Í∞Ä ÏßßÍ±∞ÎÇò Î∂àÍ∑úÏπôÌïòÎ©¥ ÏûÑÏã† Í∞ÄÎä•Ìï©ÎãàÎã§.</p>
                                </div>
                                <div class="ovulation-info-card">
                                    <h4>‚úó "ÏÉùÎ¶¨Ìòà ÏÉâÏù¥ Í≤ÄÏúºÎ©¥ Î¨∏Ï†úÎã§"</h4>
                                    <p>‚úì ÏÇ¨Ïã§: ÏßôÏùÄ Í∞àÏÉâ~Í≤ÄÏùÄÏÉâ ÌòàÏùÄ Ïò§ÎûòÎêú ÌòàÏï°ÏúºÎ°ú Ï†ïÏÉÅÏûÖÎãàÎã§.</p>
                                </div>
                                <div class="ovulation-info-card">
                                    <h4>‚úó "ÏÉùÎ¶¨ Ï£ºÍ∏∞Îäî Ìï≠ÏÉÅ 28ÏùºÏù¥Ïñ¥Ïïº Ï†ïÏÉÅ"</h4>
                                    <p>‚úì ÏÇ¨Ïã§: 21~35Ïùº ÏÇ¨Ïù¥ÎùºÎ©¥ Î™®Îëê Ï†ïÏÉÅ Î≤îÏúÑÏûÖÎãàÎã§.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function initOvulationCalculator() {
            // Ïò§Îäò ÎÇ†ÏßúÎ•º Í∏∞Î≥∏Í∞íÏúºÎ°ú ÏÑ§Ï†ï
            document.getElementById('ovulationLastPeriod').valueAsDate = new Date();
        }
        
        function updateOvulationCycleValue() {
            document.getElementById('ovulationCycleValue').textContent = document.getElementById('ovulationCycleLength').value;
        }
        
        function updateOvulationPeriodValue() {
            document.getElementById('ovulationPeriodValue').textContent = document.getElementById('ovulationPeriodLength').value;
        }
        
        function formatOvulationDate(date) {
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const weekdays = ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'];
            const weekday = weekdays[date.getDay()];
            return month + 'Ïõî ' + day + 'Ïùº (' + weekday + ')';
        }
        
        function formatShortOvulationDate(date) {
            const month = date.getMonth() + 1;
            const day = date.getDate();
            return month + '/' + day;
        }
        
        function addOvulationDays(date, days) {
            const result = new Date(date);
            result.setDate(result.getDate() + days);
            return result;
        }
        
        function isSameOvulationDay(date1, date2) {
            return date1.getFullYear() === date2.getFullYear() &&
                   date1.getMonth() === date2.getMonth() &&
                   date1.getDate() === date2.getDate();
        }
        
        function isInOvulationRange(date, start, end) {
            const d = new Date(date.getFullYear(), date.getMonth(), date.getDate());
            const s = new Date(start.getFullYear(), start.getMonth(), start.getDate());
            const e = new Date(end.getFullYear(), end.getMonth(), end.getDate());
            return d >= s && d <= e;
        }
        
        function calculateOvulation() {
            const lastPeriodInput = document.getElementById('ovulationLastPeriod').value;
            const cycleLength = parseInt(document.getElementById('ovulationCycleLength').value);
            const periodLength = parseInt(document.getElementById('ovulationPeriodLength').value);
            
            if (!lastPeriodInput) {
                alert('ÎßàÏßÄÎßâ ÏÉùÎ¶¨ ÏãúÏûëÏùºÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî.');
                return;
            }
            
            const lastPeriod = new Date(lastPeriodInput);
            
            // Í≥ÑÏÇ∞
            const nextPeriod = addOvulationDays(lastPeriod, cycleLength);
            const ovulationDate = addOvulationDays(nextPeriod, -14);
            const fertileStart = addOvulationDays(ovulationDate, -5);
            const fertileEnd = addOvulationDays(ovulationDate, 1);
            const periodEnd = addOvulationDays(lastPeriod, periodLength - 1);
            
            // Í≤∞Í≥º ÌëúÏãú
            document.getElementById('ovulationDateResult').textContent = formatOvulationDate(ovulationDate);
            document.getElementById('fertileWindowResult').textContent = 
                formatShortOvulationDate(fertileStart) + ' ~ ' + formatShortOvulationDate(fertileEnd);
            document.getElementById('nextPeriodResult').textContent = formatOvulationDate(nextPeriod);
            
            // Îã¨Î†• ÏÉùÏÑ±
            generateOvulationCalendar(lastPeriod, periodEnd, fertileStart, fertileEnd, ovulationDate, nextPeriod);
            
            // Í≤∞Í≥º ÏÑπÏÖò ÌëúÏãú
            document.getElementById('ovulationResults').classList.add('active');
            document.getElementById('ovulationResults').scrollIntoView({ behavior: 'smooth' });
        }
        
        function generateOvulationCalendar(lastPeriod, periodEnd, fertileStart, fertileEnd, ovulationDate, nextPeriod) {
            const calendarDiv = document.getElementById('ovulationCalendar');
            let html = '';
            
            for (let m = 0; m < 2; m++) {
                const currentMonth = new Date(lastPeriod);
                currentMonth.setMonth(currentMonth.getMonth() + m);
                currentMonth.setDate(1);
                
                const monthName = currentMonth.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long' });
                
                html += '<div style="margin-bottom: 24px;">' +
                    '<div class="ovulation-calendar-month">' + monthName + '</div>' +
                    '<div class="ovulation-calendar-grid">' +
                        '<div class="ovulation-calendar-header sunday">Ïùº</div>' +
                        '<div class="ovulation-calendar-header">Ïõî</div>' +
                        '<div class="ovulation-calendar-header">Ìôî</div>' +
                        '<div class="ovulation-calendar-header">Ïàò</div>' +
                        '<div class="ovulation-calendar-header">Î™©</div>' +
                        '<div class="ovulation-calendar-header">Í∏à</div>' +
                        '<div class="ovulation-calendar-header saturday">ÌÜ†</div>';
                
                // Ï≤´Ïß∏ ÎÇ† Ï†Ñ Îπà Ïπ∏
                const firstDay = currentMonth.getDay();
                for (let i = 0; i < firstDay; i++) {
                    html += '<div></div>';
                }
                
                // Îã¨Ïùò ÏùºÏàò
                const lastDay = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0).getDate();
                const today = new Date();
                
                for (let day = 1; day <= lastDay; day++) {
                    const currentDate = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), day);
                    let classes = 'ovulation-calendar-day';
                    
                    if (isSameOvulationDay(currentDate, ovulationDate)) {
                        classes += ' ovulation-day';
                    } else if (isInOvulationRange(currentDate, fertileStart, fertileEnd)) {
                        classes += ' fertile-day';
                    } else if (isInOvulationRange(currentDate, lastPeriod, periodEnd)) {
                        classes += ' period-day';
                    } else if (isSameOvulationDay(currentDate, nextPeriod)) {
                        classes += ' next-period-day';
                    } else {
                        const dayOfWeek = currentDate.getDay();
                        if (dayOfWeek === 0) classes += ' sunday';
                        if (dayOfWeek === 6) classes += ' saturday';
                    }
                    
                    if (isSameOvulationDay(currentDate, today)) {
                        classes += ' today';
                    }
                    
                    html += '<div class="' + classes + '">' + day + '</div>';
                }
                
                html += '</div></div>';
            }
            
            calendarDiv.innerHTML = html;
        }
        
        function showOvulationTab(tabName) {
            // Î™®Îì† ÌÉ≠ Î≤ÑÌäº ÎπÑÌôúÏÑ±Ìôî
            document.querySelectorAll('.ovulation-tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Î™®Îì† ÌÉ≠ ÏΩòÌÖêÏ∏† Ïà®Í∏∞Í∏∞
            document.querySelectorAll('.ovulation-tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // ÏÑ†ÌÉùÌïú ÌÉ≠ ÌôúÏÑ±Ìôî
            event.target.classList.add('active');
            document.getElementById('ovulation-tab-' + tabName).classList.add('active');
        }

        // ===== Ï¥åÏàòÌò∏Ïπ≠ Í≥ÑÏÇ∞Í∏∞ =====
        // Í¥ÄÍ≥Ñ Í≤ΩÎ°úÎ•º Ï†ÄÏû•ÌïòÎäî Î∞∞Ïó¥
        let frRelationPath = [];
        let frCurrentSide = 'paternal'; // 'paternal' or 'maternal'

        function getFamilyRelationCalculator() {
            return `
                <style>
                    .fr-container {
                        max-width: 500px;
                        margin: 0 auto;
                        padding: 0 16px;
                    }
                    .fr-title-header {
                        text-align: center;
                        padding: 24px 0 20px;
                    }
                    .fr-title-header h1 {
                        font-size: 22px;
                        font-weight: 700;
                        color: #1a1a2e;
                        margin-bottom: 6px;
                    }
                    .fr-title-header p {
                        font-size: 14px;
                        color: #888;
                    }
                    /* ÎÇò ÌÉúÍ∑∏ Ïπ¥Îìú */
                    .fr-me-card {
                        background: #fff;
                        border-radius: 16px;
                        padding: 16px 20px;
                        margin-bottom: 16px;
                        box-shadow: 0 2px 12px rgba(0,0,0,0.06);
                        display: flex;
                        align-items: center;
                        justify-content: space-between;
                    }
                    .fr-me-tag {
                        display: inline-flex;
                        align-items: center;
                        justify-content: center;
                        background: #4f8cff;
                        color: white;
                        font-size: 14px;
                        font-weight: 600;
                        padding: 6px 14px;
                        border-radius: 20px;
                    }
                    .fr-reset-btn {
                        display: flex;
                        align-items: center;
                        gap: 6px;
                        font-size: 13px;
                        color: #888;
                        background: none;
                        border: none;
                        cursor: pointer;
                        transition: color 0.2s;
                    }
                    .fr-reset-btn:hover {
                        color: #667eea;
                    }
                    .fr-reset-btn i {
                        font-size: 12px;
                    }
                    /* Í≤ΩÎ°ú ÌëúÏãú */
                    .fr-path-display {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        flex-wrap: wrap;
                        margin-top: 10px;
                    }
                    .fr-path-item {
                        display: inline-flex;
                        align-items: center;
                        background: #f0f4ff;
                        color: #667eea;
                        font-size: 13px;
                        font-weight: 500;
                        padding: 4px 12px;
                        border-radius: 14px;
                    }
                    .fr-path-arrow {
                        color: #ccc;
                        font-size: 12px;
                    }
                    /* Ï¥åÏàò ÌëúÏãú Ïπ¥Îìú */
                    .fr-chon-card {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        border-radius: 20px;
                        padding: 40px 20px;
                        text-align: center;
                        margin-bottom: 16px;
                        box-shadow: 0 8px 30px rgba(102, 126, 234, 0.35);
                    }
                    .fr-chon-number {
                        font-size: 72px;
                        font-weight: 800;
                        color: white;
                        line-height: 1;
                        text-shadow: 0 4px 20px rgba(0,0,0,0.2);
                    }
                    .fr-chon-label {
                        font-size: 28px;
                        font-weight: 600;
                        color: rgba(255,255,255,0.9);
                        margin-top: 8px;
                    }
                    /* Ìò∏Ïπ≠ ÌëúÏãú */
                    .fr-title-card {
                        background: #fff;
                        border-radius: 16px;
                        padding: 20px;
                        margin-bottom: 16px;
                        box-shadow: 0 2px 12px rgba(0,0,0,0.06);
                        text-align: center;
                    }
                    .fr-title-label {
                        font-size: 13px;
                        color: #888;
                        margin-bottom: 8px;
                    }
                    .fr-title-value {
                        font-size: 24px;
                        font-weight: 700;
                        color: #1a1a2e;
                    }
                    /* Ï†ïÎ≥¥ Í∑∏Î¶¨Îìú */
                    .fr-info-grid {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 10px;
                        margin-bottom: 16px;
                    }
                    .fr-info-item {
                        background: #fff;
                        border-radius: 14px;
                        padding: 16px;
                        text-align: center;
                        box-shadow: 0 2px 12px rgba(0,0,0,0.06);
                    }
                    .fr-info-label {
                        font-size: 12px;
                        color: #888;
                        margin-bottom: 6px;
                    }
                    .fr-info-value {
                        font-size: 15px;
                        font-weight: 700;
                    }
                    .fr-info-value.blue { color: #4f8cff; }
                    .fr-info-value.green { color: #22c55e; }
                    .fr-info-value.orange { color: #f59e0b; }
                    .fr-info-value.pink { color: #ec4899; }
                    /* ÏïàÎÇ¥ Î©îÏãúÏßÄ */
                    .fr-guide-msg {
                        background: linear-gradient(135deg, #e8f0fe 0%, #f0e8fe 100%);
                        border-radius: 14px;
                        padding: 16px 20px;
                        text-align: center;
                        font-size: 14px;
                        color: #667eea;
                        margin-bottom: 20px;
                        font-weight: 500;
                    }
                    /* Í¥ÄÍ≥Ñ ÏÑ†ÌÉù ÏÑπÏÖò */
                    .fr-select-section {
                        background: #fff;
                        border-radius: 20px;
                        padding: 20px;
                        margin-bottom: 16px;
                        box-shadow: 0 2px 12px rgba(0,0,0,0.06);
                    }
                    .fr-section-title {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        font-size: 15px;
                        font-weight: 700;
                        color: #1a1a2e;
                        margin-bottom: 14px;
                    }
                    .fr-section-title .emoji {
                        font-size: 18px;
                    }
                    .fr-btn-row {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 10px;
                    }
                    .fr-relation-btn {
                        padding: 14px 16px;
                        border: none;
                        border-radius: 12px;
                        font-size: 15px;
                        font-weight: 600;
                        cursor: pointer;
                        transition: all 0.2s ease;
                    }
                    .fr-relation-btn:active {
                        transform: scale(0.97);
                    }
                    /* ÏÉâÏÉÅÎ≥Ñ Î≤ÑÌäº */
                    .fr-btn-orange {
                        background: #fb923c;
                        color: white;
                    }
                    .fr-btn-orange:hover { background: #f97316; }
                    .fr-btn-green {
                        background: #22c55e;
                        color: white;
                    }
                    .fr-btn-green:hover { background: #16a34a; }
                    .fr-btn-purple {
                        background: #a855f7;
                        color: white;
                    }
                    .fr-btn-purple:hover { background: #9333ea; }
                    .fr-btn-blue {
                        background: #3b82f6;
                        color: white;
                    }
                    .fr-btn-blue:hover { background: #2563eb; }
                    .fr-btn-pink {
                        background: #f472b6;
                        color: white;
                    }
                    .fr-btn-pink:hover { background: #ec4899; }
                    .fr-btn-teal {
                        background: #2dd4bf;
                        color: white;
                    }
                    .fr-btn-teal:hover { background: #14b8a6; }
                    /* Ïö©Ïñ¥ ÏÑ§Î™Ö */
                    .fr-glossary {
                        background: #fff;
                        border-radius: 16px;
                        padding: 20px;
                        box-shadow: 0 2px 12px rgba(0,0,0,0.06);
                    }
                    .fr-glossary-title {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        font-size: 15px;
                        font-weight: 700;
                        color: #1a1a2e;
                        margin-bottom: 12px;
                    }
                    .fr-glossary-content {
                        font-size: 13px;
                        color: #555;
                        line-height: 1.8;
                    }
                    .fr-glossary-content .term {
                        font-weight: 600;
                    }
                    .fr-glossary-content .term.red { color: #ef4444; }
                    .fr-glossary-content .term.blue { color: #3b82f6; }
                    .fr-glossary-content .term.green { color: #22c55e; }
                    .fr-glossary-content .term.purple { color: #a855f7; }
                    /* ÌåÅ ÏÑπÏÖò */
                    .fr-tips-section {
                        background: #fff;
                        border-radius: 16px;
                        padding: 20px;
                        margin-top: 16px;
                        box-shadow: 0 2px 12px rgba(0,0,0,0.06);
                    }
                    .fr-tips-title {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        font-size: 15px;
                        font-weight: 700;
                        color: #1a1a2e;
                        margin-bottom: 14px;
                    }
                    .fr-chon-table {
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 8px;
                        font-size: 13px;
                        color: #555;
                    }
                    .fr-chon-table div {
                        padding: 8px 12px;
                        background: #f8fafc;
                        border-radius: 8px;
                    }
                    /* Î≤ïÎ•† Ï†ïÎ≥¥ */
                    .fr-law-section {
                        background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
                        border-left: 4px solid #0ea5e9;
                        border-radius: 12px;
                        padding: 16px;
                        margin-top: 16px;
                    }
                    .fr-law-title {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        font-size: 14px;
                        font-weight: 700;
                        color: #0369a1;
                        margin-bottom: 10px;
                    }
                    .fr-law-content {
                        font-size: 13px;
                        color: #334155;
                        line-height: 1.7;
                    }
                    .fr-law-content ul {
                        padding-left: 20px;
                        margin: 8px 0;
                    }
                    .fr-law-note {
                        background: #fff;
                        padding: 10px 12px;
                        border-radius: 8px;
                        margin-top: 10px;
                        font-size: 12px;
                    }
                    /* Ïö©Ïñ¥ ÏÑπÏÖò */
                    .fr-terms-section {
                        background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
                        border-left: 4px solid #a855f7;
                        border-radius: 12px;
                        padding: 16px;
                        margin-top: 16px;
                    }
                    .fr-terms-title {
                        display: flex;
                        align-items: center;
                        gap: 8px;
                        font-size: 14px;
                        font-weight: 700;
                        color: #7e22ce;
                        margin-bottom: 10px;
                    }
                    .fr-terms-grid {
                        display: grid;
                        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                        gap: 8px;
                        font-size: 12px;
                        color: #334155;
                    }
                    .fr-terms-grid span.term-name {
                        color: #a855f7;
                        font-weight: 600;
                    }
                </style>
                <div class="fr-container">
                    <div class="fr-title-header">
                        <h1>Ï¥åÏàò Í≥ÑÏÇ∞Í∏∞</h1>
                        <p>Í∞ÄÏ°± Í¥ÄÍ≥ÑÎ•º ÏÑ†ÌÉùÌïòÏó¨ Ï¥åÏàòÎ•º Í≥ÑÏÇ∞ÌïòÏÑ∏Ïöî</p>
                    </div>
                    
                    <!-- ÎÇò Ïπ¥Îìú -->
                    <div class="fr-me-card">
                        <div>
                            <span class="fr-me-tag">ÎÇò</span>
                            <div class="fr-path-display" id="frPathDisplay"></div>
                        </div>
                        <button class="fr-reset-btn" onclick="frResetAll()">
                            <i class="fas fa-redo"></i> Ï≤òÏùåÎ∂ÄÌÑ∞ Îã§Ïãú
                        </button>
                    </div>
                    
                    <!-- Ï¥åÏàò ÌëúÏãú Ïπ¥Îìú -->
                    <div class="fr-chon-card">
                        <div id="frChonNumber" class="fr-chon-number">-</div>
                        <div class="fr-chon-label">Ï¥å</div>
                    </div>
                    
                    <!-- Ìò∏Ïπ≠ ÌëúÏãú -->
                    <div class="fr-title-card">
                        <div class="fr-title-label">Ìò∏Ïπ≠</div>
                        <div id="frFinalTitle" class="fr-title-value">Í¥ÄÍ≥ÑÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</div>
                    </div>
                    
                    <!-- Ï†ïÎ≥¥ Í∑∏Î¶¨Îìú -->
                    <div class="fr-info-grid">
                        <div class="fr-info-item">
                            <div class="fr-info-label">ÏπúÏ°± Ïú†Ìòï</div>
                            <div id="frKinType" class="fr-info-value blue">-</div>
                        </div>
                        <div class="fr-info-item">
                            <div class="fr-info-label">Í≥ÑÌÜµ</div>
                            <div id="frLineType" class="fr-info-value green">-</div>
                        </div>
                        <div class="fr-info-item">
                            <div class="fr-info-label">Ï°¥ÎπÑÏÜç</div>
                            <div id="frGenType" class="fr-info-value orange">-</div>
                        </div>
                        <div class="fr-info-item">
                            <div class="fr-info-label">Î∂ÄÍ≥Ñ/Î™®Í≥Ñ</div>
                            <div id="frSideType" class="fr-info-value pink">-</div>
                        </div>
                    </div>
                    
                    <!-- ÏïàÎÇ¥ Î©îÏãúÏßÄ -->
                    <div class="fr-guide-msg">
                        ÏúÑÏóêÏÑú Í¥ÄÍ≥ÑÎ•º ÏÑ†ÌÉùÌïòÎ©¥ Ï¥åÏàòÍ∞Ä Í≥ÑÏÇ∞Îê©ÎãàÎã§.
                    </div>
                    
                    <!-- Í¥ÄÍ≥Ñ ÏÑ†ÌÉù: ÏúóÎåÄ -->
                    <div class="fr-select-section">
                        <div class="fr-section-title">
                            <span class="emoji">üîº</span> ÏúóÎåÄ (Ï°∞ÏÉÅ)
                        </div>
                        <div class="fr-btn-row">
                            <button class="fr-relation-btn fr-btn-orange" onclick="frAddRelation('ÏïÑÎ≤ÑÏßÄ')">ÏïÑÎ≤ÑÏßÄ</button>
                            <button class="fr-relation-btn fr-btn-orange" onclick="frAddRelation('Ïñ¥Î®∏Îãà')">Ïñ¥Î®∏Îãà</button>
                        </div>
                    </div>
                    
                    <!-- Í¥ÄÍ≥Ñ ÏÑ†ÌÉù: ÏïÑÎû´ÎåÄ -->
                    <div class="fr-select-section">
                        <div class="fr-section-title">
                            <span class="emoji">üîΩ</span> ÏïÑÎû´ÎåÄ (ÏûêÏÜê)
                        </div>
                        <div class="fr-btn-row">
                            <button class="fr-relation-btn fr-btn-green" onclick="frAddRelation('ÏïÑÎì§')">ÏïÑÎì§</button>
                            <button class="fr-relation-btn fr-btn-purple" onclick="frAddRelation('Îî∏')">Îî∏</button>
                        </div>
                    </div>
                    
                    <!-- Í¥ÄÍ≥Ñ ÏÑ†ÌÉù: Í∞ôÏùÄÎåÄ -->
                    <div class="fr-select-section">
                        <div class="fr-section-title">
                            <span class="emoji">‚ûï</span> Í∞ôÏùÄÎåÄ (ÌòïÏ†úÏûêÎß§)
                        </div>
                        <div class="fr-btn-row">
                            <button class="fr-relation-btn fr-btn-blue" onclick="frAddRelation('Ìòï')">Ìòï/Ïò§Îπ†</button>
                            <button class="fr-relation-btn fr-btn-blue" onclick="frAddRelation('ÎÇ®ÎèôÏÉù')">ÎÇ®ÎèôÏÉù</button>
                        </div>
                        <div class="fr-btn-row" style="margin-top: 10px;">
                            <button class="fr-relation-btn fr-btn-pink" onclick="frAddRelation('ÎàÑÎÇò')">ÎàÑÎÇò/Ïñ∏Îãà</button>
                            <button class="fr-relation-btn fr-btn-pink" onclick="frAddRelation('Ïó¨ÎèôÏÉù')">Ïó¨ÎèôÏÉù</button>
                        </div>
                    </div>
                    
                    <!-- Í¥ÄÍ≥Ñ ÏÑ†ÌÉù: Î∞∞Ïö∞Ïûê -->
                    <div class="fr-select-section">
                        <div class="fr-section-title">
                            <span class="emoji">üíë</span> Î∞∞Ïö∞Ïûê
                        </div>
                        <div class="fr-btn-row">
                            <button class="fr-relation-btn fr-btn-teal" onclick="frAddRelation('ÎÇ®Ìé∏')">ÎÇ®Ìé∏</button>
                            <button class="fr-relation-btn fr-btn-teal" onclick="frAddRelation('ÏïÑÎÇ¥')">ÏïÑÎÇ¥</button>
                        </div>
                    </div>
                    
                    <!-- Ïö©Ïñ¥ ÏÑ§Î™Ö -->
                    <div class="fr-glossary">
                        <div class="fr-glossary-title">
                            üìñ Ïö©Ïñ¥ ÏÑ§Î™Ö
                        </div>
                        <div class="fr-glossary-content">
                            <span class="term red">ÌòàÏ°±</span>: ÌîºÎ°ú Ïó∞Í≤∞Îêú ÏπúÏ°± / <span class="term blue">Ïù∏Ï≤ô</span>: Í≤∞ÌòºÏúºÎ°ú Îß∫Ïñ¥ÏßÑ ÏπúÏ°±<br>
                            <span class="term green">ÏßÅÍ≥Ñ</span>: ÏßÅÏ†ë Ïù¥Ïñ¥ÏßÑ Ï°∞ÏÉÅ¬∑ÏûêÏÜê / <span class="term purple">Î∞©Í≥Ñ</span>: ÌòïÏ†úÏóêÏÑú Í∞àÎùºÏßÑ ÏπúÏ°±
                        </div>
                    </div>
                    
                    <!-- Ï¥åÏàò Ï∞∏Í≥†Ìëú -->
                    <div class="fr-tips-section">
                        <div class="fr-tips-title">
                            üìä Ï¥åÏàò Ï∞∏Í≥†Ìëú
                        </div>
                        <div class="fr-chon-table">
                            <div>‚Ä¢ 1Ï¥å: Î∂ÄÎ™®, ÏûêÎÖÄ</div>
                            <div>‚Ä¢ 2Ï¥å: Ï°∞Î∂ÄÎ™®, ÏÜêÏûêÎÖÄ, ÌòïÏ†ú</div>
                            <div>‚Ä¢ 3Ï¥å: Ï¶ùÏ°∞Î∂ÄÎ™®, ÏÇºÏ¥å, Ï°∞Ïπ¥</div>
                            <div>‚Ä¢ 4Ï¥å: Í≥†Ï°∞Î∂ÄÎ™®, ÏÇ¨Ï¥å</div>
                            <div>‚Ä¢ 5Ï¥å: Ï¢ÖÏàô, 5Ï¥åÏ°∞Ïπ¥</div>
                            <div>‚Ä¢ 6Ï¥å: Ïú°Ï¥å (Ïû¨Ï¢ÖÌòïÏ†ú)</div>
                            <div>‚Ä¢ 7Ï¥å: Ïû¨Ï¢ÖÏàô, 7Ï¥åÏ°∞Ïπ¥</div>
                            <div>‚Ä¢ 8Ï¥å: ÌåîÏ¥å (ÏÇºÏ¢ÖÌòïÏ†ú)</div>
                        </div>
                        
                        <!-- Î≤ïÎ•† Ï†ïÎ≥¥ -->
                        <div class="fr-law-section">
                            <div class="fr-law-title">
                                <i class="fas fa-gavel"></i> ÎØºÎ≤ïÏÉÅ ÏπúÏ°±Ïùò Î≤îÏúÑ (8Ï¥å Ïù¥ÎÇ¥)
                            </div>
                            <div class="fr-law-content">
                                <strong>üìú ÎØºÎ≤ï Ï†ú777Ï°∞ (ÏπúÏ°±Ïùò Î≤îÏúÑ)</strong>
                                <ul>
                                    <li><strong>ÌòàÏ°±</strong>: 8Ï¥å Ïù¥ÎÇ¥Ïùò ÌòàÏ°±</li>
                                    <li><strong>Ïù∏Ï≤ô</strong>: 4Ï¥å Ïù¥ÎÇ¥Ïùò Ïù∏Ï≤ô</li>
                                    <li><strong>Î∞∞Ïö∞Ïûê</strong>: Î∞∞Ïö∞Ïûê</li>
                                </ul>
                                <div class="fr-law-note">
                                    <i class="fas fa-info-circle" style="color:#0ea5e9;"></i> 
                                    <strong>Î≤ïÏ†Å Ìö®Î†•</strong>: ÏπúÏ°± Î≤îÏúÑ ÎÇ¥ÏóêÏÑú ÏÉÅÏÜçÍ∂å, Î∂ÄÏñëÏùòÎ¨¥, ÏπúÏ°±ÏÉÅÎèÑÎ°Ä(ÏπúÏ°± Í∞Ñ Ïû¨ÏÇ∞Î≤îÏ£Ñ ÌäπÎ°Ä) Îì±Ïù¥ Ï†ÅÏö©Îê©ÎãàÎã§.
                                </div>
                            </div>
                        </div>
                        
                        <!-- ÏπúÏ°± Ïö©Ïñ¥ -->
                        <div class="fr-terms-section">
                            <div class="fr-terms-title">
                                <i class="fas fa-book"></i> ÏπúÏ°± Í¥ÄÎ†® Ïö©Ïñ¥
                            </div>
                            <div class="fr-terms-grid">
                                <div><span class="term-name">Ï¢ÖÏπú(ÂÆóË¶™)</span>: Í∞ôÏùÄ ÏÑ±Ïî®¬∑Î≥∏Í¥ÄÏùò ÏùºÏ°±</div>
                                <div><span class="term-name">ÎèôÎ≥µ(ÂêåËÖπ)</span>: Í∞ôÏùÄ Ïñ¥Î®∏ÎãàÏóêÍ≤åÏÑú ÎÇú ÌòïÏ†ú</div>
                                <div><span class="term-name">Ïù¥Î≥µ(Áï∞ËÖπ)</span>: ÏïÑÎ≤ÑÏßÄÎßå Í∞ôÏùÄ ÌòïÏ†ú</div>
                                <div><span class="term-name">Ïù¥Î∂Ä(Áï∞Áà∂)</span>: Ïñ¥Î®∏ÎãàÎßå Í∞ôÏùÄ ÌòïÏ†ú</div>
                                <div><span class="term-name">Ï†ÅÎ™®(Â´°ÊØç)</span>: ÏÑúÏûêÏùò ÏïÑÎ≤ÑÏßÄ Î≥∏Ï≤ò</div>
                                <div><span class="term-name">ÏÉùÎ™®(ÁîüÊØç)</span>: ÎÇ≥ÏïÑÏ§Ä Ïñ¥Î®∏Îãà</div>
                                <div><span class="term-name">Ïô∏Ï≤ô(Â§ñÊàö)</span>: Ïñ¥Î®∏Îãà Ï™Ω ÏπúÏ°±</div>
                                <div><span class="term-name">Ï≤òÍ∞Ä(Â¶ªÂÆ∂)</span>: ÏïÑÎÇ¥Ïùò ÏπúÏ†ï</div>
                                <div><span class="term-name">ÏãúÍ∞Ä(Â™§ÂÆ∂)</span>: ÎÇ®Ìé∏Ïùò ÏßëÏïà</div>
                                <div><span class="term-name">ÏÇ¨Îèà(ÊüªÈ†ì)</span>: ÌòºÏù∏ÏúºÎ°ú Îß∫Ïñ¥ÏßÑ ÏñëÍ∞Ä</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Ï¥åÏàò Í≥ÑÏÇ∞Í∏∞ Îç∞Ïù¥ÌÑ∞ Î∞è Ìï®Ïàò
        const frRelationInfo = {
            "ÏïÑÎ≤ÑÏßÄ": { genUp: 1, genDown: 0, isSibling: false, isSpouse: false, gender: "male", side: "paternal" },
            "Ïñ¥Î®∏Îãà": { genUp: 1, genDown: 0, isSibling: false, isSpouse: false, gender: "female", side: "maternal" },
            "Í≥†Ï°∞Ìï†ÏïÑÎ≤ÑÏßÄ": { genUp: 4, genDown: 0, isSibling: false, isSpouse: false, gender: "male", side: "paternal" },
            "Í≥†Ï°∞Ìï†Î®∏Îãà": { genUp: 4, genDown: 0, isSibling: false, isSpouse: false, gender: "female", side: "paternal" },
            "Ïô∏Í≥†Ï°∞Ìï†ÏïÑÎ≤ÑÏßÄ": { genUp: 4, genDown: 0, isSibling: false, isSpouse: false, gender: "male", side: "maternal" },
            "Ïô∏Í≥†Ï°∞Ìï†Î®∏Îãà": { genUp: 4, genDown: 0, isSibling: false, isSpouse: false, gender: "female", side: "maternal" },
            "Ï¶ùÏ°∞Ìï†ÏïÑÎ≤ÑÏßÄ": { genUp: 3, genDown: 0, isSibling: false, isSpouse: false, gender: "male", side: "paternal" },
            "Ï¶ùÏ°∞Ìï†Î®∏Îãà": { genUp: 3, genDown: 0, isSibling: false, isSpouse: false, gender: "female", side: "paternal" },
            "Ïô∏Ï¶ùÏ°∞Ìï†ÏïÑÎ≤ÑÏßÄ": { genUp: 3, genDown: 0, isSibling: false, isSpouse: false, gender: "male", side: "maternal" },
            "Ïô∏Ï¶ùÏ°∞Ìï†Î®∏Îãà": { genUp: 3, genDown: 0, isSibling: false, isSpouse: false, gender: "female", side: "maternal" },
            "Ìï†ÏïÑÎ≤ÑÏßÄ": { genUp: 2, genDown: 0, isSibling: false, isSpouse: false, gender: "male", side: "paternal" },
            "Ìï†Î®∏Îãà": { genUp: 2, genDown: 0, isSibling: false, isSpouse: false, gender: "female", side: "paternal" },
            "Ïô∏Ìï†ÏïÑÎ≤ÑÏßÄ": { genUp: 2, genDown: 0, isSibling: false, isSpouse: false, gender: "male", side: "maternal" },
            "Ïô∏Ìï†Î®∏Îãà": { genUp: 2, genDown: 0, isSibling: false, isSpouse: false, gender: "female", side: "maternal" },
            "Ìòï": { genUp: 0, genDown: 0, isSibling: true, isSpouse: false, gender: "male", isElder: true },
            "ÎàÑÎÇò": { genUp: 0, genDown: 0, isSibling: true, isSpouse: false, gender: "female", isElder: true },
            "ÎÇ®ÎèôÏÉù": { genUp: 0, genDown: 0, isSibling: true, isSpouse: false, gender: "male", isElder: false },
            "Ïó¨ÎèôÏÉù": { genUp: 0, genDown: 0, isSibling: true, isSpouse: false, gender: "female", isElder: false },
            "ÏïÑÎì§": { genUp: 0, genDown: 1, isSibling: false, isSpouse: false, gender: "male" },
            "Îî∏": { genUp: 0, genDown: 1, isSibling: false, isSpouse: false, gender: "female" },
            "Î∞∞Ïö∞Ïûê": { genUp: 0, genDown: 0, isSibling: false, isSpouse: true, gender: "unknown" },
            "ÎÇ®Ìé∏": { genUp: 0, genDown: 0, isSibling: false, isSpouse: true, gender: "male" },
            "ÏïÑÎÇ¥": { genUp: 0, genDown: 0, isSibling: false, isSpouse: true, gender: "female" }
        };

        // ÌôïÏû•Îêú Ìò∏Ïπ≠ Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§
        const frTitleDatabase = {
            // ÏßÅÍ≥Ñ 1Ï¥å
            "ÏïÑÎ≤ÑÏßÄ": { chon: 1, title: "ÏïÑÎ≤ÑÏßÄ" },
            "Ïñ¥Î®∏Îãà": { chon: 1, title: "Ïñ¥Î®∏Îãà" },
            "ÏïÑÎì§": { chon: 1, title: "ÏïÑÎì§" },
            "Îî∏": { chon: 1, title: "Îî∏" },
            
            // ÏßÅÍ≥Ñ 2Ï¥å (Ï°∞Î∂ÄÎ™®)
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ": { chon: 2, title: "Ìï†ÏïÑÎ≤ÑÏßÄ (ÏπúÏ°∞Î∂Ä)" },
            "ÏïÑÎ≤ÑÏßÄ-Ïñ¥Î®∏Îãà": { chon: 2, title: "Ìï†Î®∏Îãà (ÏπúÏ°∞Î™®)" },
            "Ïñ¥Î®∏Îãà-ÏïÑÎ≤ÑÏßÄ": { chon: 2, title: "Ïô∏Ìï†ÏïÑÎ≤ÑÏßÄ" },
            "Ïñ¥Î®∏Îãà-Ïñ¥Î®∏Îãà": { chon: 2, title: "Ïô∏Ìï†Î®∏Îãà" },
            
            // ÏßÅÍ≥Ñ 2Ï¥å (ÏÜêÏûêÎÖÄ)
            "ÏïÑÎì§-ÏïÑÎì§": { chon: 2, title: "ÏÜêÏûê" },
            "ÏïÑÎì§-Îî∏": { chon: 2, title: "ÏÜêÎÖÄ" },
            "Îî∏-ÏïÑÎì§": { chon: 2, title: "Ïô∏ÏÜêÏûê" },
            "Îî∏-Îî∏": { chon: 2, title: "Ïô∏ÏÜêÎÖÄ" },
            
            // ÌòïÏ†úÏûêÎß§ 2Ï¥å
            "Ìòï": { chon: 2, title: "Ìòï/Ïò§Îπ†" },
            "ÎàÑÎÇò": { chon: 2, title: "ÎàÑÎÇò/Ïñ∏Îãà" },
            "ÎÇ®ÎèôÏÉù": { chon: 2, title: "ÎÇ®ÎèôÏÉù" },
            "Ïó¨ÎèôÏÉù": { chon: 2, title: "Ïó¨ÎèôÏÉù" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎì§": { chon: 2, title: "ÌòïÏ†ú (ÎÇò/Ìòï/ÎèôÏÉù)" },
            "ÏïÑÎ≤ÑÏßÄ-Îî∏": { chon: 2, title: "ÏûêÎß§ (ÎÇò/ÎàÑÎÇò/ÎèôÏÉù)" },
            "Ïñ¥Î®∏Îãà-ÏïÑÎì§": { chon: 2, title: "ÌòïÏ†ú (ÎÇò/Ìòï/ÎèôÏÉù)" },
            "Ïñ¥Î®∏Îãà-Îî∏": { chon: 2, title: "ÏûêÎß§ (ÎÇò/ÎàÑÎÇò/ÎèôÏÉù)" },
            
            // Î∞∞Ïö∞Ïûê
            "ÎÇ®Ìé∏": { chon: 0, title: "ÎÇ®Ìé∏ (Î∞∞Ïö∞Ïûê)" },
            "ÏïÑÎÇ¥": { chon: 0, title: "ÏïÑÎÇ¥ (Î∞∞Ïö∞Ïûê)" },
            "Î∞∞Ïö∞Ïûê": { chon: 0, title: "Î∞∞Ïö∞Ïûê" },
            
            // 3Ï¥å - ÏÇºÏ¥å/Í≥†Î™®/Ïù¥Î™®/Ïô∏ÏÇºÏ¥å
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎì§": { chon: 3, title: "ÏÇºÏ¥å (ÌÅ∞ÏïÑÎ≤ÑÏßÄ/ÏûëÏùÄÏïÑÎ≤ÑÏßÄ)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Îî∏": { chon: 3, title: "Í≥†Î™®" },
            "ÏïÑÎ≤ÑÏßÄ-Ïñ¥Î®∏Îãà-ÏïÑÎì§": { chon: 3, title: "ÏÇºÏ¥å (Ïô∏Ïàô)" },
            "ÏïÑÎ≤ÑÏßÄ-Ïñ¥Î®∏Îãà-Îî∏": { chon: 3, title: "Í≥†Î™®" },
            "Ïñ¥Î®∏Îãà-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎì§": { chon: 3, title: "Ïô∏ÏÇºÏ¥å" },
            "Ïñ¥Î®∏Îãà-ÏïÑÎ≤ÑÏßÄ-Îî∏": { chon: 3, title: "Ïù¥Î™®" },
            "Ïñ¥Î®∏Îãà-Ïñ¥Î®∏Îãà-ÏïÑÎì§": { chon: 3, title: "Ïô∏ÏÇºÏ¥å" },
            "Ïñ¥Î®∏Îãà-Ïñ¥Î®∏Îãà-Îî∏": { chon: 3, title: "Ïù¥Î™®" },
            "ÏïÑÎ≤ÑÏßÄ-Ìòï": { chon: 3, title: "ÌÅ∞ÏïÑÎ≤ÑÏßÄ (Î∞±Î∂Ä)" },
            "ÏïÑÎ≤ÑÏßÄ-ÎÇ®ÎèôÏÉù": { chon: 3, title: "ÏûëÏùÄÏïÑÎ≤ÑÏßÄ (ÏàôÎ∂Ä)" },
            "ÏïÑÎ≤ÑÏßÄ-ÎàÑÎÇò": { chon: 3, title: "Í≥†Î™®" },
            "ÏïÑÎ≤ÑÏßÄ-Ïó¨ÎèôÏÉù": { chon: 3, title: "Í≥†Î™®" },
            "Ïñ¥Î®∏Îãà-Ìòï": { chon: 3, title: "Ïô∏ÏÇºÏ¥å" },
            "Ïñ¥Î®∏Îãà-ÎÇ®ÎèôÏÉù": { chon: 3, title: "Ïô∏ÏÇºÏ¥å" },
            "Ïñ¥Î®∏Îãà-ÎàÑÎÇò": { chon: 3, title: "Ïù¥Î™®" },
            "Ïñ¥Î®∏Îãà-Ïó¨ÎèôÏÉù": { chon: 3, title: "Ïù¥Î™®" },
            
            // 3Ï¥å - Ï°∞Ïπ¥
            "Ìòï-ÏïÑÎì§": { chon: 3, title: "Ï°∞Ïπ¥ (ÎÇ®)" },
            "Ìòï-Îî∏": { chon: 3, title: "Ï°∞Ïπ¥ (Ïó¨)" },
            "ÎàÑÎÇò-ÏïÑÎì§": { chon: 3, title: "ÏÉùÏßà" },
            "ÎàÑÎÇò-Îî∏": { chon: 3, title: "ÏÉùÏßàÎÖÄ" },
            "ÎÇ®ÎèôÏÉù-ÏïÑÎì§": { chon: 3, title: "Ï°∞Ïπ¥ (ÎÇ®)" },
            "ÎÇ®ÎèôÏÉù-Îî∏": { chon: 3, title: "Ï°∞Ïπ¥ (Ïó¨)" },
            "Ïó¨ÎèôÏÉù-ÏïÑÎì§": { chon: 3, title: "ÏÉùÏßà" },
            "Ïó¨ÎèôÏÉù-Îî∏": { chon: 3, title: "ÏÉùÏßàÎÖÄ" },
            
            // 3Ï¥å - Ï¶ùÏ°∞Î∂ÄÎ™®, Ï¶ùÏÜê
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ": { chon: 3, title: "Ï¶ùÏ°∞Ìï†ÏïÑÎ≤ÑÏßÄ" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ïñ¥Î®∏Îãà": { chon: 3, title: "Ï¶ùÏ°∞Ìï†Î®∏Îãà" },
            "Ïñ¥Î®∏Îãà-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ": { chon: 3, title: "Ïô∏Ï¶ùÏ°∞Ìï†ÏïÑÎ≤ÑÏßÄ" },
            "Ïñ¥Î®∏Îãà-Ïñ¥Î®∏Îãà-Ïñ¥Î®∏Îãà": { chon: 3, title: "Ïô∏Ï¶ùÏ°∞Ìï†Î®∏Îãà" },
            "ÏïÑÎì§-ÏïÑÎì§-ÏïÑÎì§": { chon: 3, title: "Ï¶ùÏÜêÏûê" },
            "ÏïÑÎì§-ÏïÑÎì§-Îî∏": { chon: 3, title: "Ï¶ùÏÜêÎÖÄ" },
            
            // 4Ï¥å - ÏÇ¨Ï¥å
            "ÏïÑÎ≤ÑÏßÄ-Ìòï-ÏïÑÎì§": { chon: 4, title: "ÏÇ¨Ï¥åÌòï/Ïò§Îπ† (Ï¢ÖÌòï)" },
            "ÏïÑÎ≤ÑÏßÄ-Ìòï-Îî∏": { chon: 4, title: "ÏÇ¨Ï¥åÎàÑÎÇò/Ïñ∏Îãà (Ï¢ÖÏûêÎß§)" },
            "ÏïÑÎ≤ÑÏßÄ-ÎÇ®ÎèôÏÉù-ÏïÑÎì§": { chon: 4, title: "ÏÇ¨Ï¥åÎèôÏÉù (Ï¢ÖÏ†ú)" },
            "ÏïÑÎ≤ÑÏßÄ-ÎÇ®ÎèôÏÉù-Îî∏": { chon: 4, title: "ÏÇ¨Ï¥åÏó¨ÎèôÏÉù (Ï¢ÖÎß§)" },
            "ÏïÑÎ≤ÑÏßÄ-ÎàÑÎÇò-ÏïÑÎì§": { chon: 4, title: "Í≥†Ï¢ÖÏÇ¨Ï¥å (ÎÇ®)" },
            "ÏïÑÎ≤ÑÏßÄ-ÎàÑÎÇò-Îî∏": { chon: 4, title: "Í≥†Ï¢ÖÏÇ¨Ï¥å (Ïó¨)" },
            "ÏïÑÎ≤ÑÏßÄ-Ïó¨ÎèôÏÉù-ÏïÑÎì§": { chon: 4, title: "Í≥†Ï¢ÖÏÇ¨Ï¥å (ÎÇ®)" },
            "ÏïÑÎ≤ÑÏßÄ-Ïó¨ÎèôÏÉù-Îî∏": { chon: 4, title: "Í≥†Ï¢ÖÏÇ¨Ï¥å (Ïó¨)" },
            "Ïñ¥Î®∏Îãà-Ìòï-ÏïÑÎì§": { chon: 4, title: "Ïô∏ÏÇ¨Ï¥å (ÎÇ®)" },
            "Ïñ¥Î®∏Îãà-Ìòï-Îî∏": { chon: 4, title: "Ïô∏ÏÇ¨Ï¥å (Ïó¨)" },
            "Ïñ¥Î®∏Îãà-ÎÇ®ÎèôÏÉù-ÏïÑÎì§": { chon: 4, title: "Ïô∏ÏÇ¨Ï¥å (ÎÇ®)" },
            "Ïñ¥Î®∏Îãà-ÎÇ®ÎèôÏÉù-Îî∏": { chon: 4, title: "Ïô∏ÏÇ¨Ï¥å (Ïó¨)" },
            "Ïñ¥Î®∏Îãà-ÎàÑÎÇò-ÏïÑÎì§": { chon: 4, title: "Ïù¥Ï¢ÖÏÇ¨Ï¥å (ÎÇ®)" },
            "Ïñ¥Î®∏Îãà-ÎàÑÎÇò-Îî∏": { chon: 4, title: "Ïù¥Ï¢ÖÏÇ¨Ï¥å (Ïó¨)" },
            "Ïñ¥Î®∏Îãà-Ïó¨ÎèôÏÉù-ÏïÑÎì§": { chon: 4, title: "Ïù¥Ï¢ÖÏÇ¨Ï¥å (ÎÇ®)" },
            "Ïñ¥Î®∏Îãà-Ïó¨ÎèôÏÉù-Îî∏": { chon: 4, title: "Ïù¥Ï¢ÖÏÇ¨Ï¥å (Ïó¨)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎì§-ÏïÑÎì§": { chon: 4, title: "ÏÇ¨Ï¥å (ÎÇ®)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎì§-Îî∏": { chon: 4, title: "ÏÇ¨Ï¥å (Ïó¨)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Îî∏-ÏïÑÎì§": { chon: 4, title: "Í≥†Ï¢ÖÏÇ¨Ï¥å (ÎÇ®)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Îî∏-Îî∏": { chon: 4, title: "Í≥†Ï¢ÖÏÇ¨Ï¥å (Ïó¨)" },
            
            // 4Ï¥å - Í≥†Ï°∞Î∂ÄÎ™®
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ": { chon: 4, title: "Í≥†Ï°∞Ìï†ÏïÑÎ≤ÑÏßÄ" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ïñ¥Î®∏Îãà": { chon: 4, title: "Í≥†Ï°∞Ìï†Î®∏Îãà" },
            
            // 4Ï¥å - Ï¢ÖÏ°∞Î∂ÄÎ™® (Ìï†ÏïÑÎ≤ÑÏßÄÏùò ÌòïÏ†ú)
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ìòï": { chon: 4, title: "Ï¢ÖÏ°∞Ìï†ÏïÑÎ≤ÑÏßÄ (ÌÅ∞Ìï†ÏïÑÎ≤ÑÏßÄ)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÎÇ®ÎèôÏÉù": { chon: 4, title: "Ï¢ÖÏ°∞Ìï†ÏïÑÎ≤ÑÏßÄ (ÏûëÏùÄÌï†ÏïÑÎ≤ÑÏßÄ)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÎàÑÎÇò": { chon: 4, title: "ÎåÄÍ≥†Î™®" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ïó¨ÎèôÏÉù": { chon: 4, title: "ÎåÄÍ≥†Î™®" },
            
            // Î∞∞Ïö∞Ïûê Í¥ÄÍ≥Ñ
            "Ìòï-ÎÇ®Ìé∏": { chon: 2, title: "ÌòïÎ∂Ä/Îß§Ìòï" },
            "Ìòï-ÏïÑÎÇ¥": { chon: 2, title: "ÌòïÏàò/Ïò¨ÏºÄ" },
            "ÎàÑÎÇò-ÎÇ®Ìé∏": { chon: 2, title: "Îß§Ìòï/ÌòïÎ∂Ä" },
            "ÎàÑÎÇò-ÏïÑÎÇ¥": { chon: 2, title: "ÌòïÏàò" },
            "ÎÇ®ÎèôÏÉù-ÏïÑÎÇ¥": { chon: 2, title: "Ï†úÏàò/Ïò¨ÏºÄ" },
            "Ïó¨ÎèôÏÉù-ÎÇ®Ìé∏": { chon: 2, title: "Ï†úÎ∂Ä/Îß§Ï†ú" },
            "ÏïÑÎì§-ÏïÑÎÇ¥": { chon: 1, title: "Î©∞ÎäêÎ¶¨" },
            "Îî∏-ÎÇ®Ìé∏": { chon: 1, title: "ÏÇ¨ÏúÑ" },
            "ÎÇ®Ìé∏-ÏïÑÎ≤ÑÏßÄ": { chon: 1, title: "ÏãúÏïÑÎ≤ÑÏßÄ" },
            "ÎÇ®Ìé∏-Ïñ¥Î®∏Îãà": { chon: 1, title: "ÏãúÏñ¥Î®∏Îãà" },
            "ÏïÑÎÇ¥-ÏïÑÎ≤ÑÏßÄ": { chon: 1, title: "Ïû•Ïù∏" },
            "ÏïÑÎÇ¥-Ïñ¥Î®∏Îãà": { chon: 1, title: "Ïû•Î™®" },
            "ÎÇ®Ìé∏-Ìòï": { chon: 2, title: "ÏãúÏàô (ÏãúÏïÑÏ£ºÎ≤ÑÎãà)" },
            "ÎÇ®Ìé∏-ÎÇ®ÎèôÏÉù": { chon: 2, title: "ÏãúÎèôÏÉù" },
            "ÎÇ®Ìé∏-ÎàÑÎÇò": { chon: 2, title: "ÏãúÎàÑÏù¥ (ÌòïÎãò)" },
            "ÎÇ®Ìé∏-Ïó¨ÎèôÏÉù": { chon: 2, title: "ÏãúÎàÑÏù¥ (ÏïÑÍ∞ÄÏî®)" },
            "ÏïÑÎÇ¥-Ìòï": { chon: 2, title: "Ï≤òÎÇ®" },
            "ÏïÑÎÇ¥-ÎÇ®ÎèôÏÉù": { chon: 2, title: "Ï≤òÎÇ®" },
            "ÏïÑÎÇ¥-ÎàÑÎÇò": { chon: 2, title: "Ï≤òÌòï" },
            "ÏïÑÎÇ¥-Ïó¨ÎèôÏÉù": { chon: 2, title: "Ï≤òÏ†ú" },
            
            // 5Ï¥å
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ìòï-ÏïÑÎì§": { chon: 5, title: "ÎãπÏàô (Ï¢ÖÏàôÎ∂Ä)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ìòï-Îî∏": { chon: 5, title: "ÎãπÍ≥†Î™® (Ï¢ÖÍ≥†Î™®)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÎÇ®ÎèôÏÉù-ÏïÑÎì§": { chon: 5, title: "ÎãπÏàô (Ï¢ÖÏàôÎ∂Ä)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÎÇ®ÎèôÏÉù-Îî∏": { chon: 5, title: "ÎãπÍ≥†Î™® (Ï¢ÖÍ≥†Î™®)" },
            "ÏïÑÎ≤ÑÏßÄ-Ìòï-ÏïÑÎì§-ÏïÑÎì§": { chon: 5, title: "5Ï¥å Ï°∞Ïπ¥ (ÎãπÏßà)" },
            "ÏïÑÎ≤ÑÏßÄ-Ìòï-ÏïÑÎì§-Îî∏": { chon: 5, title: "5Ï¥å Ï°∞Ïπ¥ (ÎãπÏßàÎÖÄ)" },
            
            // 6Ï¥å
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ìòï-ÏïÑÎì§-ÏïÑÎì§": { chon: 6, title: "6Ï¥åÌòï (Ïû¨Ï¢ÖÌòï)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ìòï-ÏïÑÎì§-Îî∏": { chon: 6, title: "6Ï¥åÎàÑÎÇò (Ïû¨Ï¢ÖÏûêÎß§)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÎÇ®ÎèôÏÉù-ÏïÑÎì§-ÏïÑÎì§": { chon: 6, title: "6Ï¥åÎèôÏÉù (Ïû¨Ï¢ÖÏ†ú)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÎÇ®ÎèôÏÉù-ÏïÑÎì§-Îî∏": { chon: 6, title: "6Ï¥åÏó¨ÎèôÏÉù (Ïû¨Ï¢ÖÎß§)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎì§-ÏïÑÎì§-ÏïÑÎì§": { chon: 6, title: "6Ï¥å (Ïû¨Ï¢ÖÌòïÏ†ú)" },
            
            // 7Ï¥å
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ìòï-ÏïÑÎì§-ÏïÑÎì§": { chon: 7, title: "Ïû¨Ï¢ÖÏàô" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ìòï-ÏïÑÎì§-ÏïÑÎì§-ÏïÑÎì§": { chon: 7, title: "7Ï¥å Ï°∞Ïπ¥" },
            
            // 8Ï¥å
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-Ìòï-ÏïÑÎì§-ÏïÑÎì§-ÏïÑÎì§": { chon: 8, title: "8Ï¥å (ÏÇºÏ¢ÖÌòï)" },
            "ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎ≤ÑÏßÄ-ÏïÑÎì§-ÏïÑÎì§-ÏïÑÎì§-ÏïÑÎì§": { chon: 8, title: "8Ï¥å (ÏÇºÏ¢ÖÌòïÏ†ú)" }
        };

        // Í¥ÄÍ≥Ñ Ï∂îÍ∞Ä Ìï®Ïàò
        function frAddRelation(relation) {
            if (frRelationPath.length >= 8) {
                alert('ÏµúÎåÄ 8Îã®Í≥ÑÍπåÏßÄ Í¥ÄÍ≥ÑÎ•º Ï∂îÍ∞ÄÌï† Ïàò ÏûàÏäµÎãàÎã§.');
                return;
            }
            
            // Ï≤´ Î≤àÏß∏ Í¥ÄÍ≥ÑÏóêÏÑú Î∂ÄÍ≥Ñ/Î™®Í≥Ñ Í≤∞Ï†ï
            if (frRelationPath.length === 0) {
                if (relation === 'Ïñ¥Î®∏Îãà') {
                    frCurrentSide = 'maternal';
                } else {
                    frCurrentSide = 'paternal';
                }
            }
            
            frRelationPath.push(relation);
            frUpdateDisplay();
        }

        // ÌôîÎ©¥ ÏóÖÎç∞Ïù¥Ìä∏
        function frUpdateDisplay() {
            // Í≤ΩÎ°ú ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
            const pathDisplay = document.getElementById('frPathDisplay');
            if (pathDisplay) {
                if (frRelationPath.length === 0) {
                    pathDisplay.innerHTML = '';
                } else {
                    let pathHtml = '';
                    frRelationPath.forEach((rel, idx) => {
                        if (idx > 0) pathHtml += '<span class="fr-path-arrow">‚Üí</span>';
                        pathHtml += `<span class="fr-path-item">${rel}</span>`;
                    });
                    pathDisplay.innerHTML = pathHtml;
                }
            }
            
            // Ï¥åÏàò Î∞è Ìò∏Ïπ≠ Í≥ÑÏÇ∞
            if (frRelationPath.length === 0) {
                document.getElementById('frChonNumber').textContent = '-';
                document.getElementById('frFinalTitle').textContent = 'Í¥ÄÍ≥ÑÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî';
                document.getElementById('frKinType').textContent = '-';
                document.getElementById('frLineType').textContent = '-';
                document.getElementById('frGenType').textContent = '-';
                document.getElementById('frSideType').textContent = '-';
                return;
            }
            
            const result = frCalculateChonNew(frRelationPath);
            const analysis = frAnalyzeKinTypeNew(frRelationPath);
            
            document.getElementById('frChonNumber').textContent = result.chon;
            document.getElementById('frFinalTitle').textContent = result.title;
            document.getElementById('frKinType').textContent = analysis.kinType;
            document.getElementById('frLineType').textContent = analysis.lineType;
            document.getElementById('frGenType').textContent = analysis.genType;
            document.getElementById('frSideType').textContent = analysis.sideType;
        }

        // Ï¥åÏàò Í≥ÑÏÇ∞ (ÏÉà Î≤ÑÏ†Ñ)
        function frCalculateChonNew(relations) {
            if (relations.length === 0) return { chon: 0, title: "Î≥∏Ïù∏" };
            
            const key = relations.join("-");
            if (frTitleDatabase[key]) return frTitleDatabase[key];
            
            // Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§Ïóê ÏóÜÏúºÎ©¥ Í≥ÑÏÇ∞
            let totalUp = 0, totalDown = 0, siblingCount = 0;
            let hasSpouse = false;
            
            for (const rel of relations) {
                const info = frRelationInfo[rel];
                if (!info) continue;
                
                if (info.isSpouse) {
                    hasSpouse = true;
                    continue;
                }
                
                if (info.isSibling) {
                    siblingCount++;
                    totalUp += 1;
                    totalDown += 1;
                } else {
                    totalUp += info.genUp;
                    totalDown += info.genDown;
                }
            }
            
            const chon = totalUp + totalDown;
            const title = frGenerateTitleNew(relations, chon, hasSpouse);
            
            return { chon, title };
        }

        // Ìò∏Ïπ≠ ÏÉùÏÑ± (ÏÉà Î≤ÑÏ†Ñ)
        function frGenerateTitleNew(relations, chon, hasSpouse) {
            if (chon === 0) return hasSpouse ? "Î∞∞Ïö∞Ïûê" : "Î≥∏Ïù∏";
            
            const lastRel = relations[relations.length - 1];
            const lastInfo = frRelationInfo[lastRel];
            
            // Í∏∞Î≥∏ Ï¥åÏàò Í∏∞Î∞ò Ìò∏Ïπ≠
            const chonTitles = {
                1: lastInfo && lastInfo.genUp ? "Î∂ÄÎ™®" : "ÏûêÎÖÄ",
                2: "2Ï¥å Í¥ÄÍ≥Ñ",
                3: "3Ï¥å Í¥ÄÍ≥Ñ",
                4: "4Ï¥å Í¥ÄÍ≥Ñ",
                5: "5Ï¥å Í¥ÄÍ≥Ñ",
                6: "6Ï¥å (Ïû¨Ï¢ÖÌòïÏ†ú)",
                7: "7Ï¥å Í¥ÄÍ≥Ñ",
                8: "8Ï¥å (ÏÇºÏ¢ÖÌòïÏ†ú)"
            };
            
            if (chon > 8) return `${chon}Ï¥å (ÏπúÏ°± Î≤îÏúÑ Ïô∏)`;
            
            return chonTitles[chon] || `${chon}Ï¥å Í¥ÄÍ≥Ñ`;
        }

        // ÏπúÏ°± Î∂ÑÏÑù (ÏÉà Î≤ÑÏ†Ñ)
        function frAnalyzeKinTypeNew(relations) {
            if (relations.length === 0) {
                return { kinType: "Î≥∏Ïù∏", lineType: "-", genType: "-", sideType: "-" };
            }
            
            let hasSpouse = false;
            let totalUp = 0, totalDown = 0, siblingCount = 0;
            let side = "Î∂ÄÍ≥Ñ";
            
            for (let i = 0; i < relations.length; i++) {
                const rel = relations[i];
                const info = frRelationInfo[rel];
                if (!info) continue;
                
                if (info.isSpouse) {
                    hasSpouse = true;
                    continue;
                }
                
                // Ï≤´ Í¥ÄÍ≥ÑÏóêÏÑú Î∂ÄÍ≥Ñ/Î™®Í≥Ñ Í≤∞Ï†ï
                if (i === 0 && info.side) {
                    side = info.side === "maternal" ? "Î™®Í≥Ñ" : "Î∂ÄÍ≥Ñ";
                }
                
                if (info.isSibling) {
                    siblingCount++;
                } else {
                    totalUp += info.genUp;
                    totalDown += info.genDown;
                }
            }
            
            // ÏπúÏ°± Ïú†Ìòï
            let kinType;
            if (hasSpouse && relations.length === 1) {
                kinType = "Î∞∞Ïö∞Ïûê";
            } else if (hasSpouse) {
                kinType = "Ïù∏Ï≤ô";
            } else {
                kinType = "ÌòàÏ°±";
            }
            
            // Í≥ÑÌÜµ (ÏßÅÍ≥Ñ/Î∞©Í≥Ñ)
            let lineType;
            if (kinType === "Î∞∞Ïö∞Ïûê") {
                lineType = "-";
            } else if (siblingCount > 0 || (totalUp > 0 && totalDown > 0)) {
                lineType = "Î∞©Í≥Ñ";
            } else {
                lineType = "ÏßÅÍ≥Ñ";
            }
            
            // Ï°¥ÎπÑÏÜç
            const netGen = totalUp - totalDown;
            let genType;
            if (kinType === "Î∞∞Ïö∞Ïûê") {
                genType = "Î∞∞Ïö∞Ïûê";
            } else if (netGen > 0) {
                genType = "Ï°¥ÏÜç";
            } else if (netGen < 0) {
                genType = "ÎπÑÏÜç";
            } else {
                genType = "ÎèôÌï≠Î†¨";
            }
            
            // Î∂ÄÍ≥Ñ/Î™®Í≥Ñ
            let sideType = kinType === "Î∞∞Ïö∞Ïûê" ? "-" : side;
            
            return { kinType, lineType, genType, sideType };
        }

        // Î¶¨ÏÖã
        function frResetAll() {
            frRelationPath = [];
            frCurrentSide = 'paternal';
            frUpdateDisplay();
        }

        function initFamilyRelationCalculator() {
            frRelationPath = [];
            frCurrentSide = 'paternal';
        }

        // ===== Í∏∞Ï°¥ Ìï®ÏàòÎì§ (Ìò∏ÌôòÏÑ± Ïú†ÏßÄ) =====
        function frUpdateResult() {
            // Í∏∞Ï°¥ select Î∞©ÏãùÍ≥ºÏùò Ìò∏ÌôòÏÑ±ÏùÑ ÏúÑÌï¥ Ïú†ÏßÄ
            const relations = [];
            for (let i = 1; i <= 4; i++) {
                const selectEl = document.getElementById(`frRelation${i}`);
                if (selectEl) {
                    const val = selectEl.value;
                    if (val) relations.push(val);
                }
            }
            if (relations.length > 0) {
                frRelationPath = relations;
                frUpdateDisplay();
            }
        }

        // Í∏∞Ï°¥ frCalculateChon Ìï®Ïàò (Ìò∏ÌôòÏÑ±)
        function frCalculateChon(relations) {
            return frCalculateChonNew(relations);
        }

        // Í∏∞Ï°¥ frAnalyzeKinType Ìï®Ïàò (Ìò∏ÌôòÏÑ±)
        function frAnalyzeKinType(relations) {
            return frAnalyzeKinTypeNew(relations);
        }

        function frGenerateTitle(relations, chon) {
            return frGenerateTitleNew(relations, chon, false);
        }

        function frGetDescription(chon) {
            const descriptions = {
                0: "Î∞∞Ïö∞ÏûêÎäî Ï¥åÏàòÎ°ú Í≥ÑÏÇ∞ÌïòÏßÄ ÏïäÏäµÎãàÎã§.",
                1: "ÏßÅÍ≥Ñ ÌòàÏ°± Ï§ë Í∞ÄÏû• Í∞ÄÍπåÏö¥ Í¥ÄÍ≥ÑÏûÖÎãàÎã§. (Î∂ÄÎ™®-ÏûêÎÖÄ)",
                2: "Ï°∞Î∂ÄÎ™®/ÏÜêÏûêÎÖÄ ÎòêÎäî ÌòïÏ†úÏûêÎß§ Í¥ÄÍ≥ÑÏûÖÎãàÎã§.",
                3: "Ï¶ùÏ°∞Î∂ÄÎ™®, ÏÇºÏ¥å, Í≥†Î™®, Ïù¥Î™®, Ïô∏ÏÇºÏ¥å ÎòêÎäî Ï°∞Ïπ¥ Í¥ÄÍ≥ÑÏûÖÎãàÎã§.",
                4: "Í≥†Ï°∞Î∂ÄÎ™® ÎòêÎäî ÏÇ¨Ï¥å Í¥ÄÍ≥ÑÏûÖÎãàÎã§. Í∞ôÏùÄ Ï°∞Î∂ÄÎ™®Î•º Í≥µÏú†Ìï©ÎãàÎã§.",
                5: "5ÎåÄÏ°∞ ÎòêÎäî ÎãπÏàô(Ï¢ÖÏàô)/ÎãπÍ≥†Î™®, 5Ï¥å Ï°∞Ïπ¥ÏôÄÏùò Í¥ÄÍ≥ÑÏûÖÎãàÎã§.",
                6: "6Ï¥å(Ïú°Ï¥å)ÏùÄ Í∞ôÏùÄ Ï¶ùÏ°∞Î∂ÄÎ™®Î•º Í≥µÏú†ÌïòÎäî Ïû¨Ï¢ÖÌòïÏ†ú Í¥ÄÍ≥ÑÏûÖÎãàÎã§.",
                7: "7Ï¥åÏùÄ Ïû¨Ï¢ÖÏàô/Ïû¨Ï¢ÖÍ≥†Î™® ÎòêÎäî Í∑∏ ÏûêÎÖÄÏôÄÏùò Í¥ÄÍ≥ÑÏûÖÎãàÎã§.",
                8: "8Ï¥å(ÌåîÏ¥å)ÏùÄ Í∞ôÏùÄ Í≥†Ï°∞Î∂ÄÎ™®Î•º Í≥µÏú†ÌïòÎäî ÏÇºÏ¢ÖÌòïÏ†ú Í¥ÄÍ≥ÑÏûÖÎãàÎã§."
            };
            return descriptions[chon] || `${chon}Ï¥å Í¥ÄÍ≥ÑÏûÖÎãàÎã§.`;
        }

        // ===== Ïã†Î∞úÏπòÏàò Í≥ÑÏÇ∞Í∏∞ =====
        function getShoeSizeCalculator() {
            return `
                <style>
                    .shoe-container { max-width: 700px; margin: 0 auto; }
                    .shoe-header { text-align: center; margin-bottom: 24px; }
                    .shoe-header-icon { display: inline-flex; align-items: center; justify-content: center; width: 70px; height: 70px; background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%); border-radius: 50%; margin-bottom: 12px; }
                    .shoe-header-icon i { font-size: 32px; color: white; }
                    .shoe-header h2 { font-size: 24px; font-weight: 700; color: #333; margin-bottom: 6px; }
                    .shoe-header p { font-size: 14px; color: #888; }
                    .shoe-gender-toggle { display: flex; justify-content: center; margin-bottom: 20px; }
                    .shoe-gender-toggle button { padding: 12px 24px; border: none; background: #e2e8f0; font-size: 15px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
                    .shoe-gender-toggle button:first-child { border-radius: 12px 0 0 12px; }
                    .shoe-gender-toggle button:last-child { border-radius: 0 12px 12px 0; }
                    .shoe-gender-toggle button.active { background: linear-gradient(135deg, #6366f1 0%, #818cf8 100%); color: white; }
                    .shoe-gender-toggle button.active.female { background: linear-gradient(135deg, #ec4899 0%, #f472b6 100%); }
                    .shoe-card { background: #fff; border-radius: 20px; padding: 24px; margin-bottom: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
                    .shoe-card h3 { font-size: 16px; font-weight: 600; color: #333; margin-bottom: 16px; text-align: center; }
                    .shoe-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
                    @media (min-width: 640px) { .shoe-grid { grid-template-columns: repeat(3, 1fr); } }
                    .shoe-input-box { padding: 16px; border-radius: 14px; border: 2px solid #e2e8f0; transition: all 0.3s ease; }
                    .shoe-input-box:focus-within { border-color: #6366f1; box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1); }
                    .shoe-input-box.kr { background: linear-gradient(135deg, #fef2f2 0%, #fce7f3 100%); border-color: #fca5a5; }
                    .shoe-input-box.us { background: linear-gradient(135deg, #eff6ff 0%, #e0e7ff 100%); border-color: #93c5fd; }
                    .shoe-input-box.uk { background: linear-gradient(135deg, #faf5ff 0%, #ede9fe 100%); border-color: #c4b5fd; }
                    .shoe-input-box.eu { background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border-color: #86efac; }
                    .shoe-input-box.cn { background: linear-gradient(135deg, #fefce8 0%, #fef3c7 100%); border-color: #fcd34d; }
                    .shoe-input-box.cm { background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border-color: #cbd5e1; }
                    .shoe-flag { display: flex; align-items: center; gap: 6px; margin-bottom: 8px; font-size: 13px; font-weight: 600; color: #555; }
                    .shoe-flag span { font-size: 18px; }
                    .shoe-input { width: 100%; padding: 12px; border: none; border-radius: 8px; font-size: 20px; font-weight: 700; text-align: center; background: rgba(255,255,255,0.8); }
                    .shoe-input:focus { outline: none; }
                    .shoe-unit { font-size: 12px; color: #888; text-align: center; margin-top: 4px; }
                    .shoe-reset-btn { display: block; margin: 16px auto 0; padding: 10px 24px; background: #e2e8f0; border: none; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
                    .shoe-reset-btn:hover { background: #cbd5e1; }
                    .shoe-tips { background: #f8fafc; border-radius: 16px; padding: 20px; }
                    .shoe-tips h3 { font-size: 16px; font-weight: 600; color: #333; margin-bottom: 16px; text-align: center; }
                    .shoe-tips-grid { display: grid; grid-template-columns: repeat(1, 1fr); gap: 12px; }
                    @media (min-width: 640px) { .shoe-tips-grid { grid-template-columns: repeat(2, 1fr); } }
                    .shoe-tip { padding: 16px; border-radius: 12px; background: white; border: 1px solid #e2e8f0; transition: all 0.3s ease; }
                    .shoe-tip:hover { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(0,0,0,0.08); }
                    .shoe-tip-icon { font-size: 28px; margin-bottom: 8px; }
                    .shoe-tip h4 { font-size: 14px; font-weight: 700; color: #333; margin-bottom: 6px; }
                    .shoe-tip p { font-size: 12px; color: #666; line-height: 1.5; }
                </style>
                <div class="shoe-container">
                    <div class="shoe-header">
                        <div class="shoe-header-icon"><i class="fas fa-shoe-prints"></i></div>
                        <h2>Íµ≠Ï†ú Ïã†Î∞ú ÏπòÏàò Í≥ÑÏÇ∞Í∏∞</h2>
                        <p>Ï†Ñ ÏÑ∏Í≥Ñ Ïã†Î∞ú ÏÇ¨Ïù¥Ï¶àÎ•º Ïã§ÏãúÍ∞ÑÏúºÎ°ú Î≥ÄÌôòÌïòÏÑ∏Ïöî</p>
                    </div>
                    <div class="shoe-gender-toggle">
                        <button id="shoeMaleBtn" class="active" onclick="shoeSetGender('male')">üë® ÎÇ®ÏÑ±</button>
                        <button id="shoeFemaleBtn" onclick="shoeSetGender('female')">üë© Ïó¨ÏÑ±</button>
                    </div>
                    <div class="shoe-card">
                        <h3>üîÑ ÏïÑÎ¨¥ Ïπ∏ÏóêÎÇò ÏûÖÎ†•ÌïòÎ©¥ ÏûêÎèô Î≥ÄÌôòÎê©ÎãàÎã§</h3>
                        <div class="shoe-grid">
                            <div class="shoe-input-box kr">
                                <div class="shoe-flag"><span>üá∞üá∑</span><span>üáØüáµ</span> ÌïúÍµ≠/ÏùºÎ≥∏</div>
                                <input type="number" id="shoeKr" class="shoe-input" placeholder="260" oninput="shoeConvert('kr', this.value)">
                                <div class="shoe-unit">mm</div>
                            </div>
                            <div class="shoe-input-box us">
                                <div class="shoe-flag"><span>üá∫üá∏</span> ÎØ∏Íµ≠ (US)</div>
                                <input type="number" id="shoeUs" class="shoe-input" placeholder="8" step="0.5" oninput="shoeConvert('us', this.value)">
                            </div>
                            <div class="shoe-input-box uk">
                                <div class="shoe-flag"><span>üá¨üáß</span> ÏòÅÍµ≠ (UK)</div>
                                <input type="number" id="shoeUk" class="shoe-input" placeholder="7.5" step="0.5" oninput="shoeConvert('uk', this.value)">
                            </div>
                            <div class="shoe-input-box eu">
                                <div class="shoe-flag"><span>üá™üá∫</span> Ïú†ÎüΩ (EU)</div>
                                <input type="number" id="shoeEu" class="shoe-input" placeholder="42" step="0.5" oninput="shoeConvert('eu', this.value)">
                            </div>
                            <div class="shoe-input-box cn">
                                <div class="shoe-flag"><span>üá®üá≥</span> Ï§ëÍµ≠ (CN)</div>
                                <input type="number" id="shoeCn" class="shoe-input" placeholder="42" step="0.5" oninput="shoeConvert('cn', this.value)">
                            </div>
                            <div class="shoe-input-box cm">
                                <div class="shoe-flag"><span>üìè</span> Î∞ú Í∏∏Ïù¥</div>
                                <input type="number" id="shoeCm" class="shoe-input" placeholder="26.0" step="0.1" oninput="shoeConvert('cm', this.value)">
                                <div class="shoe-unit">cm</div>
                            </div>
                        </div>
                        <button class="shoe-reset-btn" onclick="shoeResetAll()">üîÑ Ï¥àÍ∏∞Ìôî</button>
                    </div>
                    <div class="shoe-tips">
                        <h3>üí° Ïã†Î∞ú Í¥ÄÎ¶¨ ÌåÅ</h3>
                        <div class="shoe-tips-grid">
                            <div class="shoe-tip"><div class="shoe-tip-icon">üëÉ</div><h4>ÎÉÑÏÉà Ï†úÍ±∞</h4><p>Î≤†Ïù¥ÌÇπ ÏÜåÎã§Î•º Ïã†Î∞ú ÏïàÏóê ÎøåÎ†§ÎëêÎ©¥ ÎÉÑÏÉàÎ•º Ìù°ÏàòÌï©ÎãàÎã§.</p></div>
                            <div class="shoe-tip"><div class="shoe-tip-icon">üßΩ</div><h4>Í∞ÄÏ£Ω Ïã†Î∞ú Í¥ÄÎ¶¨</h4><p>Í∞ÄÏ£Ω Ï†ÑÏö© ÌÅ¨Î¶ºÏúºÎ°ú Ï†ïÍ∏∞Ï†ÅÏúºÎ°ú Í¥ÄÎ¶¨ÌïòÏÑ∏Ïöî.</p></div>
                            <div class="shoe-tip"><div class="shoe-tip-icon">üëü</div><h4>Ïö¥ÎèôÌôî ÏÑ∏ÌÉÅ</h4><p>Ï§ëÏÑ± ÏÑ∏Ï†úÎ°ú ÏÜêÏÑ∏ÌÉÅÏù¥ Í∞ÄÏû• Ï¢ãÏäµÎãàÎã§.</p></div>
                            <div class="shoe-tip"><div class="shoe-tip-icon">üì¶</div><h4>Ïò¨Î∞îÎ•∏ Î≥¥Í¥ÄÎ≤ï</h4><p>ÏäµÍ∏∞ Ï†úÍ±∞Ï†úÏôÄ Ìï®Íªò ÌÜµÌíçÏù¥ ÎêòÎäî Í≥≥Ïóê Î≥¥Í¥ÄÌïòÏÑ∏Ïöî.</p></div>
                            <div class="shoe-tip"><div class="shoe-tip-icon">üéØ</div><h4>Ïò¨Î∞îÎ•∏ ÏÇ¨Ïù¥Ï¶à ÏÑ†ÌÉù</h4><p>Î∞úÏùÄ Ï†ÄÎÖÅÏóê Í∞ÄÏû• Î∂ìÍ∏∞ ÎïåÎ¨∏Ïóê Ï†ÄÎÖÅÏóê Ïã†Ïñ¥Î≥¥Í≥† Íµ¨Îß§ÌïòÏÑ∏Ïöî.</p></div>
                            <div class="shoe-tip"><div class="shoe-tip-icon">‚è∞</div><h4>ÍµêÎåÄÎ°ú Ïã†Í∏∞</h4><p>Í∞ôÏùÄ Ïã†Î∞úÏùÑ Îß§Ïùº Ïã†ÏßÄ ÎßàÏÑ∏Ïöî. 2~3Ïº§Î†àÎ•º ÍµêÎåÄÎ°ú Ïã†ÏúºÎ©¥ ÏàòÎ™ÖÏù¥ ÎäòÏñ¥ÎÇ©ÎãàÎã§.</p></div>
                        </div>
                    </div>
                </div>
            `;
        }

        let shoeCurrentGender = 'male';
        const shoeSizeData = {
            male: {
                220: [4, 3.5, 35], 225: [4.5, 4, 35.5], 230: [5, 4.5, 36], 235: [5.5, 5, 37], 240: [6, 5.5, 38],
                245: [6.5, 6, 38.5], 250: [7, 6.5, 39], 255: [7.5, 7, 40], 260: [8, 7.5, 41], 265: [8.5, 8, 42],
                270: [9, 8.5, 42.5], 275: [9.5, 9, 43], 280: [10, 9.5, 44], 285: [10.5, 10, 44.5], 290: [11, 10.5, 45],
                295: [11.5, 11, 46], 300: [12, 11.5, 46.5], 305: [12.5, 12, 47], 310: [13, 12.5, 48], 315: [13.5, 13, 48.5], 320: [14, 13.5, 49]
            },
            female: {
                220: [5, 2.5, 35], 225: [5.5, 3, 35.5], 230: [6, 3.5, 36], 235: [6.5, 4, 37], 240: [7, 4.5, 38],
                245: [7.5, 5, 38.5], 250: [8, 5.5, 39], 255: [8.5, 6, 40], 260: [9, 6.5, 41], 265: [9.5, 7, 42],
                270: [10, 7.5, 42.5], 275: [10.5, 8, 43], 280: [11, 8.5, 44], 285: [11.5, 9, 44.5], 290: [12, 9.5, 45]
            }
        };

        function shoeSetGender(gender) {
            shoeCurrentGender = gender;
            const maleBtn = document.getElementById('shoeMaleBtn');
            const femaleBtn = document.getElementById('shoeFemaleBtn');
            maleBtn.classList.toggle('active', gender === 'male');
            femaleBtn.classList.toggle('active', gender === 'female');
            femaleBtn.classList.toggle('female', gender === 'female');
            shoeResetAll();
        }

        function shoeFindClosestMM(value, type) {
            const data = shoeSizeData[shoeCurrentGender];
            const mmSizes = Object.keys(data).map(Number);
            if (type === 'kr' || type === 'cm') {
                const mm = type === 'cm' ? value * 10 : value;
                return mmSizes.reduce((prev, curr) => Math.abs(curr - mm) < Math.abs(prev - mm) ? curr : prev);
            }
            const indices = { us: 0, uk: 1, eu: 2 };
            const idx = indices[type];
            let closestMM = mmSizes[0], minDiff = Infinity;
            for (const mm of mmSizes) {
                const diff = Math.abs(data[mm][idx] - value);
                if (diff < minDiff) { minDiff = diff; closestMM = mm; }
            }
            return closestMM;
        }

        function shoeConvert(type, value) {
            if (!value || value === '') { shoeResetAll(); return; }
            const numValue = parseFloat(value);
            if (isNaN(numValue)) return;
            const data = shoeSizeData[shoeCurrentGender];
            let mm;
            if (type === 'kr') mm = shoeFindClosestMM(numValue, 'kr');
            else if (type === 'cm') mm = shoeFindClosestMM(numValue, 'cm');
            else if (type === 'cn') mm = shoeFindClosestMM(numValue, 'eu');
            else mm = shoeFindClosestMM(numValue, type);
            const sizes = data[mm];
            if (!sizes) return;
            if (type !== 'kr') document.getElementById('shoeKr').value = mm;
            if (type !== 'us') document.getElementById('shoeUs').value = sizes[0];
            if (type !== 'uk') document.getElementById('shoeUk').value = sizes[1];
            if (type !== 'eu') document.getElementById('shoeEu').value = sizes[2];
            if (type !== 'cn') document.getElementById('shoeCn').value = sizes[2];
            if (type !== 'cm') document.getElementById('shoeCm').value = (mm / 10).toFixed(1);
        }

        function shoeResetAll() {
            ['shoeKr', 'shoeUs', 'shoeUk', 'shoeEu', 'shoeCn', 'shoeCm'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.value = '';
            });
        }

        function initShoeSizeCalculator() {
            // Ï¥àÍ∏∞Ìôî ÏôÑÎ£å
        }

        // ===== Í≥®ÌîÑÏ†êÏàò Í≥ÑÏÇ∞Í∏∞ =====
        function getGolfScoreCalculator() {
            return `
                <style>
                    .golf-container { max-width: 900px; margin: 0 auto; }
                    .golf-header { text-align: center; margin-bottom: 20px; }
                    .golf-header-icon { display: inline-flex; align-items: center; justify-content: center; width: 70px; height: 70px; background: linear-gradient(135deg, #10b981 0%, #34d399 100%); border-radius: 50%; margin-bottom: 12px; }
                    .golf-header-icon i { font-size: 32px; color: white; }
                    .golf-header h2 { font-size: 24px; font-weight: 700; color: #333; margin-bottom: 6px; }
                    .golf-header p { font-size: 14px; color: #888; }
                    .golf-card { background: #fff; border-radius: 16px; padding: 20px; margin-bottom: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); }
                    .golf-setup-row { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; margin-bottom: 12px; }
                    .golf-setup-row label { font-weight: 600; color: #555; font-size: 14px; }
                    .golf-setup-row input { padding: 10px 14px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 14px; }
                    .golf-setup-row input:focus { outline: none; border-color: #10b981; }
                    .golf-btn { padding: 10px 18px; border: none; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
                    .golf-btn-primary { background: linear-gradient(135deg, #10b981 0%, #34d399 100%); color: white; }
                    .golf-btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3); }
                    .golf-btn-secondary { background: #e2e8f0; color: #555; }
                    .golf-btn-danger { background: linear-gradient(135deg, #ef4444 0%, #f87171 100%); color: white; }
                    .golf-btn-info { background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%); color: white; }
                    .golf-player-section { margin-bottom: 16px; }
                    .golf-player-section h3 { font-size: 16px; font-weight: 700; color: #10b981; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
                    .golf-player-tabs { display: flex; flex-wrap: wrap; gap: 8px; }
                    .golf-player-tab { display: flex; align-items: center; gap: 6px; padding: 10px 16px; border: 2px solid #e2e8f0; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; font-size: 14px; font-weight: 500; }
                    .golf-player-tab:hover { border-color: #10b981; background: #f0fdf4; }
                    .golf-player-tab.active { background: linear-gradient(135deg, #10b981 0%, #34d399 100%); color: white; border-color: #10b981; }
                    .golf-player-tab .remove-btn { background: none; border: none; color: inherit; cursor: pointer; font-size: 16px; margin-left: 4px; }
                    .golf-summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-bottom: 16px; }
                    @media (max-width: 640px) { .golf-summary { grid-template-columns: repeat(2, 1fr); } }
                    .golf-summary-item { padding: 16px; border-radius: 14px; text-align: center; }
                    .golf-summary-item.par { background: #f0fdf4; }
                    .golf-summary-item.score { background: #eff6ff; }
                    .golf-summary-item.over { background: #faf5ff; }
                    .golf-summary-item.holes { background: #fffbeb; }
                    .golf-summary-label { font-size: 12px; color: #666; margin-bottom: 4px; }
                    .golf-summary-value { font-size: 28px; font-weight: 800; }
                    .golf-summary-item.par .golf-summary-value { color: #10b981; }
                    .golf-summary-item.score .golf-summary-value { color: #3b82f6; }
                    .golf-summary-item.over .golf-summary-value { color: #8b5cf6; }
                    .golf-summary-item.holes .golf-summary-value { color: #f59e0b; }
                    .golf-scorecard { overflow-x: auto; }
                    .golf-scorecard h3 { font-size: 16px; font-weight: 700; color: #10b981; margin-bottom: 12px; }
                    .golf-table { width: 100%; border-collapse: collapse; font-size: 14px; }
                    .golf-table th { background: #f0fdf4; padding: 10px 8px; text-align: center; font-weight: 600; color: #10b981; }
                    .golf-table td { padding: 10px 8px; text-align: center; border-bottom: 1px solid #e2e8f0; }
                    .golf-table tr:hover { background: #f8fafc; }
                    .golf-table select, .golf-table input { padding: 8px; border: 1px solid #e2e8f0; border-radius: 8px; width: 60px; text-align: center; font-size: 14px; }
                    .golf-table select:focus, .golf-table input:focus { outline: none; border-color: #10b981; }
                    .golf-badge { display: inline-block; padding: 4px 10px; border-radius: 20px; font-size: 12px; font-weight: 700; }
                    .golf-badge.eagle { background: #3b82f6; color: white; }
                    .golf-badge.birdie { background: #10b981; color: white; }
                    .golf-badge.par { background: #e2e8f0; color: #555; }
                    .golf-badge.bogey { background: #f97316; color: white; }
                    .golf-badge.double { background: #ef4444; color: white; }
                    .golf-badge.triple { background: #991b1b; color: white; }
                    .golf-table tfoot td { background: #f0fdf4; font-weight: 700; }
                    .golf-tips { background: #fffbeb; border-radius: 16px; padding: 20px; margin-top: 16px; }
                    .golf-tips h3 { font-size: 16px; font-weight: 700; color: #f59e0b; margin-bottom: 12px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
                    .golf-tips-content { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
                    @media (max-width: 640px) { .golf-tips-content { grid-template-columns: 1fr; } }
                    .golf-tip-item { display: flex; align-items: flex-start; gap: 10px; padding: 12px; background: white; border-radius: 10px; border-left: 4px solid; }
                    .golf-tip-item.good { border-color: #10b981; }
                    .golf-tip-item.bad { border-color: #ef4444; }
                    .golf-tip-item.info { border-color: #3b82f6; }
                    .golf-tip-item.equipment { border-color: #8b5cf6; }
                    .golf-tip-item .tip-icon { font-size: 20px; }
                    .golf-tip-item .tip-content h4 { font-size: 13px; font-weight: 700; margin-bottom: 2px; }
                    .golf-tip-item .tip-content p { font-size: 11px; color: #666; line-height: 1.5; }
                    .golf-tip-item.good .tip-content h4 { color: #10b981; }
                    .golf-tip-item.bad .tip-content h4 { color: #ef4444; }
                    .golf-tip-item.info .tip-content h4 { color: #3b82f6; }
                    .golf-tip-item.equipment .tip-content h4 { color: #8b5cf6; }
                    .golf-tips-hidden { display: none; }
                    .golf-saved-games { background: #f0fdf4; border-radius: 16px; padding: 20px; margin-bottom: 16px; }
                    .golf-saved-games h3 { font-size: 16px; font-weight: 700; color: #10b981; margin-bottom: 12px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
                    .golf-game-list { max-height: 300px; overflow-y: auto; }
                    .golf-game-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 10px; margin-bottom: 8px; border-left: 4px solid #10b981; }
                    .golf-game-item:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
                    .golf-game-info { flex: 1; }
                    .golf-game-info h4 { font-size: 14px; font-weight: 600; color: #333; margin-bottom: 4px; }
                    .golf-game-info p { font-size: 12px; color: #666; }
                    .golf-game-actions { display: flex; gap: 6px; }
                    .golf-game-actions button { padding: 6px 10px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; }
                    .golf-equipment { background: #f3e8ff; border-radius: 16px; padding: 20px; margin-top: 16px; }
                    .golf-equipment h3 { font-size: 16px; font-weight: 700; color: #8b5cf6; margin-bottom: 12px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
                    .golf-equipment-content { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
                    @media (max-width: 640px) { .golf-equipment-content { grid-template-columns: 1fr; } }
                    .golf-equipment-item { background: white; padding: 14px; border-radius: 10px; border-left: 4px solid #8b5cf6; }
                    .golf-equipment-item h4 { font-size: 13px; font-weight: 700; color: #8b5cf6; margin-bottom: 6px; display: flex; align-items: center; gap: 6px; }
                    .golf-equipment-item p { font-size: 11px; color: #666; line-height: 1.6; }
                    .golf-equipment-item ul { font-size: 11px; color: #666; margin-left: 16px; margin-top: 4px; }
                    .golf-equipment-item li { margin-bottom: 2px; }
                </style>
                <div class="golf-container">
                    <div class="golf-header">
                        <div class="golf-header-icon"><i class="fas fa-golf-ball"></i></div>
                        <h2>Í≥®ÌîÑ Ï†êÏàò Í≥ÑÏÇ∞Í∏∞</h2>
                        <p>ÌåÄÎ≥Ñ/Í∞úÏù∏Î≥Ñ Ïä§ÏΩîÏñ¥Î•º Í∏∞Î°ùÌïòÍ≥† Í¥ÄÎ¶¨ÌïòÏÑ∏Ïöî</p>
                    </div>
                    
                    <!-- Ï†ÄÏû•Îêú Í≤åÏûÑ Î™©Î°ù -->
                    <div class="golf-saved-games">
                        <h3 onclick="golfToggleSavedGames()">üìÇ Ï†ÄÏû•Îêú ÎùºÏö¥Îìú <span id="golfSavedToggle">‚ñº</span></h3>
                        <div id="golfSavedGamesContent">
                            <div class="golf-game-list" id="golfGameList">
                                <p style="text-align: center; color: #888; padding: 20px;">Ï†ÄÏû•Îêú ÎùºÏö¥ÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="golf-card">
                        <div class="golf-setup-row">
                            <label>üìÖ ÎÇ†Ïßú:</label><input type="date" id="golfDate">
                            <label>üìç Ïû•ÏÜå:</label><input type="text" id="golfLocation" placeholder="Í≥®ÌîÑÏû•">
                            <button class="golf-btn golf-btn-primary" onclick="golfSaveGame()">üíæ Ï†ÄÏû•</button>
                            <button class="golf-btn golf-btn-danger" onclick="golfResetAll()">üîÑ ÏÉà ÎùºÏö¥Îìú</button>
                        </div>
                        <div id="golfEditingId" style="display:none;"></div>
                    </div>
                    <div class="golf-card">
                        <div class="golf-player-section">
                            <h3>üë• ÌîåÎ†àÏù¥Ïñ¥</h3>
                            <div class="golf-setup-row">
                                <input type="text" id="golfNewPlayer" placeholder="Ïù¥Î¶Ñ ÏûÖÎ†•">
                                <button class="golf-btn golf-btn-primary" onclick="golfAddPlayer()">+ Ï∂îÍ∞Ä</button>
                            </div>
                            <div class="golf-player-tabs" id="golfPlayerTabs"></div>
                        </div>
                    </div>
                    <div class="golf-card">
                        <div id="golfCurrentPlayerName" style="font-size:18px; font-weight:700; color:#10b981; margin-bottom:16px;">ÌîåÎ†àÏù¥Ïñ¥Î•º Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî</div>
                        <div class="golf-summary">
                            <div class="golf-summary-item par"><div class="golf-summary-label">Ï¥ù Ìåå</div><div id="golfTotalPar" class="golf-summary-value">72</div></div>
                            <div class="golf-summary-item score"><div class="golf-summary-label">Ï¥ù Ïä§ÏΩîÏñ¥</div><div id="golfTotalScore" class="golf-summary-value">0</div></div>
                            <div class="golf-summary-item over"><div class="golf-summary-label">Ïò§Î≤Ñ/Ïñ∏Îçî</div><div id="golfOverUnder" class="golf-summary-value">E</div></div>
                            <div class="golf-summary-item holes"><div class="golf-summary-label">ÏßÑÌñâ ÌôÄ</div><div id="golfPlayedHoles" class="golf-summary-value">0/18</div></div>
                        </div>
                    </div>
                    <div class="golf-card">
                        <div class="golf-scorecard">
                            <h3>üìã Ï†ÑÎ∞ò (Front 9)</h3>
                            <table class="golf-table">
                                <thead><tr><th>ÌôÄ</th><th>Ìåå</th><th>Ïä§ÏΩîÏñ¥</th><th>Í≤∞Í≥º</th></tr></thead>
                                <tbody id="golfFrontNine"></tbody>
                                <tfoot><tr><td>Ìï©Í≥Ñ</td><td id="golfFrontPar">36</td><td id="golfFrontScore">0</td><td id="golfFrontResult">-</td></tr></tfoot>
                            </table>
                        </div>
                    </div>
                    <div class="golf-card">
                        <div class="golf-scorecard">
                            <h3>üìã ÌõÑÎ∞ò (Back 9)</h3>
                            <table class="golf-table">
                                <thead><tr><th>ÌôÄ</th><th>Ìåå</th><th>Ïä§ÏΩîÏñ¥</th><th>Í≤∞Í≥º</th></tr></thead>
                                <tbody id="golfBackNine"></tbody>
                                <tfoot><tr><td>Ìï©Í≥Ñ</td><td id="golfBackPar">36</td><td id="golfBackScore">0</td><td id="golfBackResult">-</td></tr></tfoot>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Í≥®ÌîÑ Ïö©Ïñ¥ Í∞ÄÏù¥Îìú (ÌôïÏû•) -->
                    <div class="golf-tips">
                        <h3 onclick="golfToggleTips()">üí° Í≥®ÌîÑ Ïö©Ïñ¥ Í∞ÄÏù¥Îìú <span id="golfTipToggle">‚ñº</span></h3>
                        <div id="golfTipsContent" class="golf-tips-content">
                            <div class="golf-tip-item good"><span class="tip-icon">ü¶Ö</span><div class="tip-content"><h4>Ïù¥Í∏Ä (Eagle)</h4><p>ÌååÎ≥¥Îã§ 2ÌÉÄ Ï†ÅÏùå (-2). Ìåå5ÌôÄÏóêÏÑú 3ÌÉÄ, Ìåå4ÌôÄÏóêÏÑú 2ÌÉÄÎ°ú ÌôÄÏù∏ Ïãú Îã¨ÏÑ±</p></div></div>
                            <div class="golf-tip-item good"><span class="tip-icon">üê¶</span><div class="tip-content"><h4>Î≤ÑÎîî (Birdie)</h4><p>ÌååÎ≥¥Îã§ 1ÌÉÄ Ï†ÅÏùå (-1). ÏïÑÎßàÏ∂îÏñ¥ÏóêÍ≤åÎäî ÏµúÍ≥†Ïùò Ïä§ÏΩîÏñ¥!</p></div></div>
                            <div class="golf-tip-item good"><span class="tip-icon">‚úÖ</span><div class="tip-content"><h4>Ìåå (Par)</h4><p>Í∏∞Ï§Ä ÌÉÄÏàòÎ°ú ÏôÑÎ£å. ÏïàÏ†ïÏ†ÅÏù∏ ÌîåÎ†àÏù¥Ïùò ÏßÄÌëú</p></div></div>
                            <div class="golf-tip-item bad"><span class="tip-icon">‚ûï</span><div class="tip-content"><h4>Î≥¥Í∏∞ (Bogey)</h4><p>ÌååÎ≥¥Îã§ 1ÌÉÄ ÎßéÏùå (+1). ÏïÑÎßàÏ∂îÏñ¥ÏóêÍ≤åÎäî ÌèâÍ∑†Ï†ÅÏù∏ Ïä§ÏΩîÏñ¥</p></div></div>
                            <div class="golf-tip-item bad"><span class="tip-icon">‚ûï‚ûï</span><div class="tip-content"><h4>ÎçîÎ∏îÎ≥¥Í∏∞ (Double Bogey)</h4><p>ÌååÎ≥¥Îã§ 2ÌÉÄ ÎßéÏùå (+2). Ïã§ÏàòÍ∞Ä ÏûàÏóàÎçò ÌôÄ</p></div></div>
                            <div class="golf-tip-item bad"><span class="tip-icon">‚ûï‚ûï‚ûï</span><div class="tip-content"><h4>Ìä∏Î¶¨ÌîåÎ≥¥Í∏∞+ (Triple Bogey+)</h4><p>ÌååÎ≥¥Îã§ 3ÌÉÄ Ïù¥ÏÉÅ ÎßéÏùå. Ïó∞ÏäµÏù¥ ÌïÑÏöîÌïú Î∂ÄÎ∂Ñ!</p></div></div>
                            <div class="golf-tip-item info"><span class="tip-icon">üï≥Ô∏è</span><div class="tip-content"><h4>ÌôÄÏù∏Ïõê (Hole in One)</h4><p>Ìã∞ÏÉ∑ Ìïú Î≤àÏóê ÌôÄÏóê Í≥µÏùÑ ÎÑ£Ïùå! ÏùºÏÉùÏóê Ìïú Î≤à Í≤ΩÌóòÌïòÍ∏∞ÎèÑ Ïñ¥Î†§Ïö¥ ÌñâÏö¥</p></div></div>
                            <div class="golf-tip-item info"><span class="tip-icon">ü¶¢</span><div class="tip-content"><h4>ÏïåÎ∞îÌä∏Î°úÏä§ (Albatross)</h4><p>ÌååÎ≥¥Îã§ 3ÌÉÄ Ï†ÅÏùå (-3). Ìåå5ÌôÄÏóêÏÑú 2ÌÉÄÎ°ú ÌôÄÏù∏! Ïù¥Í∏ÄÎ≥¥Îã§ Ìù¨Í∑Ä</p></div></div>
                            <div class="golf-tip-item info"><span class="tip-icon">üèåÔ∏è</span><div class="tip-content"><h4>Ìï∏ÎîîÏ∫° (Handicap)</h4><p>Ïã§Î†• Ï∞®Ïù¥Î•º Î≥¥Ï†ïÌïòÎäî ÏßÄÏàò. Ïà´ÏûêÍ∞Ä ÎÇÆÏùÑÏàòÎ°ù Ïã§Î†•Ïûê</p></div></div>
                            <div class="golf-tip-item info"><span class="tip-icon">üéØ</span><div class="tip-content"><h4>GIR (Green in Regulation)</h4><p>Í∑úÏ†ï ÌÉÄÏàò ÎÇ¥Ïóê Í∑∏Î¶∞Ïóê Ïò¨Î¶¨Îäî Í≤É. Ìåå4Îäî 2ÌÉÄ, Ìåå5Îäî 3ÌÉÄ</p></div></div>
                            <div class="golf-tip-item info"><span class="tip-icon">üîÑ</span><div class="tip-content"><h4>Î©ÄÎ¶¨Í±¥ (Mulligan)</h4><p>ÏπúÏÑ† ÎùºÏö¥ÎìúÏóêÏÑú Ïã§ÏàòÌïú ÏÉ∑ÏùÑ Îã§Ïãú Ïπ† Ïàò ÏûàÎäî Í∏∞Ìöå</p></div></div>
                            <div class="golf-tip-item info"><span class="tip-icon">‚õ≥</span><div class="tip-content"><h4>Í∑∏Î¶∞Ìîº (Green Fee)</h4><p>Í≥®ÌîÑÏû• Ïù¥Ïö©Î£å. ÏΩîÏä§, ÏãúÍ∞ÑÎåÄ, ÏöîÏùºÏóê Îî∞Îùº Îã§Î¶Ñ</p></div></div>
                        </div>
                    </div>
                    
                    <!-- Í≥®ÌîÑ Ïû•ÎπÑ Í∞ÄÏù¥Îìú (ÏÉàÎ°ú Ï∂îÍ∞Ä) -->
                    <div class="golf-equipment">
                        <h3 onclick="golfToggleEquipment()">üèåÔ∏è Í≥®ÌîÑ Ïû•ÎπÑ Í∞ÄÏù¥Îìú <span id="golfEquipToggle">‚ñº</span></h3>
                        <div id="golfEquipmentContent" class="golf-equipment-content">
                            <div class="golf-equipment-item">
                                <h4>ü™µ ÎìúÎùºÏù¥Î≤Ñ (Driver)</h4>
                                <p>Ìã∞ÏÉ∑ Ï†ÑÏö© ÌÅ¥ÎüΩ. Í∞ÄÏû• Í∏¥ ÎπÑÍ±∞Î¶¨Î•º ÎÇº Ïàò ÏûàÎäî ÌÅ¥ÎüΩ</p>
                                <ul>
                                    <li>Î°úÌîÑÌä∏: 9~12ÎèÑ</li>
                                    <li>ÎπÑÍ±∞Î¶¨: ÎÇ®ÏÑ± 200~250m, Ïó¨ÏÑ± 150~180m</li>
                                    <li>Ï¥àÎ≥¥Ïûê Ï∂îÏ≤ú: 10.5ÎèÑ Ïù¥ÏÉÅ, ÎÜíÏùÄ Í¥ÄÏö©ÏÑ±</li>
                                </ul>
                            </div>
                            <div class="golf-equipment-item">
                                <h4>üå≤ ÌéòÏñ¥Ïõ®Ïù¥ Ïö∞Îìú (Fairway Wood)</h4>
                                <p>ÌéòÏñ¥Ïõ®Ïù¥ÏóêÏÑú Ïû•Í±∞Î¶¨ ÏÉ∑Ïóê ÏÇ¨Ïö©</p>
                                <ul>
                                    <li>3Î≤à Ïö∞Îìú: 15ÎèÑ, ÏÑ∏Ïª®ÏÉ∑ ÎπÑÍ±∞Î¶¨Ïö©</li>
                                    <li>5Î≤à Ïö∞Îìú: 18ÎèÑ, Îçî Ïâ¨Ïö¥ ÌÉÄÍ≤©</li>
                                    <li>7Î≤à Ïö∞Îìú: 21ÎèÑ, Ï¥àÎ≥¥Ïûê ÏπúÌôîÏ†Å</li>
                                </ul>
                            </div>
                            <div class="golf-equipment-item">
                                <h4>üîß Ïú†Ìã∏Î¶¨Ìã∞/ÌïòÏù¥Î∏åÎ¶¨Îìú (Utility/Hybrid)</h4>
                                <p>Î°±ÏïÑÏù¥Ïñ∏ ÎåÄÏ≤¥, Îã§Ïö©ÎèÑ ÌÅ¥ÎüΩ</p>
                                <ul>
                                    <li>Ïö∞ÎìúÏôÄ ÏïÑÏù¥Ïñ∏Ïùò Ïû•Ï†ê Í≤∞Ìï©</li>
                                    <li>Îü¨ÌîÑ, ÌéòÏñ¥Ïõ®Ïù¥ Î™®Îëê ÏÇ¨Ïö© Í∞ÄÎä•</li>
                                    <li>Ï¥àÎ≥¥ÏûêÏóêÍ≤å Í∞ïÎ†• Ï∂îÏ≤ú!</li>
                                </ul>
                            </div>
                            <div class="golf-equipment-item">
                                <h4>‚öôÔ∏è ÏïÑÏù¥Ïñ∏ (Irons)</h4>
                                <p>Îã§ÏñëÌïú Í±∞Î¶¨ Ï°∞Ï†àÏóê ÏÇ¨Ïö©ÌïòÎäî ÌÅ¥ÎüΩ ÏÑ∏Ìä∏</p>
                                <ul>
                                    <li>Î°±ÏïÑÏù¥Ïñ∏(3-5Î≤à): Ïû•Í±∞Î¶¨, Ïñ¥Î†§ÏõÄ</li>
                                    <li>ÎØ∏Îì§ÏïÑÏù¥Ïñ∏(6-7Î≤à): Ï§ëÍ±∞Î¶¨</li>
                                    <li>ÏàèÏïÑÏù¥Ïñ∏(8-9Î≤à): Îã®Í±∞Î¶¨, Ï†ïÌôïÎèÑ</li>
                                </ul>
                            </div>
                            <div class="golf-equipment-item">
                                <h4>ü•Ñ Ïõ®ÏßÄ (Wedges)</h4>
                                <p>Í∑∏Î¶∞ Ï£ºÎ≥Ä Ïñ¥ÌîÑÎ°úÏπò Î∞è Î≤ôÏª§ÏÉ∑</p>
                                <ul>
                                    <li>ÌîºÏπ≠Ïõ®ÏßÄ(PW): ÏïΩ 46ÎèÑ</li>
                                    <li>Í∞≠Ïõ®ÏßÄ(GW): ÏïΩ 52ÎèÑ</li>
                                    <li>ÏÉåÎìúÏõ®ÏßÄ(SW): ÏïΩ 56ÎèÑ, Î≤ôÏª§Ïö©</li>
                                    <li>Î°≠Ïõ®ÏßÄ(LW): ÏïΩ 60ÎèÑ, Í≥†Í∂§ÎèÑÏÉ∑</li>
                                </ul>
                            </div>
                            <div class="golf-equipment-item">
                                <h4>üé± ÌçºÌÑ∞ (Putter)</h4>
                                <p>Í∑∏Î¶∞ ÏúÑÏóêÏÑú ÌôÄÏóê Í≥µÏùÑ ÎÑ£Îäî ÌÅ¥ÎüΩ</p>
                                <ul>
                                    <li>Î∏îÎ†àÏù¥ÎìúÌòï: ÏÉÅÍ∏âÏûêÏö©, Í∞êÍ∞ÅÏ†Å</li>
                                    <li>ÎßêÎ†õÌòï: Í¥ÄÏö©ÏÑ± Ï¢ãÏùå, Ï¥àÎ≥¥Ïûê Ï∂îÏ≤ú</li>
                                    <li>Í∏∏Ïù¥: 33~35Ïù∏ÏπòÍ∞Ä ÏùºÎ∞òÏ†Å</li>
                                </ul>
                            </div>
                            <div class="golf-equipment-item">
                                <h4>‚ö™ Í≥®ÌîÑÍ≥µ (Golf Ball)</h4>
                                <p>Ïã§Î†•Ïóê ÎßûÎäî Í≥µ ÏÑ†ÌÉùÏù¥ Ï§ëÏöî!</p>
                                <ul>
                                    <li>2ÌîºÏä§: ÎπÑÍ±∞Î¶¨ Ï§ëÏãú, ÎÇ¥Íµ¨ÏÑ±, Ï¥àÎ≥¥Ïûê</li>
                                    <li>3ÌîºÏä§: Í∑†ÌòïÏû°Ìûå ÏÑ±Îä•</li>
                                    <li>4ÌîºÏä§: Ïä§ÌïÄ Ï°∞Ï†à, ÏÉÅÍ∏âÏûêÏö©</li>
                                </ul>
                            </div>
                            <div class="golf-equipment-item">
                                <h4>üß§ Í∏∞ÌÉÄ ÌïÑÏàò Ïû•ÎπÑ</h4>
                                <p>ÎùºÏö¥ÎìúÏóê ÌïÑÏöîÌïú Ïï°ÏÑ∏ÏÑúÎ¶¨</p>
                                <ul>
                                    <li>Í≥®ÌîÑ Ïû•Í∞ë: Í∑∏Î¶ΩÎ†• Ìñ•ÏÉÅ</li>
                                    <li>Í≥®ÌîÑÌôî: Ïä§ÌååÏù¥ÌÅ¨/Ïä§ÌååÏù¥ÌÅ¨Î¶¨Ïä§</li>
                                    <li>Ìã∞: ÎÇòÎ¨¥/ÌîåÎùºÏä§Ìã±, Îã§ÏñëÌïú ÎÜíÏù¥</li>
                                    <li>Î≥ºÎßàÏª§, ÎîîÎ¥áÌà¥, Í±∞Î¶¨Ï∏°Ï†ïÍ∏∞</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        const golfDefaultPars = [4, 3, 5, 4, 4, 3, 4, 5, 4, 4, 3, 5, 4, 4, 3, 4, 5, 4];
        let golfRound = { date: '', location: '', players: [], pars: [...golfDefaultPars] };
        let golfCurrentPlayerIndex = -1;
        let golfSavedGames = JSON.parse(localStorage.getItem('golfSavedGames') || '[]');
        let golfEditingId = null;

        function golfAddPlayer() {
            const nameInput = document.getElementById('golfNewPlayer');
            const name = nameInput.value.trim();
            if (!name) { alert('Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî'); return; }
            if (golfRound.players.length >= 8) { alert('ÏµúÎåÄ 8Î™ÖÍπåÏßÄ Ï∂îÍ∞Ä Í∞ÄÎä•'); return; }
            golfRound.players.push({ name: name, scores: new Array(18).fill(0) });
            nameInput.value = '';
            golfCurrentPlayerIndex = golfRound.players.length - 1;
            golfRenderPlayerTabs();
            golfRenderScorecard();
            golfCalculateTotals();
        }

        function golfSelectPlayer(index) {
            golfCurrentPlayerIndex = index;
            golfRenderPlayerTabs();
            golfRenderScorecard();
            golfCalculateTotals();
        }

        function golfRemovePlayer(index) {
            if (confirm(`${golfRound.players[index].name}ÏùÑ(Î•º) ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`)) {
                golfRound.players.splice(index, 1);
                if (golfCurrentPlayerIndex >= golfRound.players.length) golfCurrentPlayerIndex = golfRound.players.length - 1;
                golfRenderPlayerTabs();
                golfRenderScorecard();
                golfCalculateTotals();
            }
        }

        function golfRenderPlayerTabs() {
            const container = document.getElementById('golfPlayerTabs');
            container.innerHTML = '';
            golfRound.players.forEach((player, index) => {
                const tab = document.createElement('div');
                tab.className = `golf-player-tab ${index === golfCurrentPlayerIndex ? 'active' : ''}`;
                tab.innerHTML = `<span onclick="golfSelectPlayer(${index})">${player.name}</span><button class="remove-btn" onclick="event.stopPropagation(); golfRemovePlayer(${index})">√ó</button>`;
                container.appendChild(tab);
            });
            const nameDisplay = document.getElementById('golfCurrentPlayerName');
            if (golfCurrentPlayerIndex >= 0 && golfRound.players[golfCurrentPlayerIndex]) {
                nameDisplay.textContent = `üèåÔ∏è ${golfRound.players[golfCurrentPlayerIndex].name}`;
            } else {
                nameDisplay.textContent = 'ÌîåÎ†àÏù¥Ïñ¥Î•º Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî';
            }
        }

        function golfRenderScorecard() {
            const frontNine = document.getElementById('golfFrontNine');
            const backNine = document.getElementById('golfBackNine');
            frontNine.innerHTML = '';
            backNine.innerHTML = '';
            for (let i = 0; i < 18; i++) {
                const row = golfCreateHoleRow(i);
                if (i < 9) frontNine.appendChild(row);
                else backNine.appendChild(row);
            }
        }

        function golfCreateHoleRow(index) {
            const row = document.createElement('tr');
            const currentScore = golfCurrentPlayerIndex >= 0 && golfRound.players[golfCurrentPlayerIndex] ? golfRound.players[golfCurrentPlayerIndex].scores[index] : 0;
            row.innerHTML = `
                <td style="font-weight:600; color:#10b981;">${index + 1}</td>
                <td><select onchange="golfUpdatePar(${index}, this.value)">
                    <option value="3" ${golfRound.pars[index] === 3 ? 'selected' : ''}>3</option>
                    <option value="4" ${golfRound.pars[index] === 4 ? 'selected' : ''}>4</option>
                    <option value="5" ${golfRound.pars[index] === 5 ? 'selected' : ''}>5</option>
                </select></td>
                <td><input type="number" min="1" max="15" value="${currentScore || ''}" onchange="golfUpdateScore(${index}, this.value)" placeholder="-" ${golfCurrentPlayerIndex < 0 ? 'disabled' : ''}></td>
                <td><span id="golfResult-${index}" class="golf-badge par">-</span></td>
            `;
            return row;
        }

        function golfUpdatePar(index, value) {
            golfRound.pars[index] = parseInt(value);
            golfCalculateTotals();
            golfUpdateResultBadge(index);
        }

        function golfUpdateScore(index, value) {
            if (golfCurrentPlayerIndex < 0) return;
            golfRound.players[golfCurrentPlayerIndex].scores[index] = value ? parseInt(value) : 0;
            golfCalculateTotals();
            golfUpdateResultBadge(index);
        }

        function golfUpdateResultBadge(index) {
            const badge = document.getElementById(`golfResult-${index}`);
            if (!badge) return;
            const score = golfCurrentPlayerIndex >= 0 && golfRound.players[golfCurrentPlayerIndex] ? golfRound.players[golfCurrentPlayerIndex].scores[index] : 0;
            const par = golfRound.pars[index];
            if (!score) { badge.textContent = '-'; badge.className = 'golf-badge par'; return; }
            const diff = score - par;
            let text, cls;
            if (diff <= -2) { text = 'Ïù¥Í∏Ä!'; cls = 'eagle'; }
            else if (diff === -1) { text = 'Î≤ÑÎîî'; cls = 'birdie'; }
            else if (diff === 0) { text = 'Ìåå'; cls = 'par'; }
            else if (diff === 1) { text = 'Î≥¥Í∏∞'; cls = 'bogey'; }
            else if (diff === 2) { text = 'ÎçîÎ∏î'; cls = 'double'; }
            else { text = `+${diff}`; cls = 'triple'; }
            badge.textContent = text;
            badge.className = `golf-badge ${cls}`;
        }

        function golfCalculateTotals() {
            const scores = golfCurrentPlayerIndex >= 0 && golfRound.players[golfCurrentPlayerIndex] ? golfRound.players[golfCurrentPlayerIndex].scores : new Array(18).fill(0);
            let frontPar = 0, frontScore = 0, frontPlayed = 0;
            for (let i = 0; i < 9; i++) { frontPar += golfRound.pars[i]; if (scores[i]) { frontScore += scores[i]; frontPlayed++; } golfUpdateResultBadge(i); }
            let backPar = 0, backScore = 0, backPlayed = 0;
            for (let i = 9; i < 18; i++) { backPar += golfRound.pars[i]; if (scores[i]) { backScore += scores[i]; backPlayed++; } golfUpdateResultBadge(i); }
            document.getElementById('golfFrontPar').textContent = frontPar;
            document.getElementById('golfFrontScore').textContent = frontScore || '-';
            document.getElementById('golfFrontResult').textContent = frontPlayed ? golfFormatDiff(frontScore - frontPar) : '-';
            document.getElementById('golfBackPar').textContent = backPar;
            document.getElementById('golfBackScore').textContent = backScore || '-';
            document.getElementById('golfBackResult').textContent = backPlayed ? golfFormatDiff(backScore - backPar) : '-';
            const totalPar = frontPar + backPar;
            const totalScore = frontScore + backScore;
            const totalPlayed = frontPlayed + backPlayed;
            document.getElementById('golfTotalPar').textContent = totalPar;
            document.getElementById('golfTotalScore').textContent = totalScore || 0;
            document.getElementById('golfPlayedHoles').textContent = `${totalPlayed}/18`;
            const overUnderEl = document.getElementById('golfOverUnder');
            if (totalPlayed > 0) {
                let playedPar = 0;
                for (let i = 0; i < 18; i++) { if (scores[i]) playedPar += golfRound.pars[i]; }
                const actualDiff = totalScore - playedPar;
                overUnderEl.textContent = golfFormatDiff(actualDiff);
                overUnderEl.style.color = actualDiff < 0 ? '#10b981' : actualDiff > 0 ? '#ef4444' : '#8b5cf6';
            } else {
                overUnderEl.textContent = 'E';
                overUnderEl.style.color = '#8b5cf6';
            }
        }

        function golfFormatDiff(diff) { return diff === 0 ? 'E' : diff > 0 ? `+${diff}` : `${diff}`; }

        function golfResetAll() {
            if (confirm('ÏÉà ÎùºÏö¥ÎìúÎ•º ÏãúÏûëÌïòÏãúÍ≤†ÏäµÎãàÍπå? Ï†ÄÏû•ÌïòÏßÄ ÏïäÏùÄ Îç∞Ïù¥ÌÑ∞Îäî ÏÇ¨ÎùºÏßëÎãàÎã§.')) {
                golfRound = { date: '', location: '', players: [], pars: [...golfDefaultPars] };
                golfCurrentPlayerIndex = -1;
                golfEditingId = null;
                document.getElementById('golfDate').value = new Date().toISOString().split('T')[0];
                document.getElementById('golfLocation').value = '';
                golfRenderPlayerTabs();
                golfRenderScorecard();
                golfCalculateTotals();
            }
        }

        function golfToggleTips() {
            const content = document.getElementById('golfTipsContent');
            const toggle = document.getElementById('golfTipToggle');
            content.classList.toggle('golf-tips-hidden');
            toggle.textContent = content.classList.contains('golf-tips-hidden') ? '‚ñ∂' : '‚ñº';
        }

        function golfToggleEquipment() {
            const content = document.getElementById('golfEquipmentContent');
            const toggle = document.getElementById('golfEquipToggle');
            content.classList.toggle('golf-tips-hidden');
            toggle.textContent = content.classList.contains('golf-tips-hidden') ? '‚ñ∂' : '‚ñº';
        }

        function golfToggleSavedGames() {
            const content = document.getElementById('golfSavedGamesContent');
            const toggle = document.getElementById('golfSavedToggle');
            content.classList.toggle('golf-tips-hidden');
            toggle.textContent = content.classList.contains('golf-tips-hidden') ? '‚ñ∂' : '‚ñº';
        }

        function golfSaveGame() {
            const date = document.getElementById('golfDate').value;
            const location = document.getElementById('golfLocation').value.trim();
            if (!date) { alert('ÎÇ†ÏßúÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî'); return; }
            if (golfRound.players.length === 0) { alert('ÏµúÏÜå 1Î™ÖÏùò ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§'); return; }
            
            const gameData = {
                id: golfEditingId || Date.now().toString(),
                date: date,
                location: location || 'ÎØ∏ÏûÖÎ†•',
                players: JSON.parse(JSON.stringify(golfRound.players)),
                pars: [...golfRound.pars],
                savedAt: new Date().toISOString()
            };
            
            if (golfEditingId) {
                const index = golfSavedGames.findIndex(g => g.id === golfEditingId);
                if (index >= 0) golfSavedGames[index] = gameData;
                golfEditingId = null;
                alert('ÎùºÏö¥ÎìúÍ∞Ä ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§!');
            } else {
                golfSavedGames.unshift(gameData);
                alert('ÎùºÏö¥ÎìúÍ∞Ä Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
            }
            
            localStorage.setItem('golfSavedGames', JSON.stringify(golfSavedGames));
            golfRenderSavedGames();
        }

        function golfLoadGame(id) {
            const game = golfSavedGames.find(g => g.id === id);
            if (!game) return;
            
            golfEditingId = id;
            document.getElementById('golfDate').value = game.date;
            document.getElementById('golfLocation').value = game.location === 'ÎØ∏ÏûÖÎ†•' ? '' : game.location;
            golfRound.players = JSON.parse(JSON.stringify(game.players));
            golfRound.pars = [...game.pars];
            golfCurrentPlayerIndex = golfRound.players.length > 0 ? 0 : -1;
            
            golfRenderPlayerTabs();
            golfRenderScorecard();
            golfCalculateTotals();
            alert('ÎùºÏö¥ÎìúÎ•º Î∂àÎü¨ÏôîÏäµÎãàÎã§. ÏàòÏ†ï ÌõÑ Ï†ÄÏû•ÌïòÏÑ∏Ïöî!');
        }

        function golfDeleteGame(id) {
            if (!confirm('Ïù¥ ÎùºÏö¥ÎìúÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            golfSavedGames = golfSavedGames.filter(g => g.id !== id);
            localStorage.setItem('golfSavedGames', JSON.stringify(golfSavedGames));
            golfRenderSavedGames();
        }

        function golfRenderSavedGames() {
            const container = document.getElementById('golfGameList');
            if (golfSavedGames.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #888; padding: 20px;">Ï†ÄÏû•Îêú ÎùºÏö¥ÎìúÍ∞Ä ÏóÜÏäµÎãàÎã§.</p>';
                return;
            }
            
            container.innerHTML = golfSavedGames.map(game => {
                const playerSummary = game.players.map(p => {
                    const totalScore = p.scores.reduce((a, b) => a + b, 0);
                    const playedHoles = p.scores.filter(s => s > 0).length;
                    return `${p.name}: ${totalScore}ÌÉÄ (${playedHoles}ÌôÄ)`;
                }).join(', ');
                
                return `
                    <div class="golf-game-item">
                        <div class="golf-game-info">
                            <h4>üìÖ ${game.date} | üìç ${game.location}</h4>
                            <p>üë• ${playerSummary}</p>
                        </div>
                        <div class="golf-game-actions">
                            <button style="background:#10b981; color:white;" onclick="golfLoadGame('${game.id}')">üìù ÏàòÏ†ï</button>
                            <button style="background:#ef4444; color:white;" onclick="golfDeleteGame('${game.id}')">üóëÔ∏è ÏÇ≠Ï†ú</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function initGolfScoreCalculator() {
            document.getElementById('golfDate').value = new Date().toISOString().split('T')[0];
            golfSavedGames = JSON.parse(localStorage.getItem('golfSavedGames') || '[]');
            golfEditingId = null;
            golfRenderPlayerTabs();
            golfRenderScorecard();
            golfCalculateTotals();
            golfRenderSavedGames();
        }

        // ===== Î≥ºÎßÅÏ†êÏàò Í≥ÑÏÇ∞Í∏∞ =====
        function getBowlingScoreCalculator() {
            return `
                <style>
                    .bowling-container { max-width: 900px; margin: 0 auto; }
                    .bowling-header { text-align: center; margin-bottom: 20px; }
                    .bowling-header-icon { display: inline-flex; align-items: center; justify-content: center; width: 70px; height: 70px; background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%); border-radius: 50%; margin-bottom: 12px; }
                    .bowling-header-icon i { font-size: 32px; color: white; }
                    .bowling-header h2 { font-size: 24px; font-weight: 700; color: #333; margin-bottom: 6px; }
                    .bowling-header p { font-size: 14px; color: #888; }
                    .bowling-card { background: #fff; border-radius: 16px; padding: 20px; margin-bottom: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); }
                    .bowling-setup-row { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; margin-bottom: 12px; }
                    .bowling-btn { padding: 10px 18px; border: none; border-radius: 10px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
                    .bowling-btn-primary { background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%); color: white; }
                    .bowling-btn-primary:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(245, 158, 11, 0.3); }
                    .bowling-btn-secondary { background: #e2e8f0; color: #555; }
                    .bowling-btn-danger { background: linear-gradient(135deg, #ef4444 0%, #f87171 100%); color: white; }
                    .bowling-btn-strike { background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: #333; }
                    .bowling-btn-spare { background: linear-gradient(135deg, #3b82f6 0%, #60a5fa 100%); color: white; }
                    .bowling-btn-gutter { background: #6b7280; color: white; }
                    .bowling-player-section h3 { font-size: 16px; font-weight: 700; color: #f59e0b; margin-bottom: 12px; }
                    .bowling-player-tabs { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px; }
                    .bowling-player-tab { display: flex; align-items: center; gap: 6px; padding: 10px 16px; border: 2px solid #e2e8f0; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; font-size: 14px; font-weight: 500; }
                    .bowling-player-tab:hover { border-color: #f59e0b; background: #fffbeb; }
                    .bowling-player-tab.active { background: linear-gradient(135deg, #f59e0b 0%, #fbbf24 100%); color: white; border-color: #f59e0b; }
                    .bowling-player-tab .remove-btn { background: none; border: none; color: inherit; cursor: pointer; font-size: 16px; margin-left: 4px; }
                    .bowling-scoreboard { overflow-x: auto; margin-bottom: 16px; }
                    .bowling-frames { display: flex; min-width: max-content; }
                    .bowling-frame { border: 2px solid #1e3a5f; background: #fef3c7; overflow: hidden; }
                    .bowling-frame-header { background: #1e3a5f; color: white; text-align: center; padding: 6px; font-size: 12px; font-weight: 700; }
                    .bowling-frame-header.tenth { background: #dc2626; }
                    .bowling-frame-rolls { display: flex; }
                    .bowling-roll { width: 36px; height: 36px; border-right: 1px solid #1e3a5f; border-bottom: 1px solid #1e3a5f; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 14px; }
                    .bowling-roll:last-child { border-right: none; }
                    .bowling-frame-score { height: 44px; border-top: 1px solid #1e3a5f; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: 800; color: #1e3a5f; }
                    .bowling-total-score { text-align: center; margin: 16px 0; }
                    .bowling-total-score span { font-size: 14px; color: #666; }
                    .bowling-total-score .score { font-size: 40px; font-weight: 800; color: #1e3a5f; }
                    .bowling-input-section { text-align: center; padding: 20px; background: #f8fafc; border-radius: 12px; }
                    .bowling-current-frame { font-size: 16px; font-weight: 600; color: #f59e0b; margin-bottom: 16px; }
                    .bowling-pin-buttons { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-bottom: 16px; }
                    .bowling-pin-btn { width: 44px; height: 44px; border-radius: 50%; border: none; background: white; font-size: 16px; font-weight: 700; cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.1); transition: all 0.2s ease; }
                    .bowling-pin-btn:hover:not(:disabled) { transform: scale(1.1); background: #fbbf24; }
                    .bowling-pin-btn:disabled { opacity: 0.3; cursor: not-allowed; }
                    .bowling-special-btns { display: flex; justify-content: center; gap: 12px; flex-wrap: wrap; }
                    .bowling-game-over { text-align: center; padding: 24px; background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); border-radius: 16px; margin-top: 16px; }
                    .bowling-game-over h3 { font-size: 24px; font-weight: 800; color: #333; margin-bottom: 12px; }
                    .bowling-tips { background: #f8fafc; border-radius: 16px; padding: 20px; margin-top: 16px; }
                    .bowling-tips h3 { font-size: 16px; font-weight: 700; color: #333; margin-bottom: 16px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
                    .bowling-tips-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
                    @media (max-width: 640px) { .bowling-tips-grid { grid-template-columns: 1fr; } }
                    .bowling-tip { background: white; padding: 14px; border-radius: 10px; border-left: 4px solid #f59e0b; }
                    .bowling-tip h4 { font-size: 13px; font-weight: 700; color: #f59e0b; margin-bottom: 4px; }
                    .bowling-tip p { font-size: 12px; color: #666; line-height: 1.5; }
                    .bowling-tip.info { border-left-color: #3b82f6; }
                    .bowling-tip.info h4 { color: #3b82f6; }
                    .bowling-tip.equipment { border-left-color: #8b5cf6; }
                    .bowling-tip.equipment h4 { color: #8b5cf6; }
                    .bowling-hidden { display: none; }
                    .bowling-saved-games { background: #fffbeb; border-radius: 16px; padding: 20px; margin-bottom: 16px; }
                    .bowling-saved-games h3 { font-size: 16px; font-weight: 700; color: #f59e0b; margin-bottom: 12px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
                    .bowling-game-list { max-height: 300px; overflow-y: auto; }
                    .bowling-game-item { display: flex; justify-content: space-between; align-items: center; padding: 12px; background: white; border-radius: 10px; margin-bottom: 8px; border-left: 4px solid #f59e0b; }
                    .bowling-game-item:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
                    .bowling-game-info { flex: 1; }
                    .bowling-game-info h4 { font-size: 14px; font-weight: 600; color: #333; margin-bottom: 4px; }
                    .bowling-game-info p { font-size: 12px; color: #666; }
                    .bowling-game-actions { display: flex; gap: 6px; }
                    .bowling-game-actions button { padding: 6px 10px; border: none; border-radius: 6px; font-size: 12px; cursor: pointer; }
                    .bowling-equipment { background: #f3e8ff; border-radius: 16px; padding: 20px; margin-top: 16px; }
                    .bowling-equipment h3 { font-size: 16px; font-weight: 700; color: #8b5cf6; margin-bottom: 12px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
                    .bowling-equipment-content { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; }
                    @media (max-width: 640px) { .bowling-equipment-content { grid-template-columns: 1fr; } }
                    .bowling-equipment-item { background: white; padding: 14px; border-radius: 10px; border-left: 4px solid #8b5cf6; }
                    .bowling-equipment-item h4 { font-size: 13px; font-weight: 700; color: #8b5cf6; margin-bottom: 6px; display: flex; align-items: center; gap: 6px; }
                    .bowling-equipment-item p { font-size: 11px; color: #666; line-height: 1.6; }
                    .bowling-equipment-item ul { font-size: 11px; color: #666; margin-left: 16px; margin-top: 4px; }
                    .bowling-equipment-item li { margin-bottom: 2px; }
                </style>
                <div class="bowling-container">
                    <div class="bowling-header">
                        <div class="bowling-header-icon"><i class="fas fa-bowling-ball"></i></div>
                        <h2>Î≥ºÎßÅ Ï†êÏàò Í≥ÑÏÇ∞Í∏∞</h2>
                        <p>ÌåÄÎ≥Ñ, Ïù∏ÏõêÎ≥Ñ Ï†êÏàòÎ•º Í∏∞Î°ùÌïòÍ≥† Ï†ÄÏû•ÌïòÏÑ∏Ïöî!</p>
                    </div>
                    
                    <!-- Ï†ÄÏû•Îêú Í≤åÏûÑ Î™©Î°ù -->
                    <div class="bowling-saved-games">
                        <h3 onclick="bowlingToggleSavedGames()">üìÇ Ï†ÄÏû•Îêú Í≤åÏûÑ <span id="bowlingSavedToggle">‚ñº</span></h3>
                        <div id="bowlingSavedGamesContent">
                            <div class="bowling-game-list" id="bowlingGameList">
                                <p style="text-align: center; color: #888; padding: 20px;">Ï†ÄÏû•Îêú Í≤åÏûÑÏù¥ ÏóÜÏäµÎãàÎã§.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bowling-card">
                        <div class="bowling-player-section">
                            <h3>üë• ÌîåÎ†àÏù¥Ïñ¥ & Í≤åÏûÑ Ï†ïÎ≥¥</h3>
                            <div class="bowling-setup-row">
                                <label style="font-weight:600; color:#555; font-size:14px;">üìÖ ÎÇ†Ïßú:</label>
                                <input type="date" id="bowlingDate" style="padding:10px 14px; border:2px solid #e2e8f0; border-radius:10px; font-size:14px;">
                                <label style="font-weight:600; color:#555; font-size:14px;">üìç Ïû•ÏÜå:</label>
                                <input type="text" id="bowlingLocation" placeholder="Î≥ºÎßÅÏû•" style="padding:10px 14px; border:2px solid #e2e8f0; border-radius:10px; font-size:14px; width:120px;">
                            </div>
                            <div class="bowling-setup-row">
                                <input type="text" id="bowlingNewPlayer" placeholder="Ïù¥Î¶Ñ ÏûÖÎ†•" style="padding:10px 14px; border:2px solid #e2e8f0; border-radius:10px; font-size:14px;">
                                <button class="bowling-btn bowling-btn-primary" onclick="bowlingAddPlayer()">+ Ï∂îÍ∞Ä</button>
                                <button class="bowling-btn bowling-btn-primary" onclick="bowlingSaveGame()">üíæ Ï†ÄÏû•</button>
                                <button class="bowling-btn bowling-btn-danger" onclick="bowlingResetAll()">üîÑ ÏÉà Í≤åÏûÑ</button>
                            </div>
                            <div class="bowling-player-tabs" id="bowlingPlayerTabs"></div>
                            <div id="bowlingEditingId" style="display:none;"></div>
                        </div>
                    </div>
                    <div class="bowling-card">
                        <h3 style="font-size:16px; font-weight:700; color:#1e3a5f; margin-bottom:12px;">üéØ <span id="bowlingCurrentPlayerName">ÌîåÎ†àÏù¥Ïñ¥ 1</span>Ïùò Ïä§ÏΩîÏñ¥Î≥¥Îìú</h3>
                        <div class="bowling-scoreboard">
                            <div class="bowling-frames" id="bowlingScoreBoard"></div>
                        </div>
                        <div class="bowling-total-score">
                            <span>Ï¥ù Ï†êÏàò: </span><span id="bowlingTotalScore" class="score">0</span><span> / 300</span>
                        </div>
                    </div>
                    <div class="bowling-card">
                        <div class="bowling-input-section">
                            <div class="bowling-current-frame">
                                üéØ <span id="bowlingCurrentFrameDisplay">ÌîÑÎ†àÏûÑ 1</span> - <span id="bowlingCurrentRollDisplay">1Î≤àÏß∏ Ìà¨Íµ¨</span>
                            </div>
                            <div class="bowling-pin-buttons" id="bowlingPinButtons"></div>
                            <div class="bowling-special-btns">
                                <button class="bowling-btn bowling-btn-strike" id="bowlingStrikeBtn" onclick="bowlingRecordRoll('strike')">‚ö° Ïä§Ìä∏ÎùºÏù¥ÌÅ¨</button>
                                <button class="bowling-btn bowling-btn-spare bowling-hidden" id="bowlingSpareBtn" onclick="bowlingRecordRoll('spare')">üéØ Ïä§ÌéòÏñ¥</button>
                                <button class="bowling-btn bowling-btn-gutter" id="bowlingGutterBtn" onclick="bowlingRecordRoll('gutter')">‚ùå Í±∞ÌÑ∞</button>
                            </div>
                        </div>
                        <div class="bowling-game-over bowling-hidden" id="bowlingGameOver">
                            <h3>üéâ Í≤åÏûÑ Ï¢ÖÎ£å!</h3>
                            <div id="bowlingFinalScore"></div>
                        </div>
                    </div>
                    <!-- Î≥ºÎßÅ Ïö©Ïñ¥ Í∞ÄÏù¥Îìú (ÌôïÏû•) -->
                    <div class="bowling-tips">
                        <h3 onclick="bowlingToggleTips()">üìö Î≥ºÎßÅ Ïö©Ïñ¥ Í∞ÄÏù¥Îìú <span id="bowlingTipToggle">‚ñº</span></h3>
                        <div id="bowlingTipsContent" class="bowling-tips-grid">
                            <div class="bowling-tip"><h4>‚ö° Ïä§Ìä∏ÎùºÏù¥ÌÅ¨ (Strike)</h4><p>Ï≤´ Ìà¨Íµ¨ÏóêÏÑú 10Í∞ú ÌïÄ Î™®Îëê Ïì∞Îü¨Îú®Î¶º. 10Ï†ê + Îã§Ïùå 2Ìà¨Íµ¨ Ï†êÏàò Î≥¥ÎÑàÏä§. Í∏∞Ìò∏: X</p></div>
                            <div class="bowling-tip"><h4>üéØ Ïä§ÌéòÏñ¥ (Spare)</h4><p>Îëê Î≤àÏß∏ Ìà¨Íµ¨Î°ú ÎÇòÎ®∏ÏßÄ ÌïÄ Î™®Îëê Ïì∞Îü¨Îú®Î¶º. 10Ï†ê + Îã§Ïùå 1Ìà¨Íµ¨ Ï†êÏàò Î≥¥ÎÑàÏä§. Í∏∞Ìò∏: /</p></div>
                            <div class="bowling-tip"><h4>ü¶É ÌÑ∞ÌÇ§ (Turkey)</h4><p>Ïó∞ÏÜç 3Î≤à Ïä§Ìä∏ÎùºÏù¥ÌÅ¨. Ï≤´ Î≤àÏß∏ ÌîÑÎ†àÏûÑÏóêÏÑú ÌÑ∞ÌÇ§ Ïãú 30Ï†ê!</p></div>
                            <div class="bowling-tip"><h4>üëë ÌçºÌéôÌä∏ Í≤åÏûÑ (Perfect Game)</h4><p>12Î≤à Ïó∞ÏÜç Ïä§Ìä∏ÎùºÏù¥ÌÅ¨Î°ú 300Ï†ê Îã¨ÏÑ±. Î≥ºÎßÅÏùò ÏµúÍ≥† ÏòÅÏòà!</p></div>
                            <div class="bowling-tip info"><h4>üé≥ ÎçîÎ∏î (Double)</h4><p>Ïó∞ÏÜç 2Î≤à Ïä§Ìä∏ÎùºÏù¥ÌÅ¨. ÌÑ∞ÌÇ§Î°ú Í∞ÄÎäî Ï≤´ Í±∏Ïùå!</p></div>
                            <div class="bowling-tip info"><h4>üî• Ìè¨Ïä§ (Four-bagger)</h4><p>Ïó∞ÏÜç 4Î≤à Ïä§Ìä∏ÎùºÏù¥ÌÅ¨. ÌñÑÎ≥∏(Hambone)Ïù¥ÎùºÍ≥†ÎèÑ Ìï®</p></div>
                            <div class="bowling-tip info"><h4>‚ùå Í±∞ÌÑ∞ (Gutter)</h4><p>Í≥µÏù¥ Î†àÏù∏ ÏñëÏ™Ω ÌôàÏúºÎ°ú Îπ†Ï†∏ 0Ï†ê Ï≤òÎ¶¨. Í∏∞Ìò∏: G</p></div>
                            <div class="bowling-tip info"><h4>üö´ Ïä§ÌîåÎ¶ø (Split)</h4><p>Ï≤´ Ìà¨Íµ¨ ÌõÑ ÌïÄ ÏÇ¨Ïù¥Í∞Ä Î≤åÏñ¥Ï†∏ Ïä§ÌéòÏñ¥ ÏπòÍ∏∞ Ïñ¥Î†§Ïö¥ ÏÉÅÌô©</p></div>
                            <div class="bowling-tip info"><h4>üèÜ ÎçîÏπòÎß® (Dutchman)</h4><p>Ïä§Ìä∏ÎùºÏù¥ÌÅ¨ÏôÄ Ïä§ÌéòÏñ¥Í∞Ä Î≤àÍ∞àÏïÑ ÎÇòÏò§Î©∞ 200Ï†ê Îã¨ÏÑ±</p></div>
                            <div class="bowling-tip info"><h4>üìä Ïï†Î≤ÑÎ¶¨ÏßÄ (Average)</h4><p>ÌèâÍ∑† Ï†êÏàò. ÏïÑÎßàÏ∂îÏñ¥ 150+, Ï§ëÍ∏âÏûê 180+, ÏÉÅÍ∏âÏûê 200+ Î™©Ìëú</p></div>
                            <div class="bowling-tip info"><h4>üéØ Ìè¨Ïºì (Pocket)</h4><p>Ïä§Ìä∏ÎùºÏù¥ÌÅ¨ ÌôïÎ•†Ïù¥ Í∞ÄÏû• ÎÜíÏùÄ ÏßÄÏ†ê. Ïò§Î•∏ÏÜêÏû°Ïù¥: 1-3Î≤à ÌïÄ ÏÇ¨Ïù¥</p></div>
                            <div class="bowling-tip info"><h4>üîÑ ÌõÑÌÅ¨ (Hook)</h4><p>Í≥µÏù¥ Î†àÏù∏ ÎÅùÏóêÏÑú ÌúòÏñ¥ÏßÄÎäî Íµ¨Ïßà. Ïä§Ìä∏ÎùºÏù¥ÌÅ¨ ÌôïÎ•† Ï¶ùÍ∞Ä</p></div>
                        </div>
                    </div>
                    
                    <!-- Î≥ºÎßÅ Ïû•ÎπÑ Í∞ÄÏù¥Îìú (ÏÉàÎ°ú Ï∂îÍ∞Ä) -->
                    <div class="bowling-equipment">
                        <h3 onclick="bowlingToggleEquipment()">üé≥ Î≥ºÎßÅ Ïû•ÎπÑ Í∞ÄÏù¥Îìú <span id="bowlingEquipToggle">‚ñº</span></h3>
                        <div id="bowlingEquipmentContent" class="bowling-equipment-content">
                            <div class="bowling-equipment-item">
                                <h4>üé± Î≥ºÎßÅÍ≥µ (Bowling Ball)</h4>
                                <p>Î≥ºÎßÅÏùò Í∞ÄÏû• Ï§ëÏöîÌïú Ïû•ÎπÑ. Î¨¥Í≤åÏôÄ Ïû¨Ïßà ÏÑ†ÌÉùÏù¥ ÌïµÏã¨!</p>
                                <ul>
                                    <li>Î¨¥Í≤å: ÏÑ±Ïù∏ ÎÇ®ÏÑ± 14-16ÌååÏö¥Îìú, Ïó¨ÏÑ± 10-14ÌååÏö¥Îìú</li>
                                    <li>ÌïòÏö∞Ïä§Î≥º: Î≥ºÎßÅÏû• Ï†úÍ≥µ, ÌîåÎùºÏä§Ìã± Ïû¨Ïßà</li>
                                    <li>Î¶¨Ïï°Ìã∞Î∏åÎ≥º: Í∞úÏù∏Î≥º, Î†àÏù∏Ïóê Î∞òÏùëÌïòÏó¨ ÌõÖ ÏÉùÏÑ±</li>
                                    <li>Ï¥àÎ≥¥Ïûê: Ìé∏ÏïàÌïú Î¨¥Í≤åÏùò ÌïòÏö∞Ïä§Î≥ºÎ°ú ÏãúÏûë Ï∂îÏ≤ú</li>
                                </ul>
                            </div>
                            <div class="bowling-equipment-item">
                                <h4>üëü Î≥ºÎßÅÌôî (Bowling Shoes)</h4>
                                <p>ÏïàÏ†ÑÌïòÍ≥† Ï†ïÌôïÌïú Ïñ¥ÌîÑÎ°úÏπòÎ•º ÏúÑÌïú ÌïÑÏàò Ïû•ÎπÑ</p>
                                <ul>
                                    <li>Ïä¨ÎùºÏù¥Îî© ÏÜî: Î∂ÄÎìúÎü¨Ïö¥ ÎßàÎ¨¥Î¶¨ ÎèôÏûë</li>
                                    <li>ÌïòÏö∞Ïä§ÏäàÏ¶à: ÏñëÏ™Ω Î™®Îëê Ïä¨ÎùºÏù¥Îî©</li>
                                    <li>ÌçºÌè¨Î®ºÏä§ÏäàÏ¶à: ÌïúÏ™ΩÎßå Ïä¨ÎùºÏù¥Îî©, ÌïúÏ™Ω Î∏åÎ†àÏù¥ÌÅ¨</li>
                                    <li>Í∞úÏù∏ Î≥ºÎßÅÌôîÎäî ÏúÑÏÉùÏ†ÅÏù¥Í≥† ÏÑ±Îä•ÎèÑ Ïö∞Ïàò</li>
                                </ul>
                            </div>
                            <div class="bowling-equipment-item">
                                <h4>üß§ Î≥ºÎßÅ Ïï°ÏÑ∏ÏÑúÎ¶¨</h4>
                                <p>Í≤ΩÍ∏∞Î†• Ìñ•ÏÉÅÏùÑ ÏúÑÌïú Î≥¥Ï°∞ Ïû•ÎπÑÎì§</p>
                                <ul>
                                    <li>ÏÜêÎ™© ÏÑúÌè¨ÌÑ∞: ÏÜêÎ™© Í≥†Ï†ï, ÏùºÍ¥ÄÎêú Î¶¥Î¶¨Ïä§</li>
                                    <li>ÌÖåÏù¥ÌîÑ: ÏÜêÍ∞ÄÎùΩ Î≥¥Ìò∏, Í∑∏Î¶Ω Ï°∞Ï†à</li>
                                    <li>ÌååÏö∞ÎçîÎ∞±: ÏÜê ÏäµÍ∏∞ Ï†úÍ±∞</li>
                                    <li>Î≥º ÌÅ¥Î¶¨ÎÑà: Í≥µ Í¥ÄÎ¶¨, ÏÑ±Îä• Ïú†ÏßÄ</li>
                                </ul>
                            </div>
                            <div class="bowling-equipment-item">
                                <h4>üî¢ ÌïÄ Î∞∞Ïπò (Pin Setup)</h4>
                                <p>ÌïÄ Î≤àÌò∏ÏôÄ ÏúÑÏπò Ïù¥Ìï¥ÌïòÍ∏∞</p>
                                <ul>
                                    <li>1Î≤à ÌïÄ: Îß® Ïïû (Ìó§ÎìúÌïÄ)</li>
                                    <li>2-3Î≤à: Îëê Î≤àÏß∏ Ï§Ñ</li>
                                    <li>4-5-6Î≤à: ÏÑ∏ Î≤àÏß∏ Ï§Ñ</li>
                                    <li>7-8-9-10Î≤à: Îß® Îí§ Ï§Ñ</li>
                                </ul>
                            </div>
                            <div class="bowling-equipment-item">
                                <h4>üõ§Ô∏è Î†àÏù∏ Íµ¨Ï°∞</h4>
                                <p>Î≥ºÎßÅ Î†àÏù∏Ïùò Íµ¨ÏÑ± ÏöîÏÜå</p>
                                <ul>
                                    <li>Ïñ¥ÌîÑÎ°úÏπò: Ìà¨Íµ¨ Ï†Ñ ÎèÑÏõÄÎã´Í∏∞ Íµ¨Ïó≠</li>
                                    <li>ÌååÏö∏ÎùºÏù∏: ÎÑòÏúºÎ©¥ ÌååÏö∏, 0Ï†ê Ï≤òÎ¶¨</li>
                                    <li>Î†àÏù∏: ÏïΩ 18m, Ïò§Ïùº Ìå®ÌÑ¥ Ï†ÅÏö©</li>
                                    <li>ÌïÄÎç±: ÌïÄÏù¥ ÏÑ∏ÏõåÏßÄÎäî Íµ¨Ïó≠</li>
                                </ul>
                            </div>
                            <div class="bowling-equipment-item">
                                <h4>üí° Ï¥àÎ≥¥Ïûê ÌåÅ</h4>
                                <p>Ï≤òÏùå ÏãúÏûëÌïòÎäî Î∂ÑÎì§ÏùÑ ÏúÑÌïú Ï°∞Ïñ∏</p>
                                <ul>
                                    <li>Í∞ÄÎ≤ºÏö¥ Í≥µÏúºÎ°ú ÏãúÏûë (10-12ÌååÏö¥Îìú)</li>
                                    <li>4Ïä§ÌÖù Ïñ¥ÌîÑÎ°úÏπò Í∏∞Î≥∏ Ïó∞Ïäµ</li>
                                    <li>ÌôîÏÇ¥Ìëú ÎßàÌÅ¨ Î≥¥Î©∞ Ï°∞Ï§ÄÌïòÍ∏∞</li>
                                    <li>ÌåîÎ°úÏä§Î£®(follow-through) Ï§ëÏöî!</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        let bowlingPlayers = [];
        let bowlingCurrentPlayerIndex = 0;
        let bowlingSavedGames = JSON.parse(localStorage.getItem('bowlingSavedGames') || '[]');
        let bowlingEditingId = null;

        function bowlingCreateEmptyFrames() {
            const frames = [];
            for (let i = 0; i < 10; i++) frames.push({ rolls: [], score: null, cumulative: null });
            return frames;
        }

        function bowlingAddPlayer() {
            const nameInput = document.getElementById('bowlingNewPlayer');
            const name = nameInput.value.trim() || `ÌîåÎ†àÏù¥Ïñ¥ ${bowlingPlayers.length + 1}`;
            bowlingPlayers.push({
                name: name,
                frames: bowlingCreateEmptyFrames(),
                currentFrame: 0,
                currentRoll: 0,
                pinsRemaining: 10,
                gameOver: false
            });
            nameInput.value = '';
            bowlingCurrentPlayerIndex = bowlingPlayers.length - 1;
            bowlingRenderPlayerTabs();
            bowlingRenderScoreBoard();
            bowlingRenderPinButtons();
            bowlingUpdateDisplay();
        }

        function bowlingSelectPlayer(index) {
            bowlingCurrentPlayerIndex = index;
            bowlingRenderPlayerTabs();
            bowlingRenderScoreBoard();
            bowlingRenderPinButtons();
            bowlingUpdateDisplay();
        }

        function bowlingRemovePlayer(index) {
            if (bowlingPlayers.length <= 1) { alert('ÏµúÏÜå 1Î™ÖÏùò ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§.'); return; }
            bowlingPlayers.splice(index, 1);
            if (bowlingCurrentPlayerIndex >= bowlingPlayers.length) bowlingCurrentPlayerIndex = bowlingPlayers.length - 1;
            bowlingRenderPlayerTabs();
            bowlingRenderScoreBoard();
            bowlingRenderPinButtons();
            bowlingUpdateDisplay();
        }

        function bowlingRenderPlayerTabs() {
            const container = document.getElementById('bowlingPlayerTabs');
            container.innerHTML = '';
            bowlingPlayers.forEach((player, index) => {
                const score = bowlingGetPlayerScore(player);
                const tab = document.createElement('div');
                tab.className = `bowling-player-tab ${index === bowlingCurrentPlayerIndex ? 'active' : ''}`;
                tab.innerHTML = `
                    <span onclick="bowlingSelectPlayer(${index})">${player.gameOver ? '‚úÖ' : 'üé≥'} ${player.name} (${score}Ï†ê)</span>
                    <button class="remove-btn" onclick="event.stopPropagation(); bowlingRemovePlayer(${index})">√ó</button>
                `;
                container.appendChild(tab);
            });
            const nameDisplay = document.getElementById('bowlingCurrentPlayerName');
            if (bowlingPlayers[bowlingCurrentPlayerIndex]) {
                nameDisplay.textContent = bowlingPlayers[bowlingCurrentPlayerIndex].name;
            }
        }

        function bowlingGetPlayerScore(player) {
            const lastFrame = player.frames.slice().reverse().find(f => f.cumulative !== null);
            return lastFrame ? lastFrame.cumulative : 0;
        }

        function bowlingRenderScoreBoard() {
            const board = document.getElementById('bowlingScoreBoard');
            board.innerHTML = '';
            const player = bowlingPlayers[bowlingCurrentPlayerIndex];
            if (!player) return;
            for (let i = 0; i < 9; i++) {
                const frame = player.frames[i];
                const roll1 = bowlingGetRollDisplay(frame, 0);
                const roll2 = bowlingGetRollDisplay(frame, 1);
                const score = frame.cumulative !== null ? frame.cumulative : '-';
                const frameDiv = document.createElement('div');
                frameDiv.className = 'bowling-frame';
                frameDiv.innerHTML = `
                    <div class="bowling-frame-header">${i + 1}</div>
                    <div class="bowling-frame-rolls">
                        <div class="bowling-roll">${roll1}</div>
                        <div class="bowling-roll">${roll2}</div>
                    </div>
                    <div class="bowling-frame-score">${score}</div>
                `;
                board.appendChild(frameDiv);
            }
            const frame10 = player.frames[9];
            const r1 = bowlingGetFrame10RollDisplay(frame10, 0);
            const r2 = bowlingGetFrame10RollDisplay(frame10, 1);
            const r3 = bowlingGetFrame10RollDisplay(frame10, 2);
            const score10 = frame10.cumulative !== null ? frame10.cumulative : '-';
            const frame10Div = document.createElement('div');
            frame10Div.className = 'bowling-frame';
            frame10Div.innerHTML = `
                <div class="bowling-frame-header tenth">10</div>
                <div class="bowling-frame-rolls">
                    <div class="bowling-roll">${r1}</div>
                    <div class="bowling-roll">${r2}</div>
                    <div class="bowling-roll">${r3}</div>
                </div>
                <div class="bowling-frame-score">${score10}</div>
            `;
            board.appendChild(frame10Div);
            document.getElementById('bowlingTotalScore').textContent = bowlingGetPlayerScore(player);
        }

        function bowlingGetRollDisplay(frame, rollIndex) {
            if (!frame.rolls[rollIndex] && frame.rolls[rollIndex] !== 0) return '-';
            const pins = frame.rolls[rollIndex];
            if (rollIndex === 0 && pins === 10) return 'X';
            if (rollIndex === 1 && frame.rolls[0] + pins === 10) return '/';
            if (pins === 0) return 'G';
            return pins.toString();
        }

        function bowlingGetFrame10RollDisplay(frame, rollIndex) {
            if (!frame.rolls[rollIndex] && frame.rolls[rollIndex] !== 0) return '-';
            const pins = frame.rolls[rollIndex];
            const rolls = frame.rolls;
            if (rollIndex === 0) return pins === 10 ? 'X' : (pins === 0 ? 'G' : pins.toString());
            if (rollIndex === 1) {
                if (rolls[0] === 10) return pins === 10 ? 'X' : (pins === 0 ? 'G' : pins.toString());
                if (rolls[0] + pins === 10) return '/';
                return pins === 0 ? 'G' : pins.toString();
            }
            if (rollIndex === 2) {
                if (rolls[1] === 10 || (rolls[0] === 10 && rolls[1] === 10)) return pins === 10 ? 'X' : (pins === 0 ? 'G' : pins.toString());
                if (rolls[0] === 10 && rolls[1] + pins === 10) return '/';
                if (rolls[0] + rolls[1] === 10) return pins === 10 ? 'X' : (pins === 0 ? 'G' : pins.toString());
                return pins === 0 ? 'G' : pins.toString();
            }
            return '-';
        }

        function bowlingRenderPinButtons() {
            const container = document.getElementById('bowlingPinButtons');
            container.innerHTML = '';
            const player = bowlingPlayers[bowlingCurrentPlayerIndex];
            if (!player) return;
            for (let i = 0; i <= 10; i++) {
                const btn = document.createElement('button');
                btn.className = 'bowling-pin-btn';
                btn.textContent = i;
                btn.onclick = () => bowlingRecordRoll(i);
                btn.disabled = i > player.pinsRemaining || player.gameOver;
                container.appendChild(btn);
            }
            bowlingUpdateSpecialButtons();
        }

        function bowlingUpdateSpecialButtons() {
            const player = bowlingPlayers[bowlingCurrentPlayerIndex];
            if (!player) return;
            const strikeBtn = document.getElementById('bowlingStrikeBtn');
            const spareBtn = document.getElementById('bowlingSpareBtn');
            const gutterBtn = document.getElementById('bowlingGutterBtn');
            strikeBtn.disabled = player.gameOver;
            spareBtn.disabled = player.gameOver;
            gutterBtn.disabled = player.gameOver;
            if (player.gameOver) { strikeBtn.classList.add('bowling-hidden'); spareBtn.classList.add('bowling-hidden'); return; }
            if (player.currentFrame < 9) {
                if (player.currentRoll === 0) { strikeBtn.classList.remove('bowling-hidden'); spareBtn.classList.add('bowling-hidden'); }
                else { strikeBtn.classList.add('bowling-hidden'); spareBtn.classList.toggle('bowling-hidden', player.pinsRemaining === 0); }
            } else {
                if (player.pinsRemaining === 10) { strikeBtn.classList.remove('bowling-hidden'); spareBtn.classList.add('bowling-hidden'); }
                else if (player.pinsRemaining > 0) { strikeBtn.classList.add('bowling-hidden'); spareBtn.classList.remove('bowling-hidden'); }
                else { strikeBtn.classList.add('bowling-hidden'); spareBtn.classList.add('bowling-hidden'); }
            }
        }

        function bowlingRecordRoll(pins) {
            const player = bowlingPlayers[bowlingCurrentPlayerIndex];
            if (!player || player.gameOver) return;
            let pinsKnocked;
            if (pins === 'strike') pinsKnocked = 10;
            else if (pins === 'spare') pinsKnocked = player.pinsRemaining;
            else if (pins === 'gutter') pinsKnocked = 0;
            else pinsKnocked = pins;
            if (pinsKnocked > player.pinsRemaining) return;
            player.frames[player.currentFrame].rolls.push(pinsKnocked);
            bowlingCalculatePlayerScores(player);
            if (player.currentFrame < 9) {
                if (pinsKnocked === 10 || player.currentRoll === 1) { player.currentFrame++; player.currentRoll = 0; player.pinsRemaining = 10; }
                else { player.currentRoll = 1; player.pinsRemaining -= pinsKnocked; }
            } else {
                const rollCount = player.frames[9].rolls.length;
                if (rollCount === 1) { player.pinsRemaining = pinsKnocked === 10 ? 10 : player.pinsRemaining - pinsKnocked; player.currentRoll = 1; }
                else if (rollCount === 2) {
                    const r0 = player.frames[9].rolls[0], r1 = player.frames[9].rolls[1];
                    if (r0 === 10) { player.pinsRemaining = r1 === 10 ? 10 : 10 - r1; player.currentRoll = 2; }
                    else if (r0 + r1 === 10) { player.pinsRemaining = 10; player.currentRoll = 2; }
                    else { player.gameOver = true; }
                } else if (rollCount === 3) { player.gameOver = true; }
            }
            if (player.currentFrame >= 10) player.gameOver = true;
            bowlingRenderScoreBoard();
            bowlingRenderPinButtons();
            bowlingUpdateDisplay();
            bowlingRenderPlayerTabs();
            if (player.gameOver) bowlingShowGameOver();
        }

        function bowlingCalculatePlayerScores(player) {
            let cumulative = 0;
            for (let i = 0; i < 10; i++) {
                const frame = player.frames[i];
                if (frame.rolls.length === 0) { frame.score = null; frame.cumulative = null; continue; }
                if (i < 9) {
                    if (frame.rolls[0] === 10) {
                        const bonus = bowlingGetNextTwoRolls(player, i);
                        if (bonus !== null) { frame.score = 10 + bonus; cumulative += frame.score; frame.cumulative = cumulative; }
                        else { frame.score = null; frame.cumulative = null; }
                    } else if (frame.rolls.length === 2) {
                        if (frame.rolls[0] + frame.rolls[1] === 10) {
                            const bonus = bowlingGetNextOneRoll(player, i);
                            if (bonus !== null) { frame.score = 10 + bonus; cumulative += frame.score; frame.cumulative = cumulative; }
                            else { frame.score = null; frame.cumulative = null; }
                        } else { frame.score = frame.rolls[0] + frame.rolls[1]; cumulative += frame.score; frame.cumulative = cumulative; }
                    } else { frame.score = null; frame.cumulative = null; }
                } else {
                    const rolls = frame.rolls;
                    if (rolls.length >= 2) {
                        if (rolls[0] === 10 || rolls[0] + rolls[1] === 10) {
                            if (rolls.length === 3) { frame.score = rolls[0] + rolls[1] + rolls[2]; cumulative += frame.score; frame.cumulative = cumulative; }
                            else { frame.score = null; frame.cumulative = null; }
                        } else { frame.score = rolls[0] + rolls[1]; cumulative += frame.score; frame.cumulative = cumulative; }
                    } else { frame.score = null; frame.cumulative = null; }
                }
            }
        }

        function bowlingGetNextTwoRolls(player, frameIndex) {
            let rolls = [];
            for (let i = frameIndex + 1; i < 10 && rolls.length < 2; i++) {
                for (let r of player.frames[i].rolls) { rolls.push(r); if (rolls.length === 2) break; }
            }
            return rolls.length === 2 ? rolls[0] + rolls[1] : null;
        }

        function bowlingGetNextOneRoll(player, frameIndex) {
            for (let i = frameIndex + 1; i < 10; i++) {
                if (player.frames[i].rolls.length > 0) return player.frames[i].rolls[0];
            }
            return null;
        }

        function bowlingUpdateDisplay() {
            const player = bowlingPlayers[bowlingCurrentPlayerIndex];
            if (!player) return;
            if (player.gameOver) {
                document.getElementById('bowlingCurrentFrameDisplay').textContent = 'Í≤åÏûÑ Ï¢ÖÎ£å';
                document.getElementById('bowlingCurrentRollDisplay').textContent = '';
                return;
            }
            document.getElementById('bowlingCurrentFrameDisplay').textContent = `ÌîÑÎ†àÏûÑ ${player.currentFrame + 1}`;
            document.getElementById('bowlingCurrentRollDisplay').textContent = `${player.currentRoll + 1}Î≤àÏß∏ Ìà¨Íµ¨`;
        }

        function bowlingShowGameOver() {
            const gameOverDiv = document.getElementById('bowlingGameOver');
            const player = bowlingPlayers[bowlingCurrentPlayerIndex];
            if (!player) return;
            gameOverDiv.classList.remove('bowling-hidden');
            document.getElementById('bowlingFinalScore').innerHTML = `<p style="font-size:20px; font-weight:700;">${player.name}: ${bowlingGetPlayerScore(player)}Ï†ê</p>`;
        }

        function bowlingResetAll() {
            if (!confirm('ÏÉà Í≤åÏûÑÏùÑ ÏãúÏûëÌïòÏãúÍ≤†ÏäµÎãàÍπå? Ï†ÄÏû•ÌïòÏßÄ ÏïäÏùÄ Îç∞Ïù¥ÌÑ∞Îäî ÏÇ¨ÎùºÏßëÎãàÎã§.')) return;
            bowlingPlayers = [{
                name: 'ÌîåÎ†àÏù¥Ïñ¥ 1',
                frames: bowlingCreateEmptyFrames(),
                currentFrame: 0,
                currentRoll: 0,
                pinsRemaining: 10,
                gameOver: false
            }];
            bowlingCurrentPlayerIndex = 0;
            bowlingEditingId = null;
            document.getElementById('bowlingDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('bowlingLocation').value = '';
            document.getElementById('bowlingGameOver').classList.add('bowling-hidden');
            bowlingRenderPlayerTabs();
            bowlingRenderScoreBoard();
            bowlingRenderPinButtons();
            bowlingUpdateDisplay();
        }

        function bowlingToggleTips() {
            const content = document.getElementById('bowlingTipsContent');
            const toggle = document.getElementById('bowlingTipToggle');
            content.classList.toggle('bowling-hidden');
            toggle.textContent = content.classList.contains('bowling-hidden') ? '‚ñ∂' : '‚ñº';
        }

        function bowlingToggleEquipment() {
            const content = document.getElementById('bowlingEquipmentContent');
            const toggle = document.getElementById('bowlingEquipToggle');
            content.classList.toggle('bowling-hidden');
            toggle.textContent = content.classList.contains('bowling-hidden') ? '‚ñ∂' : '‚ñº';
        }

        function bowlingToggleSavedGames() {
            const content = document.getElementById('bowlingSavedGamesContent');
            const toggle = document.getElementById('bowlingSavedToggle');
            content.classList.toggle('bowling-hidden');
            toggle.textContent = content.classList.contains('bowling-hidden') ? '‚ñ∂' : '‚ñº';
        }

        function bowlingSaveGame() {
            const date = document.getElementById('bowlingDate').value;
            const location = document.getElementById('bowlingLocation').value.trim();
            if (!date) { alert('ÎÇ†ÏßúÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî'); return; }
            if (bowlingPlayers.length === 0) { alert('ÏµúÏÜå 1Î™ÖÏùò ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§'); return; }
            
            const gameData = {
                id: bowlingEditingId || Date.now().toString(),
                date: date,
                location: location || 'ÎØ∏ÏûÖÎ†•',
                players: JSON.parse(JSON.stringify(bowlingPlayers)),
                savedAt: new Date().toISOString()
            };
            
            if (bowlingEditingId) {
                const index = bowlingSavedGames.findIndex(g => g.id === bowlingEditingId);
                if (index >= 0) bowlingSavedGames[index] = gameData;
                bowlingEditingId = null;
                alert('Í≤åÏûÑÏù¥ ÏàòÏ†ïÎêòÏóàÏäµÎãàÎã§!');
            } else {
                bowlingSavedGames.unshift(gameData);
                alert('Í≤åÏûÑÏù¥ Ï†ÄÏû•ÎêòÏóàÏäµÎãàÎã§!');
            }
            
            localStorage.setItem('bowlingSavedGames', JSON.stringify(bowlingSavedGames));
            bowlingRenderSavedGames();
        }

        function bowlingLoadGame(id) {
            const game = bowlingSavedGames.find(g => g.id === id);
            if (!game) return;
            
            bowlingEditingId = id;
            document.getElementById('bowlingDate').value = game.date;
            document.getElementById('bowlingLocation').value = game.location === 'ÎØ∏ÏûÖÎ†•' ? '' : game.location;
            bowlingPlayers = JSON.parse(JSON.stringify(game.players));
            bowlingCurrentPlayerIndex = 0;
            
            document.getElementById('bowlingGameOver').classList.add('bowling-hidden');
            bowlingRenderPlayerTabs();
            bowlingRenderScoreBoard();
            bowlingRenderPinButtons();
            bowlingUpdateDisplay();
            alert('Í≤åÏûÑÏùÑ Î∂àÎü¨ÏôîÏäµÎãàÎã§. ÏàòÏ†ï ÌõÑ Ï†ÄÏû•ÌïòÏÑ∏Ïöî!');
        }

        function bowlingDeleteGame(id) {
            if (!confirm('Ïù¥ Í≤åÏûÑÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
            bowlingSavedGames = bowlingSavedGames.filter(g => g.id !== id);
            localStorage.setItem('bowlingSavedGames', JSON.stringify(bowlingSavedGames));
            bowlingRenderSavedGames();
        }

        function bowlingRenderSavedGames() {
            const container = document.getElementById('bowlingGameList');
            if (bowlingSavedGames.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #888; padding: 20px;">Ï†ÄÏû•Îêú Í≤åÏûÑÏù¥ ÏóÜÏäµÎãàÎã§.</p>';
                return;
            }
            
            container.innerHTML = bowlingSavedGames.map(game => {
                const playerSummary = game.players.map(p => {
                    const score = bowlingGetPlayerScore(p);
                    return `${p.name}: ${score}Ï†ê${p.gameOver ? '‚úÖ' : ''}`;
                }).join(', ');
                
                return `
                    <div class="bowling-game-item">
                        <div class="bowling-game-info">
                            <h4>üìÖ ${game.date} | üìç ${game.location}</h4>
                            <p>üë• ${playerSummary}</p>
                        </div>
                        <div class="bowling-game-actions">
                            <button style="background:#f59e0b; color:white;" onclick="bowlingLoadGame('${game.id}')">üìù ÏàòÏ†ï</button>
                            <button style="background:#ef4444; color:white;" onclick="bowlingDeleteGame('${game.id}')">üóëÔ∏è ÏÇ≠Ï†ú</button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function initBowlingScoreCalculator() {
            bowlingPlayers = [{
                name: 'ÌîåÎ†àÏù¥Ïñ¥ 1',
                frames: bowlingCreateEmptyFrames(),
                currentFrame: 0,
                currentRoll: 0,
                pinsRemaining: 10,
                gameOver: false
            }];
            bowlingCurrentPlayerIndex = 0;
            bowlingEditingId = null;
            bowlingSavedGames = JSON.parse(localStorage.getItem('bowlingSavedGames') || '[]');
            document.getElementById('bowlingDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('bowlingGameOver').classList.add('bowling-hidden');
            bowlingRenderPlayerTabs();
            bowlingRenderScoreBoard();
            bowlingRenderPinButtons();
            bowlingUpdateDisplay();
            bowlingRenderSavedGames();
        }
    </script>
</body>
</html>